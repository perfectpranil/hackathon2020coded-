/*!
 * 
 * Copyright (C) 2019 HERE Global B.V. and its affiliate(s). All rights reserved.
 * 
 * To see full license please visit URL below
 * https://platform.here.com/visualization-library/LICENSE
 * 
 * The bundle contains open source software. Please visit URL below for overview of the licenses
 * https://platform.here.com/visualization-library/HERE_NOTICE
 */!function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=255)}([function(e,t){e.exports=THREE},function(e,t,r){"use strict";function i(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),i(r(257)),i(r(258)),i(r(262)),i(r(263)),i(r(264)),i(r(265)),i(r(266)),i(r(267)),i(r(268)),i(r(269)),i(r(270)),i(r(80)),i(r(271)),i(r(272))},function(e,t,r){"use strict";function i(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),i(r(78)),i(r(124)),i(r(54)),i(r(41)),i(r(55)),i(r(274)),i(r(275)),i(r(276)),i(r(130)),i(r(290)),i(r(307)),i(r(129))},function(e,t,r){"use strict";var i=r(8),n=r(15),o=r(249),a=r(123),s=r(250),c=r(251),l=r(252),u=r(253),d=r(254),h=r(77),m=r(76),p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function(e,t){for(var r=Object.getOwnPropertyNames(t),i=0;i<r.length;i++){var n=r[i],o=Object.getOwnPropertyDescriptor(t,n);o&&o.configurable&&void 0===e[n]&&Object.defineProperty(e,n,o)}}(e,t))}function v(){}var _=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=g(this,e.call(this));if(o.options=Object(h.b)(r),o.services={},o.logger=i.a,o.modules={external:[]},n&&!o.isInitialized&&!r.isClone){var a;if(!o.options.initImmediate)return a=o.init(r,n),g(o,a);setTimeout((function(){o.init(r,n)}),0)}return o}return y(t,e),t.prototype.init=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];function n(e){return e?"function"==typeof e?new e:e:null}if("function"==typeof t&&(r=t,t={}),this.options=f({},Object(h.a)(),this.options,Object(h.b)(t)),this.format=this.options.interpolation.format,r||(r=v),!this.options.isClone){this.modules.logger?i.a.init(n(this.modules.logger),this.options):i.a.init(null,this.options);var m=new s.a(this.options);this.store=new o.a(this.options.resources,this.options);var p=this.services;p.logger=i.a,p.resourceStore=this.store,p.resourceStore.on("added removed",(function(e,t){p.cacheConnector.save()})),p.languageUtils=m,p.pluralResolver=new c.a(m,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),p.interpolator=new l.a(this.options),p.backendConnector=new u.a(n(this.modules.backend),p.resourceStore,p,this.options),p.backendConnector.on("*",(function(t){for(var r=arguments.length,i=Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];e.emit.apply(e,[t].concat(i))})),p.backendConnector.on("loaded",(function(e){p.cacheConnector.save()})),p.cacheConnector=new d.a(n(this.modules.cache),p.resourceStore,p,this.options),p.cacheConnector.on("*",(function(t){for(var r=arguments.length,i=Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];e.emit.apply(e,[t].concat(i))})),this.modules.languageDetector&&(p.languageDetector=n(this.modules.languageDetector),p.languageDetector.init(p,this.options.detection,this.options)),this.translator=new a.a(this.services,this.options),this.translator.on("*",(function(t){for(var r=arguments.length,i=Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];e.emit.apply(e,[t].concat(i))})),this.modules.external.forEach((function(t){t.init&&t.init(e)}))}var g=["getResource","addResource","addResources","addResourceBundle","removeResourceBundle","hasResourceBundle","getResourceBundle"];g.forEach((function(t){e[t]=function(){var r;return(r=e.store)[t].apply(r,arguments)}}));var y=function(){e.changeLanguage(e.options.lng,(function(t,i){e.isInitialized=!0,e.logger.log("initialized",e.options),e.emit("initialized",e.options),r(t,i)}))};return this.options.resources||!this.options.initImmediate?y():setTimeout(y,0),this},t.prototype.loadResources=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;if(this.options.resources)t(null);else{if(this.language&&"cimode"===this.language.toLowerCase())return t();var r=[],i=function(t){t&&e.services.languageUtils.toResolveHierarchy(t).forEach((function(e){r.indexOf(e)<0&&r.push(e)}))};if(this.language)i(this.language);else{var n=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);n.forEach((function(e){return i(e)}))}this.options.preload&&this.options.preload.forEach((function(e){return i(e)})),this.services.cacheConnector.load(r,this.options.ns,(function(){e.services.backendConnector.load(r,e.options.ns,t)}))}},t.prototype.reloadResources=function(e,t){e||(e=this.languages),t||(t=this.options.ns),this.services.backendConnector.reload(e,t)},t.prototype.use=function(e){return"backend"===e.type&&(this.modules.backend=e),"cache"===e.type&&(this.modules.cache=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"postProcessor"===e.type&&m.a.addPostProcessor(e),"3rdParty"===e.type&&this.modules.external.push(e),this},t.prototype.changeLanguage=function(e,t){var r=this,i=function(e){e&&(r.language=e,r.languages=r.services.languageUtils.toResolveHierarchy(e),r.translator.language||r.translator.changeLanguage(e),r.services.languageDetector&&r.services.languageDetector.cacheUserLanguage(e)),r.loadResources((function(i){!function(e,i){r.translator.changeLanguage(i),i&&(r.emit("languageChanged",i),r.logger.log("languageChanged",i)),t&&t(e,(function(){return r.t.apply(r,arguments)}))}(i,e)}))};e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(i):i(e):i(this.services.languageDetector.detect())},t.prototype.getFixedT=function(e,t){var r=this,i=function e(t,i){for(var n=arguments.length,o=Array(n>2?n-2:0),a=2;a<n;a++)o[a-2]=arguments[a];var s=f({},i);return"object"!==(void 0===i?"undefined":p(i))&&(s=r.options.overloadTranslationOptionHandler([t,i].concat(o))),s.lng=s.lng||e.lng,s.lngs=s.lngs||e.lngs,s.ns=s.ns||e.ns,r.t(t,s)};return"string"==typeof e?i.lng=e:i.lngs=e,i.ns=t,i},t.prototype.t=function(){var e;return this.translator&&(e=this.translator).translate.apply(e,arguments)},t.prototype.exists=function(){var e;return this.translator&&(e=this.translator).exists.apply(e,arguments)},t.prototype.setDefaultNamespace=function(e){this.options.defaultNS=e},t.prototype.loadNamespaces=function(e,t){var r=this;if(!this.options.ns)return t&&t();"string"==typeof e&&(e=[e]),e.forEach((function(e){r.options.ns.indexOf(e)<0&&r.options.ns.push(e)})),this.loadResources(t)},t.prototype.loadLanguages=function(e,t){"string"==typeof e&&(e=[e]);var r=this.options.preload||[],i=e.filter((function(e){return r.indexOf(e)<0}));if(!i.length)return t();this.options.preload=r.concat(i),this.loadResources(t)},t.prototype.dir=function(e){if(e||(e=this.languages&&this.languages.length>0?this.languages[0]:this.language),!e)return"rtl";return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"].indexOf(this.services.languageUtils.getLanguagePartFromCode(e))>=0?"rtl":"ltr"},t.prototype.createInstance=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];return new t(e,r)},t.prototype.cloneInstance=function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v,n=f({},this.options,r,{isClone:!0}),o=new t(n),s=["store","services","language"];return s.forEach((function(t){o[t]=e[t]})),o.translator=new a.a(o.services,o.options),o.translator.on("*",(function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];o.emit.apply(o,[e].concat(r))})),o.init(n,i),o.translator.options=o.options,o},t}(n.a);t.a=new _},function(e,t,r){"use strict";function i(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),i(r(42)),i(r(277)),i(r(17)),i(r(278)),i(r(279)),i(r(28)),i(r(131)),i(r(280)),i(r(31)),i(r(56)),i(r(132)),i(r(281)),i(r(133)),i(r(134)),i(r(57)),i(r(282)),i(r(135)),i(r(58)),i(r(136)),i(r(137)),i(r(43)),i(r(283)),i(r(284)),i(r(285)),i(r(286)),i(r(287)),i(r(29)),i(r(30)),i(r(18)),i(r(288)),i(r(289))},function(e,t,r){"use strict";function i(e){return null==e?"":""+e}function n(e,t,r){e.forEach((function(e){t[e]&&(r[e]=t[e])}))}function o(e,t,r){function i(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function n(){return!e||"string"==typeof e}for(var o="string"!=typeof t?[].concat(t):t.split(".");o.length>1;){if(n())return{};var a=i(o.shift());!e[a]&&r&&(e[a]=new r),e=e[a]}return n()?{}:{obj:e,k:i(o.shift())}}function a(e,t,r){var i=o(e,t,Object);i.obj[i.k]=r}function s(e,t,r,i){var n=o(e,t,Object),a=n.obj,s=n.k;a[s]=a[s]||[],i&&(a[s]=a[s].concat(r)),i||a[s].push(r)}function c(e,t){var r=o(e,t),i=r.obj,n=r.k;if(i)return i[n]}function l(e,t,r){for(var i in t)i in e?"string"==typeof e[i]||e[i]instanceof String||"string"==typeof t[i]||t[i]instanceof String?r&&(e[i]=t[i]):l(e[i],t[i],r):e[i]=t[i];return e}function u(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}r.d(t,"e",(function(){return i})),r.d(t,"a",(function(){return n})),r.d(t,"h",(function(){return a})),r.d(t,"f",(function(){return s})),r.d(t,"d",(function(){return c})),r.d(t,"b",(function(){return l})),r.d(t,"g",(function(){return u})),r.d(t,"c",(function(){return h}));var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function h(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,(function(e){return d[e]})):e}},function(e,t,r){"use strict";var i=r(22),n=r(200),o=r(73),a=r(403),s=r(51);function c(e){return e}function l(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}t.newBlob=function(e,r){t.checkSupport("blob");try{return new Blob([e],{type:r})}catch(t){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return i.append(e),i.getBlob(r)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(e,t,r){var i=[],n=0,o=e.length;if(o<=r)return String.fromCharCode.apply(null,e);for(;n<o;)"array"===t||"nodebuffer"===t?i.push(String.fromCharCode.apply(null,e.slice(n,Math.min(n+r,o)))):i.push(String.fromCharCode.apply(null,e.subarray(n,Math.min(n+r,o)))),n+=r;return i.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,o.allocBuffer(1)).length}catch(e){return!1}}()}};function d(e){var r=65536,i=t.getTypeOf(e),n=!0;if("uint8array"===i?n=u.applyCanBeUsed.uint8array:"nodebuffer"===i&&(n=u.applyCanBeUsed.nodebuffer),n)for(;r>1;)try{return u.stringifyByChunk(e,i,r)}catch(e){r=Math.floor(r/2)}return u.stringifyByChar(e)}function h(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}t.applyFromCharCode=d;var m={};m.string={string:c,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return m.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,o.allocBuffer(e.length))}},m.array={string:d,array:c,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(e)}},m.arraybuffer={string:function(e){return d(new Uint8Array(e))},array:function(e){return h(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:c,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(new Uint8Array(e))}},m.uint8array={string:d,array:function(e){return h(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:c,nodebuffer:function(e){return o.newBufferFrom(e)}},m.nodebuffer={string:d,array:function(e){return h(e,new Array(e.length))},arraybuffer:function(e){return m.nodebuffer.uint8array(e).buffer},uint8array:function(e){return h(e,new Uint8Array(e.length))},nodebuffer:c},t.transformTo=function(e,r){if(r||(r=""),!e)return r;t.checkSupport(e);var i=t.getTypeOf(r);return m[i][e](r)},t.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":i.nodebuffer&&o.isBuffer(e)?"nodebuffer":i.uint8array&&e instanceof Uint8Array?"uint8array":i.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},t.checkSupport=function(e){if(!i[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(e){var t,r,i="";for(r=0;r<(e||"").length;r++)i+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return i},t.delay=function(e,t,r){a((function(){e.apply(r||null,t||[])}))},t.inherits=function(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r},t.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},t.prepareContent=function(e,r,o,a,c){return s.Promise.resolve(r).then((function(e){return i.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new s.Promise((function(t,r){var i=new FileReader;i.onload=function(e){t(e.target.result)},i.onerror=function(e){r(e.target.error)},i.readAsArrayBuffer(e)})):e})).then((function(r){var u,d=t.getTypeOf(r);return d?("arraybuffer"===d?r=t.transformTo("uint8array",r):"string"===d&&(c?r=n.decode(r):o&&!0!==a&&(r=l(u=r,i.uint8array?new Uint8Array(u.length):new Array(u.length)))),r):s.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},function(e,t,r){"use strict";var i,n,o=e.exports=r(16),a=r(221);o.codegen=r(439),o.fetch=r(440),o.path=r(441),o.fs=o.inquire("fs"),o.toArray=function(e){if(e){for(var t=Object.keys(e),r=new Array(t.length),i=0;i<t.length;)r[i]=e[t[i++]];return r}return[]},o.toObject=function(e){for(var t={},r=0;r<e.length;){var i=e[r++],n=e[r++];void 0!==n&&(t[i]=n)}return t};var s=/\\/g,c=/"/g;o.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},o.safeProp=function(e){return!/^[$\w_]+$/.test(e)||o.isReserved(e)?'["'+e.replace(s,"\\\\").replace(c,'\\"')+'"]':"."+e},o.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var l=/_([a-z])/g;o.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(l,(function(e,t){return t.toUpperCase()}))},o.compareFieldsById=function(e,t){return e.id-t.id},o.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(o.decorateRoot.remove(e.$type),e.$type.name=t,o.decorateRoot.add(e.$type)),e.$type;i||(i=r(109));var n=new i(t||e.name);return o.decorateRoot.add(n),n.ctor=e,Object.defineProperty(e,"$type",{value:n,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:n,enumerable:!1}),n};var u=0;o.decorateEnum=function(e){if(e.$type)return e.$type;n||(n=r(14));var t=new n("Enum"+u++,e);return o.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t},Object.defineProperty(o,"decorateRoot",{get:function(){return a.decorated||(a.decorated=new(r(114)))}})},function(e,t,r){"use strict";var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};var n={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,t){var r;console&&console[e]&&(r=console)[e].apply(r,function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(t))}},o=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init(t,r)}return e.prototype.init=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||n,this.options=t,this.debug=t.debug},e.prototype.setDebug=function(e){this.debug=e},e.prototype.log=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"log","",!0)},e.prototype.warn=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"warn","",!0)},e.prototype.error=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"error","")},e.prototype.deprecate=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)},e.prototype.forward=function(e,t,r,i){return i&&!this.debug?null:("string"==typeof e[0]&&(e[0]=""+r+this.prefix+" "+e[0]),this.logger[t](e))},e.prototype.create=function(t){return new e(this.logger,i({prefix:this.prefix+":"+t+":"},this.options))},e}();t.a=new o},function(e,t,r){"use strict";function i(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),i(r(146)),i(r(335)),i(r(336)),i(r(337)),i(r(341)),i(r(85)),i(r(342)),i(r(343)),i(r(344)),i(r(147)),i(r(345)),i(r(346)),i(r(347))},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){void 0===t&&(t=!1),this.url=e,this.hasQuery=t}return e.stringifyQuery=function(t){var r="";for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];void 0!==n&&(r=e.appendQueryString(r,"",i,n))}return r},e.toString=function(e){return"string"==typeof e?e:e.toString()},e.appendQueryString=function(e,t,r,i){return e+=t,e+=encodeURIComponent(r)+"=",e+="number"==typeof i?i.toString():"string"==typeof i?encodeURIComponent(i):i.map((function(e){return encodeURIComponent(e)})).join(",")},e.prototype.appendQuery=function(t,r){void 0!==r&&(this.url=e.appendQueryString(this.url,this.hasQuery?"&":"?",t,r),this.hasQuery=!0)},e}();t.UrlBuilder=o;var a=function(){function e(e){this.baseUrl=e}return e.prototype.request=function(e,t){return i(this,void 0,void 0,(function(){return n(this,(function(r){return[2,this.download(e.url,t)]}))}))},e}();t.RequestBuilder=a},function(e,t,r){"use strict";function i(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},e.exports=i},function(e,t,r){"use strict";function i(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),i(r(138)),i(r(308)),i(r(309)),i(r(19)),i(r(310))},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r(25);function n(e,t,r,n,s,l,u,d){if(n/=t,l>=(r/=t)&&u<n)return e;if(u<r||l>=n)return null;for(var h=[],m=0;m<e.length;m++){var p=e[m],f=p.geometry,g=p.type,y=0===s?p.minX:p.minY,v=0===s?p.maxX:p.maxY;if(y>=r&&v<n)h.push(p);else if(!(v<r||y>=n)){var _=[];if("Point"===g||"MultiPoint"===g)o(f,_,r,n,s);else if("LineString"===g)a(f,_,r,n,s,!1,d.lineMetrics);else if("MultiLineString"===g)c(f,_,r,n,s,!1);else if("Polygon"===g)c(f,_,r,n,s,!0);else if("MultiPolygon"===g)for(var b=0;b<f.length;b++){var S=[];c(f[b],S,r,n,s,!0),S.length&&_.push(S)}if(_.length){if(d.lineMetrics&&"LineString"===g){for(b=0;b<_.length;b++)h.push(Object(i.a)(p.id,g,_[b],p.tags));continue}"LineString"!==g&&"MultiLineString"!==g||(1===_.length?(g="LineString",_=_[0]):g="MultiLineString"),"Point"!==g&&"MultiPoint"!==g||(g=3===_.length?"Point":"MultiPoint"),h.push(Object(i.a)(p.id,g,_,p.tags))}}}return h.length?h:null}function o(e,t,r,i,n){for(var o=0;o<e.length;o+=3){var a=e[o+n];a>=r&&a<=i&&(t.push(e[o]),t.push(e[o+1]),t.push(e[o+2]))}}function a(e,t,r,i,n,o,a){for(var c,h,m=s(e),p=0===n?u:d,f=e.start,g=0;g<e.length-3;g+=3){var y=e[g],v=e[g+1],_=e[g+2],b=e[g+3],S=e[g+4],T=0===n?y:v,E=0===n?b:S,w=!1;a&&(c=Math.sqrt(Math.pow(y-b,2)+Math.pow(v-S,2))),T<r?E>r&&(h=p(m,y,v,b,S,r),a&&(m.start=f+c*h)):T>i?E<i&&(h=p(m,y,v,b,S,i),a&&(m.start=f+c*h)):l(m,y,v,_),E<r&&T>=r&&(h=p(m,y,v,b,S,r),w=!0),E>i&&T<=i&&(h=p(m,y,v,b,S,i),w=!0),!o&&w&&(a&&(m.end=f+c*h),t.push(m),m=s(e)),a&&(f+=c)}var C=e.length-3;y=e[C],v=e[C+1],_=e[C+2],(T=0===n?y:v)>=r&&T<=i&&l(m,y,v,_),C=m.length-3,o&&C>=3&&(m[C]!==m[0]||m[C+1]!==m[1])&&l(m,m[0],m[1],m[2]),m.length&&t.push(m)}function s(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function c(e,t,r,i,n,o){for(var s=0;s<e.length;s++)a(e[s],t,r,i,n,o,!1)}function l(e,t,r,i){e.push(t),e.push(r),e.push(i)}function u(e,t,r,i,n,o){var a=(o-t)/(i-t);return e.push(o),e.push(r+(n-r)*a),e.push(1),a}function d(e,t,r,i,n,o){var a=(o-r)/(n-r);return e.push(t+(i-t)*a),e.push(o),e.push(1),a}},function(e,t,r){"use strict";e.exports=a;var i=r(38);((a.prototype=Object.create(i.prototype)).constructor=a).className="Enum";var n=r(52),o=r(7);function a(e,t,r,n,o){if(i.call(this,e,r),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=n,this.comments=o||{},this.reserved=void 0,t)for(var a=Object.keys(t),s=0;s<a.length;++s)"number"==typeof t[a[s]]&&(this.valuesById[this.values[a[s]]=t[a[s]]]=a[s])}a.fromJSON=function(e,t){var r=new a(e,t.values,t.options,t.comment,t.comments);return r.reserved=t.reserved,r},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},a.prototype.add=function(e,t,r){if(!o.isString(e))throw TypeError("name must be a string");if(!o.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return this.comments[e]=r||null,this},a.prototype.remove=function(e){if(!o.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this},a.prototype.isReservedId=function(e){return n.isReservedId(this.reserved,e)},a.prototype.isReservedName=function(e){return n.isReservedName(this.reserved,e)}},function(e,t,r){"use strict";var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observers={}}return e.prototype.on=function(e,t){var r=this;e.split(" ").forEach((function(e){r.observers[e]=r.observers[e]||[],r.observers[e].push(t)}))},e.prototype.off=function(e,t){var r=this;this.observers[e]&&this.observers[e].forEach((function(){if(t){var i=r.observers[e].indexOf(t);i>-1&&r.observers[e].splice(i,1)}else delete r.observers[e]}))},e.prototype.emit=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];if(this.observers[e]){var n=[].concat(this.observers[e]);n.forEach((function(e){e.apply(void 0,r)}))}if(this.observers["*"]){var o=[].concat(this.observers["*"]);o.forEach((function(t){var i;t.apply(t,(i=[e]).concat.apply(i,r))}))}},e}();t.a=i},function(e,t,r){"use strict";(function(e){var i=t;function n(e,t,r){for(var i=Object.keys(t),n=0;n<i.length;++n)void 0!==e[i[n]]&&r||(e[i[n]]=t[i[n]]);return e}function o(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&n(this,r)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}i.asPromise=r(218),i.base64=r(430),i.EventEmitter=r(431),i.float=r(432),i.inquire=r(219),i.utf8=r(433),i.pool=r(434),i.LongBits=r(435),i.global="undefined"!=typeof window&&window||void 0!==e&&e||"undefined"!=typeof self&&self||this,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isNode=Boolean(i.global.process&&i.global.process.versions&&i.global.process.versions.node),i.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},i.isString=function(e){return"string"==typeof e||e instanceof String},i.isObject=function(e){return e&&"object"==typeof e},i.isset=i.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},i.Buffer=function(){try{var e=i.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(e){return"number"==typeof e?i.Buffer?i._Buffer_allocUnsafe(e):new i.Array(e):i.Buffer?i._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},i.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(e){return e?i.LongBits.from(e).toHash():i.LongBits.zeroHash},i.longFromHash=function(e,t){var r=i.LongBits.fromHash(e);return i.Long?i.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},i.merge=n,i.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},i.newError=o,i.ProtocolError=o("ProtocolError"),i.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},i.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var e=i.Buffer;e?(i._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},i._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):i._Buffer_from=i._Buffer_allocUnsafe=null}}).call(this,r(23))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);class n{constructor(e,t,r){this.latitude=e,this.longitude=t,this.altitude=r}static fromDegrees(e,t,r){return new n(e,t,r)}static fromRadians(e,t,r){return new n(i.Math.radToDeg(e),i.Math.radToDeg(t),r)}static fromLatLng(e){return new n(e.lat,e.lng)}static fromGeoPoint(e){return new n(e[1],e[0],e[2])}get latitudeInRadians(){return i.Math.degToRad(this.latitude)}get longitudeInRadians(){return i.Math.degToRad(this.longitude)}get latitudeInDegrees(){return this.latitude}get longitudeInDegrees(){return this.longitude}get lat(){return this.latitude}get lng(){return this.longitude}isValid(){return!isNaN(this.latitude)&&!isNaN(this.longitude)}normalized(){let{latitude:e,longitude:t}=this;if(isNaN(e)||isNaN(t))return this;if(e>90){let r=(e+90)%360;r>=180&&(t+=180,r=360-r),e=r-90}if(e<-90){let r=(e-90)%360;r<=-180&&(t+=180,r=-360-r),e=r+90}if(t<-180||t>180){const e=Math.sign(t);t=(t%360+180*e)%360-180*e}return e===this.latitude&&t===this.longitude?this:new n(e,t,this.altitude)}equals(e){return this.latitude===e.latitude&&this.longitude===e.longitude&&this.altitude===e.altitude}copy(e){return this.latitude=e.latitude,this.longitude=e.longitude,this.altitude=e.altitude,this}clone(){return new n(this.latitude,this.longitude,this.altitude)}toLatLng(){return{lat:this.latitude,lng:this.longitude}}toGeoPoint(){return void 0!==this.altitude?[this.longitude,this.latitude,this.altitude]:[this.longitude,this.latitude]}}t.GeoCoordinates=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);!function(e){function t(e){return(e%=360)<0&&(e+=360),e}function r(e,r){const i=(e=t(e))-(r=t(r));return i>180?i-360:i<=-180?i+360:i}e.newEmptyBox3=function(){return{min:{x:1/0,y:1/0,z:1/0},max:{x:-1/0,y:-1/0,z:-1/0}}},e.newVector3=function(e,t,r,i){return void 0===i?{x:e,y:t,z:r}:(i.x=e,i.y=t,i.z=r,i)},e.degToRad=i.Math.degToRad,e.radToDeg=i.Math.radToDeg,e.clamp=i.Math.clamp,e.normalizeAngleDeg=t,e.angleDistanceDeg=r,e.interpolateAnglesDeg=function(e,t,i){return(e+r(t,e)*i)%360}}(t.MathUtils||(t.MathUtils={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(291),n=r(304),o=r(41),a=r(55),s=r(54);!function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(305));const c=new i.ExprEvaluator;class l{constructor(){this.properties=new Set}}t.ExprDependencies=l;class u{static of(e){const t=new l;return e.accept(this.instance,t),t}visitNullLiteralExpr(e,t){}visitBooleanLiteralExpr(e,t){}visitNumberLiteralExpr(e,t){}visitStringLiteralExpr(e,t){}visitObjectLiteralExpr(e,t){}visitVarExpr(e,t){t.properties.add(e.name)}visitHasAttributeExpr(e,t){t.properties.add(e.name)}visitContainsExpr(e,t){e.value.accept(this,t)}visitCallExpr(e,t){"zoom"===e.op&&0===e.args.length?t.zoom=!0:e.args.forEach(e=>e.accept(this,t))}visitMatchExpr(e,t){e.value.accept(this,t),e.branches.forEach(([e,r])=>r.accept(this,t)),e.fallback.accept(this,t)}visitCaseExpr(e,t){e.branches.forEach(([e,r])=>{e.accept(this,t),r.accept(this,t)}),e.fallback.accept(this,t)}}function d(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]}var h;u.instance=new u,t.isJsonExpr=d,function(e){e[e.Value=0]="Value",e[e.Condition=1]="Condition"}(h=t.ExprScope||(t.ExprScope={}));class m{static parse(e){return new n.ExprParser(e).parse()}static fromJSON(e,t,r){const i=void 0!==t?{definitions:t,lockedNames:new Set,cache:r||new Map}:void 0;return m.parseNode(e,i)}static parseNode(e,t){if(Array.isArray(e))return m.parseCall(e,t);if(null===e)return g.instance;if("boolean"==typeof e)return new y(e);if("number"==typeof e)return new v(e);if("string"==typeof e)return new _(e);throw new Error(`failed to create expression from: ${JSON.stringify(e)}`)}static parseCall(e,t){const r=e[0];if("string"!=typeof r)throw new Error("expected a builtin function name");switch(r){case"!has":case"!in":return new E("!",[this.parseCall([r.slice(1),...e.slice(1)])]);case"ref":return m.resolveReference(e,t);case"get":return m.parseGetExpr(e,t);case"has":return m.parseHasExpr(e,t);case"in":return m.parseInExpr(e,t);case"literal":return m.parseLiteralExpr(e);case"match":return m.parseMatchExpr(e,t);case"case":return m.parseCaseExpr(e,t);default:return this.makeCallExpr(r,e,t)}}static parseGetExpr(e,t){if(void 0!==e[2])return m.makeCallExpr("get",e,t);const r=e[1];if("string"!=typeof r)throw new Error("expected the name of an attribute");return new p(r)}static parseHasExpr(e,t){if(void 0!==e[2])return m.makeCallExpr("has",e,t);const r=e[1];if("string"!=typeof r)throw new Error("expected the name of an attribute");return new S(r)}static parseInExpr(e,t){const r=e[2];if(!T.isValidElementsArray(r))throw new Error("'in' expects an array of number or string literals");return new T(this.parseNode(e[1],t),r)}static parseLiteralExpr(e){const t=e[1];if(null===t||"object"!=typeof t)throw new Error("expected an object or array literal");return new b(t)}static parseMatchExpr(e,t){if(e.length<4)throw new Error("not enough arguments");if(!(e.length%2))throw new Error("fallback is missing in 'match' expression");const r=this.parseNode(e[1],t),i=[];for(let r=2;r<e.length-1;r+=2){const n=e[r];if(!w.isValidMatchLabel(n))throw new Error(`'${JSON.stringify(n)}' is not a valid label for 'match'`);const o=this.parseNode(e[r+1],t);i.push([n,o])}const n=this.parseNode(e[e.length-1],t);return new w(r,i,n)}static parseCaseExpr(e,t){if(e.length<3)throw new Error("not enough arguments");if(e.length%2)throw new Error("fallback is missing in 'case' expression");const r=[];for(let i=1;i<e.length-1;i+=2){const n=this.parseNode(e[i],t),o=this.parseNode(e[i+1],t);r.push([n,o])}const i=this.parseNode(e[e.length-1],t);return new C(r,i)}static makeCallExpr(e,t,r){return new E(e,t.slice(1).map(e=>this.parseNode(e,r)))}static resolveReference(e,t){if("string"!=typeof e[1])throw new Error("expected the name of an attribute");if(void 0===t)throw new Error("ref used with no definitions");const r=e[1];if(t.lockedNames.has(r))throw new Error(`circular referene to '${r}'`);if(!(r in t.definitions))throw new Error(`definition '${r}' not found`);const i=t.cache.get(r);if(void 0!==i)return i;let n,c=t.definitions[r];if(s.isSelectorDefinition(c)&&(c=c.value),s.isValueDefinition(c)){if(o.isInterpolatedPropertyDefinition(c.value))return m.fromJSON(a.interpolatedPropertyDefinitionToJsonExpr(c.value));if(!d(c.value))return m.fromJSON(c.value);c=c.value}if(!d(c))throw new Error(`unsupported definition ${r}`);t.lockedNames.add(r);try{n=m.parseNode(c,t)}finally{t.lockedNames.delete(r)}return t.cache.set(r,n),n}evaluate(e,t=h.Value,r){return this.accept(c,new i.ExprEvaluatorContext(c,e,t,r))}dependencies(){return u.of(this)}intern(e){return e.add(this)}toJSON(){return(new x).serialize(this)}}t.Expr=m;class p extends m{constructor(e){super(),this.name=e}accept(e,t){return e.visitVarExpr(this,t)}}t.VarExpr=p;class f extends m{}t.LiteralExpr=f;class g extends m{constructor(){super(),this.value=null}accept(e,t){return e.visitNullLiteralExpr(this,t)}}t.NullLiteralExpr=g,g.instance=new g;class y extends f{constructor(e){super(),this.value=e}accept(e,t){return e.visitBooleanLiteralExpr(this,t)}}t.BooleanLiteralExpr=y;class v extends f{constructor(e){super(),this.value=e}accept(e,t){return e.visitNumberLiteralExpr(this,t)}}t.NumberLiteralExpr=v;class _ extends f{constructor(e){super(),this.value=e}accept(e,t){return e.visitStringLiteralExpr(this,t)}}t.StringLiteralExpr=_;class b extends f{constructor(e){super(),this.value=e}get isArrayLiteral(){return Array.isArray(this.value)}accept(e,t){return e.visitObjectLiteralExpr(this,t)}}t.ObjectLiteralExpr=b;class S extends m{constructor(e){super(),this.name=e}accept(e,t){return e.visitHasAttributeExpr(this,t)}}t.HasAttributeExpr=S;class T extends m{constructor(e,t){super(),this.value=e,this.elements=t}static isValidElementsArray(e){if(!Array.isArray(e)||0===e.length)return!1;const t=typeof e[0];return("number"===t||"string"===t)&&e.every(e=>typeof e===t)}accept(e,t){return e.visitContainsExpr(this,t)}}t.ContainsExpr=T;class E extends m{constructor(e,t){super(),this.op=e,this.args=t}get children(){return this.args}accept(e,t){return e.visitCallExpr(this,t)}}t.CallExpr=E;class w extends m{constructor(e,t,r){super(),this.value=e,this.branches=t,this.fallback=r}static isValidMatchLabel(e){switch(typeof e){case"number":case"string":return!0;case"object":if(!Array.isArray(e)||0===e.length)return!1;const t=typeof e[0];return("number"===t||"string"===t)&&e.every(e=>typeof e===t);default:return!1}}accept(e,t){return e.visitMatchExpr(this,t)}}t.MatchExpr=w;class C extends m{constructor(e,t){super(),this.branches=e,this.fallback=t}accept(e,t){return e.visitCaseExpr(this,t)}}t.CaseExpr=C;class x{serialize(e){return e.accept(this,void 0)}visitNullLiteralExpr(e,t){return null}visitBooleanLiteralExpr(e,t){return e.value}visitNumberLiteralExpr(e,t){return e.value}visitStringLiteralExpr(e,t){return e.value}visitObjectLiteralExpr(e,t){return["literal",e.value]}visitVarExpr(e,t){return["get",e.name]}visitHasAttributeExpr(e,t){return["has",e.name]}visitContainsExpr(e,t){return["in",this.serialize(e.value),e.elements]}visitCallExpr(e,t){return[e.op,...e.args.map(e=>this.serialize(e))]}visitMatchExpr(e,t){const r=[];for(const[t,i]of e.branches)r.push(t,this.serialize(i));return["match",this.serialize(e.value),...r,this.serialize(e.fallback)]}visitCaseExpr(e,t){const r=[];for(const[t,i]of e.branches)r.push(this.serialize(t),this.serialize(i));return["case",...r,this.serialize(e.fallback)]}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(4),o=r(28),a=r(9),s=r(1),c=r(67),l=s.LoggerManager.instance.create("MapViewUtils"),u=1e3,d=56,h=new i.Vector3(0,0,1),m=new i.Plane(h.clone()),p=new i.Sphere(void 0,o.EarthConstants.EQUATORIAL_RADIUS),f=new i.Raycaster,g={x:new i.Vector3,y:new i.Vector3,z:new i.Vector3},y={x:new i.Vector3,y:new i.Vector3,z:new i.Vector3},v={quaternions:[new i.Quaternion,new i.Quaternion],vector3:[new i.Vector3,new i.Vector3],matrix4:[new i.Matrix4,new i.Matrix4],transforms:[{xAxis:new i.Vector3,yAxis:new i.Vector3,zAxis:new i.Vector3,position:new i.Vector3}]};!function(e){function t(e,t,r,n=Math.PI/2){const o=s(e,0,0);if(null===o)throw new Error("MapView does not support a view pointing in the void");const a=e.projection.unprojectPoint(o),c=T(e,e.camera,a),l=Math.max(Math.min(i.Math.radToDeg(n),r+i.Math.radToDeg(c.tilt)),0);e.lookAt(a,o.distanceTo(e.camera.position),l,i.Math.radToDeg(c.azimuth+Math.PI)+t)}function r(e,t,r,a,s,c=new i.Vector3){const l=i.Math.degToRad(a),u=Math.cos(l)*t,d=i.Math.degToRad(r);s.projectPoint(e,c);const h=t*Math.sin(l);if(s.type===n.ProjectionType.Planar)c.x=c.x+Math.sin(d)*h,c.y=c.y-Math.cos(d)*h,c.z=c.z+u;else if(s.type===n.ProjectionType.Spherical){y.z.copy(c).normalize(),y.y.set(0,0,1).projectOnPlane(y.z).normalize(),v.quaternions[0].setFromAxisAngle(y.z,d-Math.PI),y.y.applyQuaternion(v.quaternions[0]),y.y.setLength(h);const e=t*Math.cos(l);c.add(y.y).add(y.z.setLength(e));const r=o.EarthConstants.EQUATORIAL_RADIUS+u,i=Math.sin(l)*t,n=Math.sqrt(r*r+i*i);c.setLength(n)}return c}function s(e,t,r,o){const a=new i.Vector3(t,r,0);v.vector3[1].copy(e.camera.position),v.matrix4[0].extractRotation(e.camera.matrixWorld),v.matrix4[1].multiplyMatrices(v.matrix4[0],v.matrix4[1].getInverse(e.camera.projectionMatrix));const s=a.applyMatrix4(v.matrix4[1]);f.set(v.vector3[1],s.normalize()),void 0!==o&&(m.constant=-o);const c=new i.Vector3,l=e.projection.type===n.ProjectionType.Planar?f.ray.intersectPlane(m,c):f.ray.intersectSphere(p,c);return m.constant=0,l}function h(e,t,r){e.camera.position.x+=t,e.camera.position.y+=r}function _(e,t,r){v.quaternions[0].setFromUnitVectors(t.normalize(),r.normalize()).inverse(),v.matrix4[0].makeRotationFromQuaternion(v.quaternions[0]),e.camera.applyMatrix(v.matrix4[0]),e.camera.updateMatrixWorld()}function b(e,t,r,n,o=new i.Quaternion){const a=v.transforms[0];return e.localTangentSpace(t,a),v.matrix4[0].makeBasis(a.xAxis,a.yAxis,a.zAxis),o.setFromRotationMatrix(v.matrix4[0]),v.quaternions[0].setFromAxisAngle(v.vector3[1].set(0,0,1),i.Math.degToRad(r)),v.quaternions[1].setFromAxisAngle(v.vector3[1].set(1,0,0),i.Math.degToRad(n)),o.multiply(v.quaternions[0]),o.multiply(v.quaternions[1]),o}function S(e,t){v.vector3[1].setFromMatrixPosition(t.matrixWorld),e.projection.localTangentSpace(e.projection.unprojectPoint(v.vector3[1]),{xAxis:y.x,yAxis:y.y,zAxis:y.z,position:v.vector3[0]}),v.matrix4[1].makeBasis(y.x,y.y,y.z),v.matrix4[0].getInverse(v.matrix4[1]).multiply(t.matrixWorld),g.x.setFromMatrixColumn(v.matrix4[0],0),g.y.setFromMatrixColumn(v.matrix4[0],1),g.z.setFromMatrixColumn(v.matrix4[0],2);let r=0,i=0,n=0;const o=g.z.dot(v.vector3[1].set(0,0,1));return o<.99999?o>1e-5-1?(r=Math.atan2(g.z.x,-g.z.y),i=Math.acos(g.z.z),n=Math.atan2(g.x.z,g.y.z)):(r=-Math.atan2(-g.y.x,g.x.x),i=180,n=0):(r=Math.atan2(-g.y.x,g.x.x),i=0,n=0),{yaw:r,pitch:i,roll:n}}function T(e,t,r){e.projection.localTangentSpace(r,{xAxis:y.x,yAxis:y.y,zAxis:y.z,position:v.vector3[0]});let i=0,n=0;return v.vector3[1].copy(t.position).sub(v.vector3[0]).normalize(),v.vector3[1].dot(y.z)>.99999?(n=Math.PI-S(e,t).yaw,{tilt:i=0,azimuth:n=Math.atan2(Math.sin(n),Math.cos(n))}):(i=v.vector3[1].angleTo(y.z),v.vector3[1].copy(t.position).sub(v.vector3[0]).projectOnPlane(y.z).normalize(),n=v.vector3[1].angleTo(y.y),v.vector3[1].cross(y.y).dot(y.z)<0&&(n=-n),{tilt:i,azimuth:n})}function E(e,t){const r=S(e,e.camera).pitch,i=o.EarthConstants.EQUATORIAL_CIRCUMFERENCE/Math.pow(2,t);return e.focalLength*i/256*Math.cos(r)}function w(e,t,r){if(null===e||void 0===e.image)return;if(void 0!==e.uuid&&!0===r.get(e.uuid))return;r.set(e.uuid,!0);const i=e.image,n=4*i.width*i.height;t.heapSize+=n,t.gpuSize+=n}function C(e,t,r){if(void 0===e.uuid||!0!==r.get(e.uuid))if(r.set(e.uuid,!0),e instanceof i.RawShaderMaterial||e instanceof i.ShaderMaterial){const n=e;for(const e in n.uniforms)if(void 0!==n.uniforms[e]){const o=n.uniforms[e];o instanceof i.Texture&&w(o,t,r)}}else if(e instanceof i.MeshBasicMaterial||e instanceof a.MapMeshBasicMaterial){const i=e;w(i.map,t,r),w(i.aoMap,t,r),w(i.specularMap,t,r),w(i.alphaMap,t,r),w(i.envMap,t,r)}else if(e instanceof a.MapMeshStandardMaterial){const i=e;w(i.map,t,r),w(i.lightMap,t,r),w(i.aoMap,t,r),w(i.emissiveMap,t,r),w(i.bumpMap,t,r),w(i.normalMap,t,r),w(i.displacementMap,t,r),w(i.roughnessMap,t,r),w(i.metalnessMap,t,r),w(i.alphaMap,t,r),w(i.envMap,t,r)}else e instanceof i.LineBasicMaterial||e instanceof i.LineDashedMaterial||l.warn("estimateMeshSize: unidentified material: ",e)}function x(e,t,r,n){if(void 0===e.uuid&&(e.uuid=i.Math.generateUUID()),!0===n.get(e.uuid))return;n.set(e.uuid,!0);let o=0,a=4;void 0!==e.array.BYTES_PER_ELEMENT&&(a=e.array.BYTES_PER_ELEMENT),e instanceof i.InterleavedBufferAttribute||e instanceof i.BufferAttribute?o=a*e.count*e.itemSize:l.warn("estimateMeshSize: unidentified attribute: ",t),r.heapSize+=o+d,r.gpuSize+=o}function O(e){return e.substring(0,2)}e.zoomOnTargetPosition=function(e,r,i,a,c=Math.PI/2){const l=s(e,r,i),u=E(e,a);if(e.projection.type===n.ProjectionType.Planar?e.camera.position.setZ(u):e.projection.type===n.ProjectionType.Spherical&&e.camera.position.setLength(o.EarthConstants.EQUATORIAL_RADIUS+u),e.projection.type===n.ProjectionType.Spherical){const r=s(e,0,0);if(null!==r){const i=T(e,e.camera,e.projection.unprojectPoint(r)).tilt-c;i>0&&t(e,0,i,c)}}const d=s(e,r,i);l&&d&&(e.projection.type===n.ProjectionType.Planar?(l.sub(d),h(e,l.x,l.y)):e.projection.type===n.ProjectionType.Spherical&&_(e,l,d))},e.orbitFocusPoint=t,e.getCameraPositionFromTargetCoordinates=r,e.getCameraCoordinatesFromTargetCoordinates=function(e,t,i,n,o){return o.projection.unprojectPoint(r(e,t,i,n,o.projection,v.vector3[1]))},e.rayCastWorldCoordinates=s,e.panCameraAboveFlatMap=h,e.panCameraAroundGlobe=_,e.rotate=function(t,r,a=0,s=Math.PI/4){if(t.camera.rotateOnWorldAxis(t.projection.type===n.ProjectionType.Spherical?v.vector3[0].copy(t.camera.position).normalize():v.vector3[0].set(0,0,1),n.MathUtils.degToRad(-r)),t.camera.updateMatrixWorld(),0===a)return;const c=e.extractAttitude(t,t.camera).pitch;let l=i.Math.clamp(c+i.Math.degToRad(a),0,s);if(t.projection.type===n.ProjectionType.Spherical){const e=Math.asin(o.EarthConstants.EQUATORIAL_RADIUS*Math.sin(Math.PI-s)/t.camera.position.length());l=Math.min(l,e)}t.camera.rotateX(l-c)},e.getCameraRotationAtTarget=b,e.setRotation=function(e,t,r){b(e.projection,e.geoCenter,t,r,e.camera.quaternion)},e.extractAttitude=S,e.extractSphericalCoordinatesFromLocation=T,e.getCameraFrustumPlanes=function(e){const t=e.near,r=e.far;let n=t*Math.tan(i.Math.degToRad(.5*e.fov))/e.zoom,o=2*n,a=e.aspect*o,s=-.5*a;const c=e.view;if(null!==c&&c.enabled){const e=c.fullWidth,t=c.fullHeight;s+=c.offsetX*a/e,n-=c.offsetY*o/t,a*=c.width/e,o*=c.height/t}return{left:s+=0!==e.filmOffset?t*e.filmOffset/e.getFilmWidth():0,right:s+a,top:n,bottom:n-o,near:t,far:r}},e.rayCastGeoCoordinates=function(e,t,r){const i=s(e,t,r);return i?e.projection.unprojectPoint(i):null},e.calculateDistanceToGroundFromZoomLevel=E,e.calculateZoomLevelFromDistance=function(e,t){const r=256*e/t.focalLength,n=i.Math.clamp(Math.log2(o.EarthConstants.EQUATORIAL_CIRCUMFERENCE/r),t.minZoomLevel,t.maxZoomLevel);return Math.round(1e16*n)/1e16},e.calculateDepthFromClipDistance=function(e,t){const r=t,i=r.far-r.near,n=e*r.far;return(1-r.near/n)*(r.far/i)},e.cameraToWorldDistance=function(e,t){return e*t.far},e.calculateVerticalFovByHorizontalFov=function(e,t){return 2*Math.atan(Math.tan(e/2)/t)},e.calculateHorizontalFovByVerticalFov=function(e,t){return 2*Math.atan(Math.tan(e/2)*t)},e.calculateFocalLengthByVerticalFov=function(e,t){return t/2/Math.tan(e/2)},e.calculateFovByFocalLength=function(e,t){return i.Math.radToDeg(2*Math.atan(t/2/e))},e.calculateScreenSizeByFocalLength=function(e,t,r){return e*r/t},e.calculateWorldSizeByFocalLength=function(e,t,r){return t*r/e},e.estimateObject3dSize=function e(t,r,n){const o=void 0!==r?r:{heapSize:0,gpuSize:0};if(void 0===n&&(n=new Map),function(e,t,r){if(!e.isObject3D||e instanceof i.Scene)return;if(void 0!==e.uuid&&!0===r.get(e.uuid))return;if(r.set(e.uuid,!0),e.isMesh||e.isLine||e.isPoints){let n=u;const o=0,a=e;if(void 0!==a.material)if(Array.isArray(a.material)){const e=a.material;for(const i of e)C(i,t,r)}else{C(a.material,t,r)}void 0!==a.geometry&&function(e,t,r){if(void 0!==e.uuid&&!0===r.get(e.uuid))return;let n;r.set(e.uuid,!0),e instanceof i.Geometry?(t.heapSize+=24*e.vertices.length,t.heapSize+=48*e.faces.length,n=e._bufferGeometry):e instanceof i.BufferGeometry&&(n=e);if(void 0===n)return;const o=n.attributes;if(void 0===o)return void l.warn("estimateGeometrySize: unidentified geometry: ",e);for(const e in o)void 0!==o[e]&&x(o[e],e,t,r);null!==n.index&&x(n.index,"index",t,r)}(a.geometry,t,r);const s=void 0!==e.userData?e.userData.feature:void 0;void 0!==s&&(n+=c.getFeatureDataSize(s)),t.heapSize+=n,t.gpuSize+=o}else l.warn("estimateMeshSize: unidentified object",e)}(t,o,n),t.children.length>0)for(const r of t.children)e(r,o,n);return o},e.getBrowserLanguages=function(){if(void 0!==navigator.languages&&navigator.languages.length>0){const e=[];for(const t of navigator.languages)e.push(O(t));return e}if(void 0!==navigator.language)return[O(navigator.language)]}}(t.MapViewUtils||(t.MapViewUtils={}));const _=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,4294967296,8589934592,17179869184,34359738368,68719476736,137438953472,274877906944,549755813888,1099511627776,2199023255552,4398046511104,8796093022208,17592186044416,35184372088832,70368744177664,0x800000000000,281474976710656,562949953421312,0x4000000000000,0x8000000000000,4503599627370496];!function(e){function t(e,t,r=4){const i=function(e,t=4){let r=0;const i=_[t];e+=i/2;for(;e<0;)e+=i;for(;e>=i;)e-=i;for(let i=0;i<t&&e>0;i++)1&e&&(r+=_[53-t+i]),e>>>=1;return s.assert(0===e),r}(t,r);return e.mortonCode()+i}function r(e,t=4){let r=0,i=e,n=0;for(;n<t;n++){const e=_[52-n];i>=e&&(i-=e,r+=_[t-1-n])}return{offset:r-=_[t-1],mortonCode:i}}e.getKeyForTileKeyAndOffset=t,e.extractOffsetAndMortonKeyFromKey=r,e.getParentKeyFromKey=function(e,i=4){const{offset:o,mortonCode:a}=r(e,i);return t(n.TileKey.fromMortonCode(n.TileKey.parentMortonCode(a)),o,i)}}(t.TileOffsetUtils||(t.TileOffsetUtils={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(69),n=r(0);var o;t.getRelativeScreenCoordinates=function(e,t,r,i=!0){const o=document.body.getBoundingClientRect(),a=e.canvas.getBoundingClientRect();let s=a.left-o.left;const c=a.top-o.top;return!0===i&&e.canvas.parentElement&&(s-=e.canvas.parentElement.offsetLeft),t-=s,r-=c,new n.Vector2(t,r)},function(e){e[e.pixels=0]="pixels",e[e.meters=1]="meters"}(o=t.Units||(t.Units={})),t.getUnits=function(e){return"string"!=typeof e?o.pixels:"m"===(e=e.trim())[e.length-1]?o.meters:o.pixels},t.getValue=function(e){return"number"==typeof e?e:parseFloat(e)},t.getCanvasCoordinates=function(e,t,r){const i=document.body.getBoundingClientRect(),n=e.canvas.getBoundingClientRect();return{x:t-=n.left-i.left,y:r-=n.top-i.top}},t.convertCamelToSnakeCase=function e(t){if(null===t||"object"!=typeof t)return t;const r=new t.constructor;for(const i in t)if(t.hasOwnProperty(i)){r[i.split(/(?=[A-Z])/).join("_").toLowerCase()]=e(t[i])}return r};class a{static isLong(e){return e instanceof i}static isLongLike(e){return"object"==typeof e&&null!=e&&"high"in e&&"low"in e&&"unsigned"in e}static getSame(e){const t=`${e.low.toString(36)}-${e.high.toString(36)}-${e.unsigned?"u":"s"}`;if(!a.m_longs.has(t)){const r=e instanceof i?e:new i(e.low,e.high,e.unsigned);a.m_longs.set(t,r)}return a.m_longs.get(t)}static abs(e){return e.isPositive()?e:a.getSame(e.multiply(-1))}static clear(){a.m_longs.clear()}}t.LongUtils=a,a.m_longs=new Map,t.reconstructLongs=function e(t){for(const r in t){if(!t.hasOwnProperty(r))continue;const n=t[r];null!=n&&(n instanceof i||!n.hasOwnProperty("high")||!n.hasOwnProperty("low")||!n.hasOwnProperty("unsigned")?"object"==typeof n&&e(n):t[r]=a.getSame(n))}},t.getValueInRange=function(e,t){for(const r of e){const[e,i]=r;for(const r of i)if(t>=r.start&&t<=r.end)return e}},t.appendToArray=function(e,t){if(t instanceof Array){const r=e.length,i=t.length;t.length>500&&(e.length=r+i);for(let n=0;n<i;n++)e[r+n]=t[n]}else for(const r of t)e.push(r)}},function(e,t,r){"use strict";(function(e){if(t.base64=!0,t.array=!0,t.string=!0,t.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,t.nodebuffer=void 0!==e,t.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)t.blob=!1;else{var i=new ArrayBuffer(0);try{t.blob=0===new Blob([i],{type:"application/zip"}).size}catch(e){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(i),t.blob=0===n.getBlob("application/zip").size}catch(e){t.blob=!1}}}try{t.nodestream=!!r(193).Readable}catch(e){t.nodestream=!1}}).call(this,r(36).Buffer)},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var i in r)n(r,i)&&(e[i]=r[i])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:function(e,t,r,i,n){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+i),n);else for(var o=0;o<i;o++)e[n+o]=t[r+o]},flattenChunks:function(e){var t,r,i,n,o,a;for(i=0,t=0,r=e.length;t<r;t++)i+=e[t].length;for(a=new Uint8Array(i),n=0,t=0,r=e.length;t<r;t++)o=e[t],a.set(o,n),n+=o.length;return a}},a={arraySet:function(e,t,r,i,n){for(var o=0;o<i;o++)e[n+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,o)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,a))},t.setTyped(i)},function(e,t,r){"use strict";function i(e,t,r,i){var o={id:void 0===e?null:e,type:t,geometry:r,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,r=e.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)n(e,t);else if("Polygon"===r||"MultiLineString"===r)for(var i=0;i<t.length;i++)n(e,t[i]);else if("MultiPolygon"===r)for(i=0;i<t.length;i++)for(var o=0;o<t[i].length;o++)n(e,t[i][o])}(o),o}function n(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}r.d(t,"a",(function(){return i}))},function(e,t,r){"use strict";var i=r(72),n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=d;var o=r(50);o.inherits=r(37);var a=r(194),s=r(103);o.inherits(d,a);for(var c=n(s.prototype),l=0;l<c.length;l++){var u=c[l];d.prototype[u]||(d.prototype[u]=s.prototype[u])}function d(e){if(!(this instanceof d))return new d(e);a.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||i.nextTick(m,this)}function m(e){e.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),d.prototype._destroy=function(e,t){this.push(null),this.end(),i.nextTick(t,e)}},function(e,t,r){"use strict";e.exports=l;var i=r(38);((l.prototype=Object.create(i.prototype)).constructor=l).className="Field";var n,o=r(14),a=r(39),s=r(7),c=/^required|optional|repeated$/;function l(e,t,r,n,o,l,u){if(s.isObject(n)?(u=o,l=n,n=o=void 0):s.isObject(o)&&(u=l,l=o,o=void 0),i.call(this,e,l),!s.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!s.isString(r))throw TypeError("type must be a string");if(void 0!==n&&!c.test(n=n.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==o&&!s.isString(o))throw TypeError("extend must be a string");this.rule=n&&"optional"!==n?n:void 0,this.type=r,this.id=t,this.extend=o||void 0,this.required="required"===n,this.optional=!this.required,this.repeated="repeated"===n,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!s.Long&&void 0!==a.long[r],this.bytes="bytes"===r,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=u}l.fromJSON=function(e,t){return new l(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(l.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),l.prototype.setOption=function(e,t,r){return"packed"===e&&(this._packed=null),i.prototype.setOption.call(this,e,t,r)},l.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},l.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=a.defaults[this.type])&&(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof n?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof o&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof o)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=s.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;s.base64.test(this.typeDefault)?s.base64.decode(this.typeDefault,e=s.newBuffer(s.base64.length(this.typeDefault)),0):s.utf8.write(this.typeDefault,e=s.newBuffer(s.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=s.emptyObject:this.repeated?this.defaultValue=s.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof n&&(this.parent.ctor.prototype[this.name]=this.defaultValue),i.prototype.resolve.call(this)},l.d=function(e,t,r,i){return"function"==typeof t?t=s.decorateType(t).name:t&&"object"==typeof t&&(t=s.decorateEnum(t).name),function(n,o){s.decorateType(n.constructor).add(new l(o,e,t,r,{default:i}))}},l._configure=function(e){n=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.EarthConstants=i,i.EQUATORIAL_CIRCUMFERENCE=40075016.68557849,i.EQUATORIAL_RADIUS=6378137,i.MIN_ELEVATION=-433,i.MAX_ELEVATION=8848,i.MAX_BUILDING_HEIGHT=828},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBox3Like=function(e){const t=e;return void 0!==t.min&&void 0!==t.max}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isOrientedBox3Like=function(e){const t=e;return void 0!==t.position&&void 0!==t.xAxis&&void 0!==t.yAxis&&void 0!==t.zAxis&&void 0!==t.extents}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(18);!function(e){e[e.Planar=0]="Planar",e[e.Spherical=1]="Spherical"}(t.ProjectionType||(t.ProjectionType={}));t.Projection=class{constructor(e){this.unitScale=e}localTangentSpace(e,t){return this.projectPoint(e,t.position),i.MathUtils.newVector3(1,0,0,t.xAxis),i.MathUtils.newVector3(0,1,0,t.yAxis),i.MathUtils.newVector3(0,0,1,t.zAxis),t}reprojectPoint(e,t,r){return e===this?void 0===r?{x:t.x,y:t.y,z:t.z}:(r.x=t.x,r.y=t.y,r.z=t.z,r):this.projectPoint(e.unprojectPoint(t),r)}}},function(e,t,r){"use strict";function i(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),i(r(311)),i(r(312)),i(r(313)),i(r(59)),i(r(315)),i(r(140))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);var n,o,a,s,c,l,u;!function(e){e[e.Em=0]="Em",e[e.Pixel=1]="Pixel",e[e.Point=2]="Point",e[e.Percent=3]="Percent"}(n=t.FontUnit||(t.FontUnit={})),function(e){e[e.Regular=0]="Regular",e[e.Bold=1]="Bold",e[e.Italic=2]="Italic",e[e.BoldItalic=3]="BoldItalic"}(o=t.FontStyle||(t.FontStyle={})),function(e){e[e.Regular=0]="Regular",e[e.AllCaps=1]="AllCaps",e[e.SmallCaps=2]="SmallCaps"}(a=t.FontVariant||(t.FontVariant={})),function(e){e[e.Above=0]="Above",e[e.Center=-.5]="Center",e[e.Below=-1]="Below"}(s=t.VerticalAlignment||(t.VerticalAlignment={})),function(e){e[e.Left=0]="Left",e[e.Center=-.5]="Center",e[e.Right=-1]="Right"}(c=t.HorizontalAlignment||(t.HorizontalAlignment={})),function(e){e[e.None=0]="None",e[e.Character=1]="Character",e[e.Word=2]="Word"}(l=t.WrappingMode||(t.WrappingMode={})),function(e){e.DEFAULT_FONT_NAME="",e.DEFAULT_FONT_SIZE={unit:Object.freeze(n.Pixel),size:Object.freeze(16),backgroundSize:Object.freeze(0)},e.DEFAULT_FONT_STYLE=o.Regular,e.DEFAULT_FONT_VARIANT=a.Regular,e.DEFAULT_ROTATION=0,e.DEFAULT_COLOR=new i.Color(0),e.DEFAULT_OPACITY=1,e.DEFAULT_BACKGROUND_COLOR=new i.Color(0),e.DEFAULT_BACKGROUND_OPACITY=0,e.DEFAULT_TRACKING=0,e.DEFAULT_LEADING=0,e.DEFAULT_MAX_LINES=1/0,e.DEFAULT_LINE_WIDTH=1/0,e.DEFAULT_CANVAS_ROTATION=0,e.DEFAULT_LINE_ROTATION=0,e.DEFAULT_WRAPPING_MODE=l.Word,e.DEFAULT_VERTICAL_ALIGNMENT=s.Above,e.DEFAULT_HORIZONTAL_ALIGNMENT=c.Left}(u=t.DefaultTextStyle||(t.DefaultTextStyle={}));class d{constructor(e={}){this.m_params={fontName:void 0!==e.fontName?e.fontName:u.DEFAULT_FONT_NAME,fontSize:void 0!==e.fontSize?e.fontSize:{unit:u.DEFAULT_FONT_SIZE.unit,size:u.DEFAULT_FONT_SIZE.size,backgroundSize:u.DEFAULT_FONT_SIZE.backgroundSize},fontStyle:void 0!==e.fontStyle?e.fontStyle:u.DEFAULT_FONT_STYLE,fontVariant:void 0!==e.fontVariant?e.fontVariant:u.DEFAULT_FONT_VARIANT,rotation:void 0!==e.rotation?e.rotation:u.DEFAULT_ROTATION,color:void 0!==e.color?e.color:new i.Color(u.DEFAULT_COLOR),opacity:void 0!==e.opacity?e.opacity:u.DEFAULT_OPACITY,backgroundColor:void 0!==e.backgroundColor?e.backgroundColor:new i.Color(u.DEFAULT_BACKGROUND_COLOR),backgroundOpacity:void 0!==e.backgroundOpacity?e.backgroundOpacity:u.DEFAULT_BACKGROUND_OPACITY}}get params(){return this.m_params}set params(e){this.m_params=Object.assign(Object.assign({},this.m_params),e)}get fontName(){return this.m_params.fontName}set fontName(e){this.m_params.fontName=e}get fontSize(){return this.m_params.fontSize}set fontSize(e){this.m_params.fontSize=e}get fontStyle(){return this.m_params.fontStyle}set fontStyle(e){this.m_params.fontStyle=e}get fontVariant(){return this.m_params.fontVariant}set fontVariant(e){this.m_params.fontVariant=e}get rotation(){return this.m_params.rotation}set rotation(e){this.m_params.rotation=e}get color(){return this.m_params.color}set color(e){this.m_params.color=e}get backgroundColor(){return this.m_params.backgroundColor}set backgroundColor(e){this.m_params.backgroundColor=e}get opacity(){return this.m_params.opacity}set opacity(e){this.m_params.opacity=e}get backgroundOpacity(){return this.m_params.backgroundOpacity}set backgroundOpacity(e){this.m_params.backgroundOpacity=e}clone(e={}){return new d(Object.assign(Object.assign({},this.m_params),e))}}t.TextRenderStyle=d;class h{constructor(e={}){this.m_params={tracking:void 0!==e.tracking?e.tracking:u.DEFAULT_TRACKING,leading:void 0!==e.leading?e.leading:u.DEFAULT_LEADING,maxLines:void 0!==e.maxLines?e.maxLines:u.DEFAULT_MAX_LINES,lineWidth:void 0!==e.lineWidth?e.lineWidth:u.DEFAULT_LINE_WIDTH,canvasRotation:void 0!==e.canvasRotation?e.canvasRotation:u.DEFAULT_CANVAS_ROTATION,lineRotation:void 0!==e.lineRotation?e.lineRotation:u.DEFAULT_LINE_ROTATION,wrappingMode:void 0!==e.wrappingMode?e.wrappingMode:u.DEFAULT_WRAPPING_MODE,verticalAlignment:void 0!==e.verticalAlignment?e.verticalAlignment:u.DEFAULT_VERTICAL_ALIGNMENT,horizontalAlignment:void 0!==e.horizontalAlignment?e.horizontalAlignment:u.DEFAULT_HORIZONTAL_ALIGNMENT}}get params(){return this.m_params}set params(e){this.m_params=Object.assign(Object.assign({},this.m_params),e)}get tracking(){return this.m_params.tracking}set tracking(e){this.m_params.tracking=e}get leading(){return this.m_params.leading}set leading(e){this.m_params.leading=e}get maxLines(){return this.m_params.maxLines}set maxLines(e){this.m_params.maxLines=e}get lineWidth(){return this.m_params.lineWidth}set lineWidth(e){this.m_params.lineWidth=e}get canvasRotation(){return this.m_params.canvasRotation}set canvasRotation(e){this.m_params.canvasRotation=e}get lineRotation(){return this.m_params.lineRotation}set lineRotation(e){this.m_params.lineRotation=e}get wrappingMode(){return this.m_params.wrappingMode}set wrappingMode(e){this.m_params.wrappingMode=e}get verticalAlignment(){return this.m_params.verticalAlignment}set verticalAlignment(e){this.m_params.verticalAlignment=e}get horizontalAlignment(){return this.m_params.horizontalAlignment}set horizontalAlignment(e){this.m_params.horizontalAlignment=e}clone(e={}){return new h(Object.assign(Object.assign({},this.m_params),e))}}t.TextLayoutStyle=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);class n{constructor(){this.m_map=new Map}static get instance(){return this.m_instance}getColor(e){"number"==typeof e&&(e="#"+e.toString(16).padStart(6,"0"));let t=this.m_map.get(e);return void 0!==t?t:(t=new i.Color(e),this.m_map.set(e,t),t)}get size(){return this.m_map.size}clear(){this.m_map.clear()}}t.ColorCache=n,n.m_instance=new n},function(e,t,r){"use strict";for(var i=r(6),n=r(22),o=r(73),a=r(11),s=new Array(256),c=0;c<256;c++)s[c]=c>=252?6:c>=248?5:c>=240?4:c>=224?3:c>=192?2:1;s[254]=s[254]=1;function l(){a.call(this,"utf-8 decode"),this.leftOver=null}function u(){a.call(this,"utf-8 encode")}t.utf8encode=function(e){return n.nodebuffer?o.newBufferFrom(e,"utf-8"):function(e){var t,r,i,o,a,s=e.length,c=0;for(o=0;o<s;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(i-56320),o++),c+=r<128?1:r<2048?2:r<65536?3:4;for(t=n.uint8array?new Uint8Array(c):new Array(c),a=0,o=0;a<c;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(i-56320),o++),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|63&r):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|63&r):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|63&r);return t}(e)},t.utf8decode=function(e){return n.nodebuffer?i.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,r,n,o,a=e.length,c=new Array(2*a);for(r=0,t=0;t<a;)if((n=e[t++])<128)c[r++]=n;else if((o=s[n])>4)c[r++]=65533,t+=o-1;else{for(n&=2===o?31:3===o?15:7;o>1&&t<a;)n=n<<6|63&e[t++],o--;o>1?c[r++]=65533:n<65536?c[r++]=n:(n-=65536,c[r++]=55296|n>>10&1023,c[r++]=56320|1023&n)}return c.length!==r&&(c.subarray?c=c.subarray(0,r):c.length=r),i.applyFromCharCode(c)}(e=i.transformTo(n.uint8array?"uint8array":"array",e))},i.inherits(l,a),l.prototype.processChunk=function(e){var r=i.transformTo(n.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var o=r;(r=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),r.set(o,this.leftOver.length)}else r=this.leftOver.concat(r);this.leftOver=null}var a=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0?t:0===r?t:r+s[e[r]]>t?r:t}(r),c=r;a!==r.length&&(n.uint8array?(c=r.subarray(0,a),this.leftOver=r.subarray(a,r.length)):(c=r.slice(0,a),this.leftOver=r.slice(a,r.length))),this.push({data:t.utf8decode(c),meta:e.meta})},l.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:t.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},t.Utf8DecodeWorker=l,i.inherits(u,a),u.prototype.processChunk=function(e){this.push({data:t.utf8encode(e.data),meta:e.meta})},t.Utf8EncodeWorker=u},function(e,t,r){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var i=r(389),n=r(390),o=r(192);function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,r){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return l(this,e,t,r)}function l(e,t,r,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,i){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,r):new Uint8Array(t,r,i);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=h(e,t);return e}(e,t,r,i):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!c.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=0|p(t,r),n=(e=s(e,i)).write(t,r);n!==i&&(e=e.slice(0,n));return e}(e,t,r):function(e,t){if(c.isBuffer(t)){var r=0|m(t.length);return 0===(e=s(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?s(e,0):h(e,t);if("Buffer"===t.type&&o(t.data))return h(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(u(t),e=s(e,t<0?0:0|m(t)),!c.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function h(e,t){var r=t.length<0?0:0|m(t.length);e=s(e,r);for(var i=0;i<r;i+=1)e[i]=255&t[i];return e}function m(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return B(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(e).length;default:if(i)return B(e).length;t=(""+t).toLowerCase(),i=!0}}function f(e,t,r){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,r);case"utf8":case"utf-8":return x(this,t,r);case"ascii":return A(this,t,r);case"latin1":case"binary":return P(this,t,r);case"base64":return C(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,r);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function g(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function y(e,t,r,i,n){if(0===e.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(n)return-1;r=e.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof t&&(t=c.from(t,i)),c.isBuffer(t))return 0===t.length?-1:v(e,t,r,i,n);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,i,n);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,i,n){var o,a=1,s=e.length,c=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,r/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(n){var u=-1;for(o=r;o<s;o++)if(l(e,o)===l(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===c)return u*a}else-1!==u&&(o-=o-u),u=-1}else for(r+c>s&&(r=s-c),o=r;o>=0;o--){for(var d=!0,h=0;h<c;h++)if(l(e,o+h)!==l(t,h)){d=!1;break}if(d)return o}return-1}function _(e,t,r,i){r=Number(r)||0;var n=e.length-r;i?(i=Number(i))>n&&(i=n):i=n;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var a=0;a<i;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[r+a]=s}return a}function b(e,t,r,i){return z(B(t,e.length-r),e,r,i)}function S(e,t,r,i){return z(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,i)}function T(e,t,r,i){return S(e,t,r,i)}function E(e,t,r,i){return z(G(t),e,r,i)}function w(e,t,r,i){return z(function(e,t){for(var r,i,n,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),i=r>>8,n=r%256,o.push(n),o.push(i);return o}(t,e.length-r),e,r,i)}function C(e,t,r){return 0===t&&r===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,r))}function x(e,t,r){r=Math.min(e.length,r);for(var i=[],n=t;n<r;){var o,a,s,c,l=e[n],u=null,d=l>239?4:l>223?3:l>191?2:1;if(n+d<=r)switch(d){case 1:l<128&&(u=l);break;case 2:128==(192&(o=e[n+1]))&&(c=(31&l)<<6|63&o)>127&&(u=c);break;case 3:o=e[n+1],a=e[n+2],128==(192&o)&&128==(192&a)&&(c=(15&l)<<12|(63&o)<<6|63&a)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:o=e[n+1],a=e[n+2],s=e[n+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(c=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(u=c)}null===u?(u=65533,d=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),n+=d}return function(e){var t=e.length;if(t<=O)return String.fromCharCode.apply(String,e);var r="",i=0;for(;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=O));return r}(i)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,r){return l(null,e,t,r)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,r){return function(e,t,r,i){return u(t),t<=0?s(e,t):void 0!==r?"string"==typeof i?s(e,t).fill(r,i):s(e,t).fill(r):s(e,t)}(null,e,t,r)},c.allocUnsafe=function(e){return d(null,e)},c.allocUnsafeSlow=function(e){return d(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,i=t.length,n=0,o=Math.min(r,i);n<o;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var i=c.allocUnsafe(t),n=0;for(r=0;r<e.length;++r){var a=e[r];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,n),n+=a.length}return i},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?x(this,0,e):f.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,r,i,n){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),t<0||r>e.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&t>=r)return 0;if(i>=n)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(n>>>=0)-(i>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(o,a),l=this.slice(i,n),u=e.slice(t,r),d=0;d<s;++d)if(l[d]!==u[d]){o=l[d],a=u[d];break}return o<a?-1:a<o?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return y(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return y(this,e,t,r,!1)},c.prototype.write=function(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n=this.length-t;if((void 0===r||r>n)&&(r=n),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return _(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":return S(this,e,t,r);case"latin1":case"binary":return T(this,e,t,r);case"base64":return E(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var O=4096;function A(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}function P(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}function R(e,t,r){var i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var n="",o=t;o<r;++o)n+=V(e[o]);return n}function I(e,t,r){for(var i=e.slice(t,r),n="",o=0;o<i.length;o+=2)n+=String.fromCharCode(i[o]+256*i[o+1]);return n}function D(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,r,i,n,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<o)throw new RangeError('"value" argument is out of bounds');if(r+i>e.length)throw new RangeError("Index out of range")}function M(e,t,r,i){t<0&&(t=65535+t+1);for(var n=0,o=Math.min(e.length-r,2);n<o;++n)e[r+n]=(t&255<<8*(i?n:1-n))>>>8*(i?n:1-n)}function k(e,t,r,i){t<0&&(t=4294967295+t+1);for(var n=0,o=Math.min(e.length-r,4);n<o;++n)e[r+n]=t>>>8*(i?n:3-n)&255}function N(e,t,r,i,n,o){if(r+i>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function F(e,t,r,i,o){return o||N(e,0,r,4),n.write(e,t,r,i,23,4),r+4}function U(e,t,r,i,o){return o||N(e,0,r,8),n.write(e,t,r,i,52,8),r+8}c.prototype.slice=function(e,t){var r,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=c.prototype;else{var n=t-e;r=new c(n,void 0);for(var o=0;o<n;++o)r[o]=this[o+e]}return r},c.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||D(e,t,this.length);for(var i=this[e],n=1,o=0;++o<t&&(n*=256);)i+=this[e+o]*n;return i},c.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||D(e,t,this.length);for(var i=this[e+--t],n=1;t>0&&(n*=256);)i+=this[e+--t]*n;return i},c.prototype.readUInt8=function(e,t){return t||D(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||D(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||D(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||D(e,t,this.length);for(var i=this[e],n=1,o=0;++o<t&&(n*=256);)i+=this[e+o]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||D(e,t,this.length);for(var i=t,n=1,o=this[e+--i];i>0&&(n*=256);)o+=this[e+--i]*n;return o>=(n*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||D(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){t||D(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||D(e,4,this.length),n.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||D(e,4,this.length),n.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||D(e,8,this.length),n.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||D(e,8,this.length),n.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,r,i){(e=+e,t|=0,r|=0,i)||L(this,e,t,r,Math.pow(2,8*r)-1,0);var n=1,o=0;for(this[t]=255&e;++o<r&&(n*=256);)this[t+o]=e/n&255;return t+r},c.prototype.writeUIntBE=function(e,t,r,i){(e=+e,t|=0,r|=0,i)||L(this,e,t,r,Math.pow(2,8*r)-1,0);var n=r-1,o=1;for(this[t+n]=255&e;--n>=0&&(o*=256);)this[t+n]=e/o&255;return t+r},c.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):k(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):k(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t|=0,!i){var n=Math.pow(2,8*r-1);L(this,e,t,r,n-1,-n)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},c.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t|=0,!i){var n=Math.pow(2,8*r-1);L(this,e,t,r,n-1,-n)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):k(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):k(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,r){return F(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return F(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return U(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return U(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,i){if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);var n,o=i-r;if(this===e&&r<t&&t<i)for(n=o-1;n>=0;--n)e[n+t]=this[n+r];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(n=0;n<o;++n)e[n+t]=this[n+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},c.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),1===e.length){var n=e.charCodeAt(0);n<256&&(e=n)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!c.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=c.isBuffer(e)?e:B(new c(e,i).toString()),s=a.length;for(o=0;o<r-t;++o)this[o+t]=a[o%s]}return this};var j=/[^+\/0-9A-Za-z-_]/g;function V(e){return e<16?"0"+e.toString(16):e.toString(16)}function B(e,t){var r;t=t||1/0;for(var i=e.length,n=null,o=[],a=0;a<i;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!n){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===i){(t-=3)>-1&&o.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(t-=3)>-1&&o.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function G(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(j,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function z(e,t,r,i){for(var n=0;n<i&&!(n+r>=t.length||n>=e.length);++n)t[n+r]=e[n];return n}}).call(this,r(23))},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},function(e,t,r){"use strict";e.exports=o,o.className="ReflectionObject";var i,n=r(7);function o(e,t){if(!n.isString(e))throw TypeError("name must be a string");if(t&&!n.isObject(t))throw TypeError("options must be an object");this.options=t,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(o.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),o.prototype.toJSON=function(){throw Error()},o.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof i&&t._handleAdd(this)},o.prototype.onRemove=function(e){var t=e.root;t instanceof i&&t._handleRemove(this),this.parent=null,this.resolved=!1},o.prototype.resolve=function(){return this.resolved?this:(this.root instanceof i&&(this.resolved=!0),this)},o.prototype.getOption=function(e){if(this.options)return this.options[e]},o.prototype.setOption=function(e,t,r){return r&&this.options&&void 0!==this.options[e]||((this.options||(this.options={}))[e]=t),this},o.prototype.setOptions=function(e,t){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)this.setOption(r[i],e[r[i]],t);return this},o.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},o._configure=function(e){i=e}},function(e,t,r){"use strict";var i=t,n=r(7),o=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function a(e,t){var r=0,i={};for(t|=0;r<e.length;)i[o[r+t]]=e[r++];return i}i.basic=a([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),i.defaults=a([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",n.emptyArray,null]),i.long=a([0,0,0,1,1],7),i.mapKey=a([0,0,0,5,5,0,0,0,1,1,0,2],2),i.packed=a([1,5,0,0,0,5,5,0,0,0,1,1,0])},function(e,t,r){"use strict";function i(e,t,r){var i=r?" !== ":" === ",n=r?" || ":" && ",o=r?"!":"",a=r?"":"!";switch(e){case"null":return t+i+"null";case"array":return o+"Array.isArray("+t+")";case"object":return"("+o+t+n+"typeof "+t+i+'"object"'+n+a+"Array.isArray("+t+"))";case"integer":return"(typeof "+t+i+'"number"'+n+a+"("+t+" % 1)"+n+t+i+t+")";default:return"typeof "+t+i+'"'+e+'"'}}e.exports={copy:function(e,t){for(var r in t=t||{},e)t[r]=e[r];return t},checkDataType:i,checkDataTypes:function(e,t){switch(e.length){case 1:return i(e[0],t,!0);default:var r="",n=o(e);for(var a in n.array&&n.object&&(r=n.null?"(":"(!"+t+" || ",r+="typeof "+t+' !== "object")',delete n.null,delete n.array,delete n.object),n.number&&delete n.integer,n)r+=(r?" && ":"")+i(a,t,!0);return r}},coerceToTypes:function(e,t){if(Array.isArray(t)){for(var r=[],i=0;i<t.length;i++){var o=t[i];n[o]?r[r.length]=o:"array"===e&&"array"===o&&(r[r.length]=o)}if(r.length)return r}else{if(n[t])return[t];if("array"===e&&"array"===t)return["array"]}},toHash:o,getProperty:c,escapeQuotes:l,equal:r(119),ucs2length:r(460),varOccurences:function(e,t){t+="[^0-9]";var r=e.match(new RegExp(t,"g"));return r?r.length:0},varReplace:function(e,t,r){return t+="([^0-9])",r=r.replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"),r+"$1")},cleanUpCode:function(e){return e.replace(u,"").replace(d,"").replace(h,"if (!($1))")},finalCleanUpCode:function(e,t){var r=e.match(m);r&&2==r.length&&(e=t?e.replace(f,"").replace(v,_):e.replace(p,"").replace(g,y));return(r=e.match(b))&&3===r.length?e.replace(S,""):e},schemaHasRules:function(e,t){if("boolean"==typeof e)return!e;for(var r in e)if(t[r])return!0},schemaHasRulesExcept:function(e,t,r){if("boolean"==typeof e)return!e&&"not"!=r;for(var i in e)if(i!=r&&t[i])return!0},schemaUnknownRules:function(e,t){if("boolean"==typeof e)return;for(var r in e)if(!t[r])return r},toQuotedString:T,getPathExpr:function(e,t,r,i){return C(e,r?"'/' + "+t+(i?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):i?"'[' + "+t+" + ']'":"'[\\'' + "+t+" + '\\']'")},getPath:function(e,t,r){var i=T(r?"/"+x(t):c(t));return C(e,i)},getData:function(e,t,r){var i,n,o,a;if(""===e)return"rootData";if("/"==e[0]){if(!E.test(e))throw new Error("Invalid JSON-pointer: "+e);n=e,o="rootData"}else{if(!(a=e.match(w)))throw new Error("Invalid JSON-pointer: "+e);if(i=+a[1],"#"==(n=a[2])){if(i>=t)throw new Error("Cannot access property/index "+i+" levels up, current level is "+t);return r[t-i]}if(i>t)throw new Error("Cannot access data "+i+" levels up, current level is "+t);if(o="data"+(t-i||""),!n)return o}for(var s=o,l=n.split("/"),u=0;u<l.length;u++){var d=l[u];d&&(o+=c(O(d)),s+=" && "+o)}return s},unescapeFragment:function(e){return O(decodeURIComponent(e))},unescapeJsonPointer:O,escapeFragment:function(e){return encodeURIComponent(x(e))},escapeJsonPointer:x};var n=o(["string","number","integer","boolean","null"]);function o(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}var a=/^[a-z$_][a-z$_0-9]*$/i,s=/'|\\/g;function c(e){return"number"==typeof e?"["+e+"]":a.test(e)?"."+e:"['"+l(e)+"']"}function l(e){return e.replace(s,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}var u=/else\s*{\s*}/g,d=/if\s*\([^)]+\)\s*\{\s*\}(?!\s*else)/g,h=/if\s*\(([^)]+)\)\s*\{\s*\}\s*else(?!\s*if)/g;var m=/[^v.]errors/g,p=/var errors = 0;|var vErrors = null;|validate.errors = vErrors;/g,f=/var errors = 0;|var vErrors = null;/g,g="return errors === 0;",y="validate.errors = null; return true;",v=/if \(errors === 0\) return data;\s*else throw new ValidationError\(vErrors\);/,_="return data;",b=/[^A-Za-z_$]rootData[^A-Za-z0-9_$]/g,S=/if \(rootData === undefined\) rootData = data;/;function T(e){return"'"+l(e)+"'"}var E=/^\/(?:[^~]|~0|~1)*$/,w=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function C(e,t){return'""'==e?t:(e+" + "+t).replace(/' \+ '/g,"")}function x(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function O(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(1),o=r(273),a=r(55),s=r(129),c=n.LoggerManager.instance.create("InterpolatedProperty"),l=[i.DiscreteInterpolant,i.LinearInterpolant,i.CubicInterpolant,o.ExponentialInterpolant],u=new i.Color;function d(e){return!!(e&&void 0===e.interpolationMode&&Array.isArray(e.values)&&e.values.length>0&&void 0!==e.values[0]&&Array.isArray(e.zoomLevels)&&e.zoomLevels.length>0&&void 0!==e.zoomLevels[0]&&e.values.length===e.zoomLevels.length)}function h(e){return void 0!==e&&void 0!==e.interpolationMode&&e.zoomLevels instanceof Float32Array&&void 0!==e.values&&e.values.length>0&&(e.zoomLevels.length===e.values.length/3||e.zoomLevels.length===e.values.length)}function m(e,t,r){const i=e.values.length/e.zoomLevels.length,n=new l[e.interpolationMode](e.zoomLevels,e.values,i);if(e.interpolationMode===a.InterpolationMode.Exponential&&void 0!==e.exponent&&(n.exponent=e.exponent),n.evaluate(t),void 0===e._stringEncodedNumeralDynamicMask)return n.resultBuffer[0];{const i=new l[e.interpolationMode](e.zoomLevels,e._stringEncodedNumeralDynamicMask,1);return e.interpolationMode===a.InterpolationMode.Exponential&&void 0!==e.exponent&&(i.exponent=e.exponent),i.evaluate(t),n.resultBuffer[0]*(1+i.resultBuffer[0]*(r-1))}}t.isInterpolatedPropertyDefinition=d,t.isInterpolatedProperty=h,t.getPropertyValue=function(e,t,r=1){if(d(e))throw new Error("Cannot interpolate a InterpolatedPropertyDefinition.");if(h(e)){if(void 0!==e._stringEncodedNumeralType)switch(e._stringEncodedNumeralType){case s.StringEncodedNumeralType.Meters:case s.StringEncodedNumeralType.Pixels:return m(e,t,r);case s.StringEncodedNumeralType.Hex:case s.StringEncodedNumeralType.RGB:case s.StringEncodedNumeralType.HSL:return function(e,t){const r=e.values.length/e.zoomLevels.length,i=new l[e.interpolationMode](e.zoomLevels,e.values,r);e.interpolationMode===a.InterpolationMode.Exponential&&void 0!==e.exponent&&(i.exponent=e.exponent);return i.evaluate(t),u.setHSL(i.resultBuffer[0],i.resultBuffer[1],i.resultBuffer[2]).getHex()}(e,t)}}else{if("string"!=typeof e)return e;{const t=s.StringEncodedNumeralFormats.find(t=>t.regExp.test(e));if(void 0===t)return e;switch(t.type){case s.StringEncodedNumeralType.Meters:return t.decoder(e)[0];case s.StringEncodedNumeralType.Pixels:return t.decoder(e)[0]*r;case s.StringEncodedNumeralType.Hex:case s.StringEncodedNumeralType.RGB:case s.StringEncodedNumeralType.HSL:const i=t.decoder(e);return u.setHSL(i[0],i[1],i[2]).getHex();default:return t.decoder(e)[0]}}}return m(e,t,r)},t.createInterpolatedProperty=function(e){!function(e){const t="Cubic"===e.interpolation;for(let r=0;r<e.values.length;++r){e.zoomLevels.findIndex(i=>t?Math.abs(i-e.zoomLevels[r])<.001:i===e.zoomLevels[r])!==r&&(e.zoomLevels.splice(--r,1),e.values.splice(--r,1))}}(e);const t=void 0!==e.interpolation?a.InterpolationMode[e.interpolation]:a.InterpolationMode.Discrete,r=new Float32Array(e.zoomLevels),i=e.values[0];switch(typeof i){default:case"number":case"boolean":return{interpolationMode:t,zoomLevels:r,values:new Float32Array(e.values),exponent:e.exponent};case"string":const n=s.StringEncodedNumeralFormats.find(e=>e.regExp.test(i));if(void 0===n)return t===a.InterpolationMode.Discrete?{interpolationMode:t,zoomLevels:r,values:e.values}:void c.error(`No StringEncodedNumeralFormat matched ${i}.`);let o=!1;const l=new Float32Array(e.values.length*n.size),u=new Float32Array(e.values.length);return o=function(e,t,r,i){let n=!1;const o=e.type===s.StringEncodedNumeralType.Meters||e.type===s.StringEncodedNumeralType.Pixels?f:p;for(let e=0;e<t.values.length;++e)for(const a of o){const o=t.values[e];if(!a.regExp.test(o))continue;void 0!==a.mask&&(i[e]=a.mask,n=!0);const s=a.decoder(o);for(let t=0;t<s.length;++t)r[e*a.size+t]=s[t];break}return n}(n,e,l,u),{interpolationMode:t,zoomLevels:r,values:l,exponent:e.exponent,_stringEncodedNumeralType:n.type,_stringEncodedNumeralDynamicMask:o?u:void 0}}};const p=[s.StringEncodedHSL,s.StringEncodedHex,s.StringEncodedRGB],f=[s.StringEncodedMeters,s.StringEncodedPixels]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(17),n=r(0);class o{constructor(e,t){this.southWest=e,this.northEast=t}static fromCoordinates(e,t){return new o(e,t)}get minAltitude(){if(void 0!==this.southWest.altitude&&void 0!==this.northEast.altitude)return Math.min(this.southWest.altitude,this.northEast.altitude)}get maxAltitude(){if(void 0!==this.southWest.altitude&&void 0!==this.northEast.altitude)return Math.max(this.southWest.altitude,this.northEast.altitude)}get south(){return this.southWest.latitude}get north(){return this.northEast.latitude}get west(){return this.southWest.longitude}get east(){return this.northEast.longitude}get center(){const e=.5*(this.south+this.north),{west:t,east:r}=this,{minAltitude:n,altitudeSpan:o}=this;let a;if(void 0!==n&&void 0!==o&&(a=n+.5*o),t<r)return new i.GeoCoordinates(e,.5*(t+r),a);let s=.5*(360+r+t);return s>360&&(s-=360),new i.GeoCoordinates(e,s,a)}get latitudeSpanInRadians(){return n.Math.degToRad(this.latitudeSpan)}get longitudeSpanInRadians(){return n.Math.degToRad(this.longitudeSpan)}get latitudeSpan(){return this.north-this.south}get altitudeSpan(){if(void 0!==this.maxAltitude&&void 0!==this.minAltitude)return this.maxAltitude-this.minAltitude}get longitudeSpan(){let e=this.northEast.longitude-this.southWest.longitude;return e<0&&(e+=360),e}get latitudeSpanInDegrees(){return this.latitudeSpan}get longitudeSpanInDegrees(){return this.longitudeSpan}contains(e){if(void 0===e.altitude||void 0===this.minAltitude||void 0===this.maxAltitude)return this.containsHelper(e);const t=this.minAltitude===this.maxAltitude,r=this.minAltitude===e.altitude,i=this.minAltitude<=e.altitude&&this.maxAltitude>e.altitude;return!(t?!r:!i)&&this.containsHelper(e)}clone(){return new o(this.southWest,this.northEast)}growToContain(e){this.southWest.latitude=Math.min(this.southWest.latitude,e.latitude),this.southWest.longitude=Math.min(this.southWest.longitude,e.longitude),this.southWest.altitude=void 0!==this.southWest.altitude&&void 0!==e.altitude?Math.min(this.southWest.altitude,e.altitude):void 0!==this.southWest.altitude?this.southWest.altitude:void 0!==e.altitude?e.altitude:void 0,this.northEast.latitude=Math.max(this.northEast.latitude,e.latitude),this.northEast.longitude=Math.max(this.northEast.longitude,e.longitude),this.northEast.altitude=void 0!==this.northEast.altitude&&void 0!==e.altitude?Math.max(this.northEast.altitude,e.altitude):void 0!==this.northEast.altitude?this.northEast.altitude:void 0!==e.altitude?e.altitude:void 0}containsHelper(e){if(e.latitude<this.southWest.latitude||e.latitude>=this.northEast.latitude)return!1;const{west:t,east:r}=this;return r>t?e.longitude>=t&&e.longitude<r:e.longitude>r||e.longitude<=t}}t.GeoBox=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(133),n=r(136),o=r(137);t.TilingScheme=class{constructor(e,t){this.subdivisionScheme=e,this.projection=t,this.boundingBoxGenerator=new i.FlatTileBoundingBoxGenerator(this),this.tileTreeTraverse=new o.TileTreeTraverse(e)}getSubTileKeys(e){return this.tileTreeTraverse.subTiles(e)}getTileKey(e,t){return n.TileKeyUtils.geoCoordinatesToTileKey(this,e,t)}getTileKeys(e,t){return n.TileKeyUtils.geoRectangleToTileKeys(this,e,t)}getGeoBox(e){return this.boundingBoxGenerator.getGeoBox(e)}getWorldBox(e,t){return this.boundingBoxGenerator.getWorldBox(e,t)}}},function(e,t,r){"use strict";function i(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),i(r(141)),i(r(142)),i(r(329)),i(r(330)),i(r(81)),i(r(144)),i(r(82))},function(e,t,r){"use strict";function i(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),i(r(350)),i(r(88)),i(r(33)),i(r(150)),i(r(352)),i(r(355)),i(r(151)),i(r(90)),i(r(46))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){let t;e.whiteSpaceRanges=[[9,9],[32,32],[5760,5760],[8192,8198],[8200,8202],[8287,12288],[6158,6158],[8203,8205]],e.isWhiteSpace=function(t){for(const r of e.whiteSpaceRanges)if(t>=r[0]&&t<=r[1])return!0;return!1},e.newLineRanges=[[10,13],[133,133],[8232,8233]],e.isNewLine=function(t){for(const r of e.newLineRanges)if(t>=r[0]&&t<=r[1])return!0;return!1},e.nonPrintableRanges=[[0,31],[127,159]],e.isPrintable=function(t){for(const r of e.nonPrintableRanges)if(t>=r[0]&&t<=r[1])return!1;return!0},function(e){e[e.Neutral=0]="Neutral",e[e.Weak=.5]="Weak",e[e.LTR=1]="LTR",e[e.RTL=-1]="RTL"}(t=e.Direction||(e.Direction={})),e.rtlBlocks=["Hebrew","Alphabetic Presentation Forms","Arabic","Arabic Supplement","Arabic Extended-A","Arabic Presentation Forms-A","Arabic Presentation Forms-B","Arabic Mathematical Alphabetic Symbols","Indic Siyaq Numbers","Rumi Numeral Symbols","Syriac","Syriac Supplement","Samaritan","Mandaic","Thaana","Mende Kikakui","NKo","Adlam","Hanifi Rohingya"],e.neutralBidirectionalRanges=[[32,47],[58,64],[91,96],[123,126]],e.weakBidirectionalRanges=[[48,57],[1632,1641],[1776,1785]],e.getDirection=function(r,i){for(const i of e.weakBidirectionalRanges)if(r>=i[0]&&r<=i[1])return t.Weak;for(const i of e.neutralBidirectionalRanges)if(r>=i[0]&&r<=i[1])return t.Neutral;return void 0!==e.rtlBlocks.find(e=>e===i)?t.RTL:t.LTR},e.rtlMirroredCodePoints=[40,41,60,62,91,93,123,125],e.isRtlMirrored=function(t){return void 0!==e.rtlMirroredCodePoints.find(e=>e===t)}}(t.UnicodeUtils||(t.UnicodeUtils={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(45),n=r(34);t.DEFAULT_TEXT_STYLE_CACHE_ID="Default",t.computeStyleCacheId=function(e,t,r){return`${e}_${t._key}_${r}`};t.TextRenderStyleCache=class{constructor(){this.m_map=new Map,this.m_map.set(t.DEFAULT_TEXT_STYLE_CACHE_ID,new i.TextRenderStyle({fontSize:{unit:i.FontUnit.Pixel,size:32,backgroundSize:8},color:n.ColorCache.instance.getColor("#6d7477"),backgroundColor:n.ColorCache.instance.getColor("#f7fbfd"),backgroundOpacity:.5}))}get size(){return this.m_map.size}get(e){return this.m_map.get(e)}set(e,t){this.m_map.set(e,t)}clear(){this.m_map.clear(),this.m_map.set(t.DEFAULT_TEXT_STYLE_CACHE_ID,new i.TextRenderStyle({fontSize:{unit:i.FontUnit.Pixel,size:32,backgroundSize:8},color:n.ColorCache.instance.getColor("#6d7477"),backgroundColor:n.ColorCache.instance.getColor("#f7fbfd"),backgroundOpacity:.5}))}};t.TextLayoutStyleCache=class{constructor(){this.m_map=new Map,this.m_map.set(t.DEFAULT_TEXT_STYLE_CACHE_ID,new i.TextLayoutStyle({verticalAlignment:i.VerticalAlignment.Center,horizontalAlignment:i.HorizontalAlignment.Center}))}get size(){return this.m_map.size}get(e){return this.m_map.get(e)}set(e,t){this.m_map.set(e,t)}clear(){this.m_map.clear(),this.m_map.set(t.DEFAULT_TEXT_STYLE_CACHE_ID,new i.TextLayoutStyle({verticalAlignment:i.VerticalAlignment.Center,horizontalAlignment:i.HorizontalAlignment.Center}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=i.LoggerManager.instance.create("Statistics");class o{constructor(e){this.capacity=e,this.buffer=new Array(e),this.capacity=e,this.head=this.tail=this.size=0}clear(){this.head=this.tail=this.size=0}enqOne(e){let t=this.head+1;t>=this.capacity&&(t=0),this.size<this.capacity&&this.size++,this.buffer[this.head]=e,this.head=t,this.size===this.capacity&&(this.tail=this.head)}enq(...e){for(const t of e)this.enqOne(t)}deq(){if(0===this.size)throw new Error("Ringbuffer underrun");const e=this.buffer[this.tail];let t=this.tail+1;return t>=this.capacity&&(t=0),this.size>0&&this.size--,this.tail=t,e}get top(){if(0===this.size)throw new Error("Ringbuffer underrun");return this.buffer[this.tail]}get bottom(){if(0===this.size)throw new Error("Ringbuffer underrun");let e=this.head-1;return e<0&&(e=this.capacity-1),this.buffer[e]}iterator(){return new o.Iterator(this)}asArray(){const e=new Array;for(let t=0;t<this.size;t++)e.push(this.buffer[(this.tail+t)%this.capacity]);return e}}t.RingBuffer=o,function(e){e.Iterator=class{constructor(e,t=0){this.m_buffer=e,this.m_index=t}get value(){return this.m_buffer.buffer[(this.m_buffer.tail+this.m_index)%this.m_buffer.capacity]}next(){return this.m_index++,this.m_index<this.m_buffer.size}}}(o=t.RingBuffer||(t.RingBuffer={}));class a{constructor(e,t){this.statistics=e,this.name=t,this.running=!1}get value(){return this.m_currentValue}setValue(e){this.m_currentValue=e}reset(){this.m_currentValue=void 0}start(){if(!this.statistics.enabled)return-1;if(this.running)throw new Error("Timer '"+this.name+"' is already running");return this.running=!0,this.m_currentValue=i.PerformanceTimer.now()}stop(){if(!this.statistics.enabled)return-1;if(this.running){const e=i.PerformanceTimer.now()-(this.m_currentValue||0);return this.m_currentValue=e,this.setValue(e),this.running=!1,e}throw new Error("Timer '"+this.name+"' has not been started")}now(){if(!this.statistics.enabled)return-1;if(this.running){return i.PerformanceTimer.now()-(this.m_currentValue||0)}throw new Error("Timer '"+this.name+"' has not been started")}}t.SimpleTimer=a;class s extends a{constructor(e,t){super(e,t),this.statistics=e,this.name=t,this.numResets=0,this.maxNumSamples=1e3,this.samples=new o(this.maxNumSamples)}reset(){super.reset(),this.getStats(),this.samples.clear(),this.numResets++}setValue(e){super.setValue(e),void 0!==e&&this.samples.enqOne(e)}getStats(){return c(this.samples.asArray())}}function c(e){if(0===e.length)return;e.sort((e,t)=>e-t);const t=e[0],r=e[e.length-1];let i,n,o,a,s,c,l;if(1===e.length)n=o=a=s=c=l=i=e[0];else if(2===e.length)i=.5*e[0]+.5*e[1],n=o=a=s=c=l=e[1];else{const t=Math.floor(e.length/2);i=e.length%2==0?.5*e[t-1]+.5*e[t]:e[t],n=e[Math.round(.75*e.length)-1],o=e[Math.round(.9*e.length)-1],a=e[Math.round(.95*e.length)-1],s=e[Math.round(.97*e.length)-1],c=e[Math.round(.99*e.length)-1],l=e[Math.round(.999*e.length)-1]}let u=0;for(let t=0,r=e.length;t<r;t++)u+=e[t];return{min:t,max:r,avg:u/e.length,median:i,median75:n,median90:o,median95:a,median97:s,median99:c,median999:l,numSamples:e.length}}t.SampledTimer=s,t.computeArrayStats=c,t.computeArrayAverage=function(e){if(0===e.length)return;let t=0;for(let r=0,i=e.length;r<i;r++)t+=e[r];return t/e.length};t.MultiStageTimer=class{constructor(e,t,r){if(this.statistics=e,this.name=t,this.stages=r,r.length<1)throw new Error("MultiStageTimer needs stages");r.forEach(t=>{if(!e.hasTimer(t))throw new Error("Unknown timer: "+t)})}get value(){return this.statistics.getTimer(this.stages[this.stages.length-1]).value}reset(){this.statistics.enabled&&this.stages.forEach(e=>{this.statistics.getTimer(e).reset()})}start(){return this.stage=this.stages[0],this.statistics.getTimer(this.stages[0]).value||-1}stop(){return this.stage=void 0,void 0!==this.value?this.value:-1}get stage(){return this.currentStage}set stage(e){this.currentStage!==e&&(this.statistics.enabled&&void 0!==this.currentStage&&this.statistics.getTimer(this.currentStage).stop(),this.currentStage=e,this.statistics.enabled&&void 0!==this.currentStage&&this.statistics.getTimer(this.currentStage).start())}};t.Statistics=class{constructor(e,t=!1){this.name=e,this.enabled=t,this.timers=new Map,this.nullTimer=new a(this,"<null>")}createTimer(e,t=!0){const r=t?new s(this,e):new a(this,e);return this.addTimer(r)}addTimer(e){if(void 0!==this.timers.get(e.name))throw new Error("Duplicate timer name: '"+e.name+"'");return this.timers.set(e.name,e),e}getTimer(e){if(!this.enabled)return this.nullTimer;const t=this.timers.get(e);return void 0===t?this.nullTimer:t}hasTimer(e){return void 0!==this.timers.get(e)}reset(){this.timers.forEach(e=>{e.reset()})}log(e,t){void 0===e&&void 0===this.name||n.log(void 0!==e?e:this.name);let r=0;this.timers.forEach(e=>{r=Math.max(r,e.name.length)});const i=e=>void 0!==e?e.toFixed(5):"?";this.timers.forEach(e=>{let t=e.name+": "+" ".repeat(r-e.name.length);if(t+=i(e.value),e instanceof s){const r=e.getStats();void 0!==r&&(t+=`  [ min=${i(r.min)}, max=${i(r.max)}, `+`avg=${i(r.avg)}, med=${i(r.median)}, `+`med95=${i(r.median95)}, med99=${i(r.median99)}, `+`N=${i(r.numSamples)} ]`)}n.log(t)}),void 0!==t&&n.log(t)}};class l{constructor(){this.entries=new Map,this.messages=void 0}getValue(e){return this.entries.get(e)}setValue(e,t){this.entries.set(e,t)}addValue(e,t){const r=this.entries.get(e);this.entries.set(e,t+(void 0===r?0:r))}addMessage(e){void 0===this.messages&&(this.messages=[]),this.messages.push(e)}reset(){this.entries.forEach((e,t)=>{this.entries.set(t,0)}),this.messages=void 0}}t.FrameStats=l;class u{constructor(e=0){this.capacity=e,this.frameEntries=new Map,this.messages=new o(e)}get length(){return this.messages.size}reset(){this.frameEntries.forEach((e,t)=>{e.clear()}),this.messages.clear()}addFrame(e){const t=this.length,r=this.frameEntries;e.entries.forEach((e,i)=>{let n=r.get(i);if(void 0===n){n=new o(this.capacity);for(let e=0;e<t;e++)n.enqOne(0);this.frameEntries.set(i,n)}n.enqOne(e)}),this.messages.enq(e.messages)}log(){let e=0;this.frameEntries.forEach((t,r)=>{e=Math.max(e,r.length)});const t=e=>void 0!==e?e.toFixed(5):"?";this.frameEntries.forEach((r,i)=>{let o=i+": "+" ".repeat(e-i.length);const a=c(r.asArray());void 0!==a&&(o+=`  [ min=${t(a.min)}, max=${t(a.max)}, `+`avg=${t(a.avg)}, med=${t(a.median)}, `+`med95=${t(a.median95)}, med99=${t(a.median99)}, `+`N=${t(a.numSamples)} ]`),n.log(o)})}}t.FrameStatsArray=u;class d{constructor(e=!0,t=1e3){this.enabled=e,this.maxNumFrames=t,this.currentFrame=new l,this.appResults=new Map,this.configs=new Map,d.m_instance=this,this.m_frameEvents=new u(t)}get isFull(){return this.m_frameEvents.length>=this.maxNumFrames}static get instance(){return void 0===d.m_instance&&(d.m_instance=new d(!1,0)),d.m_instance}get frameEvents(){return this.m_frameEvents}clear(){this.clearFrames(),this.configs.clear(),this.appResults.clear()}clearFrames(){this.m_frameEvents.reset(),this.currentFrame.reset()}storeFrameInfo(e){if(this.m_frameEvents.length>=this.maxNumFrames)return!1;if(void 0!==e&&(void 0!==e.render&&(this.currentFrame.setValue("gl.numCalls",null===e.render.calls?0:e.render.calls),this.currentFrame.setValue("gl.numPoints",null===e.render.points?0:e.render.points),this.currentFrame.setValue("gl.numLines",null===e.render.lines?0:e.render.lines),this.currentFrame.setValue("gl.numTriangles",null===e.render.triangles?0:e.render.triangles)),void 0!==e.memory&&(this.currentFrame.setValue("gl.numGeometries",null===e.memory.geometries?0:e.memory.geometries),this.currentFrame.setValue("gl.numTextures",null===e.memory.textures?0:e.memory.textures)),void 0!==e.programs&&this.currentFrame.setValue("gl.numPrograms",null===e.programs?0:e.programs.length)),void 0!==window&&void 0!==window.performance){const e=window.performance.memory;void 0!==e&&(this.currentFrame.setValue("memory.totalJSHeapSize",e.totalJSHeapSize),this.currentFrame.setValue("memory.usedJSHeapSize",e.usedJSHeapSize),this.currentFrame.setValue("memory.jsHeapSizeLimit",e.jsHeapSizeLimit))}return this.m_frameEvents.addFrame(this.currentFrame),this.currentFrame.reset(),!0}log(e,t){n.log(void 0!==e?e:"PerformanceStatistics"),this.appResults.forEach((e,t)=>{n.log(t,e)}),this.configs.forEach((e,t)=>{n.log(t,e)}),this.m_frameEvents.log(),void 0!==t&&n.log(t)}getAsPlainObject(e=!1){const t={},r={},i={},n={configs:r,appResults:t,frames:i};if(this.appResults.forEach((e,r)=>{t[r]=e}),this.configs.forEach((e,t)=>{r[t]=e}),e)for(const[e,t]of this.m_frameEvents.frameEntries)i[e]=t.bottom;else for(const[e,t]of this.m_frameEvents.frameEntries)i[e]=t.asArray();return n.messages=this.m_frameEvents.messages.asArray(),n}getLastFrameStatistics(){return this.getAsPlainObject(!0)}getAsSimpleFrameStatistics(e=!1){const t=new Map,r=new Map,i=new Map,n={configs:t,appResults:r,frames:i,messages:this.m_frameEvents.messages.asArray()};if(this.appResults.forEach((e,t)=>{r.set(t,e)}),this.configs.forEach((e,r)=>{t.set(r,e)}),e)for(const[e,t]of this.m_frameEvents.frameEntries)i.set(e,t.bottom);else for(const[e,t]of this.m_frameEvents.frameEntries)i.set(e,t.asArray());return n}}t.PerformanceStatistics=d,d.m_instance=void 0},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);class n{constructor(){this.enabled=!1,this.renderToScreen=!1}setSize(e,t){}render(e,t,r,i,n,o){}}t.Pass=n;t.RenderPass=class extends n{constructor(){super()}render(e,t,r,i,n){e.setRenderTarget(this.renderToScreen?null:i),e.render(t,r)}};t.ShaderPass=class extends n{constructor(e,t="tDiffuse"){super(),this.textureID=t,e instanceof i.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):(this.uniforms=i.UniformsUtils.clone(e.uniforms),this.material=new i.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new o(this.material)}render(e,t,r,i,n,o){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,e.setRenderTarget(this.renderToScreen?null:i),this.fsQuad.render(e)}};class o{constructor(e){this.m_camera=new i.OrthographicCamera(-1,1,1,-1,0,1);const t=new i.PlaneBufferGeometry(2,2);this.m_mesh=new i.Mesh(t,e)}get material(){return this.m_mesh.material}set material(e){this.m_mesh.material=e}render(e){e.render(this.m_mesh,this.m_camera)}}},function(e,t,r){(function(e){function r(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===r(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===r(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===r(e)},t.isError=function(e){return"[object Error]"===r(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=e.isBuffer}).call(this,r(36).Buffer)},function(e,t,r){"use strict";var i=null;i="undefined"!=typeof Promise?Promise:r(404),e.exports={Promise:i}},function(e,t,r){"use strict";e.exports=u;var i=r(38);((u.prototype=Object.create(i.prototype)).constructor=u).className="Namespace";var n,o,a,s=r(27),c=r(7);function l(e,t){if(e&&e.length){for(var r={},i=0;i<e.length;++i)r[e[i].name]=e[i].toJSON(t);return r}}function u(e,t){i.call(this,e,t),this.nested=void 0,this._nestedArray=null}function d(e){return e._nestedArray=null,e}u.fromJSON=function(e,t){return new u(e,t.options).addJSON(t.nested)},u.arrayToJSON=l,u.isReservedId=function(e,t){if(e)for(var r=0;r<e.length;++r)if("string"!=typeof e[r]&&e[r][0]<=t&&e[r][1]>=t)return!0;return!1},u.isReservedName=function(e,t){if(e)for(var r=0;r<e.length;++r)if(e[r]===t)return!0;return!1},Object.defineProperty(u.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=c.toArray(this.nested))}}),u.prototype.toJSON=function(e){return c.toObject(["options",this.options,"nested",l(this.nestedArray,e)])},u.prototype.addJSON=function(e){if(e)for(var t,r=Object.keys(e),i=0;i<r.length;++i)t=e[r[i]],this.add((void 0!==t.fields?n.fromJSON:void 0!==t.values?a.fromJSON:void 0!==t.methods?o.fromJSON:void 0!==t.id?s.fromJSON:u.fromJSON)(r[i],t));return this},u.prototype.get=function(e){return this.nested&&this.nested[e]||null},u.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof a)return this.nested[e].values;throw Error("no such enum: "+e)},u.prototype.add=function(e){if(!(e instanceof s&&void 0!==e.extend||e instanceof n||e instanceof a||e instanceof o||e instanceof u))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof u&&e instanceof u)||t instanceof n||t instanceof o)throw Error("duplicate name '"+e.name+"' in "+this);for(var r=t.nestedArray,i=0;i<r.length;++i)e.add(r[i]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),d(this)},u.prototype.remove=function(e){if(!(e instanceof i))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),d(this)},u.prototype.define=function(e,t){if(c.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var r=this;e.length>0;){var i=e.shift();if(r.nested&&r.nested[i]){if(!((r=r.nested[i])instanceof u))throw Error("path conflicts with non-namespace objects")}else r.add(r=new u(i))}return t&&r.addJSON(t),r},u.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof u?e[t++].resolveAll():e[t++].resolve();return this.resolve()},u.prototype.lookup=function(e,t,r){if("boolean"==typeof t?(r=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),c.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var i=this.get(e[0]);if(i){if(1===e.length){if(!t||t.indexOf(i.constructor)>-1)return i}else if(i instanceof u&&(i=i.lookup(e.slice(1),t,!0)))return i}else for(var n=0;n<this.nestedArray.length;++n)if(this._nestedArray[n]instanceof u&&(i=this._nestedArray[n].lookup(e,t,!0)))return i;return null===this.parent||r?null:this.parent.lookup(e,t)},u.prototype.lookupType=function(e){var t=this.lookup(e,[n]);if(!t)throw Error("no such type: "+e);return t},u.prototype.lookupEnum=function(e){var t=this.lookup(e,[a]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},u.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[n,a]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},u.prototype.lookupService=function(e){var t=this.lookup(e,[o]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},u._configure=function(e,t,r){n=e,o=t,a=r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COMMON_VARYINGS="\nvarying lowp vec4 vColor;\n",t.COMMON_ATTRUBUTES="\nattribute float objectIdentifier;\nattribute lowp vec4 defaultColor;\n",t.COMMON_VARYINGS_ATTRS_UNIFORMS=`\nuniform float uHoveredObject;\nuniform float uSelectedObject;\nuniform lowp vec4 uHoverColor;\nuniform lowp vec4 uSelectColor;\nuniform lowp vec4 uSelectHoverColor;\n\n${t.COMMON_ATTRUBUTES}\n${t.COMMON_VARYINGS}\n`,t.COMMON_VERTEX="\nif (uSelectedObject != objectIdentifier && uHoveredObject != objectIdentifier) {\n    vColor = defaultColor;\n} else if (uSelectedObject == objectIdentifier && uHoveredObject == objectIdentifier) {\n    vColor = uSelectHoverColor;\n} else if (uHoveredObject == objectIdentifier) {\n    vColor = uHoverColor;\n} else if (uSelectedObject == objectIdentifier) {\n    vColor = uSelectColor;\n}\n",t.COMMON_FRAGMENT="\ngl_FragColor = vColor;\n"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValueDefinition=function(e){const t=e;return"object"==typeof t&&null!==t&&"string"==typeof t.type&&void 0!==t.value},t.isSelectorDefinition=function(e){const t=e;return"object"==typeof t&&null!==t&&"selector"===t.type&&("string"==typeof t.value||Array.isArray(t.value))},t.isJsonExprReference=function(e){return Array.isArray(e)&&2===e.length&&"ref"===e[0]&&"string"==typeof e[1]},t.isActualSelectorDefinition=function(e){const t=e;return"object"==typeof t&&null!==t&&!Array.isArray(t)&&"string"==typeof t.technique}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Discrete=0]="Discrete",e[e.Linear=1]="Linear",e[e.Cubic=2]="Cubic",e[e.Exponential=3]="Exponential"}(t.InterpolationMode||(t.InterpolationMode={})),t.interpolatedPropertyDefinitionToJsonExpr=function(e){if(void 0===e.interpolation||"Discrete"===e.interpolation){const t=["step",["zoom"],e.values[0]];for(let r=1;r<e.zoomLevels.length;++r)t.push(e.zoomLevels[r],e.values[r]);return t}const t=["interpolate"];switch(e.interpolation){case"Linear":t.push(["linear"]);break;case"Cubic":t.push(["cubic"]);break;case"Exponential":t.push(["exponential",void 0!==e.exponent?e.exponent:2]);break;default:throw new Error(`interpolation mode '${e.interpolation}' is not supported`)}t.push(["zoom"]);for(let r=0;r<e.zoomLevels.length;++r)t.push(e.zoomLevels[r],e.values[r]);return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(42),n=r(17),o=r(29),a=r(18),s=r(30),c=r(28),l=r(31);class u extends l.Projection{constructor(){super(...arguments),this.type=l.ProjectionType.Planar}static clamp(e,t,r){return Math.min(Math.max(t,e),r)}static latitudeClamp(e){return u.clamp(e,-d.MAXIMUM_LATITUDE,d.MAXIMUM_LATITUDE)}static latitudeProject(e){return Math.log(Math.tan(.25*Math.PI+.5*e))/Math.PI}static latitudeClampProject(e){return u.latitudeProject(u.latitudeClamp(e))}static unprojectLatitude(e){return 2*Math.atan(Math.exp(Math.PI*e))-.5*Math.PI}getScaleFactor(e){return Math.cosh(2*Math.PI*(e.y/this.unitScale-.5))}worldExtent(e,t,r){return r||(r=a.MathUtils.newEmptyBox3()),r.min.x=0,r.min.y=0,r.min.z=e,r.max.x=this.unitScale,r.max.y=this.unitScale,r.max.z=t,r}projectPoint(e,t){let r;return r=e instanceof n.GeoCoordinates?e:new n.GeoCoordinates(e.latitude,e.longitude,e.altitude),t||(t={x:0,y:0,z:0}),t.x=(r.longitude+180)/360*this.unitScale,t.y=(.5*u.latitudeClampProject(r.latitudeInRadians)+.5)*this.unitScale,t.z=r.altitude||0,t}unprojectPoint(e){return n.GeoCoordinates.fromRadians(u.unprojectLatitude(2*(e.y/this.unitScale-.5)),e.x/this.unitScale*2*Math.PI-Math.PI,e.z)}unprojectAltitude(e){return e.z}projectBox(e,t){const r=this.projectPoint(e.center),i=(.5*u.latitudeClampProject(e.northEast.latitudeInRadians)+.5)*this.unitScale,n=(.5*u.latitudeClampProject(e.southWest.latitudeInRadians)+.5)*this.unitScale,c=.5*(i+n);r.y=c;const l=i-n,d=e.longitudeSpan/360*this.unitScale;if(t||(t=a.MathUtils.newEmptyBox3()),o.isBox3Like(t)){t.min.x=r.x-.5*d,t.min.y=r.y-.5*l,t.max.x=r.x+.5*d,t.max.y=r.y+.5*l;const i=e.altitudeSpan;void 0!==i?(t.min.z=r.z-.5*i,t.max.z=r.z+.5*i):(t.min.z=0,t.max.z=0)}else{if(!s.isOrientedBox3Like(t))throw new Error("invalid bounding box");a.MathUtils.newVector3(1,0,0,t.xAxis),a.MathUtils.newVector3(0,1,0,t.yAxis),a.MathUtils.newVector3(0,0,1,t.zAxis),t.position.x=r.x,t.position.y=r.y,t.position.z=r.z,t.extents.x=.5*d,t.extents.y=.5*l,t.extents.z=Math.max(Number.EPSILON,.5*(e.altitudeSpan||0))}return t}unprojectBox(e){const t=this.unprojectPoint(e.min),r=this.unprojectPoint(e.max);return i.GeoBox.fromCoordinates(t,r)}groundDistance(e){return e.z}scalePointToSurface(e){return e.z=0,e}surfaceNormal(e,t){return void 0===t?t={x:0,y:0,z:1}:(t.x=0,t.y=0,t.z=1),t}reprojectPoint(e,r,i){return e===this||e!==t.webMercatorProjection&&e!==t.mercatorProjection?super.reprojectPoint(e,r,i):(void 0===i&&(i={}),i.x=r.x,i.y=this.unitScale-r.y,i.z=r.z,i)}}class d{}t.MercatorConstants=d,d.MAXIMUM_LATITUDE=1.4844222297453322,t.mercatorProjection=new u(c.EarthConstants.EQUATORIAL_CIRCUMFERENCE),t.webMercatorProjection=new class extends u{projectPoint(e,t){let r;r=e instanceof n.GeoCoordinates?e:new n.GeoCoordinates(e.latitude,e.longitude,e.altitude),t||(t={x:0,y:0,z:0}),t.x=(r.longitude+180)/360*this.unitScale;const i=Math.sin(u.latitudeClamp(r.latitudeInRadians));return t.y=(.5-Math.log((1+i)/(1-i))/(4*Math.PI))*this.unitScale,t.z=r.altitude||0,t}unprojectPoint(e){const t=e.x/this.unitScale-.5,r=.5-e.y/this.unitScale,i=360*t,o=90-360*Math.atan(Math.exp(2*-r*Math.PI))/Math.PI;return new n.GeoCoordinates(o,i,e.z)}projectBox(e,t){const r=super.projectBox(e,t);if(o.isBox3Like(r)){const e=r.max.y;r.max.y=this.unitScale-r.min.y,r.min.y=this.unitScale-e}else s.isOrientedBox3Like(r)&&(a.MathUtils.newVector3(1,0,0,r.xAxis),a.MathUtils.newVector3(0,-1,0,r.yAxis),a.MathUtils.newVector3(0,0,-1,r.zAxis),r.position.y=this.unitScale-r.position.y);return r}unprojectBox(e){const t=this.unprojectPoint(e.min),r=this.unprojectPoint(e.max);return new i.GeoBox(new n.GeoCoordinates(r.latitude,t.longitude,t.altitude),new n.GeoCoordinates(t.latitude,r.longitude,r.altitude))}surfaceNormal(e,t){return void 0===t?t={x:0,y:0,z:-1}:(t.x=0,t.y=0,t.z=-1),t}localTangentSpace(e,t){return this.projectPoint(e,t.position),a.MathUtils.newVector3(1,0,0,t.xAxis),a.MathUtils.newVector3(0,-1,0,t.yAxis),a.MathUtils.newVector3(0,0,-1,t.zAxis),t}}(c.EarthConstants.EQUATORIAL_CIRCUMFERENCE)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.quadTreeSubdivisionScheme=new class{getSubdivisionX(){return 2}getSubdivisionY(){return 2}getLevelDimensionX(e){return 1<<e}getLevelDimensionY(e){return 1<<e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,4294967296,8589934592,17179869184,34359738368,68719476736,137438953472,274877906944,549755813888,1099511627776,2199023255552,4398046511104,8796093022208,17592186044416,35184372088832,70368744177664,0x800000000000,281474976710656,562949953421312,0x4000000000000,0x8000000000000,4503599627370496];class n{constructor(e,t,r){this.row=e,this.column=t,this.level=r}static fromRowColumnLevel(e,t,r){return new n(e,t,r)}static fromQuadKey(e){const t=e.length;let r=0,i=0;for(let n=0;n<e.length;++n){const o=1<<n,a=parseInt(e.charAt(t-n-1),10);1&a&&(i|=o),2&a&&(r|=o)}return n.fromRowColumnLevel(r,i,t)}static fromMortonCode(e){let t=0,r=0,i=0,o=e;for(;o>1;){const e=1<<t;1&o&&(i|=e),2&o&&(r|=e),t++,o=(o-(3&o))/4}const a=n.fromRowColumnLevel(r,i,t);return a.m_mortonCode=e,a}static fromHereTile(e){const t=n.fromMortonCode(parseInt(e,10));return t.m_hereTile=e,t}static columnsAtLevel(e){return Math.pow(2,e)}static rowsAtLevel(e){return Math.pow(2,e)}static atCoords(e,t,r,i,o){return n.fromRowColumnLevel(Math.floor(r/(o/n.rowsAtLevel(e))),Math.floor(t/(i/n.columnsAtLevel(e))),e)}static parentMortonCode(e){return Math.floor(e/4)}parent(){if(0===this.level)throw new Error("Cannot get the parent of the root tile key");return n.fromRowColumnLevel(this.row>>>1,this.column>>>1,this.level-1)}changedLevelBy(e){const t=Math.max(0,this.level+e);let r=this.row,i=this.column;return e>=0?(r<<=e,i<<=e):(r>>>=-e,i>>>=-e),n.fromRowColumnLevel(r,i,t)}changedLevelTo(e){return this.changedLevelBy(e-this.level)}mortonCode(){if(void 0===this.m_mortonCode){let e=this.column,t=this.row,r=i[this.level<<1];for(let n=0;n<this.level;++n)1&e&&(r+=i[2*n]),1&t&&(r+=i[2*n+1]),e>>>=1,t>>>=1;this.m_mortonCode=r}return this.m_mortonCode}toHereTile(){return void 0===this.m_hereTile&&(this.m_hereTile=this.mortonCode().toString()),this.m_hereTile}toQuadKey(){let e="";for(let t=this.level;t>0;--t){const r=1<<t-1,i=0!=(this.column&r),n=0!=(this.row&r);e+=i&&n?"3":n?"2":i?"1":"0"}return e}equals(e){return this.row===e.row&&this.column===e.column&&this.level===e.level}addedSubKey(e){const t=n.fromQuadKey(0===e.length?"-":e),r=this.changedLevelBy(t.level);return n.fromRowColumnLevel(r.row+t.row,r.column+t.column,r.level)}addedSubHereTile(e){const t=n.fromHereTile(e),r=this.changedLevelBy(t.level);return n.fromRowColumnLevel(r.row+t.row,r.column+t.column,r.level)}getSubHereTile(e){const t=1<<2*e;return(this.mortonCode()&t-1|t).toString()}rowCount(){return n.rowsAtLevel(this.level)}columnCount(){return n.columnsAtLevel(this.level)}}t.TileKey=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(1).LoggerManager.instance.create("WorkerService",{enabled:!1});t.WorkerService=class{constructor(e){this.serviceId=e,this.m_pendingRequests=new Map,this.onMessage=e=>{if("string"==typeof e.data.service&&e.data.service===this.serviceId)try{if(i.WorkerServiceProtocol.isRequestMessage(e.data)){const t=e.data,r={service:t.service,messageId:t.messageId,responseSent:!1};this.m_pendingRequests.set(t.messageId,r),this.tryHandleRequest(t.request).then(e=>{this.doSendResponse(r,{service:this.serviceId,type:i.WorkerServiceProtocol.ServiceMessageName.Response,messageId:t.messageId,response:e.response},e.transferList)}).catch(e=>{this.doSendResponse(r,{service:this.serviceId,type:i.WorkerServiceProtocol.ServiceMessageName.Response,messageId:t.messageId,errorMessage:e.toString(),errorStack:e.stack})})}else this.tryHandleMessage(e.data)}catch(t){n.error(`[${this.serviceId}]: Unhandled exception when handling ${e.type}`)}},self.addEventListener("message",this.onMessage);const t={service:e,type:i.WorkerServiceProtocol.ServiceMessageName.Initialized};self.postMessage(t)}destroy(){this.cancelAllPendingRequests(),self.removeEventListener("message",this.onMessage)}handleMessage(e){n.error(`[${this.serviceId}]: Invalid message ${e.type}`)}handleRequest(e){throw new Error(`ServiceAdapter[${this.serviceId}]: Invalid request '${e.type}'`)}tryHandleMessage(e){try{this.handleMessage(e)}catch(t){n.error(`[${this.serviceId}]: Failed, handling message ${e.type}`)}}tryHandleRequest(e){try{return this.handleRequest(e)}catch(e){return n.error(`[${this.serviceId}]: Failure`,e),Promise.reject(e)}}doSendResponse(e,t,r){e.responseSent||(void 0!==r?self.postMessage(t,r):self.postMessage(t),e.responseSent=!0,this.m_pendingRequests.delete(e.messageId))}cancelAllPendingRequests(){this.m_pendingRequests.forEach(e=>{this.doSendResponse(e,{service:this.serviceId,type:i.WorkerServiceProtocol.ServiceMessageName.Response,messageId:e.messageId,errorMessage:"cancelled"})})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(10));var i=r(318);t.ArtifactApi=i;var n=r(319);t.BlobApi=n;var o=r(320);t.ConfigApi=o;var a=r(321);t.CoverageApi=a;var s=r(322);t.IndexApi=s;var c=r(323);t.LookupApi=c;var l=r(324);t.MetadataApi=l;var u=r(325);t.QueryApi=u;var d=r(326);t.VolatileBlobApi=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(332))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(4),o=r(1),a=r(0),s=r(84),c=r(348),l=r(158),u=r(159),d=r(160),h=r(95),m=r(96),p=r(367),f=r(369),g=r(370),y=r(166),v=r(167),_=r(169),b=r(66),S=r(170),T=r(171),E=r(172),w=r(372),C=r(373),x=r(374),O=r(48),A=r(65),P=r(47),R=r(152),I=r(175),D=r(20),L=r(176),M=!0;var k;M?o.LoggerManager.instance.setLogLevelForAll(o.LogLevel.Error):o.LoggerManager.instance.setLogLevelForAll(o.LogLevel.Log),function(e){e.Update="update",e.Resize="resize",e.Render="render",e.AfterRender="didrender",e.FirstFrame="first-render",e.FrameComplete="frame-complete",e.ThemeLoaded="theme-loaded",e.AnimationStarted="animation-started",e.AnimationFinished="animation-finished",e.MovementStarted="movement-started",e.MovementFinished="movement-finished",e.DataSourceConnect="datasource-connect",e.CopyrightChanged="copyright-changed",e.ContextLost="webglcontext-lost",e.ContextRestored="webglcontext-restored",e.CameraPositionChanged="camera-changed"}(k=t.MapViewEventNames||(t.MapViewEventNames={}));const N=o.LoggerManager.instance.create("MapView"),F="./resources/fonts/Default_FontCatalog.json",U=15722977,j={type:"dynamic",fov:40},V=.1,B=4e6,G=140,z=10;t.FALLBACK_RENDER_ORDER_OFFSET=2e4;const q=1,H=20,W=20,K=12,Y=30,$=4,Z="polar",J={type:k.Update},X={type:k.Render},Q={type:k.AfterRender},ee={type:k.FirstFrame},te={type:k.FrameComplete},re={type:k.ThemeLoaded},ie={type:k.AnimationStarted},ne={type:k.AnimationFinished},oe={type:k.MovementStarted},ae={type:k.MovementFinished},se={type:k.ContextLost},ce={type:k.ContextRestored},le={type:k.CopyrightChanged},ue={vector2:[new a.Vector2],vector3:[new a.Vector3]};var de;!function(e){e.Default="default",e.LowPower="low-power",e.HighPerformance="high-performance"}(de=t.MapViewPowerPreference||(t.MapViewPowerPreference={})),t.MapViewDefaults={projection:n.mercatorProjection,maxVisibleDataSourceTiles:120,extendedFrustumCulling:!0,tileCacheSize:200,resourceComputationType:L.ResourceComputationType.EstimationInMb,quadTreeSearchDistanceUp:3,quadTreeSearchDistanceDown:2,pixelRatio:"undefined"!=typeof window&&void 0!==window.devicePixelRatio?window.devicePixelRatio:1};class he extends a.EventDispatcher{constructor(e){super(),this.defaultFontCatalog=F,this.dumpNext=!1,this.renderLabels=!0,this.m_screenCollisions=new w.ScreenCollisions,this.m_visibleTileSetLock=!1,this.m_tileWrappingEnabled=!0,this.m_zoomLevel=q,this.m_minZoomLevel=q,this.m_maxZoomLevel=H,this.m_minCameraHeight=W,this.m_screenCamera=new a.OrthographicCamera(-1,1,1,-1),this.m_rteCamera=new a.PerspectiveCamera,this.m_viewRanges={near:V,far:B,minimum:V,maximum:B},this.m_scene=new a.Scene,this.m_fog=new _.MapViewFog(this.m_scene),this.m_mapTilesRoot=new a.Object3D,this.m_mapAnchors=new a.Object3D,this.m_animationCount=0,this.m_drawing=!1,this.m_updatePending=!1,this.m_frameNumber=0,this.m_maxFps=0,this.m_detectedFps=Y,this.m_textRenderStyleCache=new P.TextRenderStyleCache,this.m_textLayoutStyleCache=new P.TextLayoutStyleCache,this.m_overlayTextElements=[],this.m_forceCameraAspect=void 0,this.m_tileDataSources=[],this.m_connectedDataSources=new Set,this.m_failedDataSources=new Set,this.m_enablePolarDataSource=!0,this.m_raycaster=new a.Raycaster,this.m_plane=new a.Plane(new a.Vector3(0,0,1)),this.m_sphere=new a.Sphere(void 0,n.EarthConstants.EQUATORIAL_RADIUS),this.m_theme={},this.m_themeIsLoading=!1,this.m_firstFrameRendered=!1,this.m_firstFrameComplete=!1,this.m_initialTextPlacementDone=!1,this.m_frameTimeIndex=0,this.m_frameTimeRing=[],this.m_imageCache=new v.MapViewImageCache(this),this.m_poiManager=new S.PoiManager(this),this.m_poiTableManager=new T.PoiTableManager(this),this.m_lastTileIds="",this.m_copyrightInfo=[],this.onWebGLContextLost=e=>{this.dispatchEvent(se),N.warn("WebGL context lost",e)},this.onWebGLContextRestored=e=>{this.dispatchEvent(ce),void 0!==this.m_renderer&&(void 0!==this.m_theme&&void 0!==this.m_theme.clearColor?this.m_renderer.setClearColor(new a.Color(this.m_theme.clearColor)):this.m_renderer.setClearColor(U),this.update()),N.warn("WebGL context restored",e)},this.m_options=Object.assign({},e),this.m_uriResolver=this.m_options.uriResolver,void 0!==this.m_options.minZoomLevel&&(this.m_minZoomLevel=this.m_options.minZoomLevel),void 0!==this.m_options.maxZoomLevel&&(this.m_maxZoomLevel=this.m_options.maxZoomLevel),void 0!==this.m_options.minCameraHeight&&(this.m_minCameraHeight=this.m_options.minCameraHeight),void 0!==this.m_options.fontCatalog&&(this.defaultFontCatalog=this.m_options.fontCatalog),void 0!==this.m_options.decoderUrl&&(h.ConcurrentDecoderFacade.defaultScriptUrl=this.m_uriResolver?this.m_uriResolver.resolveUri(this.m_options.decoderUrl):this.m_options.decoderUrl),void 0!==this.m_options.decoderCount&&(h.ConcurrentDecoderFacade.defaultWorkerCount=this.m_options.decoderCount),this.m_visibleTileSetOptions=Object.assign(Object.assign({},t.MapViewDefaults),{clipPlanesEvaluator:void 0!==e.clipPlanesEvaluator?e.clipPlanesEvaluator:u.createDefaultClipPlanesEvaluator()}),void 0!==e.projection&&(this.m_visibleTileSetOptions.projection=e.projection),void 0!==e.extendedFrustumCulling&&(this.m_visibleTileSetOptions.extendedFrustumCulling=e.extendedFrustumCulling),void 0!==e.maxVisibleDataSourceTiles&&(this.m_visibleTileSetOptions.maxVisibleDataSourceTiles=e.maxVisibleDataSourceTiles),void 0!==e.tileCacheSize&&(this.m_visibleTileSetOptions.tileCacheSize=e.tileCacheSize),void 0!==e.resourceComputationType&&(this.m_visibleTileSetOptions.resourceComputationType=e.resourceComputationType),void 0!==e.quadTreeSearchDistanceUp&&(this.m_visibleTileSetOptions.quadTreeSearchDistanceUp=e.quadTreeSearchDistanceUp),void 0!==e.quadTreeSearchDistanceDown&&(this.m_visibleTileSetOptions.quadTreeSearchDistanceDown=e.quadTreeSearchDistanceDown),void 0!==e.enablePolarDataSource&&(this.m_enablePolarDataSource=e.enablePolarDataSource),this.m_pixelRatio=e.pixelRatio,void 0!==e.maxFps&&(this.m_maxFps=Math.max(0,e.maxFps)),this.m_options.enableStatistics=!0===this.m_options.enableStatistics,this.m_languages=this.m_options.languages,M||void 0===this.m_options.collisionDebugCanvas||null===this.m_options.collisionDebugCanvas||(this.m_collisionDebugCanvas=this.m_options.collisionDebugCanvas,this.m_screenCollisions=new w.ScreenCollisionsDebug(this.m_collisionDebugCanvas)),this.handleRequestAnimationFrame=this.renderFunc.bind(this),this.handlePostponedAnimationFrame=this.postponedAnimationFrame.bind(this),this.m_pickHandler=new b.PickHandler(this,this.m_rteCamera,!0===this.m_options.enableRoadPicking),void 0!==this.m_options.tileWrappingEnabled&&(this.m_tileWrappingEnabled=this.m_options.tileWrappingEnabled),this.setupStats(this.m_options.enableStatistics),this.canvas.addEventListener("webglcontextlost",this.onWebGLContextLost),this.canvas.addEventListener("webglcontextrestored",this.onWebGLContextRestored),this.m_renderer=new a.WebGLRenderer({canvas:this.canvas,antialias:this.nativeWebglAntialiasEnabled,alpha:this.m_options.alpha,preserveDrawingBuffer:!0===this.m_options.preserveDrawingBuffer,powerPreference:void 0===this.m_options.powerPreference?de.Default:this.m_options.powerPreference}),this.m_renderer.autoClear=!1,this.m_renderer.localClippingEnabled=!0,this.m_renderer.info.autoReset=!1,this.setupRenderer(),this.m_options.fovCalculation=void 0===this.m_options.fovCalculation?j:this.m_options.fovCalculation,this.m_options.fovCalculation.fov=a.Math.clamp(this.m_options.fovCalculation.fov,z,G);const{width:r,height:i}=this.getCanvasClientSize(),o=r/i;this.m_camera=new a.PerspectiveCamera(this.m_options.fovCalculation.fov,o,V,B),this.m_camera.up.set(0,0,1),this.m_lookAtDistance=0,this.m_focalLength=0,this.m_scene.add(this.m_camera),this.m_screenProjector=new C.ScreenProjector(this.m_camera),this.setupCamera(),this.m_movementDetector=new l.CameraMovementDetector(this.m_options.movementThrottleTimeout,()=>this.movementStarted(),()=>this.movementFinished());const m=this.m_options.customAntialiasSettings;if(this.mapRenderingManager=new d.MapRenderingManager(r,i,this.m_options.dynamicPixelRatio,m),this.m_tileGeometryManager=!0===this.m_options.enablePhasedLoading?new g.PhasedTileGeometryManager(this):new y.SimpleTileGeometryManager(this),this.m_visibleTiles=new L.VisibleTileSet(new p.FrustumIntersection(this.m_camera,this,this.m_visibleTileSetOptions.extendedFrustumCulling,this.m_tileWrappingEnabled),this.m_tileGeometryManager,this.m_visibleTileSetOptions),this.m_animatedExtrusionHandler=new s.AnimatedExtrusionHandler(this),this.m_backgroundDataSource=new c.BackgroundDataSource,this.addDataSource(this.m_backgroundDataSource),this.m_enablePolarDataSource){const t=void 0!==e.polarStyleSetName?e.polarStyleSetName:Z;this.m_polarDataSource=new E.PolarTileDataSource({styleSetName:t,geometryLevelOffset:e.polarGeometryLevelOffset}),this.updatePolarDataSource()}void 0!==e.backgroundTilingScheme&&this.m_backgroundDataSource.setTilingScheme(e.backgroundTilingScheme),this.initTheme(),this.drawFrame()}get textElementsRenderer(){return this.m_textElementsRenderer}get textRenderStyleCache(){return this.m_textRenderStyleCache}get textLayoutStyleCache(){return this.m_textLayoutStyleCache}get cameraMovementDetector(){return this.m_movementDetector}get animatedExtrusionHandler(){return this.m_animatedExtrusionHandler}get tileGeometryManager(){return this.m_tileGeometryManager}dispose(){this.m_movementFinishedUpdateTimerId&&(clearTimeout(this.m_movementFinishedUpdateTimerId),this.m_movementFinishedUpdateTimerId=void 0),void 0!==this.m_textElementsRendererTimer&&(clearTimeout(this.m_textElementsRendererTimer),this.m_textElementsRendererTimer=void 0),void 0!==this.m_animationFrameHandle&&(cancelAnimationFrame(this.m_animationFrameHandle),this.m_animationFrameHandle=void 0),this.canvas.removeEventListener("webglcontextlost",this.onWebGLContextLost),this.canvas.removeEventListener("webglcontextrestored",this.onWebGLContextRestored);for(const e of this.m_tileDataSources)e.dispose();this.m_visibleTiles.clearTileCache(),this.m_renderer.dispose(),this.m_imageCache.clear(),this.m_movementDetector.dispose()}get resourceComputationType(){return this.m_visibleTiles.resourceComputationType}set resourceComputationType(e){this.m_visibleTiles.resourceComputationType=e}getCacheSize(){return this.m_visibleTiles.getDataSourceCacheSize()}setCacheSize(e,t){this.m_visibleTiles.setDataSourceCacheSize(e),t=void 0!==t?t:e/2,this.m_visibleTiles.setNumberOfVisibleTiles(Math.floor(t)),this.updateImages(),this.updateLighting(),void 0!==this.m_textElementsRenderer&&this.m_textElementsRenderer.placeAllTileLabels(),this.updateSkyBackground(),this.update()}get extendedFrustumCulling(){return void 0===this.m_options.extendedFrustumCulling||this.m_visibleTileSetOptions.extendedFrustumCulling}set extendedFrustumCulling(e){this.m_visibleTileSetOptions.extendedFrustumCulling=e}get lockVisibleTileSet(){return this.m_visibleTileSetLock}set lockVisibleTileSet(e){this.m_visibleTileSetLock=e}get pointOfView(){return this.m_pointOfView}set pointOfView(e){this.m_pointOfView=e,this.update()}loadPostEffects(e){fetch(e).then(e=>e.json()).then(e=>{this.m_postEffects=e,this.setPostEffects()})}get postEffects(){return this.m_postEffects}set postEffects(e){this.m_postEffects=e,this.setPostEffects()}get theme(){return this.m_theme}set theme(e){if(!I.ThemeLoader.isThemeLoaded(e))return this.m_themeIsLoading=!0,void I.ThemeLoader.load(e,{uriResolver:this.m_uriResolver}).then(e=>{this.m_themeIsLoading=!1,this.theme=e}).catch(e=>{this.m_themeIsLoading=!1,N.error(`failed to set theme: ${e}`,e)});this.m_theme.fog=e.fog,this.m_theme.sky=e.sky,this.updateSkyBackground(),this.m_fog.reset(this.m_theme),this.m_theme.lights=e.lights,this.updateLighting(),this.m_theme.clearColor=e.clearColor,this.renderer.setClearColor(new a.Color(e.clearColor)),this.m_theme.images=e.images,this.m_theme.imageTextures=e.imageTextures,this.updateImages(),this.m_theme.poiTables=e.poiTables,this.loadPoiTables(),this.m_theme.textStyles=e.textStyles,this.m_theme.defaultTextStyle=e.defaultTextStyle,this.m_theme.fontCatalogs=e.fontCatalogs,this.m_textRenderStyleCache.clear(),this.m_textLayoutStyleCache.clear(),this.resetTextRenderer(),void 0===this.m_theme.styles&&(this.m_theme.styles={}),this.m_backgroundDataSource&&this.m_backgroundDataSource.setTheme(this.m_theme),this.m_theme.styles=e.styles||{},this.m_theme.definitions=e.definitions;for(const e of this.m_tileDataSources)e.setTheme(this.m_theme);this.dispatchEvent(re),this.update()}get uriResolver(){return this.m_uriResolver}get forceCameraAspect(){return this.m_forceCameraAspect}set forceCameraAspect(e){this.m_forceCameraAspect=e}set maxFps(e){this.m_maxFps=Math.max(0,e)}get maxFps(){return Math.max(0,this.m_maxFps)}get languages(){return this.m_languages}set languages(e){this.m_languages=e,this.m_tileDataSources.forEach(e=>{e.setLanguages(this.m_languages)}),this.update()}get copyrightInfo(){return this.m_copyrightInfo}set disableFading(e){this.m_options.disableFading=e}get disableFading(){return!0===this.m_options.disableFading}get frameNumber(){return this.m_frameNumber}resetFrameNumber(){this.m_frameNumber=0,this.m_previousFrameTimeStamp=void 0}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}get canvas(){return this.m_options.canvas}get collisionDebugCanvas(){return this.m_collisionDebugCanvas}get scene(){return this.m_scene}get camera(){return this.m_camera}get renderer(){return this.m_renderer}get clearColor(){const e=this.m_renderer.getClearColor();return void 0!==e?e.getHex():0}set clearColor(e){this.m_renderer.setClearColor(e)}get projection(){return this.m_visibleTileSetOptions.projection}set projection(e){const t=D.MapViewUtils.rayCastWorldCoordinates(this,0,0);if(null===t)throw new Error("MapView does not support a view pointing in the void.");const r=this.projection.unprojectPoint(t),i=this.camera.position.distanceTo(t),n=D.MapViewUtils.extractAttitude(this,this.camera),o=a.Math.radToDeg(n.pitch),s=a.Math.radToDeg(n.yaw);this.m_visibleTileSetOptions.projection=e,this.updatePolarDataSource(),this.clearTileCache(),this.m_visibleTiles=new L.VisibleTileSet(new p.FrustumIntersection(this.m_camera,this,this.m_visibleTileSetOptions.extendedFrustumCulling,this.m_tileWrappingEnabled),this.m_tileGeometryManager,this.m_visibleTileSetOptions),this.lookAt(r,i,o,s)}get clipPlanesEvaluator(){return this.m_visibleTileSetOptions.clipPlanesEvaluator}set clipPlanesEvaluator(e){this.m_visibleTileSetOptions.clipPlanesEvaluator=e}get focalLength(){return this.m_focalLength}get lookAtDistance(){return this.m_lookAtDistance}get viewRanges(){return this.m_viewRanges}get geoCenter(){return this.projection.unprojectPoint(this.m_camera.position).normalized()}set geoCenter(e){if(void 0!==e.altitude)this.projection.projectPoint(e,this.m_camera.position);else{const t=this.geoCenter.altitude;this.projection.projectPoint(new n.GeoCoordinates(e.latitude,e.longitude,t),this.m_camera.position)}this.update()}get mapAnchors(){return this.m_mapAnchors}get worldCenter(){return this.m_camera.position}get worldRootObject(){return this.m_mapTilesRoot}get pickHandler(){return this.m_pickHandler}get imageCache(){return this.m_imageCache}get poiManager(){return this.m_poiManager}get poiTableManager(){return this.m_poiTableManager}get minCameraHeight(){return this.m_minCameraHeight}get minZoomLevel(){return this.m_minZoomLevel}set minZoomLevel(e){this.m_minZoomLevel=e,this.update()}get maxZoomLevel(){return this.m_maxZoomLevel}set maxZoomLevel(e){this.m_maxZoomLevel=e,this.update()}get zoomLevel(){return this.m_zoomLevel}set zoomLevel(e){this.m_zoomLevel=a.Math.clamp(e,this.m_minZoomLevel,this.m_maxZoomLevel),D.MapViewUtils.zoomOnTargetPosition(this,0,0,this.m_zoomLevel),this.update()}get storageLevel(){return a.Math.clamp(Math.floor(this.m_zoomLevel),this.m_minZoomLevel,this.m_maxZoomLevel)}get viewportHeight(){return this.canvas.height}get nativeWebglAntialiasEnabled(){return void 0===this.m_options.enableNativeWebglAntialias?this.pixelRatio<2:this.m_options.enableNativeWebglAntialias}get phasedLoadingEnabled(){return!1!==this.m_options.enablePhasedLoading}get dataSources(){return this.m_tileDataSources}setFovCalculation(e){this.m_options.fovCalculation=e,this.calculateFocalLength(this.m_renderer.getSize(ue.vector2[0]).height),this.updateCameras()}getDataSourceByName(e){return this.m_tileDataSources.find(t=>t.name===e)}getDataSourcesByStyleSetName(e){return this.m_tileDataSources.filter(t=>t.styleSetName===e)}isDataSourceEnabled(e){return e.enabled&&e.ready()&&this.m_connectedDataSources.has(e.name)}addDataSource(e){if(void 0!==this.getDataSourceByName(e.name))throw new Error(`A DataSource with the name "${e.name}" already exists in this MapView.`);return e.attach(this),this.m_tileDataSources.push(e),this.m_backgroundDataSource&&this.m_backgroundDataSource.updateStorageLevelOffset(),e.connect().then(()=>new Promise(e=>{if(void 0!==this.theme&&void 0!==this.theme.styles)return void e();const t=()=>{this.removeEventListener(k.ThemeLoaded,t),e()};this.addEventListener(k.ThemeLoaded,t)})).then(()=>{-1===this.m_tileDataSources.indexOf(e)||(e.addEventListener(k.Update,()=>{this.update()}),e.setTheme(this.m_theme),this.m_connectedDataSources.add(e.name),this.dispatchEvent({type:k.DataSourceConnect,dataSourceName:e.name}),this.update())}).catch(t=>{N.error(`Failed to connect to datasource ${e.name}: ${t.message}`),this.m_failedDataSources.add(e.name),this.dispatchEvent({type:k.DataSourceConnect,dataSourceName:e.name,error:t})})}removeDataSource(e){const t=this.m_tileDataSources.indexOf(e);-1!==t&&(e.detach(this),this.m_visibleTiles.removeDataSource(e),this.m_tileDataSources.splice(t,1),this.m_connectedDataSources.delete(e.name),this.m_failedDataSources.delete(e.name),this.m_backgroundDataSource&&this.m_backgroundDataSource.updateStorageLevelOffset(),this.update())}get visibleTileSet(){return this.m_visibleTiles}addOverlayText(e){void 0!==this.m_overlayTextElements&&(this.m_overlayTextElements=this.m_overlayTextElements.concat(e)),this.createTextRendererIfNeeded(),this.m_textElementsRenderer.placeAllTileLabels(),this.update()}clearOverlayText(){this.m_overlayTextElements=[]}lookAt(e,t,r=0,i=0){const n=Math.min(89,r);D.MapViewUtils.getCameraRotationAtTarget(this.projection,e,-i,n,this.camera.quaternion),D.MapViewUtils.getCameraPositionFromTargetCoordinates(e,t,-i,n,this.projection,this.camera.position),this.camera.updateMatrixWorld(!0)}setCameraGeolocationAndZoom(e,t,r=0,i=0){this.geoCenter=e;let o=Math.min(89,i);if(this.projection.type===n.ProjectionType.Spherical){const e=Math.asin(n.EarthConstants.EQUATORIAL_RADIUS/(D.MapViewUtils.calculateDistanceToGroundFromZoomLevel(this,t)+n.EarthConstants.EQUATORIAL_RADIUS)),r=a.Math.radToDeg(e);o=Math.min(o,r)}D.MapViewUtils.zoomOnTargetPosition(this,0,0,t),D.MapViewUtils.setRotation(this,r,o),this.update()}get animating(){return this.m_animationCount>0}beginAnimation(){0==this.m_animationCount++&&(this.m_updatePending||(this.m_updatePending=!0,this.drawFrame()),ie.time=Date.now(),this.dispatchEvent(ie))}endAnimation(){this.m_animationCount>0&&--this.m_animationCount,0===this.m_animationCount&&(ne.time=Date.now(),this.dispatchEvent(ne))}get cameraIsMoving(){return this.m_movementDetector.cameraIsMoving}get isDynamicFrame(){return this.cameraIsMoving||this.animating||this.m_updatePending||this.m_animatedExtrusionHandler.isAnimating}get pixelToWorld(){if(void 0===this.m_pixelToWorld){o.assert(void 0!==this.m_options.fovCalculation);const e=this.m_lookAtDistance;this.m_pixelToWorld=D.MapViewUtils.calculateWorldSizeByFocalLength(this.m_focalLength,e,1)}return this.m_pixelToWorld}get worldToPixel(){return 1/this.pixelToWorld}get pixelRatio(){return void 0!==this.m_pixelRatio?this.m_pixelRatio:"undefined"!=typeof window&&void 0!==window.devicePixelRatio?window.devicePixelRatio:1}set pixelRatio(e){this.m_pixelRatio=e,this.renderer.getPixelRatio()!==this.pixelRatio&&this.renderer.setPixelRatio(this.pixelRatio)}set dynamicPixelRatio(e){this.mapRenderingManager.lowResPixelRatio=e}get dynamicPixelRatio(){return this.mapRenderingManager.lowResPixelRatio}getScreenPosition(e){this.projection.projectPoint(e,ue.vector3[0]);const t=this.m_screenProjector.project(ue.vector3[0]);if(void 0!==t){const{width:e,height:r}=this.getCanvasClientSize();t.x=t.x+e/2,t.y=r-(t.y+r/2)}return t}raycasterFromScreenPoint(e,t){return this.m_raycaster.setFromCamera(this.getNormalizedScreenCoordinates(e,t),this.m_rteCamera),this.m_raycaster}getWorldPositionAt(e,t){return this.m_raycaster.setFromCamera(this.getNormalizedScreenCoordinates(e,t),this.m_camera),this.projection.type===n.ProjectionType.Spherical?this.m_raycaster.ray.intersectSphere(this.m_sphere,ue.vector3[0]):this.m_raycaster.ray.intersectPlane(this.m_plane,ue.vector3[0])}getGeoCoordinatesAt(e,t){const r=this.getWorldPositionAt(e,t);return r?this.projection.unprojectPoint(r):null}getNormalizedScreenCoordinates(e,t){const{width:r,height:i}=this.getCanvasClientSize();return new a.Vector3(e/r*2-1,-t/i*2+1,0)}intersectMapObjects(e,t){return this.m_pickHandler.intersectMapObjects(e,t)}resize(e,t){this.m_renderer.setSize(e,t,!1),this.m_renderer.getPixelRatio()!==this.pixelRatio&&this.m_renderer.setPixelRatio(this.pixelRatio),void 0!==this.mapRenderingManager&&this.mapRenderingManager.setSize(e,t),void 0!==this.collisionDebugCanvas&&(this.collisionDebugCanvas.width=e,this.collisionDebugCanvas.height=t),this.updateCameras(),this.update(),this.dispatchEvent({type:k.Resize,size:{width:e,height:t}})}renderSync(){this.renderFunc(o.PerformanceTimer.now())}update(){this.dispatchEvent(J),this.m_updatePending||(this.m_updatePending=!0,this.animating||this.drawFrame())}get updatePending(){return this.m_updatePending}requestUpdateIfNeeded(){this.update()}clearTileCache(e){if(void 0!==e){const t=this.getDataSourceByName(e);t&&(this.m_visibleTiles.clearTileCache(t),t.clearCache())}else this.m_visibleTiles.clearTileCache(),this.m_tileDataSources.forEach(e=>e.clearCache());void 0!==this.m_elevationProvider&&this.m_elevationProvider.clearCache()}forEachVisibleTile(e){this.m_visibleTiles.forEachVisibleTile(e)}forEachCachedTile(e){this.m_visibleTiles.forEachCachedTile(e)}markTilesDirty(e){this.m_visibleTiles.markTilesDirty(e)}setElevationSource(e,t,r){this.removeDataSource(e),this.addDataSource(e),this.m_elevationRangeSource=t,this.m_elevationRangeSource.connect(),this.m_elevationProvider=r,this.dataSources.forEach(e=>{e.setEnableElevationOverlay(!0)}),this.m_tileGeometryManager.setTileUpdateCallback(e=>{f.overlayOnElevation(e)}),this.clearTileCache()}clearElevationSource(e){this.removeDataSource(e),this.m_elevationRangeSource=void 0,this.m_elevationProvider=void 0,this.dataSources.forEach(e=>{e.setEnableElevationOverlay(!1)}),this.m_tileGeometryManager.setTileUpdateCallback(void 0),this.clearTileCache()}get fog(){return this.m_fog}setPostEffects(){this.mapRenderingManager.bloom.enabled=!1,this.mapRenderingManager.outline.enabled=!1,this.mapRenderingManager.vignette.enabled=!1,this.mapRenderingManager.sepia.enabled=!1,void 0!==this.m_postEffects&&(void 0!==this.m_postEffects.bloom&&(this.mapRenderingManager.bloom=this.m_postEffects.bloom),void 0!==this.m_postEffects.outline&&(this.mapRenderingManager.outline.enabled=this.m_postEffects.outline.enabled,this.mapRenderingManager.updateOutline(this.m_postEffects.outline)),void 0!==this.m_postEffects.vignette&&(this.mapRenderingManager.vignette=this.m_postEffects.vignette),void 0!==this.m_postEffects.sepia&&(this.mapRenderingManager.sepia=this.m_postEffects.sepia))}get elevationProvider(){return this.m_elevationProvider}updatePolarDataSource(){const e=this.m_polarDataSource;if(!0===this.m_enablePolarDataSource&&void 0!==e){const t=this.getDataSourceByName(e.name);this.projection.type===n.ProjectionType.Spherical?void 0===t&&this.addDataSource(e):void 0!==t&&this.removeDataSource(e)}}updateCameras(e){const{width:t,height:r}=this.m_renderer.getSize(ue.vector2[0]);this.m_camera.aspect=void 0!==this.m_forceCameraAspect?this.m_forceCameraAspect:t/r,this.setFovOnCamera(this.m_options.fovCalculation,r);const i=this.projection.getScaleFactor(this.camera.position)*this.m_tileDataSources.reduce((e,t)=>Math.max(e,t.maxGeometryHeight),0);Object.assign(this.m_viewRanges,void 0===e?this.m_visibleTiles.updateClipPlanes(i):e),this.m_camera.near=this.m_viewRanges.near,this.m_camera.far=this.m_viewRanges.far,this.m_camera.updateProjectionMatrix(),this.m_camera.updateMatrixWorld(!1),this.m_rteCamera.copy(this.m_camera),this.m_rteCamera.position.setScalar(0),this.m_rteCamera.updateMatrixWorld(!0),this.m_screenCamera.left=t/-2,this.m_screenCamera.right=t/2,this.m_screenCamera.bottom=r/-2,this.m_screenCamera.top=r/2,this.m_screenCamera.updateProjectionMatrix(),this.m_screenCamera.updateMatrixWorld(!1),this.m_screenProjector.update(this.camera,t,r),this.m_screenCollisions.update(t,r),this.m_pixelToWorld=void 0;const n=D.MapViewUtils.extractAttitude(this,this.m_camera).pitch,o=this.getCameraHeightAboveTerrain($),a=D.MapViewUtils.rayCastWorldCoordinates(this,0,0);if(null!==a){this.m_lookAtDistance=a.sub(this.camera.position).length();const e=o/Math.cos(Math.min(n,Math.PI/3));this.m_zoomLevel=D.MapViewUtils.calculateZoomLevelFromDistance(e,this),this.m_fog.update(this,this.m_viewRanges.maximum)}}getCameraHeightAboveTerrain(e){if(void 0!==this.elevationProvider){const t=this.elevationProvider.getHeight(this.geoCenter,e);if(void 0!==t){const e=this.projection.unprojectAltitude(this.m_camera.position)-t;return Math.max(e,1)}}return Math.abs(this.projection.groundDistance(this.m_camera.position))}detectCurrentFps(e){if(void 0!==this.m_previousRequestAnimationTime&&this.m_frameNumber>5){const t=1e3/(e-this.m_previousRequestAnimationTime);this.m_frameTimeRing[this.m_frameTimeIndex%K]=t,this.m_frameTimeIndex++;const r=Math.min(this.m_frameTimeIndex,K);let i=0;for(let e=0;e<r;e++)i+=this.m_frameTimeRing[e];this.m_detectedFps=i/r}this.m_previousRequestAnimationTime=e}drawFrame(){if(this.m_drawing||this.m_options.synchronousRendering)return;if(void 0!==this.m_animationFrameHandle&&(cancelAnimationFrame(this.m_animationFrameHandle),this.m_animationFrameHandle=void 0),this.m_maxFps<=0)return void(this.m_animationFrameHandle=requestAnimationFrame(this.handleRequestAnimationFrame));const e=1e3/this.m_detectedFps,t=1e3/this.m_maxFps,r=void 0===this.m_previousFrameTimeStamp?0:this.m_previousFrameTimeStamp,i=r+t-e-3;this.m_targetRequestAnimationTime=i,this.postponedAnimationFrame(r)}postponedAnimationFrame(e){void 0!==this.m_targetRequestAnimationTime&&(void 0!==this.m_animationFrameHandle&&(cancelAnimationFrame(this.m_animationFrameHandle),this.m_animationFrameHandle=void 0),this.detectCurrentFps(e),this.m_animationFrameHandle=requestAnimationFrame(e>this.m_targetRequestAnimationTime?this.handleRequestAnimationFrame:this.handlePostponedAnimationFrame))}renderFunc(e){this.render(e)}getEnabledTileDataSources(){const e=[];for(const t of this.m_tileDataSources)this.isDataSourceEnabled(t)&&e.push(t);return e}render(e){if(this.m_drawing)return;++this.m_frameNumber;const t=O.PerformanceStatistics.instance,r=t.enabled,i=e;let a,s,c,l,u,d,h;if(X.time=e,this.dispatchEvent(X),r&&((a=t.currentFrame).setValue("renderCount.frameNumber",this.m_frameNumber),void 0!==this.m_previousFrameTimeStamp)){const e=i-this.m_previousFrameTimeStamp;r&&(a.setValue("render.fullFrameTime",e),a.setValue("render.fps",1e3/e))}for(this.m_previousFrameTimeStamp=i,this.m_renderer.info.reset(),this.m_updatePending=!1,this.m_thisFrameTilesChanged=void 0,this.m_drawing=!0,this.m_renderer.getPixelRatio()!==this.pixelRatio&&this.m_renderer.setPixelRatio(this.pixelRatio),this.updateCameras(),this.m_renderer.clear();this.m_mapTilesRoot.children.length>0;)this.m_mapTilesRoot.remove(this.m_mapTilesRoot.children[0]);if(r&&(s=o.PerformanceTimer.now()),!this.lockVisibleTileSet){const e=this.m_visibleTiles.updateRenderList(this.storageLevel,Math.floor(this.zoomLevel),this.getEnabledTileDataSources(),this.m_elevationRangeSource);e.viewRangesChanged&&this.updateCameras(e.viewRanges)}r&&(c=o.PerformanceTimer.now());const m=this.m_visibleTiles.dataSourceTileList,p=void 0!==this.m_textElementsRenderer;let f=void 0!==this.m_overlayTextElements&&this.m_overlayTextElements.length>0,g=!f&&!p&&this.renderLabels;if(m.forEach(({zoomLevel:e,renderedTiles:t})=>{t.forEach(t=>{this.renderTileObjects(t,e),g&&t.hasTextElements()&&(g=!1,f=!0),t.frameNumLastVisible=this.m_frameNumber})}),f&&!p&&this.renderLabels&&this.enqueueTextRendererCreation(),!this.m_initialTextPlacementDone&&!this.m_firstFrameComplete&&!this.isDynamicFrame&&!this.m_initialTextPlacementDone&&!this.m_themeIsLoading&&this.m_poiTableManager.finishedLoading&&this.m_visibleTiles.allVisibleTilesLoaded&&this.m_connectedDataSources.size+this.m_failedDataSources.size===this.m_tileDataSources.length){const e=void 0!==this.m_textElementsRenderer&&this.m_textElementsRenderer.ready&&!this.m_textElementsRenderer.loading;this.textElementsRendererRequested&&!e||(e&&this.m_textElementsRenderer.placeAllTileLabels(),this.m_initialTextPlacementDone=!0),this.update()}if(this.m_mapAnchors.children.forEach(e=>{void 0!==e.geoPosition&&(this.projection.projectPoint(e.geoPosition,e.position),e.position.sub(this.camera.position))}),this.m_animatedExtrusionHandler.zoom=this.m_zoomLevel,void 0!==a&&(a.addValue("renderCount.numTilesRendered",0),a.addValue("renderCount.numTilesVisible",0),a.addValue("renderCount.numTilesLoading",0),m.forEach(({zoomLevel:e,renderedTiles:t,visibleTiles:r,numTilesLoading:i})=>{a.addValue("renderCount.numTilesRendered",t.size),a.addValue("renderCount.numTilesVisible",r.length),a.addValue("renderCount.numTilesLoading",i)})),this.m_movementDetector.checkCameraMoved(this,e)){const{yaw:e,pitch:t,roll:r}=D.MapViewUtils.extractAttitude(this,this.camera),{latitude:i,longitude:n,altitude:o}=this.geoCenter;this.dispatchEvent({type:k.CameraPositionChanged,latitude:i,longitude:n,altitude:o,yaw:e,pitch:t,roll:r,zoom:this.zoomLevel})}const y=void 0!==this.m_pointOfView?this.m_pointOfView:this.m_rteCamera;this.renderLabels&&this.prepareRenderTextElements(e),r&&(l=o.PerformanceTimer.now()),void 0!==this.m_skyBackground&&this.projection.type===n.ProjectionType.Planar&&this.m_skyBackground.updateCamera(this.m_camera),this.mapRenderingManager.render(this.m_renderer,this.m_scene,y,!this.isDynamicFrame),r&&(u=o.PerformanceTimer.now()),this.renderLabels&&this.finishRenderTextElements(),r&&(d=o.PerformanceTimer.now()),this.m_firstFrameRendered||(this.m_firstFrameRendered=!0,r&&t.appResults.set("firstFrame",e),ee.time=e,this.dispatchEvent(ee)),this.m_visibleTiles.disposePendingTiles(),this.m_drawing=!1,(this.animating||this.m_updatePending)&&this.drawFrame(),this.checkCopyrightUpdates(),void 0!==a&&(h=o.PerformanceTimer.now(),a.setValue("render.setupTime",s-i),a.setValue("render.cullTime",c-s),a.setValue("render.textPlacementTime",l-c),a.setValue("render.drawTime",u-l),a.setValue("render.textDrawTime",d-u),a.setValue("render.cleanupTime",h-d),a.setValue("render.frameRenderTime",h-i),O.PerformanceStatistics.instance.storeFrameInfo(this.m_renderer.info)),Q.time=e,this.dispatchEvent(Q),this.m_firstFrameComplete||!this.m_initialTextPlacementDone||this.isDynamicFrame||void 0!==this.m_textElementsRenderer&&(!this.m_textElementsRenderer.ready||this.m_textElementsRenderer.loading)||(this.m_firstFrameComplete=!0,r&&t.appResults.set("firstFrameComplete",e),te.time=e,this.dispatchEvent(te))}renderTileObjects(e,r){const n=this.projection.worldExtent(0,0).max.x*e.offset;if(e.willRender(r))for(const r of e.objects){r.position.copy(e.center),void 0!==r.displacement&&r.position.add(r.displacement),r.position.x+=n,r.position.sub(this.m_camera.position),e.localTangentSpace&&r.setRotationFromMatrix(e.boundingBox.getRotationMatrix()),r.frustumCulled=!1,void 0===r._backupRenderOrder&&(r._backupRenderOrder=r.renderOrder);const o=void 0!==r.userData&&void 0!==r.userData.kind&&r.userData.kind.includes(i.GeometryKind.Building);r.renderOrder=r._backupRenderOrder+(!o&&e.levelOffset<0?t.FALLBACK_RENDER_ORDER_OFFSET*e.levelOffset:0),this.m_mapTilesRoot.add(r)}e.didRender()}prepareRenderTextElements(e){const t=void 0!==this.m_pointOfView;void 0!==this.m_textElementsRenderer&&this.m_textElementsRenderer.ready&&!t&&((this.checkIfTextElementsChanged()||this.checkIfTilesChanged())&&this.m_textElementsRenderer.placeAllTileLabels(),this.m_textElementsRenderer.reset(),this.m_textElementsRenderer.prepopulateScreenWithBlockingElements(),this.m_textElementsRenderer.renderUserTextElements(e,this.m_frameNumber),this.m_textElementsRenderer.renderAllTileText(e,this.m_frameNumber),this.m_textElementsRenderer.renderOverlay(this.m_overlayTextElements),this.m_textElementsRenderer.update())}finishRenderTextElements(){void 0===this.m_pointOfView&&void 0!==this.m_textElementsRenderer&&(this.m_screenCamera.far=this.m_viewRanges.maximum,this.m_textElementsRenderer.renderText(this.m_screenCamera))}initTheme(){void 0!==this.m_options.theme&&(this.m_themeIsLoading=!0,Promise.resolve(this.m_options.theme).then(e=>I.ThemeLoader.load(e,{uriResolver:this.m_uriResolver})).then(e=>{this.m_themeIsLoading=!1,this.theme=e,re.time=Date.now(),this.dispatchEvent(re)}).catch(e=>{this.m_themeIsLoading=!1;const t="string"==typeof this.m_options.theme?` from ${this.m_options.theme}`:"";N.error(`Failed to load theme${t}: ${e}`,e)}))}setupCamera(){const{width:e,height:t}=this.getCanvasClientSize(),r=new n.GeoCoordinates(25,0,3e7);this.projection.projectPoint(r,this.m_camera.position),this.projection.type===n.ProjectionType.Spherical&&this.m_camera.lookAt(this.scene.position),this.m_lookAtDistance=r.altitude,this.calculateFocalLength(t),this.m_visibleTiles=new L.VisibleTileSet(new p.FrustumIntersection(this.m_camera,this,this.m_visibleTileSetOptions.extendedFrustumCulling,this.m_tileWrappingEnabled),this.m_tileGeometryManager,this.m_visibleTileSetOptions),this.resize(e,t),this.geoCenter=r,this.m_screenCamera.position.z=1,this.m_screenCamera.near=0}updateSkyBackground(){if(void 0===this.m_theme)return;const e=this.m_theme;if(this.m_skyBackground instanceof x.SkyBackground&&void 0!==e.sky)this.updateSkyBackgroundColors(e.sky,e.clearColor);else{if(void 0===this.m_skyBackground&&void 0!==e.sky)return void this.addNewSkyBackground(e.sky,e.clearColor);this.m_skyBackground instanceof x.SkyBackground&&void 0===e.sky&&this.removeSkyBackGround()}}addNewSkyBackground(e,t){"gradient"===e.type&&void 0===e.groundColor&&(e.groundColor=o.getOptionValue(t,"#000000")),this.m_skyBackground=new x.SkyBackground(e,this.projection.type,this.m_camera),this.m_scene.background=this.m_skyBackground.texture}removeSkyBackGround(){this.m_scene.background=null,void 0!==this.m_skyBackground&&(this.m_skyBackground.dispose(),this.m_skyBackground=void 0)}updateSkyBackgroundColors(e,t){"gradient"===e.type&&void 0===e.groundColor&&(e.groundColor=o.getOptionValue(t,"#000000")),void 0!==this.m_skyBackground&&this.m_skyBackground.updateTexture(e,this.projection.type)}updateLighting(){if(!this.m_theme)return;const e=this.m_theme;void 0!==e.clearColor&&this.m_renderer.setClearColor(new a.Color(e.clearColor)),this.m_createdLights&&this.m_createdLights.forEach(e=>{this.m_scene.remove(e)}),void 0!==e.lights&&(this.m_createdLights=[],e.lights.forEach(e=>{const t=R.createLight(e);t?(this.m_scene.add(t),this.m_createdLights.push(t)):N.warn(`MapView: failed to create light ${e.name} of type ${e.type}`)}))}movementStarted(){void 0!==this.m_textElementsRenderer&&this.m_textElementsRenderer.movementStarted(),oe.time=Date.now(),this.dispatchEvent(oe)}movementFinished(){void 0!==this.m_textElementsRenderer&&this.m_textElementsRenderer.movementFinished(),ae.time=Date.now(),this.dispatchEvent(ae),this.animating||(void 0!==this.m_movementFinishedUpdateTimerId&&clearTimeout(this.m_movementFinishedUpdateTimerId),this.m_movementFinishedUpdateTimerId=setTimeout(()=>{this.m_movementFinishedUpdateTimerId=void 0,this.update()},0))}checkIfTextElementsChanged(){const e=this.m_visibleTiles.dataSourceTileList;let t=!1;return e.forEach(({renderedTiles:e})=>{e.forEach(e=>{e.textElementsChanged&&(e.textElementsChanged=!1,t=!0)})}),t}checkIfTilesChanged(){if(void 0!==this.m_thisFrameTilesChanged)return this.m_thisFrameTilesChanged;const e=this.m_visibleTiles.dataSourceTileList,t=[];t.length=0,e.forEach(({dataSource:e,renderedTiles:r})=>{r.forEach(r=>{t.push(e.name+"-"+r.tileKey.mortonCode())})}),t.sort();const r=t.join("#");return r!==this.m_lastTileIds?(this.m_lastTileIds=r,this.m_thisFrameTilesChanged=!0):this.m_thisFrameTilesChanged=!1,this.m_thisFrameTilesChanged}checkCopyrightUpdates(){if(!this.checkIfTilesChanged())return;const e=this.getRenderedTilesCopyrightInfo();if(e!==this.m_copyrightInfo){if(e.length===this.m_copyrightInfo.length){let t=!0;for(let r=0;r<e.length;r++){const i=e[r],n=this.m_copyrightInfo[r];if(i.label!==n.label){t=!1;break}}if(t)return}this.m_copyrightInfo=e,this.dispatchEvent(le)}}getRenderedTilesCopyrightInfo(){let e=[];for(const t of this.m_visibleTiles.dataSourceTileList)for(const r of t.renderedTiles.values()){const t=r.copyrightInfo;void 0!==t&&0!==t.length&&(e=m.CopyrightInfo.mergeArrays(e,t))}return e}updateImages(){if(!this.m_theme)return;const e=this.m_theme;if(this.m_imageCache.clear(),this.poiManager.clear(),void 0!==e.images)for(const t of Object.keys(e.images)){const r=e.images[t];this.m_imageCache.addImage(t,r.url,!0===r.preload),"string"==typeof r.atlas&&this.poiManager.addTextureAtlas(t,r.atlas)}void 0!==e.imageTextures&&e.imageTextures.forEach(e=>{this.poiManager.addImageTexture(e)})}loadPoiTables(){void 0!==this.m_theme&&(this.poiTableManager.clear(),this.poiTableManager.loadPoiTables(this.m_theme).then(()=>this.update()).catch(()=>this.update()))}setupStats(e){new O.PerformanceStatistics(e,1e3)}setupRenderer(){this.m_renderer.setClearColor(U),this.m_scene.add(this.m_mapTilesRoot),this.m_scene.add(this.m_mapAnchors)}createTextRendererIfNeeded(){void 0===this.m_textElementsRenderer&&(this.m_textElementsRenderer=new A.TextElementsRenderer(this,this.m_screenCollisions,this.m_screenProjector,this.m_options.minNumGlyphs,this.m_options.maxNumGlyphs,this.m_theme,this.m_options.maxNumVisibleLabels,this.m_options.numSecondChanceLabels,this.m_options.labelDistanceScaleMin,this.m_options.labelDistanceScaleMax,this.m_options.maxDistanceRatioForTextLabels,this.m_options.maxDistanceRatioForPoiLabels))}enqueueTextRendererCreation(){void 0===this.m_textElementsRenderer&&void 0===this.m_textElementsRendererTimer&&(this.m_textElementsRendererTimer=setTimeout(()=>{this.m_textElementsRendererTimer=void 0,this.createTextRendererIfNeeded()},0))}get textElementsRendererRequested(){return void 0!==this.m_textElementsRendererTimer}resetTextRenderer(){void 0!==this.m_textElementsRenderer&&(this.m_textElementsRenderer=void 0),void 0!==this.m_textElementsRendererTimer&&clearTimeout(this.m_textElementsRendererTimer)}limitFov(e,t){e=a.Math.clamp(e,z,G);let r=a.Math.radToDeg(D.MapViewUtils.calculateHorizontalFovByVerticalFov(a.Math.degToRad(e),t));return(r>G||r<z)&&(r=a.Math.clamp(r,z,G),e=a.Math.radToDeg(D.MapViewUtils.calculateVerticalFovByHorizontalFov(a.Math.degToRad(r),t))),e}setFovOnCamera(e,t){let r=0;"fixed"===e.type?(this.calculateFocalLength(t),r=e.fov):(o.assert(0!==this.m_focalLength),r=D.MapViewUtils.calculateFovByFocalLength(this.m_focalLength,t)),this.m_camera.fov=this.limitFov(r,this.m_camera.aspect)}calculateFocalLength(e){o.assert(void 0!==this.m_options.fovCalculation),this.m_focalLength=D.MapViewUtils.calculateFocalLengthByVerticalFov(a.Math.degToRad(this.m_options.fovCalculation.fov),e)}getCanvasClientSize(){const{clientWidth:e,clientHeight:t}=this.canvas;if(0===e||0===t||"number"!=typeof e||"number"!=typeof t){const e=this.m_renderer.getPixelRatio();return{width:Math.round(this.canvas.width/e),height:Math.round(this.canvas.height/e)}}return{width:e,height:t}}}t.MapView=he},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(148),o=r(4),a=r(9),s=r(45),c=r(1),l=r(0),u=r(84),d=r(34),h=r(91),m=r(153),p=r(62),f=r(356),g=r(64),y=r(65),v=r(47),_=r(94),b=c.LoggerManager.instance.create("TileGeometryCreator"),S=.1;class T{constructor(){this.clippingPlanes=[new l.Plane(new l.Vector3(-1,0,0),0),new l.Plane(new l.Vector3(1,0,0),0),new l.Plane(new l.Vector3(0,-1,0),0),new l.Plane(new l.Vector3(0,1,0),0)]}static get instance(){return this.m_instance||(this.m_instance=new T)}initDecodedTile(e,t,r){for(const n of e.techniques)void 0===n.enabled&&(void 0!==n.kind&&(Array.isArray(n.kind)?n.kind=new i.GeometryKindSet(n.kind):"string"!=typeof n.kind&&(b.warn("Technique has unknown type of kind:",n),n.kind=void 0)),void 0===n.kind||n.kind instanceof Set&&0===n.kind.size?n.enabled=!0:n.enabled=!(void 0!==r&&r.hasOrIntersects(n.kind))||void 0!==t&&t.hasOrIntersects(n.kind));for(const t of e.geometries)for(const e of t.groups)e.createdOffsets=[]}createAllGeometries(e,t){const r=e=>!1!==e.enabled;void 0!==t.maxGeometryHeight&&(e.maxGeometryHeight=t.maxGeometryHeight),this.createObjects(e,t,r),this.preparePois(e,t);this.createTextElements(e,t,e=>!!(i.isPoiTechnique(e)||i.isLineMarkerTechnique(e)||i.isTextTechnique(e))&&r(e)),this.createLabelRejectionElements(e,t),e.dataSource.addGroundPlane&&e.projection.type===o.ProjectionType.Planar&&T.instance.addGroundPlane(e,-p.FALLBACK_RENDER_ORDER_OFFSET/2)}createLabelRejectionElements(e,t){if(void 0!==t.pathGeometries)for(const r of t.pathGeometries)e.addBlockingElement(new f.PathBlockingElement(r.path))}processTechniques(e,t,r){if(void 0!==e){for(const t of e.techniques)void 0===t.kind&&_.TileGeometryLoader.setDefaultGeometryKind(t);this.initDecodedTile(e,t,r)}}registerTileObject(e,t,r){void 0===t.userData&&(t.userData={});const i=t.userData;i.tileKey=e.tileKey,i.dataSource=e.dataSource.name,i.kind=r instanceof Set?Array.from(r.values()):Array.isArray(r)?r:[r],e.resetVisibilityCounter()}prepareTextPaths(e,t,r){const n=new Array,o=e.slice();for(;o.length>0;){const e=o.pop();if(void 0===e)break;const a=t.techniques[e.technique];i.isTextTechnique(a)&&(void 0===r||r(a))&&n.push(e)}return n}createTextElements(e,t,r){const n=e.mapView,o=Math.floor(n.zoomLevel);if(void 0!==t.textPathGeometries){const a=this.prepareTextPaths(t.textPathGeometries,t,r);let c=0;for(const e of a){const r=t.techniques[e.technique];!1!==r.enabled&&i.isTextTechnique(r)&&(e.pathLengthSqr>c&&(c=e.pathLengthSqr))}for(const u of a){const a=t.techniques[u.technique];if(!1===a.enabled||!i.isTextTechnique(a)||void 0!==r&&!r(a))continue;const d=[];for(let e=0;e<u.path.length;e+=3)d.push(new l.Vector3(u.path[e],u.path[e+1],u.path[e+2]));const h=(void 0!==a.priority?i.getPropertyValue(a.priority,o):0)+(c>0?S*u.pathLengthSqr/c:0),m=void 0!==a.fadeNear?i.getPropertyValue(a.fadeNear,o):a.fadeNear,p=void 0!==a.fadeFar?i.getPropertyValue(a.fadeFar,o):a.fadeFar,f=new g.TextElement(s.ContextualArabicConverter.instance.convert(u.text),d,this.getRenderStyle(e,a),this.getLayoutStyle(e,a),h,void 0!==a.xOffset?a.xOffset:0,void 0!==a.yOffset?a.yOffset:0,u.featureId,a.style,m,p);f.minZoomLevel=void 0!==a.minZoomLevel?a.minZoomLevel:n.minZoomLevel,f.maxZoomLevel=void 0!==a.maxZoomLevel?a.maxZoomLevel:n.maxZoomLevel,f.distanceScale=void 0!==a.distanceScale?a.distanceScale:y.DEFAULT_TEXT_DISTANCE_SCALE,f.mayOverlap=!0===a.mayOverlap,f.reserveSpace=!1!==a.reserveSpace,f.kind=a.kind,f.userData=u.objInfos,e.addTextElement(f)}}if(void 0!==t.textGeometries)for(const a of t.textGeometries){if(void 0===a.technique||void 0===a.stringCatalog)continue;const c=t.techniques[a.technique];if(!1===c.enabled||!i.isTextTechnique(c)||void 0!==r&&!r(c))continue;const u=new l.BufferAttribute(new Float32Array(a.positions.buffer),a.positions.itemCount),d=u.count;if(d<1)continue;const h=void 0!==c.priority?i.getPropertyValue(c.priority,o):0,m=void 0!==c.fadeNear?i.getPropertyValue(c.fadeNear,o):c.fadeNear,p=void 0!==c.fadeFar?i.getPropertyValue(c.fadeFar,o):c.fadeFar;for(let t=0;t<d;++t){const r=u.getX(t),i=u.getY(t),o=u.getZ(t),d=a.stringCatalog[a.texts[t]];if(void 0===d)continue;const f=new g.TextElement(s.ContextualArabicConverter.instance.convert(d),new l.Vector3(r,i,o),this.getRenderStyle(e,c),this.getLayoutStyle(e,c),h,c.xOffset||0,c.yOffset||0,a.featureId,c.style);f.minZoomLevel=void 0!==c.minZoomLevel?c.minZoomLevel:n.minZoomLevel,f.maxZoomLevel=void 0!==c.maxZoomLevel?c.maxZoomLevel:n.maxZoomLevel,f.mayOverlap=!0===c.mayOverlap,f.reserveSpace=!1!==c.reserveSpace,f.kind=c.kind,f.fadeNear=m,f.fadeFar=p,void 0!==a.objInfos&&(f.userData=a.objInfos[t]),f.isPointLabel=!0,e.addTextElement(f)}}}createObjects(e,t,r){const n=[],s=e.mapView,p=e.dataSource,f=Math.floor(s.zoomLevel),g=e.objects,y=s.viewRanges;for(const v of t.geometries){const _=v.groups,b=_.length;for(let S=0;S<b;){const T=_[S++],E=T.start,w=T.technique,C=t.techniques[w];if(-1!==T.createdOffsets.indexOf(e.offset)||!1===C.enabled||void 0!==r&&!r(C))continue;let x=T.count;for(T.createdOffsets.push(e.offset);S<b&&_[S].technique===w&&E+x===_[S].start;++S)x+=_[S].count,_[S].createdOffsets.push(e.offset);const O=h.getObjectConstructor(C);if(void 0===O)continue;let A=n[w];if(void 0===A){const t=t=>{p.requestUpdate(),void 0!==t&&e.addOwnedTexture(t)};if(void 0===(A=h.createMaterial({technique:C,level:f,fog:null!==s.scene.fog},t)))continue;n[w]=A}i.isTerrainTechnique(C)&&this.setupTerrainMaterial(C,A,e.mapView.clearColor);const P=new l.BufferGeometry;if(v.vertexAttributes.forEach(e=>{const t=h.getBufferAttribute(e);P.setAttribute(e.name,t)}),void 0!==v.interleavedVertexAttributes&&v.interleavedVertexAttributes.forEach(e=>{const t=i.getArrayConstructor(e.type),r=new l.InterleavedBuffer(new t(e.buffer),e.stride);e.attributes.forEach(e=>{const t=new l.InterleavedBufferAttribute(r,e.itemSize,e.offset,!1);P.setAttribute(e.name,t)})}),v.index&&P.setIndex(h.getBufferAttribute(v.index)),!P.getAttribute("normal")&&i.needsVertexNormals(C)&&P.computeVertexNormals(),P.addGroup(E,x),i.isSolidLineTechnique(C)||i.isDashedLineTechnique(C)){const t=A;if(t.uniforms.opacity.value=A.opacity,!1!==C.clipping&&e.projection.type===o.ProjectionType.Planar){const r=t.uniforms.tileSize,i=new l.Vector3;e.boundingBox.getSize(i),r.value.x=i.x,r.value.y=i.y,t.defines.TILE_CLIP=1}P.getAttribute("color")&&(t.defines.USE_COLOR=1),void 0!==C.caps&&a.LineCapsDefinitions.hasOwnProperty(C.caps)&&(t.defines[a.LineCapsDefinitions[C.caps]]=1)}const R=i.isSolidLineTechnique(C)&&void 0!==C.secondaryWidth,I=new O(P,A);if(I.renderOrder=C.renderOrder,void 0!==T.renderOrderOffset&&(I.renderOrder+=T.renderOrderOffset),void 0!==v.uuid&&(I.userData.geometryId=v.uuid),i.isFillTechnique(C)&&s.projection.type===o.ProjectionType.Planar&&(I.onBeforeRender=c.chainCallbacks(I.onBeforeRender,(t,r,i,n,o,a)=>{null===o.clippingPlanes&&(o.clippingPlanes=this.clippingPlanes);const c=s.projection.worldExtent(0,0).max.x*e.offset,l=s.zoomLevel<=2?1.01:1.001,u=o.clippingPlanes,d=e.center.x-s.worldCenter.x+e.boundingBox.extents.x*l+c;u[0].constant=d;const h=e.center.x-s.worldCenter.x-e.boundingBox.extents.x*l+c;u[1].constant=-h;const m=e.center.y-s.worldCenter.y+e.boundingBox.extents.y*l;u[2].constant=m;const p=e.center.y-s.worldCenter.y-e.boundingBox.extents.y*l;u[3].constant=-p})),(i.isCirclesTechnique(C)||i.isSquaresTechnique(C))&&void 0!==C.enablePicking&&(I.enableRayTesting=C.enablePicking),i.isLineTechnique(C)||i.isSegmentsTechnique(C)&&void 0!==C.color&&i.isInterpolatedProperty(C.color)){const e=this.getFadingParams(f,C);a.FadingFeature.addRenderHelper(I,y,e.fadeNear,e.fadeFar,!1,!1,(e,t)=>{t.color.set(i.getPropertyValue(C.color,s.zoomLevel))})}if(i.isSolidLineTechnique(C)||i.isDashedLineTechnique(C)){const e=this.getFadingParams(f,C);a.FadingFeature.addRenderHelper(I,y,e.fadeNear,e.fadeFar,!0,!1,(e,t)=>{const r=t,n="Pixel"===C.metricUnit?s.pixelToWorld:1;if(void 0!==C.color&&r.color.set(i.getPropertyValue(C.color,s.zoomLevel)),r.lineWidth=i.getPropertyValue(C.lineWidth,s.zoomLevel,s.pixelToWorld)*n*.5,void 0!==C.outlineWidth&&(r.outlineWidth=i.getPropertyValue(C.outlineWidth,s.zoomLevel,s.pixelToWorld)*n),i.isDashedLineTechnique(C)){const e=r;void 0!==C.dashSize&&(e.dashSize=i.getPropertyValue(C.dashSize,s.zoomLevel,s.pixelToWorld)*n*.5),void 0!==C.gapSize&&(e.gapSize=i.getPropertyValue(C.gapSize,s.zoomLevel,s.pixelToWorld)*n*.5)}})}if(i.isExtrudedLineTechnique(C)&&(void 0!==C.fadeFar||i.isInterpolatedProperty(C.color))){const e=this.getFadingParams(f,C);a.FadingFeature.addRenderHelper(I,y,e.fadeNear,e.fadeFar,!0,!0,void 0!==C.color&&i.isInterpolatedProperty(C.color)?(e,t)=>{t.color.set(i.getPropertyValue(C.color,s.zoomLevel))}:void 0)}if(this.addFeatureData(v,C,I),this.addGeometryObjInfos(e,v,C,I),i.isExtrudedPolygonTechnique(C)||i.isFillTechnique(C)){const e=void 0!==C.color&&i.isInterpolatedProperty(C.color)||i.isExtrudedPolygonTechnique(C)&&i.isInterpolatedProperty(C.emissive);if(void 0!==C.fadeFar||e){const t=this.getFadingParams(f,C);a.FadingFeature.addRenderHelper(I,y,t.fadeNear,t.fadeFar,!0,!0,e?(e,t)=>{if(t.color.set(i.getPropertyValue(C.color,s.zoomLevel)),i.isExtrudedPolygonTechnique(C)&&void 0!==C.emissive){t.emissive.set(i.getPropertyValue(C.emissive,s.zoomLevel))}}:void 0)}}const D=[],L=s.animatedExtrusionHandler;let M=!1;if(i.isExtrudedPolygonTechnique(C)&&void 0!==L){let e=C.animateExtrusion;void 0!==e&&(e="boolean"==typeof e?e:"number"==typeof e&&0!==e),M=void 0!==e&&!1===L.forceEnabled?e:L.enabled}if(i.isExtrudedPolygonTechnique(C)&&m.isRenderDepthPrePassEnabled(C)){const t=m.createDepthPrePassMesh(I);this.registerTileObject(e,t,C.kind),g.push(t),M&&D.push({object:t,materialFeature:!0}),m.setDepthPrePassStencil(t,I)}if(this.registerTileObject(e,I,C.kind),g.push(I),i.isExtrudedPolygonTechnique(C)&&void 0!==v.edgeIndex){const t=new l.BufferGeometry;t.setAttribute("position",P.getAttribute("position"));const r=P.getAttribute("color");void 0!==r&&t.setAttribute("color",r);const n=P.getAttribute("extrusionAxis");void 0!==n&&t.setAttribute("extrusionAxis",n);const o=P.getAttribute("normal");void 0!==o&&t.setAttribute("normal",o);const c=P.getAttribute("uv");void 0!==c&&t.setAttribute("uv",c),t.setIndex(h.getBufferAttribute(v.edgeIndex));const u=C,d=this.getPolygonFadingParams(f,u),m={color:d.color,colorMix:d.colorMix,fadeNear:d.lineFadeNear,fadeFar:d.lineFadeFar},p=new a.EdgeMaterial(m),_=new l.LineSegments(t,p);_.renderOrder=I.renderOrder+.1,a.FadingFeature.addRenderHelper(_,y,d.lineFadeNear,d.lineFadeFar,!1,!1,void 0!==u.lineColor&&i.isInterpolatedProperty(u.lineColor)?(e,t)=>{p.color.set(i.getPropertyValue(u.lineColor,s.zoomLevel))}:void 0),M&&D.push({object:_,materialFeature:!1}),this.registerTileObject(e,_,C.kind),g.push(_)}if(i.isExtrudedPolygonTechnique(C)&&M){D.push({object:I,materialFeature:!0});const t=void 0!==C.animateExtrusionDuration&&!1===L.forceEnabled?C.animateExtrusionDuration:L.duration;e.animatedExtrusionTileHandler=new u.AnimatedExtrusionTileHandler(e,D,t),s.animatedExtrusionHandler.add(e.animatedExtrusionTileHandler)}if(i.isFillTechnique(C)&&void 0!==v.edgeIndex){const t=new l.BufferGeometry;t.setAttribute("position",P.getAttribute("position")),t.setIndex(h.getBufferAttribute(v.edgeIndex));const r=C,n=this.getPolygonFadingParams(f,r),o={color:n.color,colorMix:n.colorMix,fadeNear:n.lineFadeNear,fadeFar:n.lineFadeFar},c=new a.EdgeMaterial(o),u=new l.LineSegments(t,c);u.renderOrder=I.renderOrder+.1,a.FadingFeature.addRenderHelper(u,y,n.lineFadeNear,n.lineFadeFar,!0,!1,void 0!==r.lineColor&&i.isInterpolatedProperty(r.lineColor)?(e,t)=>{t.color.set(i.getPropertyValue(r.lineColor,s.zoomLevel))}:void 0),this.registerTileObject(e,u,C.kind),g.push(u)}if(R){const t=C,r=A.clone(),n=d.ColorCache.instance.getColor(void 0!==t.secondaryColor?i.getPropertyValue(t.secondaryColor,f):"0x000000");r.uniforms.diffuse.value=n;const o=new O(P,r);o.renderOrder=void 0!==t.secondaryRenderOrder?t.secondaryRenderOrder:C.renderOrder-1e-7,void 0!==T.renderOrderOffset&&(o.renderOrder+=T.renderOrderOffset);const c=this.getFadingParams(f,C);a.FadingFeature.addRenderHelper(o,y,c.fadeNear,c.fadeFar,!0,!1,(e,r)=>{const n=r,o="Pixel"===t.metricUnit?s.pixelToWorld:1;void 0!==t.secondaryColor&&n.color.set(i.getPropertyValue(t.secondaryColor,s.zoomLevel)),void 0!==t.secondaryWidth&&(n.lineWidth=i.getPropertyValue(t.secondaryWidth,s.zoomLevel,s.pixelToWorld)*o*.5)}),this.registerTileObject(e,o,C.kind),g.push(o)}}}}preparePois(e,t){void 0!==t.poiGeometries&&e.mapView.poiManager.addPois(e,t)}getRenderStyle(e,t){const r=e.mapView,n=e.dataSource,o=r.zoomLevel,a=v.computeStyleCacheId(n.name,t,Math.floor(o));let l=r.textRenderStyleCache.get(a);if(void 0===l){const e=void 0!==r.textElementsRenderer?r.textElementsRenderer.defaultStyle.renderParams:{fontSize:{unit:s.FontUnit.Pixel,size:32,backgroundSize:8}};if(void 0!==t.color){const e=i.getPropertyValue(t.color,Math.floor(o));T.m_colorMap.set(a,d.ColorCache.instance.getColor(e))}if(void 0!==t.backgroundColor){const e=i.getPropertyValue(t.backgroundColor,Math.floor(o));T.m_colorMap.set(a+"_bg",d.ColorCache.instance.getColor(e))}const n={fontName:c.getOptionValue(t.fontName,e.fontName),fontSize:{unit:s.FontUnit.Pixel,size:void 0!==t.size?i.getPropertyValue(t.size,Math.floor(o)):e.fontSize.size,backgroundSize:void 0!==t.backgroundSize?i.getPropertyValue(t.backgroundSize,Math.floor(o)):e.fontSize.backgroundSize},fontStyle:"Regular"===t.fontStyle||"Bold"===t.fontStyle||"Italic"===t.fontStyle||"BoldItalic"===t.fontStyle?s.FontStyle[t.fontStyle]:e.fontStyle,fontVariant:"Regular"===t.fontVariant||"AllCaps"===t.fontVariant||"SmallCaps"===t.fontVariant?s.FontVariant[t.fontVariant]:e.fontVariant,rotation:c.getOptionValue(t.rotation,e.rotation),color:c.getOptionValue(T.m_colorMap.get(a),e.color),backgroundColor:c.getOptionValue(T.m_colorMap.get(a+"_bg"),e.backgroundColor),opacity:void 0!==t.opacity?i.getPropertyValue(t.opacity,Math.floor(o)):e.opacity,backgroundOpacity:void 0!==t.backgroundOpacity?i.getPropertyValue(t.backgroundOpacity,Math.floor(o)):void 0!==t.backgroundColor&&void 0!==t.backgroundSize&&i.getPropertyValue(t.backgroundSize,Math.floor(o))>0?1:e.backgroundOpacity},u=void 0!==r.textElementsRenderer?r.textElementsRenderer.getTextElementStyle(t.style).renderParams:{};l=new s.TextRenderStyle(Object.assign(Object.assign({},u),n)),r.textRenderStyleCache.set(a,l)}return l}getLayoutStyle(e,t){const r=e.mapView,i=e.dataSource,n=r.zoomLevel,o=v.computeStyleCacheId(i.name,t,Math.floor(n));let a=r.textLayoutStyleCache.get(o);if(void 0===a){const e=void 0!==r.textElementsRenderer?r.textElementsRenderer.defaultStyle.layoutParams:{},i={tracking:c.getOptionValue(t.tracking,e.tracking),leading:c.getOptionValue(t.leading,e.leading),maxLines:c.getOptionValue(t.maxLines,e.maxLines),lineWidth:c.getOptionValue(t.lineWidth,e.lineWidth),canvasRotation:c.getOptionValue(t.canvasRotation,e.canvasRotation),lineRotation:c.getOptionValue(t.lineRotation,e.lineRotation),wrappingMode:"None"===t.wrappingMode||"Character"===t.wrappingMode||"Word"===t.wrappingMode?s.WrappingMode[t.wrappingMode]:e.wrappingMode,horizontalAlignment:"Left"===t.hAlignment||"Center"===t.hAlignment||"Right"===t.hAlignment?s.HorizontalAlignment[t.hAlignment]:e.horizontalAlignment,verticalAlignment:"Above"===t.vAlignment||"Center"===t.vAlignment||"Below"===t.vAlignment?s.VerticalAlignment[t.vAlignment]:e.verticalAlignment},n=void 0!==r.textElementsRenderer?r.textElementsRenderer.getTextElementStyle(t.style).layoutParams:{};a=new s.TextLayoutStyle(Object.assign(Object.assign({},n),i)),r.textLayoutStyleCache.set(o,a)}return a}addGroundPlane(e,t){const r=e.mapView,s=e.dataSource,c=e.projection,u=r.clearColor,d=new l.Vector3;if(e.projection.type===o.ProjectionType.Spherical){const{east:r,west:h,north:m,south:p}=e.geoBox,f=s.getTilingScheme().projection,g=new l.BufferGeometry,y=new l.BufferAttribute(new Float32Array([...f.projectPoint(new o.GeoCoordinates(p,h),d).toArray(),...f.projectPoint(new o.GeoCoordinates(p,r),d).toArray(),...f.projectPoint(new o.GeoCoordinates(m,h),d).toArray(),...f.projectPoint(new o.GeoCoordinates(m,r),d).toArray()]),3);g.setAttribute("position",y),g.setIndex(new l.BufferAttribute(new Uint16Array([0,1,2,2,1,3]),1)),new n.SphericalGeometrySubdivisionModifier(l.Math.degToRad(10),f).modify(g);for(let t=0;t<y.array.length;t+=3)d.set(y.array[t],y.array[t+1],y.array[t+2]),c.reprojectPoint(f,d,d),d.sub(e.center),y.array[t]=d.x,y.array[t+1]=d.y,y.array[t+2]=d.z;y.needsUpdate=!0;const v=new a.MapMeshBasicMaterial({color:u,visible:!0,depthWrite:!0}),_=new l.Mesh(g,v);_.renderOrder=t,this.registerTileObject(e,_,i.GeometryKind.Background),e.objects.push(_)}else{e.boundingBox.getSize(d);const r=this.createPlane(d.x,d.y,e.center,u,!0,t);this.registerTileObject(e,r,i.GeometryKind.Background),e.objects.push(r)}}setupTerrainMaterial(e,t,r){if(void 0!==e.displacementMap)t.onBeforeCompile=e=>{e.fragmentShader=e.fragmentShader.replace("#include <map_pars_fragment>","#include <map_pars_fragment>\n    uniform sampler2D displacementMap;\n    uniform float displacementScale;\n    uniform float displacementBias;"),e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>",`#ifdef USE_MAP\n    float minElevation = ${o.EarthConstants.MIN_ELEVATION.toFixed(1)};\n    float maxElevation = ${o.EarthConstants.MAX_ELEVATION.toFixed(1)};\n    float elevationRange = maxElevation - minElevation;\n\n    float disp = texture2D( displacementMap, vUv ).x * displacementScale + displacementBias;\n    vec4 texelColor = texture2D( map, vec2((disp - minElevation) / elevationRange, 0.0) );\n    texelColor = mapTexelToLinear( texelColor );\n    diffuseColor *= texelColor;\n#endif`),e.vertexShader=e.vertexShader.replace("#include <displacementmap_vertex>","")},t.displacementMap.needsUpdate=!0;else{t.color.set(r)}}createPlane(e,t,r,i,n,o){const s=new l.PlaneGeometry(e,t,1),c=new a.MapMeshBasicMaterial({color:i,visible:n,depthWrite:!1}),u=new l.Mesh(s,c);return u.position.copy(r),u.renderOrder=o,u}addFeatureData(e,t,r){if((void 0!==e.featureIds&&e.featureIds.length>0||i.isCirclesTechnique(t)||i.isSquaresTechnique(t))&&!i.isSolidLineTechnique(t)&&!i.isDashedLineTechnique(t)){const t={geometryType:e.type,ids:e.featureIds,starts:e.featureStarts};r.userData.feature=t,void 0!==e.objInfos&&(r.userData.feature.objInfos=e.objInfos)}}addGeometryObjInfos(e,t,r,n){if(!(void 0===t.objInfos||Object.keys(n.userData).length>0))if(i.isTerrainTechnique(r)){const r=t.objInfos[0],i={tileKey:e.tileKey,texture:new l.DataTexture(r.buffer,r.xCountVertices,r.yCountVertices,l.LuminanceFormat,l.FloatType),displacementMap:r};n.userData=i}else n.userData=t.objInfos}getFadingParams(e,t){return{fadeNear:void 0!==t.fadeNear?i.getPropertyValue(t.fadeNear,e):a.FadingFeature.DEFAULT_FADE_NEAR,fadeFar:void 0!==t.fadeFar?i.getPropertyValue(t.fadeFar,e):a.FadingFeature.DEFAULT_FADE_FAR}}getPolygonFadingParams(e,t){let r,n=a.EdgeMaterial.DEFAULT_COLOR_MIX;if(void 0!==t.lineColor&&(r=i.getPropertyValue(t.lineColor,e),i.isExtrudedPolygonTechnique(t))){const e=t;n=void 0!==e.lineColorMix?e.lineColorMix:a.EdgeMaterial.DEFAULT_COLOR_MIX}const o=void 0!==t.fadeNear?i.getPropertyValue(t.fadeNear,e):a.FadingFeature.DEFAULT_FADE_NEAR,s=void 0!==t.fadeFar?i.getPropertyValue(t.fadeFar,e):a.FadingFeature.DEFAULT_FADE_FAR,c=void 0!==t.lineFadeNear?i.getPropertyValue(t.lineFadeNear,e):o,l=void 0!==t.lineFadeFar?i.getPropertyValue(t.lineFadeFar,e):s;return void 0===r&&(r=a.EdgeMaterial.DEFAULT_COLOR),{color:r,colorMix:n,fadeNear:o,fadeFar:s,lineFadeNear:c,lineFadeFar:l}}}t.TileGeometryCreator=T,T.m_colorMap=new Map},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(45),o=r(1),a=r(357),s=r(93);!function(e){e[e.Requested=0]="Requested",e[e.Loaded=1]="Loaded",e[e.Initialized=2]="Initialized"}(t.LoadingState||(t.LoadingState={}));t.TextElement=class{constructor(e,t,r,i,o=0,s,c,l,u,d,h){this.text=e,this.points=t,this.renderParams=r,this.layoutParams=i,this.priority=o,this.xOffset=s,this.yOffset=c,this.featureId=l,this.style=u,this.fadeNear=d,this.fadeFar=h,this.visible=!0,this.distanceScale=.5,this.renderOrder=0,this.sortPriority=0,r instanceof n.TextRenderStyle&&(this.renderStyle=r),i instanceof n.TextLayoutStyle&&(this.layoutStyle=i),this.m_renderState=new a.TextElementState}get position(){if(this.points instanceof Array){return this.points[0]}return this.points}get path(){if(this.points instanceof Array)return this.points}get textMayOverlap(){return!0===this.mayOverlap}set textMayOverlap(e){this.mayOverlap=e}get textReservesSpace(){return!1!==this.reserveSpace}set textReservesSpace(e){this.reserveSpace=e}get isLineMarker(){return void 0!==this.points&&void 0!==this.m_poiInfo&&i.isLineMarkerTechnique(this.m_poiInfo.technique)}get isPathLabel(){return void 0!==this.path&&!this.isLineMarker}get isPoiLabel(){return void 0===this.path}get type(){return this.isPoiLabel?s.TextElementType.PoiLabel:this.isLineMarker?s.TextElementType.LineMarker:s.TextElementType.PathLabel}get renderState(){return this.m_renderState}get renderDistance(){return!0===this.alwaysOnTop?0:void 0!==this.m_renderState.viewDistance?-this.m_renderState.viewDistance:0}get poiInfo(){return this.m_poiInfo}set poiInfo(e){if(this.m_poiInfo=e,void 0!==e){const t=void 0!==this.renderOrder?this.renderOrder:0;e.renderOrder=t}}updateMinMaxZoomLevelsFromPoiInfo(){void 0!==this.poiInfo&&(void 0===this.minZoomLevel&&(this.minZoomLevel=o.MathUtils.min2(this.poiInfo.iconMinZoomLevel,this.poiInfo.textMinZoomLevel)),void 0===this.maxZoomLevel&&(this.maxZoomLevel=o.MathUtils.max2(this.poiInfo.iconMaxZoomLevel,this.poiInfo.textMaxZoomLevel)))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(4),n=r(45),o=r(1),a=r(0),s=r(34),c=r(155),l=r(66),u=r(358),d=r(154),h=r(361),m=r(64),p=r(93),f=r(47),g="default",y="default",v=1/0,_=1024,b=32768,S=500;t.DEFAULT_TEXT_DISTANCE_SCALE=.5;const T=300,E=.99,w=.7,C=1.5,x=2e4,O=100,A=5,P=10,R=5,I=4,D=!1,L=o.LoggerManager.instance.create("TextElementsRenderer"),M=new a.Box2,k=[],N=new o.Math2D.Box,F=new a.Vector3,U=new a.Vector3(0,0,0),j=new a.Vector2,V=new a.Vector2;class B{constructor(e,t){this.tile=e,this.textElements=t}}class G{constructor(e,t){this.priority=e,this.textElementLists=t}count(){let e=0;for(const t of this.textElementLists)e+=t.textElements.length;return e}}t.TextElementsRenderer=class{constructor(e,t,r,i,n,o,s,c,l,u,d,h){this.m_mapView=e,this.m_screenCollisions=t,this.m_screenProjector=r,this.m_minNumGlyphs=i,this.m_maxNumGlyphs=n,this.m_theme=o,this.m_maxNumVisibleLabels=s,this.m_numSecondChanceLabels=c,this.m_labelDistanceScaleMin=l,this.m_labelDistanceScaleMax=u,this.m_maxDistanceRatioForTextLabels=d,this.m_maxDistanceRatioForPoiLabels=h,this.m_initializedTextElementCount=0,this.m_textRenderers=[],this.m_textStyles=new Map,this.m_defaultStyle={name:g,fontCatalog:y,renderParams:this.m_mapView.textRenderStyleCache.get(f.DEFAULT_TEXT_STYLE_CACHE_ID).params,layoutParams:this.m_mapView.textLayoutStyleCache.get(f.DEFAULT_TEXT_STYLE_CACHE_ID).params},this.m_lastRenderedTextElements=[],this.m_secondChanceTextElements=[],this.m_tmpVector=new a.Vector2,this.m_overloaded=!1,this.m_catalogsLoading=0,void 0===this.m_minNumGlyphs&&(this.m_minNumGlyphs=_),void 0===this.m_maxNumGlyphs&&(this.m_maxNumGlyphs=b),void 0===this.m_maxNumVisibleLabels&&(this.m_maxNumVisibleLabels=S),void 0===this.m_numSecondChanceLabels&&(this.m_numSecondChanceLabels=T),void 0===this.m_labelDistanceScaleMin&&(this.m_labelDistanceScaleMin=w),void 0===this.m_labelDistanceScaleMax&&(this.m_labelDistanceScaleMax=C),void 0===this.m_maxDistanceRatioForTextLabels&&(this.m_maxDistanceRatioForTextLabels=E),void 0===this.m_maxDistanceRatioForPoiLabels&&(this.m_maxDistanceRatioForPoiLabels=E),this.initializeDefaultAssets(),this.initializeTextCanvases()}renderText(e){const t=c.debugContext.getValue("DEBUG_GLYPHS");void 0!==t&&void 0!==this.m_debugGlyphTextureCacheMesh&&void 0!==this.m_debugGlyphTextureCacheWireMesh&&(this.m_debugGlyphTextureCacheMesh.visible=t,this.m_debugGlyphTextureCacheWireMesh.visible=t);for(const t of this.m_textRenderers)t.textCanvas.render(e)}reset(){this.m_screenCollisions.reset();for(const e of this.m_textRenderers)e.textCanvas.clear(),e.poiRenderer.reset();this.m_initializedTextElementCount=0}update(){for(const e of this.m_textRenderers)e.poiRenderer.update()}placeAllTileLabels(){this.placeAllLabels()}movementStarted(){}movementFinished(){this.placeAllLabels()}get defaultStyle(){return this.m_defaultStyle}get overloaded(){return this.m_overloaded}renderUserTextElements(e,t){const r=this.m_mapView.visibleTileSet.dataSourceTileList,i=this.m_mapView.zoomLevel;r.forEach(r=>{for(const n of r.visibleTiles){for(const e of n.userTextElements)e.tileCenter=n.center,this.updateViewDistance(this.m_mapView.worldCenter,e);this.renderTextElements(n.userTextElements,e,t,i)}})}renderAllTileText(e,t){const r=this.m_mapView.visibleTileSet.dataSourceTileList,i=this.m_mapView.zoomLevel;this.checkIfOverloaded();const n=this.overloaded&&this.m_mapView.isDynamicFrame?o.PerformanceTimer.now():void 0;r.forEach(r=>{this.renderTileList(r.renderedTiles,e,t,i,n)})}renderOverlay(e){void 0!==e&&0!==e.length&&this.renderOverlayTextElements(e)}pickTextElements(e,t){const r=(r,i)=>{const n=r;if(void 0===n)return;let o=!1;if(void 0!==n.featureId&&!(o=t.some(e=>void 0!==e&&i===e.type&&(void 0!==e.featureId&&e.featureId===n.featureId||void 0!==e.userData&&e.userData===n.userData)))){const r={type:i,point:e,distance:0,featureId:n.featureId,userData:n.userData,text:n.text};t.push(r)}};for(const t of this.m_textRenderers)t.textCanvas.pickText(e,e=>{r(e,l.PickObjectType.Text)}),t.poiRenderer.pickTextElements(e,e=>{r(e,l.PickObjectType.Icon)})}getTextElementStyle(e){let t;return void 0===e?t=this.m_defaultStyle:void 0===(t=this.m_textStyles.get(e))&&(t=this.m_defaultStyle),t}get ready(){return 0===this.m_catalogsLoading&&this.m_textRenderers.length>0}get loading(){let e=this.m_catalogsLoading>0;for(const t of this.m_textRenderers)e=e||t.textCanvas.fontCatalog.isLoading;return e}clearRenderStates(){this.m_mapView.visibleTileSet.dataSourceTileList.forEach(e=>{for(const t of e.visibleTiles)t.userTextElements.forEach(e=>{e.renderState.clear()}),t.textElementGroups.forEach(e=>{e.renderState.clear()})})}getMemoryUsage(){const e={heapSize:0,gpuSize:0};for(const t of this.m_textRenderers)t.textCanvas.getMemoryUsage(e),t.poiRenderer.getMemoryUsage(e);return e}prepopulateScreenWithBlockingElements(){const e=this.m_mapView.visibleTileSet.dataSourceTileList,t=[];e.forEach(e=>{const r=new a.Vector3,i=new a.Vector3;for(const n of e.visibleTiles)for(const e of n.blockingElements)if(!(e.points.length<2)){this.m_screenProjector.project3(e.points[0],r);for(let n=1;n<e.points.length;n++){this.m_screenProjector.project3(e.points[n],i);const o=e.screenSpaceLines[n-1];o.start.copy(r),o.end.copy(i);const a={minX:Math.min(r.x,i.x),maxX:Math.max(r.x,i.x),minY:Math.min(r.y,i.y),maxY:Math.max(r.y,i.y),type:"line",line:o};t.push(a),r.copy(i)}}}),this.m_screenCollisions.allocateIBoxes(t)}renderTextElements(e,t,r,i,o,s){if(0===this.m_textRenderers.length)return 0;const c=e.length>5e3,l={cameraIsMoving:this.m_mapView.cameraIsMoving,maxVisibilityDist:this.m_mapView.viewRanges.maximum,zoomLevel:i,frameNumber:r,time:t},u={numNotVisible:0,numPathTooSmall:0,numCannotAdd:0,numRenderedPoiIcons:0,numRenderedPoiTexts:0,numPoiTextsInvisible:0,numRenderedTextElements:0,fadeAnimationRunning:!1},d=this.m_maxNumVisibleLabels,h=[],p={additionParams:{},poiMeasurementParams:{},measurementParams:{},bufferAdditionParams:{}},f=this.m_mapView.tileGeometryManager,g=void 0!==f?f.hiddenGeometryKinds:void 0;for(const t of e){if(d>=0&&u.numRenderedTextElements>=d)break;const e=this.getTextElementStyle(t.style),r=e.textCanvas,i=e.poiRenderer;if(void 0===r||void 0===i)continue;if(void 0!==g&&void 0!==t.kind&&g.hasOrIntersects(t.kind))continue;const c=t.isPathLabel;let f;if(c){const e=this.checkForSmallLabels(t);if(void 0===e){u.numNotVisible++,!0===t.dbgPathTooSmall&&u.numPathTooSmall++;continue}f=e}if(void 0===t.loadingState&&(t.loadingState=m.LoadingState.Requested,void 0===t.renderStyle&&(t.renderStyle=new n.TextRenderStyle(Object.assign(Object.assign({},e.renderParams),t.renderParams))),void 0===t.layoutStyle&&(t.layoutStyle=new n.TextLayoutStyle(Object.assign(Object.assign({},e.layoutParams),t.layoutParams))),""===t.text?t.loadingState=m.LoadingState.Loaded:r.fontCatalog.loadCharset(t.text,t.renderStyle).then(()=>{t.loadingState=m.LoadingState.Loaded,this.m_mapView.update()})),t.loadingState===m.LoadingState.Loaded&&this.m_initializedTextElementCount<v&&(r.textRenderStyle=t.renderStyle,r.textLayoutStyle=t.layoutStyle,t.glyphCaseArray=[],t.glyphs=r.fontCatalog.getGlyphs(t.text,r.textRenderStyle,t.glyphCaseArray),c||(t.bounds=new a.Box2,p.poiMeasurementParams.letterCaseArray=t.glyphCaseArray,r.measureText(t.glyphs,t.bounds,p.poiMeasurementParams)),t.loadingState=m.LoadingState.Initialized,++this.m_initializedTextElementCount),t.loadingState!==m.LoadingState.Initialized)continue;const y=r.getLayer(t.renderOrder||n.DEFAULT_TEXT_CANVAS_LAYER);void 0!==y&&y.storage.drawCount+t.glyphs.length>y.storage.capacity?++u.numCannotAdd:(r.textRenderStyle=t.renderStyle,r.textLayoutStyle=t.layoutStyle,t.isPoiLabel?this.addPoiLabel(t,i,r,u,l,p,o,s):t.isLineMarker?this.addLineMarkerLabel(t,i,h,r,u,l,p,o,s):c&&this.addPathLabel(t,f,i,r,u,l,p,o,s))}return D&&c&&(L.log("textElements.length",e.length),L.log("numRenderedTextElements",u.numRenderedTextElements),L.log("numRenderedPoiIcons",u.numRenderedPoiIcons),L.log("numRenderedPoiTexts",u.numRenderedPoiTexts),L.log("numPoiTextsInvisible",u.numPoiTextsInvisible),L.log("numNotVisible",u.numNotVisible),L.log("numPathTooSmall",u.numPathTooSmall),L.log("numCannotAdd",u.numCannotAdd)),!this.m_mapView.disableFading&&u.fadeAnimationRunning&&this.m_mapView.update(),u.numRenderedTextElements}initializeDefaultAssets(){(void 0===this.m_theme.fontCatalogs||Array.isArray(this.m_theme.fontCatalogs)&&0===this.m_theme.fontCatalogs.length)&&(this.m_theme.fontCatalogs=[{name:y,url:this.m_mapView.defaultFontCatalog}]);const e=this.m_theme.fontCatalogs;let t;if(e.length>0){for(const r of e)if(void 0!==r.name){t=r.name;break}void 0===t&&(t=y,e[0].name=t)}void 0===this.m_theme.textStyles&&(this.m_theme.textStyles=[]);const r=this.m_theme.textStyles,i=r.find(e=>e.name===g);void 0!==i?this.m_defaultStyle=this.createTextElementStyle(i,g):void 0!==this.m_theme.defaultTextStyle?this.m_defaultStyle=this.createTextElementStyle(this.m_theme.defaultTextStyle,g):r.length>0&&(this.m_defaultStyle=this.createTextElementStyle(r[0],g)),this.m_defaultStyle.fontCatalog=t}createTextElementStyle(e,t){return{name:t,fontCatalog:o.getOptionValue(e.fontCatalogName,y),renderParams:{fontName:e.fontName,fontSize:{unit:n.FontUnit.Pixel,size:32,backgroundSize:e.backgroundSize||8},fontStyle:"Regular"===e.fontStyle||"Bold"===e.fontStyle||"Italic"===e.fontStyle||"BoldItalic"===e.fontStyle?n.FontStyle[e.fontStyle]:void 0,fontVariant:"Regular"===e.fontVariant||"AllCaps"===e.fontVariant||"SmallCaps"===e.fontVariant?n.FontVariant[e.fontVariant]:void 0,rotation:e.rotation,color:void 0!==e.color?s.ColorCache.instance.getColor(e.color):void 0,backgroundColor:void 0!==e.backgroundColor?s.ColorCache.instance.getColor(e.backgroundColor):void 0,opacity:e.opacity,backgroundOpacity:e.backgroundOpacity},layoutParams:{tracking:e.tracking,leading:e.leading,maxLines:e.maxLines,lineWidth:e.lineWidth,canvasRotation:e.canvasRotation,lineRotation:e.lineRotation,wrappingMode:"None"===e.wrappingMode||"Character"===e.wrappingMode||"Word"===e.wrappingMode?n.WrappingMode[e.wrappingMode]:n.WrappingMode.Word,verticalAlignment:"Above"===e.vAlignment||"Center"===e.vAlignment||"Below"===e.vAlignment?n.VerticalAlignment[e.vAlignment]:n.VerticalAlignment.Center,horizontalAlignment:"Left"===e.hAlignment||"Center"===e.hAlignment||"Right"===e.hAlignment?n.HorizontalAlignment[e.hAlignment]:n.HorizontalAlignment.Center}}}initializeTextCanvases(){const e=[];this.m_theme.fontCatalogs.forEach(t=>{this.m_catalogsLoading+=1;const r=n.FontCatalog.load(t.url,1024).then(e=>{const r=new n.TextCanvas({renderer:this.m_mapView.renderer,fontCatalog:e,minGlyphCount:this.m_minNumGlyphs,maxGlyphCount:this.m_maxNumGlyphs});this.m_textRenderers.push({fontCatalog:t.name,textCanvas:r,poiRenderer:new u.PoiRenderer(this.m_mapView,r)})}).catch(e=>{L.error("Failed to load FontCatalog: ",e)}).finally(()=>{this.m_catalogsLoading-=1});e.push(r)}),Promise.all(e).then(()=>{this.initializeTextElementStyles();const e=this.m_textRenderers[0].textCanvas.fontCatalog,t=new a.PlaneGeometry(e.textureSize.width/2.5,e.textureSize.height/2.5,e.textureSize.width/e.maxWidth,e.textureSize.height/e.maxHeight),r=new a.MeshBasicMaterial({transparent:!0,depthWrite:!1,depthTest:!1,map:e.texture});this.m_debugGlyphTextureCacheMesh=new a.Mesh(t,r),this.m_debugGlyphTextureCacheMesh.renderOrder=1e4,this.m_debugGlyphTextureCacheMesh.visible=!1,this.m_debugGlyphTextureCacheMesh.name="glyphDebug";const i=new a.WireframeGeometry(t),o=new a.LineBasicMaterial({transparent:!0,color:10066329,depthWrite:!1,depthTest:!1});this.m_debugGlyphTextureCacheWireMesh=new a.LineSegments(i,o),this.m_debugGlyphTextureCacheWireMesh.renderOrder=9999,this.m_debugGlyphTextureCacheWireMesh.visible=!1,this.m_debugGlyphTextureCacheWireMesh.name="glyphDebug",this.m_textRenderers[0].textCanvas.getLayer(n.DEFAULT_TEXT_CANVAS_LAYER).storage.scene.add(this.m_debugGlyphTextureCacheMesh,this.m_debugGlyphTextureCacheWireMesh),this.m_mapView.update()})}initializeTextElementStyles(){let e;this.m_textRenderers.forEach(t=>{void 0===e&&(e=t.textCanvas)});const t=new u.PoiRenderer(this.m_mapView,e);if(void 0!==this.m_defaultStyle.fontCatalog){const e=this.m_textRenderers.find(e=>e.fontCatalog===this.m_defaultStyle.fontCatalog);this.m_defaultStyle.textCanvas=void 0!==e?e.textCanvas:void 0,this.m_defaultStyle.poiRenderer=void 0!==e?e.poiRenderer:void 0}void 0===this.m_defaultStyle.textCanvas&&(void 0!==this.m_defaultStyle.fontCatalog&&L.warn(`FontCatalog '${this.m_defaultStyle.fontCatalog}' set in TextStyle '${this.m_defaultStyle.name}' not found, using default fontCatalog(${e.fontCatalog.name}).`),this.m_defaultStyle.textCanvas=e,this.m_defaultStyle.poiRenderer=t),this.m_theme.textStyles.forEach(e=>{this.m_textStyles.set(e.name,this.createTextElementStyle(e,e.name))});for(const[r,i]of this.m_textStyles)if(void 0===i.textCanvas){if(void 0!==i.fontCatalog){const e=this.m_textRenderers.find(e=>e.fontCatalog===i.fontCatalog);i.textCanvas=void 0!==e?e.textCanvas:void 0,i.poiRenderer=void 0!==e?e.poiRenderer:void 0}void 0===i.textCanvas&&(void 0!==i.fontCatalog&&L.warn(`FontCatalog '${i.fontCatalog}' set in TextStyle '${i.name}' not found, using default fontCatalog(${e.fontCatalog.name}).`),i.textCanvas=e,i.poiRenderer=t)}}updateViewDistance(e,t){let r;if(Array.isArray(t.points)&&t.points.length>1){U.copy(t.points[0]).add(t.tileCenter);const i=e.distanceTo(U);U.copy(t.points[t.points.length-1]).add(t.tileCenter);const n=e.distanceTo(U);r=Math.min(i,n)}else U.copy(t.position).add(t.tileCenter),r=e.distanceTo(U);return t.renderState.viewDistance=r,r}sortTextElements(e,t){for(const r of e)r.sortPriority=r.priority+.1-r.renderState.viewDistance/t*.1;e.sort((e,t)=>t.sortPriority-e.sortPriority)}placeAllLabels(){const e=this.m_mapView.visibleTileSet.dataSourceTileList,t=this.m_mapView.zoomLevel;this.checkIfOverloaded();const r=this.overloaded&&this.m_mapView.isDynamicFrame?o.PerformanceTimer.now():void 0;e.forEach(e=>{this.placeTextElements(e.dataSource,e.storageLevel,t,e.visibleTiles,r)}),this.m_lastRenderedTextElements.length=0,this.m_secondChanceTextElements.length=0}placeTextElements(e,t,r,i,n){const a=i;a.sort((e,t)=>e.tileKey.mortonCode()-t.tileKey.mortonCode());for(const e of a)this.prepareUserTextElements(e);const s=[];this.createSortedGroupsForSorting(e,t,a,s);const c=[];let l=0;for(const e of s)if(this.selectTextElementsToPlaceByDistance(r,e,c),void 0!==n){if(A>0){if(o.PerformanceTimer.now()-n>A)break}if((l+=e.count())>=O)break}}prepareUserTextElements(e){for(const t of e.userTextElements)t.tileCenter=e.center}createSortedGroupsForSorting(e,t,r,i){if(0===this.m_textRenderers.length||0===r.length)return;const n=[];for(const i of r)i.placedTextElements.clear(),e.shouldRenderText(t,i.tileKey)&&n.push(i);const o=(e,t)=>!(void 0===e.renderState.textRenderState||e.renderState.textRenderState.lastFrameNumber<0)&&(void 0===t.renderState.textRenderState||t.renderState.textRenderState.lastFrameNumber<0||e.renderState.textRenderState.lastFrameNumber>t.renderState.textRenderState.lastFrameNumber),a=e=>{const t=[];for(const r of e)if(!0===r.isPointLabel){const e=c.get(r.text);if(void 0!==e){const i=e.list,n=e.listIndex,a=i[n];void 0!==a&&r.position.distanceToSquared(a.position)<I&&o(r,a)&&(i[n]=void 0,c.set(r.text,{list:t,listIndex:t.length}),t.push(r))}else c.set(r.text,{list:t,listIndex:t.length}),t.push(r)}else t.push(r);return t},s=new Map,c=new Map;for(const e of n)for(const t of e.textElementGroups.groups.values()){if(0===t.elements.length)continue;const r=a(t.elements),i=s.get(t.priority);void 0===i?s.set(t.priority,new G(t.priority,[new B(e,r)])):i.textElementLists.push(new B(e,r))}if(0===s.size)return;for(const e of s){const t=e[1];i.push(t)}i.sort((e,t)=>t.priority-e.priority)}getMaxDistance(e){return this.m_mapView.viewRanges.maximum*e}selectTextElementsToPlaceByDistance(e,t,r){const n=Math.max(this.m_maxDistanceRatioForTextLabels,this.m_maxDistanceRatioForPoiLabels),s=this.getMaxDistance(n);for(const r of t.textElementLists){const t=r.tile,n=this.m_mapView.projection.worldExtent(0,0).max.x*t.offset;for(const c of r.textElements){if(void 0===c||!c.visible)continue;if(void 0!==c.poiInfo&&void 0!==c.poiInfo.poiTableName){if(!this.m_mapView.poiManager.updatePoiFromPoiTable(c))continue;c.poiInfo.poiTableName=void 0}if(!c.visible||!o.MathUtils.isClamped(e,c.minZoomLevel,c.maxZoomLevel))continue;void 0===c.tileCenter?c.tileCenter=new a.Vector3(t.center.x+n,t.center.y,t.center.z):c.tileCenter.set(t.center.x+n,t.center.y,t.center.z);const r=this.updateViewDistance(this.m_mapView.worldCenter,c);if(this.m_mapView.projection.type===i.ProjectionType.Spherical){U.copy(c.position).add(c.tileCenter),U.normalize();const e=new a.Vector3;this.m_mapView.camera.getWorldDirection(e),U.dot(e)<-.6&&void 0!==r&&r<=s&&t.placedTextElements.add(c)}else void 0!==r&&r<=s&&t.placedTextElements.add(c)}}r.push([])}renderOverlayTextElements(e){if(0===this.m_textRenderers.length)return;const t=this.m_mapView.renderer.getSize(this.m_tmpVector),r=-t.width/2,i=t.height/2,o={},s={};for(const c of e){const e=this.getTextElementStyle(c.style),l=e.textCanvas;if(void 0===l)continue;const u=l.getLayer(c.renderOrder||n.DEFAULT_TEXT_CANVAS_LAYER),d=void 0!==c.path&&!c.isLineMarker;if(void 0===c.loadingState&&(c.loadingState=m.LoadingState.Requested,void 0===c.renderStyle&&(c.renderStyle=new n.TextRenderStyle(Object.assign(Object.assign({},e.renderParams),c.renderParams))),void 0===c.layoutStyle&&(c.layoutStyle=new n.TextLayoutStyle(Object.assign(Object.assign({},e.layoutParams),c.layoutParams))),""===c.text?c.loadingState=m.LoadingState.Loaded:l.fontCatalog.loadCharset(c.text,c.renderStyle).then(()=>{c.loadingState=m.LoadingState.Loaded,this.m_mapView.update()})),c.loadingState===m.LoadingState.Loaded&&this.m_initializedTextElementCount<v&&(l.textRenderStyle=c.renderStyle,l.textLayoutStyle=c.layoutStyle,c.glyphCaseArray=[],c.glyphs=l.fontCatalog.getGlyphs(c.text,l.textRenderStyle,c.glyphCaseArray),c.loadingState=m.LoadingState.Initialized,++this.m_initializedTextElementCount),c.loadingState!==m.LoadingState.Initialized)continue;if(void 0!==u&&u.storage.drawCount+c.glyphs.length>u.storage.capacity)continue;let p;if(l.textRenderStyle=c.renderStyle,l.textLayoutStyle=c.layoutStyle,d){j.x=r,j.y=i,void 0!==c.xOffset&&(j.x+=c.xOffset),void 0!==c.yOffset&&(j.y-=c.yOffset);const e=[];for(const r of c.path){const i=j.x+r.x*t.width,n=j.y-r.y*t.height;e.push(new a.Vector2(i,n))}p=new h.SimplePath;for(let t=0;t<e.length-1;++t)p.add(new a.LineCurve(e[t],e[t+1]));o.path=p,o.pathOverflow=!0,o.layer=c.renderOrder,o.letterCaseArray=c.glyphCaseArray,o.pickingData=c.userData?c:void 0,l.addText(c.glyphs,F,o)}else j.x=r+c.position.x*t.width,j.y=i-c.position.y*t.height,void 0!==c.xOffset&&(j.x+=c.xOffset),void 0!==c.yOffset&&(j.y-=c.yOffset),F.x=j.x,F.y=j.y,F.z=0,s.position=F,o.layer=c.renderOrder,o.letterCaseArray=c.glyphCaseArray,o.pickingData=c.userData?c:void 0,l.addText(c.glyphs,F,o)}}getDistanceScalingFactor(e,t){let r=this.m_mapView.lookAtDistance/t;return r=1+(r-1)*e.distanceScale,r=Math.max(r,this.m_labelDistanceScaleMin),r=Math.min(r,this.m_labelDistanceScaleMax)}getDistanceFadingFactor(e,t){let r=1;const i=e.renderState.viewDistance;if(void 0!==i&&void 0!==e.fadeFar&&e.fadeFar>0){const n=void 0===e.fadeNear?0:e.fadeNear,o=e.fadeFar;o>n&&(r=1-a.Math.clamp((i/t-n)/(o-n),0,1))}return r}addPointLabel(e,t,r,i,a,s,c,l,u,d,h,m){const p=this.m_numSecondChanceLabels,f=this.getMaxDistance(this.m_maxDistanceRatioForPoiLabels);j.x=V.x=a.x,j.y=V.y=a.y;let g=(e.xOffset||0)*(e.layoutStyle.horizontalAlignment===n.HorizontalAlignment.Right?-1:1),y=(e.yOffset||0)*(e.layoutStyle.verticalAlignment===n.VerticalAlignment.Below?-1:1);void 0!==e.poiInfo&&(g+=e.poiInfo.computedWidth*(.5+e.layoutStyle.horizontalAlignment),y+=e.poiInfo.computedHeight*(.5+e.layoutStyle.verticalAlignment)),j.x+=g,j.y+=y,e.layoutStyle.verticalAlignment===n.VerticalAlignment.Above&&(j.y+=-e.bounds.min.y);let v=1,_=1;const b=this.m_mapView.worldCenter.distanceTo(i);if(void 0!==b){if(void 0!==e.fadeFar&&(e.fadeFar<=0||e.fadeFar*u.maxVisibilityDist<b))return!1;e.renderState.viewDistance=b,v*=_=this.getDistanceScalingFactor(e,b)}const S=this.getDistanceFadingFactor(e,u.maxVisibilityDist),T=e.poiInfo;let E=!0,w=void 0===T||o.MathUtils.isClamped(u.zoomLevel,T.iconMinZoomLevel,T.iconMaxZoomLevel);if(w&&void 0!==T&&s.prepareRender(e,u.zoomLevel)){if(!1===T.isValid)return!1;if(!s.computeScreenBox(T,V,_,this.m_screenCollisions,u.zoomLevel,N))return void 0!==m&&m.length<p&&m.push(e),t.lastFrameNumber=-1,!1;if(E=s.isSpaceAvailable(this.m_screenCollisions,N))(t.lastFrameNumber<u.frameNumber-1||t.isFadingOut()||t.isFadedOut())&&this.startFadeIn(t,u.frameNumber,u.time);else{if(!t.isVisible())return!1;!0===T.mayOverlap||t.isFadingOut()||(this.startFadeOut(t,u.frameNumber,u.time),void 0!==r&&r.isVisible()&&this.startFadeOut(r,u.frameNumber,u.time))}t.isFading()&&this.updateFading(t,u.time)}const C=(void 0===T||void 0===u.zoomLevel||o.MathUtils.isClamped(u.zoomLevel,T.iconMinZoomLevel,T.iconMaxZoomLevel))&&(!0===e.ignoreDistance||void 0===e.renderState.viewDistance||e.renderState.viewDistance<f)&&(void 0===T||!0===T.isValid||!1!==T.iconIsOptional);if(void 0!==r&&C&&""!==e.text){if(F.x=j.x,F.y=j.y,F.z=e.renderDistance,N.x=j.x+e.bounds.min.x*v,N.y=j.y+e.bounds.min.y*v,N.w=(e.bounds.max.x-e.bounds.min.x)*v,N.h=(e.bounds.max.y-e.bounds.min.y)*v,N.x-=4*v,N.y-=2*v,N.w+=8*v,N.h+=4*v,!this.m_screenCollisions.isVisible(N))return void 0!==m&&m.length<p&&m.push(e),l.numPoiTextsInvisible++,!1;const i=void 0!==e.poiInfo&&!0===e.poiInfo.textIsOptional,n=r.isFadingIn(),o=r.isFadingOut(),a=!this.m_screenCollisions.isAllocated(N);if(e.textMayOverlap||a||n||o){if(void 0===e.textBufferObject&&(e.textBufferObject=c.createTextBufferObject(e.glyphs)),!o&&e.textReservesSpace&&this.m_screenCollisions.allocate(N),(n||o||!u.cameraIsMoving||void 0===T||!0===T.renderTextDuringMovements)&&!t.isFadedOut()){let t=!1;!r.isFadingOut()&&a&&E?t=this.checkStartFadeIn(r,u.frameNumber,u.time,!0):r.isFading()&&(this.updateFading(r,u.time),t=!0),l.fadeAnimationRunning=l.fadeAnimationRunning||o||t;const i=r.opacity,n=e.renderStyle.backgroundOpacity>0&&c.textRenderStyle.fontSize.backgroundSize>0;d.bufferAdditionParams.layer=e.renderOrder,d.bufferAdditionParams.position=F,d.bufferAdditionParams.scale=v,d.bufferAdditionParams.opacity=i*S*e.renderStyle.opacity,d.bufferAdditionParams.backgroundOpacity=n?d.bufferAdditionParams.opacity*e.renderStyle.backgroundOpacity:0,d.bufferAdditionParams.pickingData=e.userData?e:void 0,c.addTextBufferObject(e.textBufferObject,d.bufferAdditionParams)}l.numRenderedPoiTexts++}else if(w&&i){if(void 0!==r&&r.isVisible()){const e=this.checkStartFadeOut(r,u.frameNumber,u.time);l.fadeAnimationRunning=l.fadeAnimationRunning||e}}else{if(w=!1,void 0!==e.poiInfo&&!t.isVisible())return void 0!==m&&m.length<p&&m.push(e),l.numPoiTextsInvisible++,!1;if(void 0!==e.poiInfo&&this.startFadeOut(t,u.frameNumber,u.time),void 0!==r&&r.isVisible()){const e=this.checkStartFadeOut(r,u.frameNumber,u.time);l.fadeAnimationRunning=l.fadeAnimationRunning||e}this.startFadeOut(t,u.frameNumber,u.time)}}if(w&&void 0!==T&&s.poiIsRenderable(T)){const e=this.checkStartFadeIn(t,u.frameNumber,u.time);l.fadeAnimationRunning=l.fadeAnimationRunning||e,s.renderPoi(T,V,this.m_screenCollisions,_,!1!==T.reserveSpace,t.opacity*S,u.zoomLevel),t.lastFrameNumber=u.frameNumber,l.numRenderedPoiIcons++}return void 0!==h&&h.push(e),l.numRenderedTextElements++,!0}addPoiLabel(e,t,r,i,n,o,a,s){F.copy(e.position).add(e.tileCenter),void 0!==this.m_screenProjector.project(F,j)&&(!1===e.renderState.initialized&&e.renderState.initialize(p.TextElementType.PoiLabel,this.m_mapView.disableFading),this.addPointLabel(e,e.renderState.iconRenderState,e.renderState.textRenderState,F,j,t,r,i,n,o,a,s))}addLineMarkerLabel(e,t,r,i,n,a,s,c,l){const u=e.poiInfo;if(void 0===e.path||0===e.path.length||!t.prepareRender(e,a.zoomLevel))return;let d;void 0!==u.shieldGroupIndex&&void 0===(d=r[u.shieldGroupIndex])&&(d=[],r[u.shieldGroupIndex]=d),!1===e.renderState.initialized&&e.renderState.initialize(p.TextElementType.LineMarker,this.m_mapView.disableFading,e.path.length);const h=u.technique,m=void 0!==h.minDistance?h.minDistance*h.minDistance:0;if(m>0&&void 0!==d)for(let r=0;r<e.path.length;r++){const u=e.path[r];if(F.copy(u).add(e.tileCenter),void 0!==this.m_screenProjector.project(F,j)){let u=!1;for(let e=0;e<d.length;e+=2){if(u=o.Math2D.distSquared(d[e],d[e+1],j.x,j.y)<m)break}u||this.addPointLabel(e,e.renderState.iconRenderStates[r],void 0,F,j,t,i,n,a,s,c,l)&&d.push(j.x,j.y)}}else for(let r=0;r<e.path.length;r++){const o=e.path[r];F.copy(o).add(e.tileCenter),void 0!==this.m_screenProjector.project(F,j)&&this.addPointLabel(e,e.renderState.iconRenderStates[r],void 0,F,j,t,i,n,a,s,c,l)}}addPathLabel(e,t,r,i,n,o,s,c,l){const u=this.getMaxDistance(this.m_maxDistanceRatioForTextLabels);if(!(!0===e.ignoreDistance||void 0===e.renderState.viewDistance||e.renderState.viewDistance<u))return!1;if(void 0!==e.fadeFar&&(e.fadeFar<=0||e.fadeFar*o.maxVisibilityDist<e.renderDistance))return!1;let m=i.textRenderStyle.fontSize.size/100,f=e.renderStyle.opacity,g=new a.Path;j.copy(t[0]);for(let e=0;e<t.length-1;++e)g.add(new h.SimpleLineCurve(t[e],t[e+1]));if(g.getPoint(.5).x-g.getPoint(.51).x>0){j.copy(t[t.length-1]),g=new a.Path;for(let e=t.length-1;e>0;--e)g.add(new h.SimpleLineCurve(t[e],t[e-1]))}this.updateViewDistance(this.m_mapView.worldCenter,e);const y=-e.renderDistance;m*=this.getDistanceScalingFactor(e,y);const v=i.textRenderStyle.fontSize.size;if(i.textRenderStyle.fontSize.size=100*m,s.measurementParams.path=g,s.measurementParams.outputCharacterBounds=k,s.measurementParams.letterCaseArray=e.glyphCaseArray,!i.measureText(e.glyphs,M,s.measurementParams))return i.textRenderStyle.fontSize.size=v,!1;for(const t of k)if(N.x=j.x+t.min.x,N.y=j.y+t.min.y,N.w=t.max.x-t.min.x,N.h=t.max.y-t.min.y,!this.m_screenCollisions.isVisible(N)||!e.textMayOverlap&&this.m_screenCollisions.isAllocated(N))return i.textRenderStyle.fontSize.size=v,!1;!1===e.renderState.initialized&&e.renderState.initialize(p.TextElementType.PathLabel,this.m_mapView.disableFading),(e.renderState.textRenderState.state===d.FadingState.Undefined||e.renderState.textRenderState.lastFrameNumber<o.frameNumber-1)&&this.startFadeIn(e.renderState.textRenderState,o.frameNumber,o.time);const _=this.checkStartFadeIn(e.renderState.textRenderState,o.frameNumber,o.time);n.fadeAnimationRunning=n.fadeAnimationRunning||_,e.renderState.textRenderState.isFading()&&(f=e.renderState.textRenderState.opacity*e.renderStyle.opacity);const b=i.textRenderStyle.opacity,S=i.textRenderStyle.backgroundOpacity,T=this.getDistanceFadingFactor(e,o.maxVisibilityDist);return i.textRenderStyle.opacity=f*T,i.textRenderStyle.backgroundOpacity=i.textRenderStyle.opacity*e.renderStyle.backgroundOpacity,F.z=e.renderDistance,s.additionParams.path=g,s.additionParams.layer=e.renderOrder,s.additionParams.letterCaseArray=e.glyphCaseArray,s.additionParams.pickingData=e.userData?e:void 0,i.addText(e.glyphs,F,s.additionParams),e.textReservesSpace&&(N.x=j.x+M.min.x,N.y=j.y+M.min.y,N.w=M.max.x-M.min.x,N.h=M.max.y-M.min.y,this.m_screenCollisions.allocate(N)),void 0!==c&&c.push(e),n.numRenderedTextElements++,i.textRenderStyle.fontSize.size=v,i.textRenderStyle.opacity=b,i.textRenderStyle.backgroundOpacity=S,!0}checkForSmallLabels(e){let t=-1;const r=[];let i=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(const s of e.path){F.copy(s).add(e.tileCenter);const c=this.m_screenProjector.project(F,j);if(void 0!==c&&(r.push(j.clone()),c.x<i&&(i=c.x),c.x>n&&(n=c.x),c.y<o&&(o=c.y),c.y>a&&(a=c.y),t<0)){const e=r.findIndex(e=>this.m_screenCollisions.screenBounds.contains(e.x,e.y));e>=0&&(t=e)}}if(-1===t)return;const s=e.text.length*R;if(!((n-i)*(n-i)+(a-o)*(a-o)<s*s))return r;e.dbgPathTooSmall=!0}renderTileList(e,t,r,i,n,a,s){if(0===this.m_textRenderers.length||0===e.size)return;const c=new o.GroupedPriorityList;for(const t of e.values())c.merge(t.placedTextElements);const l=this.m_maxNumVisibleLabels;let u=0;for(const e of c.sortedGroups){const c=e.elements;if(this.sortTextElements(c,this.m_mapView.viewRanges.maximum),(u+=this.renderTextElements(c,t,r,i,a,s))>l)break;if(void 0!==n&&P>0){if(o.PerformanceTimer.now()-n>P)return}}}checkIfOverloaded(){const e=this.m_mapView.visibleTileSet.dataSourceTileList;let t=0;return e.forEach(e=>{for(const r of e.renderedTiles.values())t+=r.textElementGroups.count(),t+=r.userTextElements.length}),this.m_overloaded=t>x,this.m_overloaded}checkStartFadeIn(e,t,r,i=!1){let n=!1;return void 0!==e&&((i||e.state===d.FadingState.Undefined||e.lastFrameNumber<t-1)&&this.startFadeIn(e,t,r),e.isFading()&&(this.updateFading(e,r),n=!0),e.lastFrameNumber=t),n}checkStartFadeOut(e,t,r,i=!0){let n=!1;return void 0!==e&&((i||e.state===d.FadingState.Undefined||e.lastFrameNumber<t-1)&&this.startFadeOut(e,t,r),e.isFading()&&(this.updateFading(e,r),n=!0),e.lastFrameNumber=t),n}startFadeIn(e,t,r){e.lastFrameNumber<t-1&&e.reset(),e.state!==d.FadingState.FadingIn&&e.state!==d.FadingState.FadedIn&&(e.state===d.FadingState.FadingOut?(e.value=1-e.value,e.startTime=r-e.value*e.fadingTime):(e.startTime=r,e.value=0,e.opacity=0),e.state=d.FadingState.FadingIn)}startFadeOut(e,t,r){e.lastFrameNumber<t-1&&e.reset(),e.state!==d.FadingState.FadingOut&&e.state!==d.FadingState.FadedOut&&(e.state===d.FadingState.FadingIn?(e.startTime=r-e.value*e.fadingTime,e.value=1-e.value):(e.startTime=r,e.value=0,e.opacity=1),e.state=d.FadingState.FadingOut)}updateFading(e,t){if(e.state!==d.FadingState.FadingIn&&e.state!==d.FadingState.FadingOut)return;0===e.startTime&&(e.startTime=t);const r=t-e.startTime,i=e.state===d.FadingState.FadingIn?0:1,n=e.state===d.FadingState.FadingIn?1:0;r>=e.fadingTime?(e.value=1,e.opacity=n,e.state=e.state===d.FadingState.FadingIn?d.FadingState.FadedIn:d.FadingState.FadedOut):(e.value=r/e.fadingTime,e.opacity=a.Math.clamp(o.MathUtils.smootherStep(i,n,e.value),0,1))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(0),o=r(92),a=r(156);var s;!function(e){e[e.Unspecified=0]="Unspecified",e[e.Point=1]="Point",e[e.Line=2]="Line",e[e.Area=3]="Area",e[e.Text=4]="Text",e[e.Icon=5]="Icon",e[e.Object3D=6]="Object3D"}(s=t.PickObjectType||(t.PickObjectType={}));t.PickHandler=class{constructor(e,t,r=!0){this.mapView=e,this.camera=t,this.enableRoadPicking=r,this.m_plane=new n.Plane(new n.Vector3(0,0,1)),r&&(this.m_roadPicker=new a.RoadPicker(e))}registerTile(e){return void 0!==this.m_roadPicker?this.m_roadPicker.registerTile(e):void 0}intersectMapObjects(e,t){const r=this.mapView.getNormalizedScreenCoordinates(e,t),o=this.mapView.raycasterFromScreenPoint(e,t),a=[];if(void 0!==this.mapView.textElementsRenderer){const{clientWidth:e,clientHeight:t}=this.mapView.canvas,i=r.x*e*.5*this.mapView.pixelRatio,o=r.y*t*.5*this.mapView.pixelRatio,s=new n.Vector2(i,o);this.mapView.textElementsRenderer.pickTextElements(s,a)}const c=o.intersectObjects(this.mapView.worldRootObject.children,!0);for(const e of c){const t={type:s.Unspecified,point:e.point,distance:e.distance,intersection:e};if(void 0===e.object.userData||void 0===e.object.userData.feature){a.push(t);continue}const r=e.object.userData.feature;if(this.addObjInfo(r,e,t),void 0!==r.ids){const e=1===r.ids.length?r.ids[0]:void 0;t.featureId=e}let n;switch(r.geometryType){case i.GeometryType.Point:case i.GeometryType.Text:n=s.Point;break;case i.GeometryType.Line:case i.GeometryType.ExtrudedLine:case i.GeometryType.SolidLine:case i.GeometryType.TextPath:n=s.Line;break;case i.GeometryType.Polygon:case i.GeometryType.ExtrudedPolygon:n=s.Area;break;case i.GeometryType.Object3D:n=s.Object3D;break;default:n=s.Unspecified}t.type=n,a.push(t)}if(this.enableRoadPicking){const e=new n.Vector3,t=this.mapView.camera.position.clone();o.setFromCamera(r,this.mapView.camera),o.ray.intersectPlane(this.m_plane,e),this.mapView.forEachVisibleTile(r=>{this.m_roadPicker.intersectRoads(r,t,e,a)})}return a.sort((e,t)=>e.distance-t.distance),a}addObjInfo(e,t,r){if(r.intersection.object instanceof o.MapViewPoints)r.userData=e.objInfos[t.index];else if(void 0!==e.objInfos&&void 0!==e.starts&&void 0!==t.faceIndex)if(e.starts.length>1){let i=0;for(const r of e.starts){if(r>3*t.faceIndex)break;i++}r.userData=e.objInfos[i-1]}else r.userData=e.objInfos[0]}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(4),n=r(1),o=r(0),a=r(48),s=r(20),c=n.LoggerManager.instance.create("Tile"),l=16,u=100;var d;t.getFeatureDataSize=function(e){let t=u;return void 0!==e.ids&&(t+=8*e.ids.length),void 0!==e.starts&&(t+=8*e.starts.length),void 0!==e.objInfos&&(t+=e.objInfos.length*l),t},function(e){e[e.Initialized=0]="Initialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.Decoding=3]="Decoding",e[e.Ready=4]="Ready",e[e.Canceled=5]="Canceled",e[e.Failed=6]="Failed"}(d=t.TileLoaderState||(t.TileLoaderState={}));t.Tile=class{constructor(e,t,r=0,o){this.dataSource=e,this.tileKey=t,this.offset=r,this.objects=[],this.dependencies=new Array,this.boundingBox=new i.OrientedBox3,this.maxGeometryHeight=0,this.frameNumLastRequested=-1,this.frameNumVisible=-1,this.frameNumLastVisible=-1,this.numFramesVisible=0,this.visibilityCounter=-1,this.levelOffset=0,this.m_disposed=!1,this.m_localTangentSpace=!1,this.m_forceHasGeometry=void 0,this.m_userTextElements=[],this.m_textElementGroups=new n.GroupedPriorityList,this.m_pathBlockingElements=[],this.m_placedTextElements=new n.GroupedPriorityList,this.m_textElementsChanged=!1,this.m_visibleArea=0,this.m_minElevation=0,this.m_maxElevation=0,this.m_ownedTextures=new WeakSet,this.m_nextTextElementToOverlay={groupIndex:0,elementIndex:0},this.geoBox=this.dataSource.getTilingScheme().getGeoBox(this.tileKey),this.projection.projectBox(this.geoBox,this.boundingBox),this.m_localTangentSpace=void 0!==o&&o}get isVisible(){return this.frameNumLastRequested>=this.dataSource.mapView.frameNumber-1}set isVisible(e){this.frameNumLastRequested=e?this.dataSource.mapView.frameNumber:-1}get projection(){return this.dataSource.projection}get mapView(){return this.dataSource.mapView}get localTangentSpace(){return this.m_localTangentSpace}get placedTextElements(){return this.m_placedTextElements}get memoryUsage(){return void 0===this.m_resourceInfo&&this.computeResourceInfo(),this.m_resourceInfo.heapSize}get center(){return this.boundingBox.position}getResourceInfo(){return void 0===this.m_resourceInfo&&this.computeResourceInfo(),this.m_resourceInfo}invalidateResourceInfo(){this.m_resourceInfo=void 0}addOwnedTexture(e){this.m_ownedTextures.add(e)}get userTextElements(){return this.m_userTextElements}addUserTextElement(e){this.m_userTextElements.push(e),this.textElementsChanged=!0}removeUserTextElement(e){const t=this.m_userTextElements.indexOf(e);return t>=0&&(this.m_userTextElements.splice(t,1),this.textElementsChanged=!0,!0)}addTextElement(e){this.textElementGroups.add(e),this.textElementsChanged=!0}addBlockingElement(e){this.m_pathBlockingElements.push(e)}removeTextElement(e){return!!this.textElementGroups.remove(e)&&(this.textElementsChanged=!0,!0)}get textElementGroups(){return this.m_textElementGroups}get textElementsChanged(){return this.m_textElementsChanged}set textElementsChanged(e){this.m_textElementsChanged=e}hasTextElements(){return this.m_textElementGroups.count()>0||this.m_userTextElements.length>0}get blockingElements(){return this.m_pathBlockingElements}prepareTileInfo(){void 0!==this.m_decodedTile&&!this.m_disposed&&this.isVisible&&void 0!==this.m_decodedTile.tileInfo&&(this.roadIntersectionData=this.dataSource.mapView.pickHandler.registerTile(this))}willRender(e){return!0}didRender(){}get visibleArea(){return this.m_visibleArea}set visibleArea(e){this.m_visibleArea=e,void 0!==this.tileLoader&&this.tileLoader.updatePriority(e)}get minElevation(){return this.m_minElevation}set minElevation(e){this.m_minElevation=e}get maxElevation(){return this.m_maxElevation}set maxElevation(e){this.m_maxElevation=e}get decodedTile(){return this.m_decodedTile}set decodedTile(e){if(this.m_decodedTile=e,this.invalidateResourceInfo(),void 0===e)return;0===e.geometries.length&&this.forceHasGeometry(!0),void 0!==e.boundingBox&&this.boundingBox.copy(e.boundingBox);const t=a.PerformanceStatistics.instance;t.enabled&&void 0!==e.decodeTime&&(t.currentFrame.addValue("decode.decodingTime",e.decodeTime),t.currentFrame.addValue("decode.decodedTiles",1)),void 0!==e.copyrightHolderIds&&(this.copyrightInfo=e.copyrightHolderIds.map(e=>({id:e}))),this.dataSource.requestUpdate()}removeDecodedTile(){this.m_decodedTile=void 0,this.invalidateResourceInfo()}loadingFinished(){}shouldDisposeObjectGeometry(e){return!0}shouldDisposeObjectMaterial(e){return!0}shouldDisposeTexture(e){return this.m_ownedTextures.has(e)}get disposed(){return this.m_disposed}get tileGeometryLoader(){return this.m_tileGeometryLoader}set tileGeometryLoader(e){this.m_tileGeometryLoader=e}get basicGeometryLoaded(){return void 0===this.m_tileGeometryLoader?this.hasGeometry:this.m_tileGeometryLoader.basicGeometryLoaded||this.m_tileGeometryLoader.isFinished}get allGeometryLoaded(){return void 0===this.m_tileGeometryLoader?this.hasGeometry:this.m_tileGeometryLoader.allGeometryLoaded||this.m_tileGeometryLoader.isFinished}get hasGeometry(){return void 0===this.m_forceHasGeometry?0!==this.objects.length:this.m_forceHasGeometry}forceHasGeometry(e){this.m_forceHasGeometry=e}resetVisibilityCounter(){this.visibilityCounter=-1}get tileLoader(){return this.m_tileLoader}set tileLoader(e){this.m_tileLoader=e}load(){const e=this.tileLoader;void 0!==e&&e.loadAndDecode().then(t=>{n.assert(t===d.Ready);const r=e.decodedTile;this.decodedTile=r}).catch(e=>{e!==d.Canceled&&e!==d.Failed&&c.error("Unknown error"+e)})}get animatedExtrusionTileHandler(){return this.m_animatedExtrusionTileHandler}set animatedExtrusionTileHandler(e){this.m_animatedExtrusionTileHandler=e}get allTextElementsOverlaid(){return this.allGeometryLoaded&&this.nextTextElementToOverlay.groupIndex>=this.m_textElementGroups.groups.size}get nextTextElementToOverlay(){return this.m_nextTextElementToOverlay}set nextTextElementToOverlay(e){this.m_nextTextElementToOverlay=e}clear(){const e=e=>{Object.getOwnPropertyNames(e).forEach(t=>{const r=e[t];if(void 0!==r&&r instanceof o.Texture){const e=r;this.shouldDisposeTexture(e)&&e.dispose()}}),e.dispose()},t=t=>{void 0!==t.geometry&&this.shouldDisposeObjectGeometry(t)&&t.geometry.dispose(),void 0!==t.material&&this.shouldDisposeObjectMaterial(t)&&(t.material instanceof Array?t.material.forEach(t=>{void 0!==t&&e(t)}):e(t.material))};this.objects.forEach(e=>{e.traverse(e=>{t(e)}),t(e)}),this.objects.length=0,this.preparedTextPaths&&(this.preparedTextPaths=[]),void 0!==this.m_animatedExtrusionTileHandler&&this.m_animatedExtrusionTileHandler.dispose(),this.clearTextElements(),this.invalidateResourceInfo()}clearTextElements(){this.placedTextElements.clear(),this.m_pathBlockingElements.splice(0),this.textElementGroups.clear(),this.userTextElements.length=0,this.textElementsChanged=!0}dispose(){this.m_disposed||(this.m_tileLoader&&(this.m_tileLoader.cancel(),this.m_tileLoader=void 0),void 0!==this.m_tileGeometryLoader&&(this.m_tileGeometryLoader.dispose(),this.m_tileGeometryLoader=void 0),this.clear(),this.userTextElements.length=0,this.m_disposed=!0,this.frameNumLastRequested=0)}computeResourceInfo(){let e=0,t=0,r=0,i=0;const n={heapSize:0,gpuSize:0},o=new Map;for(const e of this.objects)e.visible&&t++,s.MapViewUtils.estimateObject3dSize(e,n,o);for(const e of this.textElementGroups.groups)r+=e[1].elements.length;e+=312*(r+(i=this.userTextElements.length)),void 0!==this.m_decodedTile&&void 0!==this.m_decodedTile.tileInfo&&(n.heapSize+=this.m_decodedTile.tileInfo.numBytes),void 0!==this.roadIntersectionData&&(e+=function(e){let t=u;const r=32+u,i=e.techniqueIndex.length;return t+=e.techniqueIndex.length*r,void 0!==e.ids&&(t+=8*i),void 0!==e.objInfos&&(t+=i*l),t}(this.roadIntersectionData)),this.m_resourceInfo={heapSize:n.heapSize+e,gpuSize:n.gpuSize,num3dObjects:t,numTextElements:r,numUserTextElements:i}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t){e.exports=i;var r=null;try{r=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function i(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function n(e){return!0===(e&&e.__isLong__)}i.prototype.__isLong__,Object.defineProperty(i.prototype,"__isLong__",{value:!0}),i.isLong=n;var o={},a={};function s(e,t){var r,i,n;return t?(n=0<=(e>>>=0)&&e<256)&&(i=a[e])?i:(r=l(e,(0|e)<0?-1:0,!0),n&&(a[e]=r),r):(n=-128<=(e|=0)&&e<128)&&(i=o[e])?i:(r=l(e,e<0?-1:0,!1),n&&(o[e]=r),r)}function c(e,t){if(isNaN(e))return t?v:y;if(t){if(e<0)return v;if(e>=p)return E}else{if(e<=-f)return w;if(e+1>=f)return T}return e<0?c(-e,t).neg():l(e%m|0,e/m|0,t)}function l(e,t,r){return new i(e,t,r)}i.fromInt=s,i.fromNumber=c,i.fromBits=l;var u=Math.pow;function d(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return y;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var i;if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return d(e.substring(1),t,r).neg();for(var n=c(u(r,8)),o=y,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),l=parseInt(e.substring(a,a+s),r);if(s<8){var h=c(u(r,s));o=o.mul(h).add(c(l))}else o=(o=o.mul(n)).add(c(l))}return o.unsigned=t,o}function h(e,t){return"number"==typeof e?c(e,t):"string"==typeof e?d(e,t):l(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}i.fromString=d,i.fromValue=h;var m=4294967296,p=m*m,f=p/2,g=s(1<<24),y=s(0);i.ZERO=y;var v=s(0,!0);i.UZERO=v;var _=s(1);i.ONE=_;var b=s(1,!0);i.UONE=b;var S=s(-1);i.NEG_ONE=S;var T=l(-1,2147483647,!1);i.MAX_VALUE=T;var E=l(-1,-1,!0);i.MAX_UNSIGNED_VALUE=E;var w=l(0,-2147483648,!1);i.MIN_VALUE=w;var C=i.prototype;C.toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*m+(this.low>>>0):this.high*m+(this.low>>>0)},C.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(w)){var t=c(e),r=this.div(t),i=r.mul(t).sub(this);return r.toString(e)+i.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var n=c(u(e,6),this.unsigned),o=this,a="";;){var s=o.div(n),l=(o.sub(s.mul(n)).toInt()>>>0).toString(e);if((o=s).isZero())return l+a;for(;l.length<6;)l="0"+l;a=""+l+a}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(w)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},C.isZero=function(){return 0===this.high&&0===this.low},C.eqz=C.isZero,C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return 1==(1&this.low)},C.isEven=function(){return 0==(1&this.low)},C.equals=function(e){return n(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},C.eq=C.equals,C.notEquals=function(e){return!this.eq(e)},C.neq=C.notEquals,C.ne=C.notEquals,C.lessThan=function(e){return this.comp(e)<0},C.lt=C.lessThan,C.lessThanOrEqual=function(e){return this.comp(e)<=0},C.lte=C.lessThanOrEqual,C.le=C.lessThanOrEqual,C.greaterThan=function(e){return this.comp(e)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(e){return this.comp(e)>=0},C.gte=C.greaterThanOrEqual,C.ge=C.greaterThanOrEqual,C.compare=function(e){if(n(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(w)?w:this.not().add(_)},C.neg=C.negate,C.add=function(e){n(e)||(e=h(e));var t=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,a=e.high>>>16,s=65535&e.high,c=e.low>>>16,u=0,d=0,m=0,p=0;return m+=(p+=o+(65535&e.low))>>>16,d+=(m+=i+c)>>>16,u+=(d+=r+s)>>>16,u+=t+a,l((m&=65535)<<16|(p&=65535),(u&=65535)<<16|(d&=65535),this.unsigned)},C.subtract=function(e){return n(e)||(e=h(e)),this.add(e.neg())},C.sub=C.subtract,C.multiply=function(e){if(this.isZero())return y;if(n(e)||(e=h(e)),r)return l(r.mul(this.low,this.high,e.low,e.high),r.get_high(),this.unsigned);if(e.isZero())return y;if(this.eq(w))return e.isOdd()?w:y;if(e.eq(w))return this.isOdd()?w:y;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return c(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,i=65535&this.high,o=this.low>>>16,a=65535&this.low,s=e.high>>>16,u=65535&e.high,d=e.low>>>16,m=65535&e.low,p=0,f=0,v=0,_=0;return v+=(_+=a*m)>>>16,f+=(v+=o*m)>>>16,v&=65535,f+=(v+=a*d)>>>16,p+=(f+=i*m)>>>16,f&=65535,p+=(f+=o*d)>>>16,f&=65535,p+=(f+=a*u)>>>16,p+=t*m+i*d+o*u+a*s,l((v&=65535)<<16|(_&=65535),(p&=65535)<<16|(f&=65535),this.unsigned)},C.mul=C.multiply,C.divide=function(e){if(n(e)||(e=h(e)),e.isZero())throw Error("division by zero");var t,i,o;if(r)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?l((this.unsigned?r.div_u:r.div_s)(this.low,this.high,e.low,e.high),r.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?v:y;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return v;if(e.gt(this.shru(1)))return b;o=v}else{if(this.eq(w))return e.eq(_)||e.eq(S)?w:e.eq(w)?_:(t=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?_:S:(i=this.sub(e.mul(t)),o=t.add(i.div(e)));if(e.eq(w))return this.unsigned?v:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=y}for(i=this;i.gte(e);){t=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(t)/Math.LN2),s=a<=48?1:u(2,a-48),d=c(t),m=d.mul(e);m.isNegative()||m.gt(i);)m=(d=c(t-=s,this.unsigned)).mul(e);d.isZero()&&(d=_),o=o.add(d),i=i.sub(m)}return o},C.div=C.divide,C.modulo=function(e){return n(e)||(e=h(e)),r?l((this.unsigned?r.rem_u:r.rem_s)(this.low,this.high,e.low,e.high),r.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},C.mod=C.modulo,C.rem=C.modulo,C.not=function(){return l(~this.low,~this.high,this.unsigned)},C.and=function(e){return n(e)||(e=h(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},C.or=function(e){return n(e)||(e=h(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},C.xor=function(e){return n(e)||(e=h(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},C.shiftLeft=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(e){if(n(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?l(this.low>>>e|t<<32-e,t>>>e,this.unsigned):l(32===e?t:t>>>e-32,0,this.unsigned)},C.shru=C.shiftRightUnsigned,C.shr_u=C.shiftRightUnsigned,C.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},C.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},C.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},i.fromBytes=function(e,t,r){return r?i.fromBytesLE(e,t):i.fromBytesBE(e,t)},i.fromBytesLE=function(e,t){return new i(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},i.fromBytesBE=function(e,t){return new i(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=r(387),o=r(69),a=r(427);a.util.Long!==o&&(a.util.Long=o,a.configure());t.SchemaProviderAbstract=class{constructor(e){this.m_params=e,this.m_isReady=!1,this.m_loggerName="Schema Provider",this.m_manifestFile="META-INF/layer.manifest.json",this.m_errorsLogLevel="error",this.m_logger=i.LoggerManager.instance.create(this.getLoggerName())}setErrorsLogLevel(e){this.m_errorsLogLevel=e}isReady(){return this.m_isReady}async connect(){void 0===this.m_connectPromise&&(this.m_connectPromise=new Promise(async(e,t)=>{try{this.m_isReady=!1,this.m_schemaDetails=await this.fetchSchemaDetails();const t=await this.getSchemaArchive();if(void 0===t)return void e();const r=await this.unpackSchemaArchive(t),i=r.get(this.m_manifestFile);if(void 0===i)return this.m_logger.error(`File '${this.m_manifestFile}' missing from Protobuf bundle.`),void e();const n=JSON.parse(i).main.message;if("string"!=typeof n)return this.m_logger.error(`Malformed '${this.m_manifestFile}': main.message must be a string.`),void e();this.m_schemaData={schemaFiles:r,messageName:n},this.m_isReady=!0,this.m_logger.info("Connected successfully"),e()}catch(e){t(e)}})),await this.m_connectPromise}getSchemaData(){return this.m_schemaData}getSchemaDetails(){return this.m_schemaDetails}getProtobufDecoder(e=!0){if(void 0!==this.m_protobufDecoder)return this.m_protobufDecoder;const t=this.getSchemaData();if(void 0===t)return void this.m_logger.warn("Data is not obtained from the schema.");const r=this.getProtobufRoot(t.schemaFiles,e);if(void 0!==r)try{this.m_protobufDecoder=r.lookupType(t.messageName)}catch(e){this.m_logger.error(`Error while looking for a type '${t.messageName}' in proto file:`,e.message)}return this.m_protobufDecoder}getRenderer(){if(void 0!==this.m_renderer)return this.m_renderer;const e=this.getSchemaData();return this.m_renderer=void 0!==e?e.schemaFiles.get(`renderers/${e.messageName}.js`):void 0,this.m_renderer}getProtobufRoot(e,t=!0){const r=new a.Root;let i=!1;for(const[n,o]of e)if(n.endsWith(".proto")){i=!0;try{a.parse(o,r,{keepCase:t})}catch(e){return void this.m_logger[this.m_errorsLogLevel](`Error while reading proto file '${n}':`,e.message)}}if(i)return r;this.m_logger[this.m_errorsLogLevel]("Proto file not found in schema.")}async unpackSchemaArchive(e){const t=new n,r=await t.loadAsync(e),i=new Map;for(const e in r.files){if(!r.files[e])continue;const n=r.files[e];if(n.dir)continue;const o=await t.file(n.name).async("text");i.set(n.name,o)}return i}getLoggerName(){return this.m_params&&this.m_params.loggerName?this.m_params.loggerName:this.m_loggerName}}},function(e,t){var r,i,n=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var c,l=[],u=!1,d=-1;function h(){u&&c&&(u=!1,c.length?l=c.concat(l):d=-1,l.length&&m())}function m(){if(!u){var e=s(h);u=!0;for(var t=l.length;t;){for(c=l,l=[];++d<t;)c&&c[d].run();d=-1,t=l.length}c=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new p(e,t)),1!==l.length||u||s(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=f,n.addListener=f,n.once=f,n.off=f,n.removeListener=f,n.removeAllListeners=f,n.emit=f,n.prependListener=f,n.prependOnceListener=f,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t,r){"use strict";(function(t){void 0===t||!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,r,i,n){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick((function(){e.call(null,r)}));case 3:return t.nextTick((function(){e.call(null,r,i)}));case 4:return t.nextTick((function(){e.call(null,r,i,n)}));default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return t.nextTick((function(){e.apply(null,o)}))}}}:e.exports=t}).call(this,r(71))},function(e,t,r){"use strict";(function(t){e.exports={isNode:void 0!==t,newBufferFrom:function(e,r){if(t.from&&t.from!==Uint8Array.from)return t.from(e,r);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new t(e,r)},allocBuffer:function(e){if(t.alloc)return t.alloc(e);var r=new t(e);return r.fill(0),r},isBuffer:function(e){return t.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}}).call(this,r(36).Buffer)},function(e,t,r){"use strict";e.exports=a;var i=r(38);((a.prototype=Object.create(i.prototype)).constructor=a).className="OneOf";var n=r(27),o=r(7);function a(e,t,r,n){if(Array.isArray(t)||(r=t,t=void 0),i.call(this,e,r),void 0!==t&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=n}function s(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}a.fromJSON=function(e,t){return new a(e,t.oneof,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},a.prototype.add=function(e){if(!(e instanceof n))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,s(this),this},a.prototype.remove=function(e){if(!(e instanceof n))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},a.prototype.onAdd=function(e){i.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var r=e.get(this.oneof[t]);r&&!r.partOf&&(r.partOf=this,this.fieldsArray.push(r))}s(this)},a.prototype.onRemove=function(e){for(var t,r=0;r<this.fieldsArray.length;++r)(t=this.fieldsArray[r]).parent&&t.parent.remove(t);i.prototype.onRemove.call(this,e)},a.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,r){o.decorateType(t.constructor).add(new a(r,e)),Object.defineProperty(t,r,{get:o.oneOfGetter(e),set:o.oneOfSetter(e)})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(4),n=r(0),o=r(230);function a(e,t,r=Math.floor){return r((1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*Math.pow(2,t))}function s(e,t){const{north:r,west:i}=t.geoBox,n=Math.log2(e),s=Math.pow(2,t.tileKey.level+n);return{extents:e,scale:s,top:a(r,t.tileKey.level+n,t.adapterId===o.VTJsonDataAdapterId?Math.round:Math.floor),left:(i+180)/360*s}}function c(e,t,r,n=!1,o){void 0!==t.worldTileProjectionCookie&&t.worldTileProjectionCookie.extents===e||(t.worldTileProjectionCookie=s(e,t));const{top:a,left:c,scale:l}=t.worldTileProjectionCookie,u=i.EarthConstants.EQUATORIAL_CIRCUMFERENCE;return o.set((c+r.x)/l*u,(a+(n?-r.y:r.y))/l*u)}t.isArrayBufferLike=function(e){return"undefined"!=typeof SharedArrayBuffer?e instanceof ArrayBuffer||e instanceof SharedArrayBuffer:e instanceof ArrayBuffer},t.lat2tile=a,t.tile2lat=function(e,t){const r=Math.PI-2*Math.PI*e/Math.pow(2,t);return 180/Math.PI*Math.atan(.5*(Math.exp(r)-Math.exp(-r)))},t.createWorldTileTransformationCookie=s,t.tile2world=c,t.world2tile=function(e,t,r,n=!1,o){void 0!==t.worldTileProjectionCookie&&t.worldTileProjectionCookie.extents===e||(t.worldTileProjectionCookie=s(e,t));const{top:a,left:c,scale:l}=t.worldTileProjectionCookie,u=i.EarthConstants.EQUATORIAL_CIRCUMFERENCE;return o.set(r.x/u*l-c,(n?-1:1)*(r.y/u*l-a))};const l=new n.Vector2;t.webMercatorTile2TargetWorld=function(e,t,r,n,o=!1){const a=c(e,t,r,o,l);n.set(a.x,a.y,0),t.targetProjection.reprojectPoint(i.webMercatorProjection,n,n).sub(t.center)}},function(e,t,r){"use strict";t.a={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,t,r,i,n){var o=this;return e.forEach((function(e){o.processors[e]&&(t=o.processors[e].process(t,r,i,n))})),t}}},function(e,t,r){"use strict";function i(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:function(){},parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t={};return e[1]&&(t.defaultValue=e[1]),e[2]&&(t.tDescription=e[2]),t},interpolation:{escapeValue:!0,format:function(e,t,r){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",maxReplaces:1e3}}}function n(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.whitelist&&e.whitelist.indexOf("cimode")<0&&(e.whitelist=e.whitelist.concat(["cimode"])),e}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(124),n=r(125);t.TEXTURE_PROPERTY_KEYS=["map","normalMap","displacementMap","roughnessMap","emissiveMap","alphaMap","metalnessMap","bumpMap"],t.techniqueDescriptors={},t.baseTechniqueParamsDescriptor={attrScopes:{renderOrder:n.AttrScope.TechniqueGeometry,renderOrderOffset:n.AttrScope.TechniqueGeometry,enabled:n.AttrScope.TechniqueGeometry,kind:n.AttrScope.TechniqueGeometry,transient:n.AttrScope.TechniqueGeometry,fadeFar:n.AttrScope.TechniqueRendering,fadeNear:n.AttrScope.TechniqueRendering}},t.pointTechniquePropTypes=n.mergeTechniqueDescriptor(t.baseTechniqueParamsDescriptor,{attrScopes:{texture:n.AttrScope.TechniqueGeometry,enablePicking:n.AttrScope.TechniqueGeometry,color:n.AttrScope.TechniqueRendering,transparent:n.AttrScope.TechniqueRendering,opacity:n.AttrScope.TechniqueGeometry}}),t.squaresTechniquePropTypes=n.mergeTechniqueDescriptor(t.baseTechniqueParamsDescriptor,t.pointTechniquePropTypes),t.techniqueDescriptors.squares=t.squaresTechniquePropTypes,t.circlesTechniquePropTypes=n.mergeTechniqueDescriptor(t.baseTechniqueParamsDescriptor,t.pointTechniquePropTypes),t.techniqueDescriptors.circles=t.circlesTechniquePropTypes;const o=n.mergeTechniqueDescriptor(t.baseTechniqueParamsDescriptor,{attrScopes:{text:n.AttrScope.FeatureGeometry,label:n.AttrScope.FeatureGeometry,useAbbreviation:n.AttrScope.FeatureGeometry,useIsoCode:n.AttrScope.FeatureGeometry,priority:n.AttrScope.TechniqueGeometry,textMinZoomLevel:n.AttrScope.TechniqueGeometry,textMaxZoomLevel:n.AttrScope.TechniqueGeometry,iconMinZoomLevel:n.AttrScope.TechniqueGeometry,iconMaxZoomLevel:n.AttrScope.TechniqueGeometry,distanceScale:n.AttrScope.TechniqueGeometry,textMayOverlap:n.AttrScope.TechniqueGeometry,iconMayOverlap:n.AttrScope.TechniqueGeometry,textReserveSpace:n.AttrScope.TechniqueGeometry,iconReserveSpace:n.AttrScope.TechniqueGeometry,renderTextDuringMovements:n.AttrScope.TechniqueGeometry,alwaysOnTop:n.AttrScope.TechniqueGeometry,textIsOptional:n.AttrScope.TechniqueGeometry,showOnMap:n.AttrScope.TechniqueGeometry,stackMode:n.AttrScope.TechniqueGeometry,minDistance:n.AttrScope.TechniqueGeometry,iconIsOptional:n.AttrScope.TechniqueGeometry,iconFadeTime:n.AttrScope.TechniqueGeometry,textFadeTime:n.AttrScope.TechniqueGeometry,xOffset:n.AttrScope.TechniqueGeometry,yOffset:n.AttrScope.TechniqueGeometry,iconXOffset:n.AttrScope.TechniqueGeometry,iconYOffset:n.AttrScope.TechniqueGeometry,iconScale:n.AttrScope.TechniqueGeometry,screenHeight:n.AttrScope.TechniqueGeometry,screenWidth:n.AttrScope.TechniqueGeometry,poiTable:n.AttrScope.TechniqueGeometry,poiName:n.AttrScope.FeatureGeometry,poiNameField:n.AttrScope.TechniqueGeometry,imageTexture:n.AttrScope.FeatureGeometry,imageTextureField:n.AttrScope.TechniqueGeometry,imageTexturePrefix:n.AttrScope.TechniqueGeometry,imageTexturePostfix:n.AttrScope.TechniqueGeometry,style:n.AttrScope.TechniqueGeometry,fontName:n.AttrScope.TechniqueGeometry,fontStyle:n.AttrScope.TechniqueGeometry,fontVariant:n.AttrScope.TechniqueGeometry,rotation:n.AttrScope.TechniqueGeometry,tracking:n.AttrScope.TechniqueGeometry,leading:n.AttrScope.TechniqueGeometry,maxLines:n.AttrScope.TechniqueGeometry,lineWidth:n.AttrScope.TechniqueGeometry,canvasRotation:n.AttrScope.TechniqueGeometry,lineRotation:n.AttrScope.TechniqueGeometry,wrappingMode:n.AttrScope.TechniqueGeometry,hAlignment:n.AttrScope.TechniqueGeometry,vAlignment:n.AttrScope.TechniqueGeometry,backgroundColor:n.AttrScope.TechniqueRendering,backgroundSize:n.AttrScope.TechniqueRendering,backgroundOpacity:n.AttrScope.TechniqueRendering,color:n.AttrScope.TechniqueRendering,opacity:n.AttrScope.TechniqueRendering,size:n.AttrScope.TechniqueRendering}});t.techniqueDescriptors["line-marker"]=o,t.techniqueDescriptors["labeled-icon"]=o;const a={attrScopes:{polygonOffset:n.AttrScope.TechniqueRendering,polygonOffsetFactor:n.AttrScope.TechniqueRendering,polygonOffsetUnits:n.AttrScope.TechniqueRendering,lineColor:n.AttrScope.TechniqueRendering,lineFadeFar:n.AttrScope.TechniqueRendering,lineFadeNear:n.AttrScope.TechniqueRendering}};t.solidLineTechniqueDescriptor=n.mergeTechniqueDescriptor(t.baseTechniqueParamsDescriptor,a,{attrScopes:{clipping:n.AttrScope.TechniqueGeometry,secondaryRenderOrder:n.AttrScope.TechniqueGeometry,color:n.AttrScope.TechniqueRendering,opacity:n.AttrScope.TechniqueRendering,transparent:n.AttrScope.TechniqueRendering,lineWidth:n.AttrScope.TechniqueRendering,secondaryWidth:n.AttrScope.TechniqueRendering,secondaryColor:n.AttrScope.TechniqueRendering}}),t.techniqueDescriptors["solid-line"]=t.solidLineTechniqueDescriptor,t.dashedLineTechniqueDescriptor=n.mergeTechniqueDescriptor(t.baseTechniqueParamsDescriptor,a,{attrScopes:{color:n.AttrScope.TechniqueRendering,clipping:n.AttrScope.TechniqueGeometry,opacity:n.AttrScope.TechniqueRendering,transparent:n.AttrScope.TechniqueRendering,lineWidth:n.AttrScope.TechniqueRendering,dashSize:n.AttrScope.TechniqueRendering,gapSize:n.AttrScope.TechniqueRendering}}),t.techniqueDescriptors["dashed-line"]=t.dashedLineTechniqueDescriptor,t.lineTechniqueDescriptor=n.mergeTechniqueDescriptor(t.baseTechniqueParamsDescriptor,{attrScopes:{color:n.AttrScope.TechniqueRendering,opacity:n.AttrScope.TechniqueRendering,transparent:n.AttrScope.TechniqueRendering,lineWidth:n.AttrScope.FeatureGeometry}}),t.techniqueDescriptors.line=t.lineTechniqueDescriptor;const s=n.mergeTechniqueDescriptor(t.baseTechniqueParamsDescriptor,a,{attrScopes:{color:n.AttrScope.TechniqueRendering,opacity:n.AttrScope.TechniqueRendering,transparent:n.AttrScope.TechniqueRendering,lineWidth:n.AttrScope.TechniqueRendering}});t.techniqueDescriptors.fill=s;const c=n.mergeTechniqueDescriptor(t.baseTechniqueParamsDescriptor,{attrScopes:{color:n.AttrScope.FeatureGeometry,vertexColors:n.AttrScope.FeatureGeometry,wireframe:n.AttrScope.TechniqueRendering,roughness:n.AttrScope.TechniqueRendering,metalness:n.AttrScope.TechniqueRendering,alphaTest:n.AttrScope.TechniqueRendering,depthTest:n.AttrScope.TechniqueRendering,transparent:n.AttrScope.TechniqueRendering,opacity:n.AttrScope.TechniqueRendering,emissive:n.AttrScope.TechniqueRendering,emissiveIntensity:n.AttrScope.TechniqueRendering,refractionRatio:n.AttrScope.TechniqueRendering,map:n.AttrScope.TechniqueGeometry,mapProperties:n.AttrScope.TechniqueGeometry,normalMap:n.AttrScope.TechniqueGeometry,normalMapProperties:n.AttrScope.TechniqueGeometry,displacementMap:n.AttrScope.TechniqueGeometry,displacementMapProperties:n.AttrScope.TechniqueGeometry,roughnessMap:n.AttrScope.TechniqueGeometry,roughnessMapProperties:n.AttrScope.TechniqueGeometry,emissiveMap:n.AttrScope.TechniqueGeometry,emissiveMapProperties:n.AttrScope.TechniqueGeometry,bumpMap:n.AttrScope.TechniqueGeometry,bumpMapProperties:n.AttrScope.TechniqueGeometry,metalnessMap:n.AttrScope.TechniqueGeometry,metalnessMapProperties:n.AttrScope.TechniqueGeometry,alphaMap:n.AttrScope.TechniqueGeometry,alphaMapProperties:n.AttrScope.TechniqueGeometry}});t.techniqueDescriptors.standard=c;const l=n.mergeTechniqueDescriptor(t.baseTechniqueParamsDescriptor,c,{attrScopes:{height:n.AttrScope.FeatureGeometry,floorHeight:n.AttrScope.FeatureGeometry,color:n.AttrScope.FeatureGeometry,defaultColor:n.AttrScope.FeatureGeometry,defaultHeight:n.AttrScope.FeatureGeometry,constantHeight:n.AttrScope.FeatureGeometry,boundaryWalls:n.AttrScope.FeatureGeometry,footprint:n.AttrScope.FeatureGeometry,maxSlope:n.AttrScope.FeatureGeometry,enableDepthPrePass:n.AttrScope.TechniqueGeometry,animateExtrusionDuration:n.AttrScope.TechniqueGeometry,animateExtrusion:n.AttrScope.TechniqueRendering,opacity:n.AttrScope.TechniqueRendering,transparent:n.AttrScope.TechniqueRendering,lineWidth:n.AttrScope.TechniqueRendering,lineFadeNear:n.AttrScope.TechniqueRendering,lineFadeFar:n.AttrScope.TechniqueRendering,lineColorMix:n.AttrScope.TechniqueGeometry,lineColor:n.AttrScope.TechniqueRendering}});t.techniqueDescriptors["extruded-polygon"]=l;const u=n.mergeTechniqueDescriptor(t.baseTechniqueParamsDescriptor,{attrScopes:{text:n.AttrScope.FeatureGeometry,label:n.AttrScope.FeatureGeometry,useAbbreviation:n.AttrScope.FeatureGeometry,useIsoCode:n.AttrScope.FeatureGeometry,minZoomLevel:n.AttrScope.TechniqueGeometry,maxZoomLevel:n.AttrScope.TechniqueGeometry,distanceScale:n.AttrScope.TechniqueGeometry,mayOverlap:n.AttrScope.TechniqueGeometry,reserveSpace:n.AttrScope.TechniqueGeometry,textFadeTime:n.AttrScope.TechniqueGeometry,xOffset:n.AttrScope.TechniqueGeometry,yOffset:n.AttrScope.TechniqueGeometry,style:n.AttrScope.TechniqueGeometry,fontName:n.AttrScope.TechniqueGeometry,fontStyle:n.AttrScope.TechniqueGeometry,fontVariant:n.AttrScope.TechniqueGeometry,rotation:n.AttrScope.TechniqueGeometry,tracking:n.AttrScope.TechniqueGeometry,leading:n.AttrScope.TechniqueGeometry,maxLines:n.AttrScope.TechniqueGeometry,lineWidth:n.AttrScope.TechniqueGeometry,canvasRotation:n.AttrScope.TechniqueGeometry,lineRotation:n.AttrScope.TechniqueGeometry,wrappingMode:n.AttrScope.TechniqueGeometry,hAlignment:n.AttrScope.TechniqueGeometry,vAlignment:n.AttrScope.TechniqueGeometry,backgroundColor:n.AttrScope.TechniqueRendering,backgroundSize:n.AttrScope.TechniqueRendering,backgroundOpacity:n.AttrScope.TechniqueRendering,color:n.AttrScope.TechniqueRendering,opacity:n.AttrScope.TechniqueRendering,priority:n.AttrScope.TechniqueRendering,size:n.AttrScope.TechniqueRendering}});t.techniqueDescriptors.text=u;const d=n.mergeTechniqueDescriptor(t.baseTechniqueParamsDescriptor,{attrScopes:{primitive:n.AttrScope.TechniqueGeometry,params:n.AttrScope.TechniqueRendering}});function h(e){return"extruded-line"===e.name}function m(e){return h(e)&&"standard"===e.shading}function p(e){return"fill"===e.name}function f(e){return"extruded-polygon"===e.name}function g(e){return"standard"===e.name}function y(e){return"terrain"===e.name}t.techniqueDescriptors.shader=d,t.isCirclesTechnique=function(e){return"circles"===e.name},t.isSquaresTechnique=function(e){return"squares"===e.name},t.isPoiTechnique=function(e){return"labeled-icon"===e.name},t.isLineMarkerTechnique=function(e){return"line-marker"===e.name},t.isDashedLineTechnique=function(e){return"dashed-line"===e.name},t.isLineTechnique=function(e){return"line"===e.name},t.isSolidLineTechnique=function(e){return"solid-line"===e.name},t.isSegmentsTechnique=function(e){return"segments"===e.name},t.isExtrudedLineTechnique=h,t.isBasicExtrudedLineTechnique=function(e){return h(e)&&"basic"===e.shading},t.isStandardExtrudedLineTechnique=m,t.isFillTechnique=p,t.isExtrudedPolygonTechnique=f,t.isStandardTechnique=g,t.isTerrainTechnique=y,t.isTextTechnique=function(e){return"text"===e.name},t.isShaderTechnique=function(e){return"shader"===e.name},t.isLabelRejectionLineTechnique=function(e){return"label-rejection-line"===e.name},t.needsVertexNormals=function(e){return p(e)||g(e)||y(e)||m(e)},t.textureCoordinateType=function(e){return g(e)?e.textureCoordinateType:f(e)?e.textureCoordinateType:y(e)?e.textureCoordinateType:void 0},t.addBuffersToTransferList=function(e,r){if(g(e)||f(e)||y(e))for(const n of t.TEXTURE_PROPERTY_KEYS){const t=e[n];i.isTextureBuffer(t)&&t.buffer instanceof ArrayBuffer&&r.push(t.buffer)}},t.composeTechniqueTextureName=function(e,t){let r=e;return"string"==typeof t.imageTexturePrefix&&(r=t.imageTexturePrefix+r),"string"==typeof t.imageTexturePostfix&&(r+=t.imageTexturePostfix),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Log=2]="Log",e[e.Info=3]="Info",e[e.Warn=4]="Warn",e[e.Error=5]="Error"}(t.LogLevel||(t.LogLevel={}));t.LoggerOptions=class{}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveReferenceUri=function(e,t){if(i.test(t))return t;if(t.startsWith("/")){return o(e)+t}return t.startsWith("./")&&(t=t.substr(2)),n(e)+t};const i=new RegExp("^(?:[a-z]+:)?//","i");function n(e){if(void 0===e)return"./";let t=e.indexOf("?");return-1!==t&&(e=e.slice(0,t)),-1===(t=e.lastIndexOf("/"))?"./":e.substring(0,t+1)}function o(e){if(void 0===e)return"";const t=a(e);return"file:"===t.protocol?"file://":t.host&&t.protocol?t.protocol+"//"+t.host:t.host?"//"+t.host:t.protocol?t.protocol+"//":""}function a(e){const t=new RegExp(/^(?:([a-z]+:))?\/\/([^\/]*)/,"i"),r=e.match(t);if(!r)throw new Error(`getUrlHostAndProtocol: unable to parse URL '${e}'`);return{protocol:r[1],host:r[2]}}t.baseUrl=n,t.getUrlOrigin=o,t.getUrlHostAndProtocol=a},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){var i=this.constructor,n=e.call(this,t)||this;return n.name="HTTPError",Object.setPrototypeOf(n,i.prototype),n.message=t||"",n.statusText=r&&r.statusText||"",n.status=r&&r.status||0,n}return n(t,e),t}(Error);t.ErrorHTTPResponse=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,4294967296,8589934592,17179869184,34359738368,68719476736,137438953472,274877906944,549755813888,1099511627776,2199023255552,4398046511104,8796093022208,17592186044416,35184372088832,70368744177664,0x800000000000,281474976710656,562949953421312,0x4000000000000,0x8000000000000,4503599627370496];t.quadKeyFromMortonCode=function(e){"string"==typeof e&&(e=parseInt(e,10));for(var t=0,r=0,i=0;e>1;){var n=1<<t;1&e&&(i|=n),2&e&&(r|=n),t++,e=(e-(3&e))/4}return{row:r,column:i,level:t}},t.mortonCodeFromQuadKey=function(e){for(var t=e.column,r=e.row,n=i[e.level<<1],o=0;o<e.level;++o)1&t&&(n+=i[2*o]),1&r&&(n+=i[2*o+1]),t>>>=1,r>>>=1;return n},t.addQuadKeys=function(e,t){return{row:(e.row<<t.level)+t.row,column:(e.column<<t.level)+t.column,level:e.level+t.level}},t.computeParentKey=function(e,t){if(void 0===t&&(t=1),t<0)throw new Error("Operation is not supported");return{row:e.row>>>t,column:e.column>>>t,level:Math.max(0,e.level-t)}},t.isValid=function(e){if(e.level<0||e.level>26)return!1;var t=Math.pow(2,e.level),r=e.row>=0&&e.row<t,i=e.column>=0&&e.column<t;return r&&i}},function(e,t,r){"use strict";function i(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),i(r(84)),i(r(158)),i(r(159)),i(r(34)),i(r(160)),i(r(95)),i(r(95)),i(r(177)),i(r(177)),i(r(376)),i(r(96)),i(r(179)),i(r(377)),i(r(87)),i(r(172)),i(r(91)),i(r(153)),i(r(165)),i(r(379)),i(r(168)),i(r(167)),i(r(62)),i(r(169)),i(r(92)),i(r(66)),i(r(157)),i(r(170)),i(r(171)),i(r(156)),i(r(48)),i(r(64)),i(r(65)),i(r(47)),i(r(175)),i(r(67)),i(r(380)),i(r(181)),i(r(20)),i(r(176)),i(r(164)),i(r(178)),i(r(163))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(9),n=r(1),o=r(62);var a;!function(e){e[e.None=0]="None",e[e.Started=1]="Started",e[e.Playing=2]="Playing",e[e.Finished=3]="Finished"}(a=t.AnimatedExtrusionState||(t.AnimatedExtrusionState={}));t.AnimatedExtrusionHandler=class{constructor(e){this.m_mapView=e,this.enabled=!0,this.duration=750,this.forceEnabled=!1,this.m_tileHandlerMap=new Map,this.m_zoomDirection=0,this.m_zoomLevelPrevious=this.m_mapView.zoomLevel}get zoomDirection(){return this.m_zoomDirection}set zoom(e){this.m_zoomLevelPrevious!==e&&(this.m_tileHandlerMap.forEach(t=>{void 0!==this.m_mapView.getDataSourceByName(t.tile.dataSource.name)&&(this.m_zoomDirection=e>this.m_zoomLevelPrevious?1:-1,t.zoomLevelChanged(this.m_zoomDirection))}),this.m_zoomLevelPrevious=e)}get forceAnimatedExtrusion(){return this.m_forceAnimatedExtrusion}set forceAnimatedExtrusion(e){this.m_forceAnimatedExtrusion=e}get forceAnimatedExtrusionDuration(){return this.m_forceAnimatedExtrusionDuration}set forceAnimatedExtrusionDuration(e){this.m_forceAnimatedExtrusionDuration=e}add(e){this.m_tileHandlerMap.set(e.tile,e)}removeTile(e){this.m_tileHandlerMap.delete(e)}find(e){for(const t of this.m_tileHandlerMap)for(const r of e)if(void 0!==r&&t[0].tileKey.mortonCode()===r.mortonCode())return t[1]}get isAnimating(){for(const e of this.m_tileHandlerMap)if(e[1].isAnimating)return!0;return!1}};t.AnimatedExtrusionTileHandler=class{constructor(e,t,r){this.m_tile=e,this.m_animatedExtrusionDuration=r,this.m_extrudedObjects=[],this.m_animatedExtrusionRatio=i.ExtrusionFeature.DEFAULT_RATIO_MAX,this.m_animatedExtrusionState=a.None,this.m_animatedExtrusionStartTime=void 0,this.animateExtrusion=e=>{if(this.m_animatedExtrusionState!==a.Playing){if(this.m_animatedExtrusionState!==a.Started)return;this.m_animatedExtrusionState=a.Playing}const t=Date.now();(void 0===this.m_animatedExtrusionStartTime||this.m_animatedExtrusionStartTime<=0)&&(this.m_animatedExtrusionStartTime=t);const r=Math.min(t-this.m_animatedExtrusionStartTime,this.m_animatedExtrusionDuration);this.extrusionRatio=n.MathUtils.easeInOutCubic(i.ExtrusionFeature.DEFAULT_RATIO_MIN,i.ExtrusionFeature.DEFAULT_RATIO_MAX,r/this.m_animatedExtrusionDuration),r>=this.m_animatedExtrusionDuration&&(this.m_animatedExtrusionState=a.Finished,this.stopExtrusionAnimation()),this.m_tile.dataSource.requestUpdate()},this.m_mapView=e.mapView,this.m_animatedExtrusionHandler=this.m_mapView.animatedExtrusionHandler,t.forEach(e=>{e.materialFeature&&i.ExtrusionFeature.addRenderHelper(e.object),this.m_extrudedObjects.push(e.object)}),this.startExtrusionAnimationIfNeeded(this.m_animatedExtrusionHandler.zoomDirection)}set extrusionRatio(e){this.m_animatedExtrusionRatio=e,this.m_extrudedObjects.forEach(e=>{e.material.extrusionRatio=this.m_animatedExtrusionRatio})}get tile(){return this.m_tile}get animationState(){return this.m_animatedExtrusionState}get isAnimating(){return this.m_animatedExtrusionState!==a.Finished}dispose(){this.stopExtrusionAnimation(),this.m_animatedExtrusionHandler.removeTile(this.m_tile)}zoomLevelChanged(e){!1===this.m_tile.isVisible&&this.m_animatedExtrusionState!==a.None&&(this.m_animatedExtrusionState=a.None,this.stopExtrusionAnimation()),!0===this.m_tile.isVisible&&this.m_animatedExtrusionState===a.None&&this.startExtrusionAnimationIfNeeded(e)}getChildTiles(e){const t=[];return e.forEach(e=>{const r=this.tile.dataSource.getTilingScheme().getSubTileKeys(e);for(const e of r)t.push(e)}),t}startExtrusionAnimationIfNeeded(e){const{quadTreeSearchDistanceUp:t,quadTreeSearchDistanceDown:r}=this.tile.mapView.visibleTileSet.options,i=this.m_tile;let n;if(void 0!==e){let o;if(e<0){let e=0,t=[i.tileKey];for(;r>e&&void 0===n;){const r=this.getChildTiles(t);if(void 0!==r){if(void 0!==(o=this.m_animatedExtrusionHandler.find(r))){n=o.m_animatedExtrusionStartTime;break}t=r}e++}}if(e>0){let e=0,r=i.tileKey;for(;t>e&&void 0===n&&0!==r.level;){const t=r.parent();if(void 0!==(o=this.m_animatedExtrusionHandler.find([t]))){n=o.m_animatedExtrusionStartTime;break}r=t,e++}}}this.startExtrusionAnimation(n)}startExtrusionAnimation(e){this.m_animatedExtrusionState=a.Started,this.m_animatedExtrusionStartTime=e,this.animateExtrusion(),this.m_mapView.addEventListener(o.MapViewEventNames.AfterRender,this.animateExtrusion)}stopExtrusionAnimation(){this.m_mapView.removeEventListener(o.MapViewEventNames.AfterRender,this.animateExtrusion)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=r(338),o=r(0),a=r(339),s=r(340);function c(e,t){return e*t.maximum}var l,u,d;!function(e){e.updateDisplacementFeature=function(e){e.needsUpdate=!0,void 0===e.defines&&(e.defines={}),void 0!==e.displacementMap&&(e.displacementMap.needsUpdate=!0,e.defines.USE_DISPLACEMENTMAP="")},e.onBeforeCompile=function(e,t){if(void 0===e.displacementMap)return;const r=t.uniforms;r.displacementMap={value:e.displacementMap},r.displacementScale={value:1},r.displacementBias={value:0},t.vertexShader=t.vertexShader.replace("#include <skinbase_vertex>","#include <skinbase_vertex>\n#ifndef USE_ENVMAP\n    vec3 objectNormal = vec3( normal );\n#endif"),t.vertexShader=n.insertShaderInclude(t.vertexShader,"uv2_pars_vertex","displacementmap_pars_vertex"),t.vertexShader=n.insertShaderInclude(t.vertexShader,"skinning_vertex","displacementmap_vertex",!0)}}(l=t.DisplacementFeature||(t.DisplacementFeature={}));class h{getDisplacementMap(){return this.m_displacementMap}setDisplacementMap(e){this.needsUpdate=this.needsUpdate||e!==this.m_displacementMap,this.m_displacementMap=e,this.needsUpdate&&l.updateDisplacementFeature(this)}addDisplacementProperties(){Object.defineProperty(this,"displacementMap",{get:()=>this.getDisplacementMap(),set:e=>{this.setDisplacementMap(e)}})}applyDisplacementParameters(e){void 0!==e&&void 0!==e.displacementMap&&this.setDisplacementMap(e.displacementMap),this.onBeforeCompile=e=>{l.onBeforeCompile(this,e)}}copyDisplacementParameters(e){return this.setDisplacementMap(e.displacementMap),this}}t.DisplacementFeatureMixin=h,function(e){e.DEFAULT_FADE_NEAR=-1,e.DEFAULT_FADE_FAR=-1,e.patchGlobalShaderChunks=function(){void 0===o.ShaderChunk.fading_pars_vertex&&Object.assign(o.ShaderChunk,s.default)},e.updateDistanceFadeFeature=function(e){e.needsUpdate=!0,void 0===e.defines&&(e.defines={}),void 0!==e.fadeFar&&e.fadeFar>0&&(e.defines.FADING_MATERIAL="")},e.onBeforeCompile=function(e,t){if(void 0===e.fadeFar||e.fadeFar<=0)return;const r=t.uniforms;r.fadeNear={value:e.fadeNear},r.fadeFar={value:e.fadeFar},t.vertexShader=n.insertShaderInclude(t.vertexShader,"fog_pars_vertex","fading_pars_vertex"),t.vertexShader=n.insertShaderInclude(t.vertexShader,"fog_vertex","fading_vertex",!0),t.fragmentShader=n.insertShaderInclude(t.fragmentShader,"fog_pars_fragment","fading_pars_fragment"),t.fragmentShader=n.insertShaderInclude(t.fragmentShader,"fog_fragment","fading_fragment",!0)},e.addRenderHelper=function(t,r,n,o,a,s,l){t.onBeforeRender=i.chainCallbacks(t.onBeforeRender,(t,i,u,d,h,m)=>{a&&(h.transparent=!0);const p=h;if(p.fadeNear=void 0===n?e.DEFAULT_FADE_NEAR:c(n,r),p.fadeFar=void 0===o?e.DEFAULT_FADE_FAR:c(o,r),s){const e=t.properties.get(h);void 0!==e.shader&&void 0!==e.shader.uniforms.fadeNear&&(e.shader.uniforms.fadeNear.value=p.fadeNear,e.shader.uniforms.fadeFar.value=p.fadeFar,p.uniformsNeedUpdate=!0)}void 0!==l&&l(t,h)}),a&&(t.onAfterRender=(e,t,r,i,n)=>{n.transparent=!1})}}(u=t.FadingFeature||(t.FadingFeature={}));class m{constructor(){this.m_fadeNear=u.DEFAULT_FADE_NEAR,this.m_fadeFar=u.DEFAULT_FADE_FAR}getFadeNear(){return this.m_fadeNear}setFadeNear(e){this.needsUpdate=this.needsUpdate||e!==this.m_fadeNear,this.m_fadeNear=e,this.needsUpdate&&u.updateDistanceFadeFeature(this)}getFadeFar(){return this.m_fadeFar}setFadeFar(e){this.needsUpdate=this.needsUpdate||e!==this.m_fadeFar,this.m_fadeFar=e,this.needsUpdate&&u.updateDistanceFadeFeature(this)}addFadingProperties(){Object.defineProperty(this,"fadeNear",{get:()=>this.getFadeNear(),set:e=>{this.setFadeNear(e)}}),Object.defineProperty(this,"fadeFar",{get:()=>this.getFadeFar(),set:e=>{this.setFadeFar(e)}})}applyFadingParameters(e){void 0!==e&&(void 0!==e.fadeNear&&this.setFadeNear(e.fadeNear),void 0!==e.fadeFar&&this.setFadeFar(e.fadeFar)),this.onBeforeCompile=e=>{u.onBeforeCompile(this,e)}}copyFadingParameters(e){return this.setFadeNear(void 0===e.fadeNear?u.DEFAULT_FADE_NEAR:e.fadeNear),this.setFadeFar(void 0===e.fadeFar?u.DEFAULT_FADE_FAR:e.fadeFar),this}}t.FadingFeatureMixin=m,function(e){e.DEFAULT_RATIO_MIN=.001,e.DEFAULT_RATIO_MAX=1,e.patchGlobalShaderChunks=function(){void 0===o.ShaderChunk.extrusion_pars_vertex&&Object.assign(o.ShaderChunk,a.default)},e.updateExtrusionFeature=function(t){t.needsUpdate=!0,void 0===t.defines&&(t.defines={}),void 0!==t.extrusionRatio&&t.extrusionRatio>=e.DEFAULT_RATIO_MIN&&(t.defines.EXTRUSION_MATERIAL="")},e.onBeforeCompile=function(e,t){if(void 0===e.extrusionRatio)return;t.uniforms.extrusionRatio={value:e.extrusionRatio},t.vertexShader=n.insertShaderInclude(t.vertexShader,"common","extrusion_pars_vertex"),t.vertexShader=n.insertShaderInclude(t.vertexShader,"begin_vertex","extrusion_vertex",!0),t.fragmentShader=n.insertShaderInclude(t.fragmentShader,"fog_pars_fragment","extrusion_pars_fragment"),t.fragmentShader=t.fragmentShader.replace("#include <normal_fragment_begin>","#include <extrusion_normal_fragment_begin>"),t.fragmentShader=n.insertShaderInclude(t.fragmentShader,"fog_fragment","extrusion_fragment",!0)},e.addRenderHelper=function(t){t.onBeforeRender=i.chainCallbacks(t.onBeforeRender,e.onBeforeRender)},e.onBeforeRender=function(t,r,i,n,o,a){const s=o,c=t.properties.get(o);void 0!==c.shader&&void 0!==c.shader.uniforms.extrusionRatio&&(c.shader.uniforms.extrusionRatio.value=s.extrusionRatio||e.DEFAULT_RATIO_MAX,s.uniformsNeedUpdate=!0)}}(d=t.ExtrusionFeature||(t.ExtrusionFeature={}));class p{constructor(){this.m_extrusion=d.DEFAULT_RATIO_MAX}getExtrusionRatio(){return this.m_extrusion}setExtrusionRatio(e){this.needsUpdate=this.needsUpdate||e!==this.m_extrusion,this.m_extrusion=e,this.needsUpdate&&d.updateExtrusionFeature(this)}addExtrusionProperties(){Object.defineProperty(this,"extrusionRatio",{get:()=>this.getExtrusionRatio(),set:e=>{this.setExtrusionRatio(e)}})}applyExtrusionParameters(e){void 0!==e&&void 0!==e.extrusionRatio&&this.setExtrusionRatio(e.extrusionRatio),this.onBeforeCompile=e=>{d.onBeforeCompile(this,e)}}copyExtrusionParameters(e){return void 0!==e.extrusionRatio&&this.setExtrusionRatio(e.extrusionRatio),this}}t.ExtrusionFeatureMixin=p;class f extends o.MeshBasicMaterial{constructor(e){super(e),u.patchGlobalShaderChunks(),this.addFadingProperties(),this.applyFadingParameters(e),d.patchGlobalShaderChunks(),this.addExtrusionProperties(),this.applyExtrusionParameters(e),this.addDisplacementProperties(),this.applyDisplacementParameters(e)}clone(){return(new f).copy(this)}copy(e){return super.copy(e),this.copyFadingParameters(e),this.copyExtrusionParameters(e),this.copyDisplacementParameters(e),this}get fadeNear(){return u.DEFAULT_FADE_NEAR}set fadeNear(e){}get fadeFar(){return u.DEFAULT_FADE_FAR}set fadeFar(e){}get extrusionRatio(){return d.DEFAULT_RATIO_MAX}set extrusionRatio(e){}get displacementMap(){}set displacementMap(e){}addFadingProperties(){}applyFadingParameters(e){}copyFadingParameters(e){}addExtrusionProperties(){}applyExtrusionParameters(e){}copyExtrusionParameters(e){}addDisplacementProperties(){}applyDisplacementParameters(e){}copyDisplacementParameters(e){}}t.MapMeshBasicMaterial=f;class g extends o.MeshStandardMaterial{constructor(e){super(e),u.patchGlobalShaderChunks(),this.addFadingProperties(),this.applyFadingParameters(e),d.patchGlobalShaderChunks(),this.addExtrusionProperties(),this.applyExtrusionParameters(e)}clone(){return(new g).copy(this)}copy(e){return super.copy(e),this.copyFadingParameters(e),this.copyExtrusionParameters(e),this}get fadeNear(){return u.DEFAULT_FADE_NEAR}set fadeNear(e){}get fadeFar(){return u.DEFAULT_FADE_FAR}set fadeFar(e){}get extrusionRatio(){return d.DEFAULT_RATIO_MAX}set extrusionRatio(e){}addFadingProperties(){}applyFadingParameters(e){}copyFadingParameters(e){}addExtrusionProperties(){}applyExtrusionParameters(e){}copyExtrusionParameters(e){}}t.MapMeshStandardMaterial=g,i.applyMixinsWithoutProperties(f,[m]),i.applyMixinsWithoutProperties(g,[m]),i.applyMixinsWithoutProperties(f,[p]),i.applyMixinsWithoutProperties(g,[p]),i.applyMixinsWithoutProperties(f,[h])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={extrude_line_vert_func:"\nvec3 extrudeLine(\n        in vec3 vertexPosition,\n        in float linePosition,\n        in float lineWidth,\n        in vec4 bitangent,\n        in vec3 tangent,\n        inout vec2 uv\n    ) {\n    vec3 result = vertexPosition;\n    // Retrieve the angle between this segment and the previous one (stored in the bitangent w\n    // component).\n    float angle = bitangent.w;\n    // Extrude according to the angle between segments to properly render narrow joints...\n    if (angle != 0.0) {\n        result += uv.y * lineWidth * bitangent.xyz / cos(angle / 2.0);\n        uv.x = linePosition + uv.x * lineWidth * uv.y * tan(angle / 2.0);\n    }\n    // ... or extrude in a simple manner for segments that keep the same direction.\n    else {\n        result += uv.y * lineWidth * bitangent.xyz + uv.x * lineWidth * tangent;\n        uv.x = linePosition + uv.x * lineWidth;\n    }\n    uv.y *= lineWidth;\n    return result;\n}\n",round_edges_and_add_caps:"\nfloat roundEdgesAndAddCaps(in vec4 coords, in vec3 range) {\n    // Compute the line's width to length ratio.\n    float widthRatio = range.y / range.x;\n\n    // Compute the inner segment distance (same for all cap mode).\n    float dist = abs(coords.y);\n    float segmentBeginMask = clamp(ceil(coords.z - coords.x), 0.0, 1.0);\n    float segmentEndMask = clamp(ceil(coords.x - coords.w), 0.0, 1.0);\n    dist = max(dist, segmentBeginMask * length(vec2((coords.x - coords.z) / widthRatio, coords.y)));\n    dist = max(dist, segmentEndMask * length(vec2((coords.x - coords.w) / widthRatio, coords.y)));\n\n    #if !defined(CAPS_ROUND)\n    // Compute the caps mask.\n    float capRangeMask = clamp(1.0 - ceil(range.z - 1.0), 0.0, 1.0);\n    float beginCapMask = clamp(ceil(0.0 - coords.x), 0.0, 1.0);\n    float endCapMask = clamp(ceil(coords.x - 1.0), 0.0, 1.0);\n    float capMask = capRangeMask * max(beginCapMask, endCapMask);\n\n    // Compute the outer segment distance (specific for each cap mode).\n    float capDist = max(coords.x - 1.0, -coords.x) / widthRatio;\n    #if defined(CAPS_NONE)\n    dist = mix(dist, max(abs(coords.y), (capDist + 0.1) / 0.1), capMask);\n    #elif defined(CAPS_SQUARE)\n    dist = mix(dist, max(abs(coords.y), capDist), capMask);\n    #elif defined(CAPS_TRIANGLE_OUT)\n    dist = mix(dist, abs(coords.y) + capDist, capMask);\n    #elif defined(CAPS_TRIANGLE_IN)\n    dist = mix(dist, max(abs(coords.y), (capDist - abs(coords.y)) + capDist), capMask);\n    #endif\n    #endif\n\n    return dist;\n}\n",tile_clip_func:"\nvoid tileClip(vec2 tilePos, vec2 tileSize) {\n    if (tileSize.x > 0.0 && (tilePos.x < -tileSize.x / 2.0 || tilePos.x > tileSize.x / 2.0))\n        discard;\n    if (tileSize.y > 0.0 && (tilePos.y < -tileSize.y / 2.0 || tilePos.y > tileSize.y / 2.0))\n        discard;\n}\n",high_precision_vert_func:"\nvec3 subtractDblEyePos( const in vec3 pos ) {\n    vec3 t1 = positionLow - u_eyepos_lowpart;\n    vec3 e = t1 - positionLow;\n    vec3 t2 = ((-u_eyepos_lowpart - e) + (positionLow - (t1 - e))) + pos - u_eyepos;\n    vec3 high_delta = t1 + t2;\n    vec3 low_delta = t2 - (high_delta - t1);\n    return (high_delta + low_delta);\n}\n"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=r(0),o={type:"update"};class a extends n.EventDispatcher{constructor(e,t,r,i,n){super(),this.enabled=!0,this.cacheable=!1,this.useGeometryLoader=!1,this.addGroundPlane=!1,this.m_minZoomLevel=1,this.m_maxZoomLevel=20,this.m_maxGeometryHeight=0,this.m_storageLevelOffset=0,void 0!==e&&0!==e.length||(e=`anonymous-datasource#${++a.uniqueNameCounter}`),this.name=e,this.styleSetName=t,void 0!==r&&(this.m_minZoomLevel=r),void 0!==i&&(this.m_maxZoomLevel=i),void 0!==n&&(this.m_storageLevelOffset=n)}get styleSetName(){return this.m_styleSetName}set styleSetName(e){this.m_styleSetName=e,void 0!==this.m_mapView&&void 0!==e&&this.setTheme(this.m_mapView.theme)}dispose(){}clearCache(){}ready(){return!0}get mapView(){if(void 0===this.m_mapView)throw new Error("This DataSource was not added to MapView");return this.m_mapView}get projection(){return this.mapView.projection}async connect(){}attach(e){this.m_mapView=e}detach(e){i.assert(this.m_mapView===e),this.m_mapView=void 0}setStyleSet(e,t,r){}setTheme(e,t){}setLanguages(e){}updateTile(e){}shouldPreloadTiles(){return!1}get minZoomLevel(){return this.m_minZoomLevel}set minZoomLevel(e){this.m_minZoomLevel=e}get maxZoomLevel(){return this.m_maxZoomLevel}set maxZoomLevel(e){this.m_maxZoomLevel=e}get maxGeometryHeight(){return this.m_maxGeometryHeight}set maxGeometryHeight(e){this.m_maxGeometryHeight=e}get storageLevelOffset(){return this.m_storageLevelOffset}set storageLevelOffset(e){this.m_storageLevelOffset=e}setEnableElevationOverlay(e){}getDisplayZoomLevel(e){return n.Math.clamp(e+this.m_storageLevelOffset,this.m_minZoomLevel,this.m_maxZoomLevel)}shouldRender(e,t){return t.level===e}shouldSubdivide(e,t){return t.level<=e}shouldRenderText(e,t){return!0}requestUpdate(){this.dispatchEvent(o)}}t.DataSource=a,a.uniqueNameCounter=0},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(46);class o{constructor(e,t,r,o,a,s,c,l,u,d,h,m,p){this.codePoint=e,this.block=t,this.width=r,this.height=o,this.advanceX=a,this.offsetX=s,this.offsetY=c,this.texture=m,this.font=p,this.positions=[],this.sourceTextureCoordinates=[],this.dynamicTextureCoordinates=[],this.copyIndex=0,this.isInCache=!1,this.character=String.fromCodePoint(e),this.direction=n.UnicodeUtils.getDirection(e,t);const f=this.offsetX,g=f+this.width,y=p.metrics.lineHeight-this.offsetY,v=y-this.height;this.positions.push(new i.Vector3(f,v,1),new i.Vector3(g,v,1),new i.Vector3(f,y,1),new i.Vector3(g,y,1)),this.sourceTextureCoordinates.push(new i.Vector2(l,u),new i.Vector2(d,u),new i.Vector2(l,h),new i.Vector2(d,h)),this.dynamicTextureCoordinates.push(new i.Vector2(0,0),new i.Vector2(1,0),new i.Vector2(0,1),new i.Vector2(1,1))}clone(){return new o(this.codePoint,this.block,this.width,this.height,this.advanceX,this.offsetX,this.offsetY,this.sourceTextureCoordinates[0].x,this.sourceTextureCoordinates[0].y,this.sourceTextureCoordinates[3].x,this.sourceTextureCoordinates[3].y,this.texture,this.font)}}t.GlyphData=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);t.MAX_CAPACITY=65536,t.VERTEX_BUFFER_STRIDE=16,t.INDEX_BUFFER_STRIDE=1,t.VERTICES_PER_QUAD=4,t.INDICES_PER_QUAD=6,t.QUAD_VERTEX_MEMORY_FOOTPRINT=t.VERTICES_PER_QUAD*t.VERTEX_BUFFER_STRIDE,t.QUAD_INDEX_MEMORY_FOOTPRINT=t.INDICES_PER_QUAD*t.INDEX_BUFFER_STRIDE;const n=4,o=4;t.TextGeometry=class{constructor(e,r,n,o,a){this.scene=e,this.capacity=Math.min(a,t.MAX_CAPACITY),this.m_currentCapacity=Math.min(o,a),this.m_drawCount=0,this.m_updateOffset=0,this.m_pickingCount=0,this.m_vertexBuffer=new i.InterleavedBuffer(new Float32Array(this.m_currentCapacity*t.QUAD_VERTEX_MEMORY_FOOTPRINT),t.VERTEX_BUFFER_STRIDE),this.m_vertexBuffer.setUsage(i.DynamicDrawUsage),this.m_positionAttribute=new i.InterleavedBufferAttribute(this.m_vertexBuffer,4,0),this.m_uvAttribute=new i.InterleavedBufferAttribute(this.m_vertexBuffer,4,4),this.m_colorAttribute=new i.InterleavedBufferAttribute(this.m_vertexBuffer,4,8),this.m_bgColorAttribute=new i.InterleavedBufferAttribute(this.m_vertexBuffer,4,12),this.m_indexBuffer=new i.BufferAttribute(new Uint32Array(this.m_currentCapacity*t.QUAD_INDEX_MEMORY_FOOTPRINT),t.INDEX_BUFFER_STRIDE),this.m_indexBuffer.setUsage(i.DynamicDrawUsage),this.m_geometry=new i.BufferGeometry,this.m_geometry.setAttribute("position",this.m_positionAttribute),this.m_geometry.setAttribute("uv",this.m_uvAttribute),this.m_geometry.setAttribute("color",this.m_colorAttribute),this.m_geometry.setAttribute("bgColor",this.m_bgColorAttribute),this.m_geometry.setIndex(this.m_indexBuffer),this.m_pickingDataArray=new Array(this.m_currentCapacity),this.m_mesh=new i.Mesh(this.m_geometry,r),this.m_bgMesh=new i.Mesh(this.m_geometry,n),this.m_mesh.renderOrder=Number.MAX_SAFE_INTEGER,this.m_bgMesh.renderOrder=Number.MAX_SAFE_INTEGER-1,this.m_mesh.frustumCulled=!1,this.m_bgMesh.frustumCulled=!1,this.scene.add(this.m_bgMesh,this.m_mesh)}get drawCount(){return this.m_drawCount}get mesh(){return this.m_mesh}get backgroundMesh(){return this.m_bgMesh}dispose(){this.scene.remove(this.m_bgMesh,this.m_mesh),this.m_geometry.dispose()}clear(){this.m_drawCount=0,this.m_updateOffset=0,this.m_pickingCount=0}update(){this.drawCount>this.m_updateOffset&&(this.m_vertexBuffer.needsUpdate=!0,this.m_vertexBuffer.updateRange.offset=this.m_updateOffset*t.QUAD_VERTEX_MEMORY_FOOTPRINT,this.m_vertexBuffer.updateRange.count=(this.m_drawCount-this.m_updateOffset)*t.QUAD_VERTEX_MEMORY_FOOTPRINT,this.m_indexBuffer.needsUpdate=!0,this.m_indexBuffer.updateRange.offset=this.m_updateOffset*t.QUAD_INDEX_MEMORY_FOOTPRINT,this.m_indexBuffer.updateRange.count=(this.m_drawCount-this.m_updateOffset)*t.QUAD_INDEX_MEMORY_FOOTPRINT),this.m_updateOffset=this.m_drawCount,this.m_geometry.setDrawRange(0,this.m_drawCount*t.INDICES_PER_QUAD)}add(e,r,i,n,o,a){if(this.m_drawCount>=this.capacity)return!1;if(this.m_drawCount>=this.m_currentCapacity){const e=Math.min(2*this.m_currentCapacity,this.capacity);this.resizeBuffers(e)}const s=this.m_drawCount*t.VERTICES_PER_QUAD,c=this.m_drawCount*t.INDICES_PER_QUAD;for(let c=0;c<t.VERTICES_PER_QUAD;++c){this.m_positionAttribute.setXYZW(s+c,r[c].x,r[c].y,r[c].z,(o?-1:1)*a.rotation);const t=o?(c+1)%2+2*Math.floor(c/2):c;this.m_uvAttribute.setXYZW(s+c,e.dynamicTextureCoordinates[t].x,e.dynamicTextureCoordinates[t].y,i,n),this.m_colorAttribute.setXYZW(s+c,a.color.r,a.color.g,a.color.b,a.opacity),this.m_bgColorAttribute.setXYZW(s+c,a.backgroundColor.r,a.backgroundColor.g,a.backgroundColor.b,a.backgroundOpacity)}return this.m_indexBuffer.setX(c,s),this.m_indexBuffer.setX(c+1,s+1),this.m_indexBuffer.setX(c+2,s+2),this.m_indexBuffer.setX(c+3,s+2),this.m_indexBuffer.setX(c+4,s+1),this.m_indexBuffer.setX(c+5,s+3),++this.m_drawCount,!0}addToBuffer(e,r,i,n,o,a,s,c){for(let l=0;l<t.VERTICES_PER_QUAD;++l){const u=r+t.VERTEX_BUFFER_STRIDE*l;e[u]=n[l].x,e[u+1]=n[l].y,e[u+2]=n[l].z,e[u+3]=(s?-1:1)*c.rotation;const d=s?(l+1)%2+2*Math.floor(l/2):l;e[u+4]=i.dynamicTextureCoordinates[d].x,e[u+5]=i.dynamicTextureCoordinates[d].y,e[u+6]=o,e[u+7]=a,e[u+8]=c.color.r,e[u+9]=c.color.g,e[u+10]=c.color.b,e[u+11]=c.opacity,e[u+12]=c.backgroundColor.r,e[u+13]=c.backgroundColor.g,e[u+14]=c.backgroundColor.b,e[u+15]=c.backgroundOpacity}}addTextBufferObject(e,r,i,n,o,a,s,c){if(this.m_drawCount+e.glyphs.length>=this.capacity)return!1;if(this.m_drawCount+e.glyphs.length>=this.m_currentCapacity){const e=Math.min(2*this.m_currentCapacity,this.capacity);this.resizeBuffers(e)}const l=i||1,u=n||0,d=Math.cos(u),h=Math.sin(u),m=void 0!==r?r.x:0,p=void 0!==r?r.y:0,f=void 0!==r?r.z:0,g=e.buffer,y=g[3]<0?-1:1,v=void 0!==o?o.r:g[8],_=void 0!==o?o.g:g[9],b=void 0!==o?o.b:g[10],S=void 0!==a?a:g[11],T=void 0!==s?s.r:g[12],E=void 0!==s?s.g:g[13],w=void 0!==s?s.b:g[14],C=void 0!==c?c:g[15],x=this.m_drawCount*t.VERTICES_PER_QUAD;for(let r=0;r<e.glyphs.length;++r){const i=r*t.QUAD_VERTEX_MEMORY_FOOTPRINT,n=e.glyphs[r];if(!n.isInCache)return!1;const o=g[i+4]>g[i+t.VERTEX_BUFFER_STRIDE+4],a=g[i+6],s=g[i+7];for(let e=0;e<t.VERTICES_PER_QUAD;++e){const c=g[i+e*t.VERTEX_BUFFER_STRIDE],O=g[i+e*t.VERTEX_BUFFER_STRIDE+1];this.m_positionAttribute.setXYZW(x+r*t.VERTICES_PER_QUAD+e,c*l*d+O*l*-h+m,c*l*h+O*l*d+p,g[i+e*t.VERTEX_BUFFER_STRIDE+2]+f,g[i+e*t.VERTEX_BUFFER_STRIDE+3]+y*u);const A=o?(e+1)%2+2*Math.floor(e/2):e;this.m_uvAttribute.setXYZW(x+r*t.VERTICES_PER_QUAD+e,n.dynamicTextureCoordinates[A].x,n.dynamicTextureCoordinates[A].y,a,(s-a)/l+a),this.m_colorAttribute.setXYZW(x+r*t.VERTICES_PER_QUAD+e,v,_,b,S),this.m_bgColorAttribute.setXYZW(x+r*t.VERTICES_PER_QUAD+e,T,E,w,C)}this.m_indexBuffer.setX((this.m_drawCount+r)*t.INDICES_PER_QUAD,(this.m_drawCount+r)*t.VERTICES_PER_QUAD),this.m_indexBuffer.setX((this.m_drawCount+r)*t.INDICES_PER_QUAD+1,(this.m_drawCount+r)*t.VERTICES_PER_QUAD+1),this.m_indexBuffer.setX((this.m_drawCount+r)*t.INDICES_PER_QUAD+2,(this.m_drawCount+r)*t.VERTICES_PER_QUAD+2),this.m_indexBuffer.setX((this.m_drawCount+r)*t.INDICES_PER_QUAD+3,(this.m_drawCount+r)*t.VERTICES_PER_QUAD+2),this.m_indexBuffer.setX((this.m_drawCount+r)*t.INDICES_PER_QUAD+4,(this.m_drawCount+r)*t.VERTICES_PER_QUAD+1),this.m_indexBuffer.setX((this.m_drawCount+r)*t.INDICES_PER_QUAD+5,(this.m_drawCount+r)*t.VERTICES_PER_QUAD+3)}return this.m_drawCount+=e.glyphs.length,!0}addPickingData(e,t,r){return!(this.m_pickingCount>=this.m_currentCapacity)&&(this.m_pickingDataArray[this.m_pickingCount]={start:Math.min(e,this.capacity),end:Math.min(t,this.capacity),data:r},++this.m_pickingCount,!0)}pick(e,r){for(const i of this.m_pickingDataArray){if(void 0===i)return;for(let n=i.start;n<i.end;++n){const o=n*t.VERTICES_PER_QUAD,a=Math.min(this.m_positionAttribute.getX(o+2),this.m_positionAttribute.getX(o+1));if(e.x<a)continue;const s=Math.max(this.m_positionAttribute.getX(o+2),this.m_positionAttribute.getX(o+1));if(e.x>s)continue;const c=Math.min(this.m_positionAttribute.getY(o+2),this.m_positionAttribute.getY(o+1));if(e.y<c)continue;const l=Math.max(this.m_positionAttribute.getY(o+2),this.m_positionAttribute.getY(o+1));if(!(e.y>l)){r(i.data);break}}}}updateMemoryUsage(e){const t=this.m_vertexBuffer.count*n+this.m_indexBuffer.count*o;e.heapSize+=t,e.gpuSize+=t}resizeBuffers(e){this.m_currentCapacity=e;const r=new Float32Array(e*t.QUAD_VERTEX_MEMORY_FOOTPRINT);r.set(this.m_vertexBuffer.array),this.m_vertexBuffer=new i.InterleavedBuffer(r,t.VERTEX_BUFFER_STRIDE),this.m_vertexBuffer.setUsage(i.DynamicDrawUsage),this.m_positionAttribute=new i.InterleavedBufferAttribute(this.m_vertexBuffer,4,0),this.m_uvAttribute=new i.InterleavedBufferAttribute(this.m_vertexBuffer,4,4),this.m_colorAttribute=new i.InterleavedBufferAttribute(this.m_vertexBuffer,4,8),this.m_bgColorAttribute=new i.InterleavedBufferAttribute(this.m_vertexBuffer,4,12);const n=new Uint32Array(e*t.QUAD_INDEX_MEMORY_FOOTPRINT);n.set(this.m_indexBuffer.array),this.m_indexBuffer=new i.BufferAttribute(n,t.INDEX_BUFFER_STRIDE),this.m_indexBuffer.setUsage(i.DynamicDrawUsage),this.m_geometry.dispose(),this.m_geometry=new i.BufferGeometry,this.m_geometry.setAttribute("position",this.m_positionAttribute),this.m_geometry.setAttribute("uv",this.m_uvAttribute),this.m_geometry.setAttribute("color",this.m_colorAttribute),this.m_geometry.setAttribute("bgColor",this.m_bgColorAttribute),this.m_geometry.setIndex(this.m_indexBuffer),this.m_pickingDataArray.length=this.m_currentCapacity,this.scene.remove(this.m_bgMesh,this.m_mesh),this.m_mesh=new i.Mesh(this.m_geometry,this.m_mesh.material),this.m_bgMesh=new i.Mesh(this.m_geometry,this.m_bgMesh.material),this.m_mesh.renderOrder=Number.MAX_SAFE_INTEGER,this.m_bgMesh.renderOrder=Number.MAX_SAFE_INTEGER-1,this.m_mesh.frustumCulled=!1,this.m_bgMesh.frustumCulled=!1,this.scene.add(this.m_bgMesh,this.m_mesh)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(33),o=r(46);!function(e){e.EM_TO_PX=16,e.PT_TO_PX=1.25,e.OBLIQUE_ANGLE=.174533,e.OBLIQUE_OFFSET=Math.tan(e.OBLIQUE_ANGLE),e.getPixelSize=function(t,r,i){let o=t;switch(r){case n.FontUnit.Em:o*=e.EM_TO_PX;break;case n.FontUnit.Point:o*=e.PT_TO_PX;break;case n.FontUnit.Percent:o*=.01*i}return o},e.getSmallCapsScale=function(e,t,r,i){return t[r]&&i===n.FontVariant.SmallCaps?e[r].font.metrics.xHeight/e[r].font.metrics.capHeight:1},e.getDirection=function(e,t){let r=o.UnicodeUtils.Direction.LTR,i=t;for(;e[i].direction!==o.UnicodeUtils.Direction.LTR&&e[i].direction!==o.UnicodeUtils.Direction.RTL&&i<e.length-1;)++i;return 1===Math.abs(e[i].direction)&&(r=e[i].direction),r},e.computeGlyphTransform=function(e,t,r,i,n){const o=Math.cos(i),a=Math.sin(i),s=Math.cos(n),c=Math.sin(n);e.set(r*s,r*-c,o*t.x-a*t.y,r*c,r*s,a*t.x+o*t.y,0,0,1)},e.updateBounds=function(e,t,r){const n=Math.min(e[0].x,e[1].x,e[2].x,e[3].x),o=Math.max(e[0].x,e[1].x,e[2].x,e[3].x),a=Math.min(e[0].y,e[1].y,e[2].y,e[3].y),s=Math.max(e[0].y,e[1].y,e[2].y,e[3].y);void 0!==r&&(void 0!==r.array[r.offset]?(r.array[r.offset].min.set(n,a),r.array[r.offset].max.set(o,s)):r.array.push(new i.Box2(new i.Vector2(n,a),new i.Vector2(o,s))),++r.offset),t.min.set(Math.min(t.min.x,n),Math.min(t.min.y,a)),t.max.set(Math.max(t.max.x,o),Math.max(t.max.y,s))}}(t.TypesettingUtils||(t.TypesettingUtils={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(9),o=r(1),a=r(0),s=r(92),c=r(152),l=o.LoggerManager.instance.create("DecodedTileHelpers"),u=[...i.TEXTURE_PROPERTY_KEYS,"mapProperties","normalMapProperties","displacementMapProperties","roughnessMapProperties","emissiveMapProperties","alphaMapProperties","metalnessMapProperties","bumpMapProperties"];function d(e){if(void 0!==e.name)switch(e.name){case"extruded-line":if(!i.isExtrudedLineTechnique(e))throw new Error("Invalid extruded-line technique");return"standard"===e.shading?n.MapMeshStandardMaterial:n.MapMeshBasicMaterial;case"standard":case"terrain":case"extruded-polygon":return n.MapMeshStandardMaterial;case"solid-line":return n.SolidLineMaterial;case"dashed-line":return n.DashedLineMaterial;case"fill":return n.MapMeshBasicMaterial;case"squares":return a.PointsMaterial;case"circles":return n.CirclePointsMaterial;case"line":case"segments":return a.LineBasicMaterial;case"shader":return a.ShaderMaterial;case"text":case"labeled-icon":case"line-marker":case"label-rejection-line":return}}function h(e,r,n,o){Object.getOwnPropertyNames(e).forEach(s=>{if(s.startsWith("_")||-1!==t.BASE_TECHNIQUE_NON_MATERIAL_PROPS.indexOf(s)||-1!==u.indexOf(s)||void 0!==o&&-1!==o.indexOf(s))return;const c=s,l=r;let d=e[c];void 0!==l[c]&&(void 0!==n&&i.isInterpolatedProperty(d)&&(d=i.getPropertyValue(d,n)),l[c]instanceof a.Color?(l[c].set(d),l[c]=l[c]):l[c]=d)})}t.createMaterial=function(e,t){const r=e.technique,o=d(r),s={};if(void 0===o)return;o.prototype instanceof a.RawShaderMaterial&&o!==n.HighPrecisionLineMaterial&&(s.fog=e.fog);const u=new o(s);if(void 0!==r.id&&(u.name=r.id),i.isExtrudedPolygonTechnique(r)&&(u.flatShading=!0),u.depthTest=i.isExtrudedPolygonTechnique(r)&&!1!==r.depthTest,(i.isStandardTechnique(r)||i.isTerrainTechnique(r)||i.isExtrudedPolygonTechnique(r))&&i.TEXTURE_PROPERTY_KEYS.forEach(e=>{const n=r[e];if(void 0===n)return;const o=i=>{const n=r[e+"Properties"];void 0!==n&&(void 0!==n.wrapS&&(i.wrapS=c.toWrappingMode(n.wrapS)),void 0!==n.wrapT&&(i.wrapT=c.toWrappingMode(n.wrapT)),void 0!==n.magFilter&&(i.magFilter=c.toTextureFilter(n.magFilter)),void 0!==n.minFilter&&(i.minFilter=c.toTextureFilter(n.minFilter)),void 0!==n.flipY&&(i.flipY=n.flipY),void 0!==n.repeatU&&(i.repeat.x=n.repeatU),void 0!==n.repeatV&&(i.repeat.y=n.repeatV)),u[e]=i,i.needsUpdate=!0,u.needsUpdate=!0,t&&t(i)},s=e=>{l.error("#createMaterial: Failed to load texture: ",e)};let d;if("string"==typeof n)d=n;else if(i.isTextureBuffer(n))if("image/raw"===n.type){const e=n.dataTextureProperties;if(void 0!==e){const t=e.type?c.toTextureDataType(e.type):void 0,r=function(e,t){if(void 0===t)return new Uint8Array(e);switch(t){case a.UnsignedByteType:return new Uint8Array(e);case a.ByteType:return new Int8Array(e);case a.ShortType:return new Int16Array(e);case a.UnsignedShortType:return new Uint16Array(e);case a.IntType:return new Int32Array(e);case a.UnsignedIntType:return new Uint32Array(e);case a.FloatType:return new Float32Array(e);case a.HalfFloatType:return new Uint16Array(e)}throw new Error("Unsupported texture data type")}(n.buffer,t);o(new a.DataTexture(r,e.width,e.height,e.format?c.toPixelFormat(e.format):void 0,t))}else s("no data texture properties provided.")}else{const e=new Blob([n.buffer],{type:n.type});d=URL.createObjectURL(e)}d&&(new a.TextureLoader).load(d,o,void 0,s)}),i.isShaderTechnique(r)){const e=r.params;Object.getOwnPropertyNames(e).forEach(t=>{const r=t;if("name"===r)return;const i=u;i[r]instanceof a.Color?i[r].set(e[r]):i[r]=e[r]})}else h(r,u,e.level,e.skipExtraProps);return u},t.getBufferAttribute=function(e){switch(e.type){case"float":return new a.BufferAttribute(new Float32Array(e.buffer),e.itemCount);case"uint8":return new a.BufferAttribute(new Uint8Array(e.buffer),e.itemCount,e.normalized);case"uint16":return new a.BufferAttribute(new Uint16Array(e.buffer),e.itemCount,e.normalized);case"uint32":return new a.BufferAttribute(new Uint32Array(e.buffer),e.itemCount,e.normalized);case"int8":return new a.BufferAttribute(new Int8Array(e.buffer),e.itemCount,e.normalized);case"int16":return new a.BufferAttribute(new Int16Array(e.buffer),e.itemCount,e.normalized);case"int32":return new a.BufferAttribute(new Int32Array(e.buffer),e.itemCount,e.normalized);default:throw new Error(`unsupported buffer of type ${e.type}`)}},t.getObjectConstructor=function(e){if(void 0!==e.name)switch(e.name){case"extruded-line":case"standard":case"terrain":case"extruded-polygon":case"fill":case"solid-line":case"dashed-line":return a.Mesh;case"circles":return s.Circles;case"squares":return s.Squares;case"line":case"segments":return a.LineSegments;case"shader":if(!i.isShaderTechnique(e))throw new Error("Invalid technique");switch(e.primitive){case"line":return a.Line;case"segments":return a.LineSegments;case"point":return a.Points;case"mesh":return a.Mesh;default:return}case"text":case"labeled-icon":case"line-marker":case"label-rejection-line":return}},t.BASE_TECHNIQUE_NON_MATERIAL_PROPS=["name","id","renderOrder","renderOrderBiasProperty","renderOrderBiasGroup","renderOrderBiasRange","transient"],t.getMaterialConstructor=d,t.applyTechniqueToMaterial=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);class n extends i.Points{constructor(){super(...arguments),this.enableRayTesting=!0}raycast(e,t){if(!this.enableRayTesting)return;const r=this.geometry,n=this.matrixWorld,a=e.ray.origin.clone().add(e.ray.direction).project(e.mapView.camera),{clientWidth:s,clientHeight:c}=e.mapView.canvas,l=new i.Vector2(Math.ceil((a.x+1)/2*s),Math.ceil((1-a.y)/2*c));if(r instanceof i.BufferGeometry){const a=new i.Vector3,u=r.index,d=r.attributes.position.array;if(null!==u){const r=u.array;for(let i=0,u=r.length;i<u;i++){const u=r[i];a.fromArray(d,3*u);const h=o(a,n,e,s,c);h.pointIsOnScreen&&this.testPoint(a,h.absoluteScreenPosition,l,i,h.distance,t)}}else for(let r=0,i=d.length/3;r<i;r++){a.fromArray(d,3*r);const i=o(a,n,e,s,c);i.pointIsOnScreen&&this.testPoint(a,i.absoluteScreenPosition,l,r,i.distance,t)}}else{const i=r.vertices;for(let r=0;r<i.length;r++){const a=i[r],u=o(a,n,e,s,c);u.pointIsOnScreen&&this.testPoint(a,u.absoluteScreenPosition,l,r,u.distance,t)}}}}function o(e,t,r,n,o){const a=e.clone();a.applyMatrix4(t);const s=a.distanceTo(r.ray.origin);a.project(r.mapView.camera);const c=new i.Vector2(a.x,a.y),l=c.x<1&&c.x>-1&&c.y<1&&c.y>-1;if(l){return a.x=(a.x+1)/2*n,a.y=(1-a.y)/2*o,{absoluteScreenPosition:new i.Vector2(a.x,a.y),pointIsOnScreen:l,distance:s}}return{pointIsOnScreen:l}}t.MapViewPoints=n;t.Circles=class extends n{testPoint(e,t,r,i,n,o){const a=t.x-r.x,s=t.y-r.y;Math.sqrt(a*a+s*s)<=this.material.size/2&&o.push({point:e,distance:n,index:i,object:this})}};t.Squares=class extends n{testPoint(e,t,r,i,n,o){const a=t.x-r.x,s=t.y-r.y,c=this.material.size/2;Math.abs(a)<=c&&Math.abs(s)<=c&&o.push({point:e,distance:n,index:i,object:this})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.PoiLabel=0]="PoiLabel",e[e.PathLabel=1]="PathLabel",e[e.LineMarker=2]="LineMarker"}(t.TextElementType||(t.TextElementType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(1),o=r(48),a=r(63);var s;!function(e){function t(e){let t=e.kind;return void 0===t&&(t=i.isFillTechnique(e)?i.GeometryKind.Area:i.isLineTechnique(e)||i.isDashedLineTechnique(e)||i.isSolidLineTechnique(e)||i.isSegmentsTechnique(e)||i.isExtrudedLineTechnique(e)?i.GeometryKind.Line:i.isExtrudedPolygonTechnique(e)?i.GeometryKind.Building:i.isPoiTechnique(e)||i.isLineMarkerTechnique(e)||i.isTextTechnique(e)?i.GeometryKind.Label:i.GeometryKind.All,e.kind=t),t}e.prepareDecodedTile=function(e){const r=new i.GeometryKindSet;for(const n of e.techniques){let e=n.kind;if(void 0===e&&(e=t(n)),Array.isArray(e)&&(e=new i.GeometryKindSet(e)),e instanceof Set)for(const t of e)r.add(t);else r.add(e)}return r},e.setDefaultGeometryKind=t}(s=t.TileGeometryLoader||(t.TileGeometryLoader={}));t.SimpleTileGeometryLoader=class{constructor(e){this.m_tile=e,this.m_isFinished=!1}get tile(){return this.m_tile}get isFinished(){return this.m_isFinished}get basicGeometryLoaded(){return this.m_tile.hasGeometry}get allGeometryLoaded(){return this.m_isFinished}setDecodedTile(e){return this.m_decodedTile=e,void 0!==this.m_decodedTile&&(this.m_availableGeometryKinds=s.prepareDecodedTile(this.m_decodedTile)),this.m_decodedTile}get availableGeometryKinds(){return this.m_availableGeometryKinds}update(e,t){const r=this.tile;void 0===this.m_decodedTile&&void 0!==r.decodedTile&&(a.TileGeometryCreator.instance.processTechniques(r.decodedTile,e,t),this.setDecodedTile(r.decodedTile),this.prepareForRender(e,t),this.finish())}dispose(){this.m_decodedTile=void 0}reset(){this.m_decodedTile=void 0,this.m_isFinished=!1,void 0!==this.m_availableGeometryKinds&&this.m_availableGeometryKinds.clear(),void 0!==this.m_timeout&&clearTimeout(this.m_timeout)}finish(){this.m_tile.loadingFinished(),this.m_tile.removeDecodedTile(),this.m_isFinished=!0,this.m_timeout=void 0}prepareForRender(e,t){const r=this.tile,i=this.m_decodedTile;this.m_decodedTile=void 0,void 0!==i&&!r.disposed&&r.isVisible&&(this.m_timeout=setTimeout(()=>{const s=o.PerformanceStatistics.instance;if(!r.isVisible)return r.mapView.visibleTileSet.disposeTile(r),void(s.enabled&&s.currentFrame.addMessage(`Decoded tile: ${r.dataSource.name} # lvl=${r.tileKey.level} col=${r.tileKey.column} row=${r.tileKey.row} DISCARDED - invisible`));let c=0;s.enabled&&(c=n.PerformanceTimer.now());const l=a.TileGeometryCreator.instance;if(r.clear(),l.initDecodedTile(i,e,t),l.createAllGeometries(r,i),s.enabled){const e=n.PerformanceTimer.now()-c,t=s.currentFrame;t.addValue("geometry.geometryCreationTime",e),t.addValue("geometryCount.numGeometries",i.geometries.length),t.addValue("geometryCount.numTechniques",i.techniques.length),t.addValue("geometryCount.numPoiGeometries",void 0!==i.poiGeometries?i.poiGeometries.length:0),t.addValue("geometryCount.numTextGeometries",void 0!==i.textGeometries?i.textGeometries.length:0),t.addValue("geometryCount.numTextPathGeometries",void 0!==i.textPathGeometries?i.textPathGeometries.length:0),t.addValue("geometryCount.numPathGeometries",void 0!==i.pathGeometries?i.pathGeometries.length:0),t.addMessage(`Decoded tile: ${r.dataSource.name} # lvl=${r.tileKey.level} col=${r.tileKey.column} row=${r.tileKey.row}`)}this.finish(),r.dataSource.requestUpdate()},0))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(162),n=r(164);class o{static getTileDecoder(e,t,r){const i=this.getWorkerSet(t,r);return new n.WorkerBasedDecoder(i,e)}static getWorkerSet(e,t){void 0===e&&(e=this.defaultScriptUrl);let r=this.workerSets[e];return void 0===r&&(r=new i.ConcurrentWorkerSet({scriptUrl:e,workerCount:void 0===t?this.defaultWorkerCount:t}),this.workerSets[e]=r),r}static destroyWorkerSet(e){const t=this.workerSets[e];void 0!==t&&(t.destroy(),delete this.workerSets[e])}static destroy(){Object.keys(this.workerSets).forEach(e=>{this.workerSets[e].destroy()}),this.workerSets={}}}t.ConcurrentDecoderFacade=o,o.defaultScriptUrl="./decoder.bundle.js",o.defaultWorkerCount=void 0,o.workerSets={}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1);!function(e){e.mergeArrays=function(e,t){const r=[];for(const n of[e,t])if(void 0!==n)for(const e of n){const t=r.find(t=>t.id===e.id||void 0!==t.label&&t.label===e.label);void 0===t?r.push(Object.assign({},e)):(t.year=i.MathUtils.max2(e.year,t.year),t.label=i.getOptionValue(e.label,t.label),t.link=i.getOptionValue(e.link,t.link))}return r},e.formatAsHtml=function(e){if(0===e.length)return"";const t=e.filter(e=>""!==e.label);return 0===t.length?"":" "+t.map(e=>{const t=void 0!==e.label?e.label:e.id,r=void 0!==e.year?`${e.year} ${t}`:t;return e.link?`<a href="${e.link}">${r}</a>`:`${r}`}).join(", ")}}(t.CopyrightInfo||(t.CopyrightInfo={}))},function(e,t,r){"use strict";function i(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),i(r(182)),i(r(98)),i(r(183)),i(r(99))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=new i.Vector3(0,0,1),o=[0,1,2,1,3,2],a=[0,1,3,3,1,2,0,3,4,5,4,3],s=8,c=Math.PI/s;function l(e,t,r,i,n,o){const a=n.length/3;n.push(e,t,0);for(let l=0;l<s+1;++l){const u=c*l+Math.PI/2+r;n.push(e+i*Math.cos(u),t+i*Math.sin(u),0),o.push(a,a+l+1,a+(l+1)%(s+1)+1)}}t.numCirclePoints=function(e){return s+1},t.triangulateLine=function(e,t,r,s,c=!0,u=c){if(e.length<3)return;const d=new i.Vector2;if(c){const i=3!==e.length?d.set(e[3]-e[0],e[4]-e[1]).angle():0;l(e[0],e[1],i,t,r,s)}const h=r.length/3,m=new i.Vector3,p=new i.Vector3,f=new i.Vector3,g=new i.Vector3,y=new i.Vector3,v=new i.Vector3,_=new i.Vector3,b=new i.Vector3,S=new i.Vector3,T=e.length/3;let E=0;for(let i=0;i<T;++i){let c=!1;if(p.set(e[3*i],e[3*i+1],e[3*i+2]),i+1<T){if(f.set(e[3*(i+1)],e[3*(i+1)+1],e[3*(i+1)+2]),g.copy(f).sub(p).normalize().cross(n),y.copy(g),i>0&&(y.add(m).multiplyScalar(1-.5*g.dot(m)),c=m.angleTo(g)>Math.PI/2)){const e=t/Math.cos(g.angleTo(m)/2);v.copy(g).add(m).normalize().multiplyScalar(-e).add(p),_.copy(m).multiplyScalar(t).add(p),b.copy(g).add(m).normalize().multiplyScalar(e).add(p),S.copy(g).multiplyScalar(t).add(p)}c?r.push(v.x,v.y,v.z,_.x,_.y,_.z,b.x,b.y,b.z,S.x,S.y,S.z):(v.copy(y).multiplyScalar(-t).add(p),_.copy(y).multiplyScalar(t).add(p),r.push(v.x,v.y,v.z,_.x,_.y,_.z)),m.copy(g)}else v.copy(m).multiplyScalar(-t).add(p),_.copy(m).multiplyScalar(t).add(p),r.push(v.x,v.y,v.z,_.x,_.y,_.z);i!==T-1&&((c?a:o).forEach(e=>s.push(h+E+e)),E+=c?4:2)}if(u){const i=2!==e.length?d.set(e[3*(T-3)]-e[3*(T-2)],e[3*(T-3)+1]-e[3*(T-2)+1]).angle():Math.PI;l(e[3*(T-2)],e[3*(T-2)+1],i,t,r,s)}},t.reconstructLine=function(e,t){const r=new Float32Array(e.length/2);for(let i=3*t,n=2*i;i<r.length;i+=3,n+=6)r[i]=e[n]+.5*(e[n+3]-e[n]),r[i+1]=e[n+1]+.5*(e[n+3+1]-e[n+1]),r[i+2]=e[n+2]+.5*(e[n+3+2]-e[n+2]);return r},t.reconstructLineWidth=function(e,t){const r=e[2*t+3]-e[2*t],i=e[2*t+3+1]-e[2*t+1],n=e[2*t+3+2]-e[2*t+2];return.5*Math.sqrt(r*r+i*i+n*n)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(9),n=r(0),o=r(183),a=r(381),s=r(98);!function(e){function t(e){return new n.Vector3(Math.fround(e.x),Math.fround(e.y),Math.fround(e.z))}function r(e,r){const i=(new n.Matrix4).copy(e.projectionMatrix).multiply(e.matrixWorldInverse),o=new n.Vector3(0,0,0).applyMatrix4(r),a=t(o);return{viewProjection:i,eyePosHi:a,eyePosLo:t(o.sub(a))}}function c(e){if(e.length>0){const t=e[0];if(null==t)throw Error("Empty element in positions");const r=new Array,i=new Array,o=(...e)=>{for(const t of e){const e=Math.fround(t);i.push(t-e),r.push(e)}},a=e=>{o(e.x,e.y,e.z)};if(void 0!==t.z)e.forEach(e=>{a(e)});else{if(r.length%3!=0)throw Error("Positions must be 3D, not 2D");e.forEach(e=>{o(e)})}return{positionHigh:new n.Float32BufferAttribute(r,3),positionLow:new n.Float32BufferAttribute(i,3)}}return{positionHigh:new n.Float32BufferAttribute([],3),positionLow:new n.Float32BufferAttribute([],3)}}function l(e,t,r=0){const i=new Array,n=e.length;for(let o=0;o<n;o+=t){for(let t=0;t<r;t++)i.push(e[o+t]);const n=e[o+r],a=e[o+r+1],s=e[o+r+2],c=Math.fround(n),l=n-c,u=Math.fround(a),d=a-u,h=Math.fround(s),m=s-h;i.push(c,u,h,l,d,m);for(let n=r+3;n<t;n++)i.push(e[o+n])}return i}function u(e,t){const r=c(t);return e.bufferGeometry.setAttribute("position",r.positionHigh),e.bufferGeometry.setAttribute("positionLow",r.positionLow),r.positionHigh.itemSize}e.doubleToFloatVec=t,e.makeFloatVec=function(e){const t=Math.fround(e.x),r=Math.fround(e.y),i=Math.fround(e.z),o=new n.Vector3(e.x-t,e.y-r,e.z-i);return e.x=Math.fround(t),e.y=Math.fround(r),e.z=Math.fround(i),o},e.createHighPrecisionCameraPos=r,e.updateHpUniforms=function(e,t,i){const n=r(t,e.matrixWorldInverse),o=n.viewProjection;if(void 0===i||!i.isMaterial)throw Error("High pecision line has no high precision material");if(!(i.uniforms&&i.uniforms.u_mvp&&i.uniforms.u_eyepos&&i.uniforms.u_eyepos_lowpart))throw Error("High pecision material has missing uniforms");i.uniforms.u_mvp.value=new Float32Array(o.elements),i.uniforms.u_eyepos.value=new Float32Array(n.eyePosHi.toArray()),i.uniforms.u_eyepos_lowpart.value=new Float32Array(n.eyePosLo.toArray())},e.createAttributes=c,e.addInterleavedAttributes3=l,e.setPositions=u,e.convertPositions=function(e){if(e.length<=0)return{positions:[]};const t=e[0];if(null==t)throw Error("Empty element in positions");const r=t;if(void 0===r.y&&void 0===r.z)return{positions:e};const i=new Array;return e.forEach(e=>{i.push(e.x,e.y,e.z)}),{positions:i}},e.createLine=function(e,t){const r=void 0!==t.lineWidth?t.lineWidth:5,a=void 0!==t.addCircles&&t.addCircles,c=void 0!==t.wireFrame&&t.wireFrame,u=[],d=[];s.triangulateLine(e,r,u,d,a);const h=new n.BufferGeometry,m=l(u,3),p=new n.InterleavedBuffer(new Float32Array(m),6),f=new n.InterleavedBufferAttribute(p,3,0,!1),g=new n.InterleavedBufferAttribute(p,3,3,!1);h.setAttribute("position",f),h.setAttribute("positionLow",g),h.setIndex(new n.BufferAttribute(new Uint32Array(d),1));const y=new i.HighPrecisionLineMaterial(t),v=c?new o.HighPrecisionWireFrameLine(h,y):new o.HighPrecisionLine(h,y);return v.setupForRendering(),v},e.createPoints=function(e,t){const r=[];for(let t=0;t<e.length;t++)r.push(r.length/3);const o=new n.BufferGeometry,s=i.isHighPrecisionPointMaterial(t)?t:new i.HighPrecisionPointMaterial(t),c=new a.HighPrecisionPoints(o,s);return u(c,e),c.setupForRendering(),c}}(t.HighPrecisionUtils||(t.HighPrecisionUtils={}))},function(e,t,r){"use strict";var i,n="object"==typeof Reflect?Reflect:null,o=n&&"function"==typeof n.apply?n.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};i=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var c=10;function l(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function u(e,t,r,i){var n,o,a,s;if("function"!=typeof r)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r);if(void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),a=o[t]),void 0===a)a=o[t]=r,++e._eventsCount;else if("function"==typeof a?a=o[t]=i?[r,a]:[a,r]:i?a.unshift(r):a.push(r),(n=l(e))>0&&a.length>n&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,s=c,console&&console.warn&&console.warn(s)}return e}function d(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,o(this.listener,this.target,e))}function h(e,t,r){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=d.bind(i);return n.listener=r,i.wrapFn=n,n}function m(e,t,r){var i=e._events;if(void 0===i)return[];var n=i[t];return void 0===n?[]:"function"==typeof n?r?[n.listener||n]:[n]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(n):f(n,n.length)}function p(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function f(e,t){for(var r=new Array(t),i=0;i<t;++i)r[i]=e[i];return r}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,n=this._events;if(void 0!==n)i=i&&void 0===n.error;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=n[e];if(void 0===c)return!1;if("function"==typeof c)o(c,this,t);else{var l=c.length,u=f(c,l);for(r=0;r<l;++r)o(u[r],this,t)}return!0},s.prototype.addListener=function(e,t){return u(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return u(this,e,t,!0)},s.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,h(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,h(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,i,n,o,a;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(i=this._events))return this;if(void 0===(r=i[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(n=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){a=r[o].listener,n=o;break}if(n<0)return this;0===n?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,n),1===r.length&&(i[e]=r[0]),void 0!==i.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,r,i;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var n,o=Object.keys(r);for(i=0;i<o.length;++i)"removeListener"!==(n=o[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},s.prototype.listeners=function(e){return m(this,e,!0)},s.prototype.rawListeners=function(e){return m(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},s.prototype.listenerCount=p,s.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(e,t,r){(t=e.exports=r(194)).Stream=t,t.Readable=t,t.Writable=r(103),t.Duplex=r(26),t.Transform=r(199),t.PassThrough=r(398)},function(e,t,r){var i=r(36),n=i.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=i:(o(i,t),t.Buffer=a),o(n,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},function(e,t,r){"use strict";(function(t,i,n){var o=r(72);function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var i=e.entry;e.entry=null;for(;i;){var n=i.callback;t.pendingcb--,n(r),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=v;var s,c=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?i:o.nextTick;v.WritableState=y;var l=r(50);l.inherits=r(37);var u={deprecate:r(396)},d=r(195),h=r(102).Buffer,m=n.Uint8Array||function(){};var p,f=r(196);function g(){}function y(e,t){s=s||r(26),e=e||{};var i=t instanceof s;this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,l=e.writableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:i&&(l||0===l)?l:u,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var d=!1===e.decodeStrings;this.decodeStrings=!d,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,n=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,n){--t.pendingcb,r?(o.nextTick(n,i),o.nextTick(w,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(n(i),e._writableState.errorEmitted=!0,e.emit("error",i),w(e,t))}(e,r,i,t,n);else{var a=T(r);a||r.corked||r.bufferProcessing||!r.bufferedRequest||S(e,r),i?c(b,e,r,a,n):b(e,r,a,n)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function v(e){if(s=s||r(26),!(p.call(v,this)||this instanceof s))return new v(e);this._writableState=new y(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),d.call(this)}function _(e,t,r,i,n,o,a){t.writelen=i,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(n,t.onwrite):e._write(n,o,t.onwrite),t.sync=!1}function b(e,t,r,i){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,i(),w(e,t)}function S(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,n=new Array(i),o=t.corkedRequestsFree;o.entry=r;for(var s=0,c=!0;r;)n[s]=r,r.isBuf||(c=!1),r=r.next,s+=1;n.allBuffers=c,_(e,t,!0,t.length,n,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,u=r.encoding,d=r.callback;if(_(e,t,!1,t.objectMode?1:l.length,l,u,d),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function T(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function E(e,t){e._final((function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),w(e,t)}))}function w(e,t){var r=T(t);return r&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,o.nextTick(E,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}l.inherits(v,d),y.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(y.prototype,"buffer",{get:u.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(v,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||this===v&&(e&&e._writableState instanceof y)}})):p=function(e){return e instanceof this},v.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},v.prototype.write=function(e,t,r){var i,n=this._writableState,a=!1,s=!n.objectMode&&(i=e,h.isBuffer(i)||i instanceof m);return s&&!h.isBuffer(e)&&(e=function(e){return h.from(e)}(e)),"function"==typeof t&&(r=t,t=null),s?t="buffer":t||(t=n.defaultEncoding),"function"!=typeof r&&(r=g),n.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),o.nextTick(t,r)}(this,r):(s||function(e,t,r,i){var n=!0,a=!1;return null===r?a=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),o.nextTick(i,a),n=!1),n}(this,n,e,r))&&(n.pendingcb++,a=function(e,t,r,i,n,o){if(!r){var a=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=h.from(t,r));return t}(t,i,n);i!==a&&(r=!0,n="buffer",i=a)}var s=t.objectMode?1:i.length;t.length+=s;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:o,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else _(e,t,!1,s,i,n,o);return c}(this,n,s,e,t,r)),a},v.prototype.cork=function(){this._writableState.corked++},v.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||S(this,e))},v.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),v.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},v.prototype._writev=null,v.prototype.end=function(e,t,r){var i=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(e,t,r){t.ending=!0,w(e,t),r&&(t.finished?o.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,i,r)},Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),v.prototype.destroy=f.destroy,v.prototype._undestroy=f.undestroy,v.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,r(71),r(197).setImmediate,r(23))},function(e,t,r){"use strict";var i=r(51),n=r(203),o=r(204),a=r(205);o=r(204);function s(e,t,r,i,n){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=i,this.compressedContent=n}s.prototype={getContentWorker:function(){var e=new n(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new n(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,r){return e.pipe(new a).pipe(new o("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},e.exports=s},function(e,t,r){"use strict";var i=r(6);var n=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();e.exports=function(e,t){return void 0!==e&&e.length?"string"!==i.getTypeOf(e)?function(e,t,r,i){var o=n,a=i+r;e^=-1;for(var s=i;s<a;s++)e=e>>>8^o[255&(e^t[s])];return-1^e}(0|t,e,e.length,0):function(e,t,r,i){var o=n,a=i+r;e^=-1;for(var s=i;s<a;s++)e=e>>>8^o[255&(e^t.charCodeAt(s))];return-1^e}(0|t,e,e.length,0):0}},function(e,t,r){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t,r){"use strict";e.exports=d;var i,n=r(16),o=n.LongBits,a=n.base64,s=n.utf8;function c(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function l(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}function h(e,t,r){t[r]=255&e}function m(e,t){this.len=e,this.next=void 0,this.val=t}function p(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function f(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}d.create=n.Buffer?function(){return(d.create=function(){return new i})()}:function(){return new d},d.alloc=function(e){return new n.Array(e)},n.Array!==Array&&(d.alloc=n.pool(d.alloc,n.Array.prototype.subarray)),d.prototype._push=function(e,t,r){return this.tail=this.tail.next=new c(e,t,r),this.len+=t,this},m.prototype=Object.create(c.prototype),m.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new m((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(p,10,o.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.uint64=function(e){var t=o.from(e);return this._push(p,t.length(),t)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(p,t.length(),t)},d.prototype.bool=function(e){return this._push(h,1,e?1:0)},d.prototype.fixed32=function(e){return this._push(f,4,e>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(e){var t=o.from(e);return this._push(f,4,t.lo)._push(f,4,t.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(e){return this._push(n.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(n.float.writeDoubleLE,8,e)};var g=n.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var i=0;i<e.length;++i)t[r+i]=e[i]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(h,1,0);if(n.isString(e)){var r=d.alloc(t=a.length(e));a.decode(e,r,0),e=r}return this.uint32(t)._push(g,t,e)},d.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t)._push(s.write,t,e):this._push(h,1,0)},d.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new c(l,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},d._configure=function(e){i=e}},function(e,t,r){"use strict";e.exports=c;var i,n=r(16),o=n.LongBits,a=n.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var l,u="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")};function d(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function m(){if(this.pos+8>this.len)throw s(this,8);return new o(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}c.create=n.Buffer?function(e){return(c.create=function(e){return n.Buffer.isBuffer(e)?new i(e):u(e)})(e)}:u,c.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice,c.prototype.uint32=(l=4294967295,function(){if(l=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return l;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return l}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return h(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|h(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=n.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=n.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw s(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},c.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){i=e;var t=n.Long?"toLong":"toNumber";n.merge(c.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return m.call(this)[t](!0)},sfixed64:function(){return m.call(this)[t](!1)}})}},function(e,t,r){"use strict";e.exports=v;var i=r(52);((v.prototype=Object.create(i.prototype)).constructor=v).className="Type";var n=r(14),o=r(74),a=r(27),s=r(110),c=r(111),l=r(113),u=r(108),d=r(107),h=r(7),m=r(222),p=r(223),f=r(224),g=r(225),y=r(226);function v(e,t){i.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function _(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(v.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var r=this.fields[e[t]],i=r.id;if(this._fieldsById[i])throw Error("duplicate id "+i+" in "+this);this._fieldsById[i]=r}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=h.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=h.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=v.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof l||((e.prototype=new l).constructor=e,h.merge(e.prototype,t)),e.$type=e.prototype.$type=this,h.merge(e,l,!0),this._ctor=e;for(var r=0;r<this.fieldsArray.length;++r)this._fieldsArray[r].resolve();var i={};for(r=0;r<this.oneofsArray.length;++r)i[this._oneofsArray[r].resolve().name]={get:h.oneOfGetter(this._oneofsArray[r].oneof),set:h.oneOfSetter(this._oneofsArray[r].oneof)};r&&Object.defineProperties(e.prototype,i)}}}),v.generateConstructor=function(e){for(var t,r=h.codegen(["p"],e.name),i=0;i<e.fieldsArray.length;++i)(t=e._fieldsArray[i]).map?r("this%s={}",h.safeProp(t.name)):t.repeated&&r("this%s=[]",h.safeProp(t.name));return r("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},v.fromJSON=function(e,t){var r=new v(e,t.options);r.extensions=t.extensions,r.reserved=t.reserved;for(var l=Object.keys(t.fields),u=0;u<l.length;++u)r.add((void 0!==t.fields[l[u]].keyType?s.fromJSON:a.fromJSON)(l[u],t.fields[l[u]]));if(t.oneofs)for(l=Object.keys(t.oneofs),u=0;u<l.length;++u)r.add(o.fromJSON(l[u],t.oneofs[l[u]]));if(t.nested)for(l=Object.keys(t.nested),u=0;u<l.length;++u){var d=t.nested[l[u]];r.add((void 0!==d.id?a.fromJSON:void 0!==d.fields?v.fromJSON:void 0!==d.values?n.fromJSON:void 0!==d.methods?c.fromJSON:i.fromJSON)(l[u],d))}return t.extensions&&t.extensions.length&&(r.extensions=t.extensions),t.reserved&&t.reserved.length&&(r.reserved=t.reserved),t.group&&(r.group=!0),t.comment&&(r.comment=t.comment),r},v.prototype.toJSON=function(e){var t=i.prototype.toJSON.call(this,e),r=!!e&&Boolean(e.keepComments);return h.toObject(["options",t&&t.options||void 0,"oneofs",i.arrayToJSON(this.oneofsArray,e),"fields",i.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])},v.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var r=this.oneofsArray;for(t=0;t<r.length;)r[t++].resolve();return i.prototype.resolveAll.call(this)},v.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},v.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof a&&void 0===e.extend){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),_(this)}return e instanceof o?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),_(this)):i.prototype.add.call(this,e)},v.prototype.remove=function(e){if(e instanceof a&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),_(this)}if(e instanceof o){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),_(this)}return i.prototype.remove.call(this,e)},v.prototype.isReservedId=function(e){return i.isReservedId(this.reserved,e)},v.prototype.isReservedName=function(e){return i.isReservedName(this.reserved,e)},v.prototype.create=function(e){return new this.ctor(e)},v.prototype.setup=function(){for(var e=this.fullName,t=[],r=0;r<this.fieldsArray.length;++r)t.push(this._fieldsArray[r].resolve().resolvedType);this.encode=m(this)({Writer:d,types:t,util:h}),this.decode=p(this)({Reader:u,types:t,util:h}),this.verify=f(this)({types:t,util:h}),this.fromObject=g.fromObject(this)({types:t,util:h}),this.toObject=g.toObject(this)({types:t,util:h});var i=y[e];if(i){var n=Object.create(this);n.fromObject=this.fromObject,this.fromObject=i.fromObject.bind(n),n.toObject=this.toObject,this.toObject=i.toObject.bind(n)}return this},v.prototype.encode=function(e,t){return this.setup().encode(e,t)},v.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},v.prototype.decode=function(e,t){return this.setup().decode(e,t)},v.prototype.decodeDelimited=function(e){return e instanceof u||(e=u.create(e)),this.decode(e,e.uint32())},v.prototype.verify=function(e){return this.setup().verify(e)},v.prototype.fromObject=function(e){return this.setup().fromObject(e)},v.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},v.d=function(e){return function(t){h.decorateType(t,e)}}},function(e,t,r){"use strict";e.exports=a;var i=r(27);((a.prototype=Object.create(i.prototype)).constructor=a).className="MapField";var n=r(39),o=r(7);function a(e,t,r,n,a,s){if(i.call(this,e,t,n,void 0,void 0,a,s),!o.isString(r))throw TypeError("keyType must be a string");this.keyType=r,this.resolvedKeyType=null,this.map=!0}a.fromJSON=function(e,t){return new a(e,t.id,t.keyType,t.type,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},a.prototype.resolve=function(){if(this.resolved)return this;if(void 0===n.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return i.prototype.resolve.call(this)},a.d=function(e,t,r){return"function"==typeof r?r=o.decorateType(r).name:r&&"object"==typeof r&&(r=o.decorateEnum(r).name),function(i,n){o.decorateType(i.constructor).add(new a(n,e,t,r))}}},function(e,t,r){"use strict";e.exports=s;var i=r(52);((s.prototype=Object.create(i.prototype)).constructor=s).className="Service";var n=r(112),o=r(7),a=r(220);function s(e,t){i.call(this,e,t),this.methods={},this._methodsArray=null}function c(e){return e._methodsArray=null,e}s.fromJSON=function(e,t){var r=new s(e,t.options);if(t.methods)for(var i=Object.keys(t.methods),o=0;o<i.length;++o)r.add(n.fromJSON(i[o],t.methods[i[o]]));return t.nested&&r.addJSON(t.nested),r.comment=t.comment,r},s.prototype.toJSON=function(e){var t=i.prototype.toJSON.call(this,e),r=!!e&&Boolean(e.keepComments);return o.toObject(["options",t&&t.options||void 0,"methods",i.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])},Object.defineProperty(s.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=o.toArray(this.methods))}}),s.prototype.get=function(e){return this.methods[e]||i.prototype.get.call(this,e)},s.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return i.prototype.resolve.call(this)},s.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof n?(this.methods[e.name]=e,e.parent=this,c(this)):i.prototype.add.call(this,e)},s.prototype.remove=function(e){if(e instanceof n){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,c(this)}return i.prototype.remove.call(this,e)},s.prototype.create=function(e,t,r){for(var i,n=new a.Service(e,t,r),s=0;s<this.methodsArray.length;++s){var c=o.lcFirst((i=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");n[c]=o.codegen(["r","c"],o.isReserved(c)?c+"_":c)("return this.rpcCall(m,q,s,r,c)")({m:i,q:i.resolvedRequestType.ctor,s:i.resolvedResponseType.ctor})}return n}},function(e,t,r){"use strict";e.exports=o;var i=r(38);((o.prototype=Object.create(i.prototype)).constructor=o).className="Method";var n=r(7);function o(e,t,r,o,a,s,c,l){if(n.isObject(a)?(c=a,a=s=void 0):n.isObject(s)&&(c=s,s=void 0),void 0!==t&&!n.isString(t))throw TypeError("type must be a string");if(!n.isString(r))throw TypeError("requestType must be a string");if(!n.isString(o))throw TypeError("responseType must be a string");i.call(this,e,c),this.type=t||"rpc",this.requestType=r,this.requestStream=!!a||void 0,this.responseType=o,this.responseStream=!!s||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=l}o.fromJSON=function(e,t){return new o(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return n.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0])},o.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),i.prototype.resolve.call(this))}},function(e,t,r){"use strict";e.exports=n;var i=r(16);function n(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}n.create=function(e){return this.$type.create(e)},n.encode=function(e,t){return this.$type.encode(e,t)},n.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},n.decode=function(e){return this.$type.decode(e)},n.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},n.verify=function(e){return this.$type.verify(e)},n.fromObject=function(e){return this.$type.fromObject(e)},n.toObject=function(e,t){return this.$type.toObject(e,t)},n.prototype.toJSON=function(){return this.$type.toObject(this,i.toJSONOptions)}},function(e,t,r){"use strict";e.exports=d;var i=r(52);((d.prototype=Object.create(i.prototype)).constructor=d).className="Root";var n,o,a,s=r(27),c=r(14),l=r(74),u=r(7);function d(e){i.call(this,"",e),this.deferred=[],this.files=[]}function h(){}d.fromJSON=function(e,t){return t||(t=new d),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},d.prototype.resolvePath=u.path.resolve,d.prototype.load=function e(t,r,i){"function"==typeof r&&(i=r,r=void 0);var n=this;if(!i)return u.asPromise(e,n,t,r);var s=i===h;function c(e,t){if(i){var r=i;if(i=null,s)throw e;r(e,t)}}function l(e,t){try{if(u.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),u.isString(t)){o.filename=e;var i,a=o(t,n,r),l=0;if(a.imports)for(;l<a.imports.length;++l)(i=n.resolvePath(e,a.imports[l]))&&d(i);if(a.weakImports)for(l=0;l<a.weakImports.length;++l)(i=n.resolvePath(e,a.weakImports[l]))&&d(i,!0)}else n.setOptions(t.options).addJSON(t.nested)}catch(e){c(e)}s||m||c(null,n)}function d(e,t){var r=e.lastIndexOf("google/protobuf/");if(r>-1){var o=e.substring(r);o in a&&(e=o)}if(!(n.files.indexOf(e)>-1))if(n.files.push(e),e in a)s?l(e,a[e]):(++m,setTimeout((function(){--m,l(e,a[e])})));else if(s){var d;try{d=u.fs.readFileSync(e).toString("utf8")}catch(e){return void(t||c(e))}l(e,d)}else++m,u.fetch(e,(function(r,o){--m,i&&(r?t?m||c(null,n):c(r):l(e,o))}))}var m=0;u.isString(t)&&(t=[t]);for(var p,f=0;f<t.length;++f)(p=n.resolvePath("",t[f]))&&d(p);if(s)return n;m||c(null,n)},d.prototype.loadSync=function(e,t){if(!u.isNode)throw Error("not supported");return this.load(e,t,h)},d.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return i.prototype.resolveAll.call(this)};var m=/^[A-Z]/;function p(e,t){var r=t.parent.lookup(t.extend);if(r){var i=new s(t.fullName,t.id,t.type,t.rule,void 0,t.options);return i.declaringField=t,t.extensionField=i,r.add(i),!0}return!1}d.prototype._handleAdd=function(e){if(e instanceof s)void 0===e.extend||e.extensionField||p(0,e)||this.deferred.push(e);else if(e instanceof c)m.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof l)){if(e instanceof n)for(var t=0;t<this.deferred.length;)p(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var r=0;r<e.nestedArray.length;++r)this._handleAdd(e._nestedArray[r]);m.test(e.name)&&(e.parent[e.name]=e)}},d.prototype._handleRemove=function(e){if(e instanceof s){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof c)m.test(e.name)&&delete e.parent[e.name];else if(e instanceof i){for(var r=0;r<e.nestedArray.length;++r)this._handleRemove(e._nestedArray[r]);m.test(e.name)&&delete e.parent[e.name]}},d._configure=function(e,t,r){n=e,o=t,a=r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(447),n=r(448),o=r(449);t.coverageTheme={name:"coverage",styles:[{when:"type == 'coverageGrid'",renderOrder:2199,technique:"shader",attr:{params:n.getCoverageGridShader({borderColor:"#48DAD0",borderOpacity:1,highlightColor:"#D1F6F3",selectedColor:"#FBCA40",selectedHoverColor:"#FCDB7F",decodedColor:"#FBCA40"}),primitive:"segments"}},{when:"type == 'coverageFill'",renderOrder:2190,technique:"shader",attr:{params:i.getCoverageFillShader({color:"#48DAD0",hoverColor:"#48DAD0",opacity:0,selectedColor:"#48DAD0",selectedHoverColor:"#48DAD0",selectedOpacity:.1,decodedColor:"#48DAD0",decodedHoverColor:"#48DAD0",decodedOpacity:.1}),primitive:"mesh"}},{when:"type == 'heatmap'",renderOrder:2191,technique:"shader",attr:{params:o.getHeatmapShader({fillColor:"#49FFDC",opacity:.2}),primitive:"mesh"}}]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(4),o=r(32),a=r(1),s=r(0),c=r(450),l=r(232),u=r(452),d=r(117),h=r(453),m=r(454),p=r(455),f=r(230),g=a.LoggerManager.instance.create("OmvDecoder",{enabled:!1});t.Ring=class{constructor(e,t,r){this.extents=e,this.vertexStride=t,this.contour=r,this.winding=this.area()<0}area(){const e=this.contour,t=this.vertexStride,r=e.length/t;let i=0;for(let n=r-1,o=0;o<r;n=o++)i+=e[n*t]*e[o*t+1]-e[o*t]*e[n*t+1];return i/2}};class y{constructor(e,t,r,i,n,o=!0,a=!1,s=!1,u=!0,d=0,h=!1,m){this.m_projection=e,this.m_styleSetEvaluator=t,this.m_showMissingTechniques=r,this.m_dataFilter=i,this.m_featureModifier=n,this.m_gatherFeatureIds=o,this.m_createTileInfo=a,this.m_gatherRoadSegments=s,this.m_skipShortLabels=u,this.m_storageLevelOffset=d,this.m_enableElevationOverlay=h,this.m_languages=m,this.m_dataAdapters=[];const y=new p.StyleSetDataFilter(t),v=i?new l.ComposedDataFilter([y,i]):y;this.m_dataAdapters.push(new c.OmvProtobufDataAdapter(this,v,g)),this.m_dataAdapters.push(new f.VTJsonDataAdapter(this,v,g))}get storageLevelOffset(){return this.m_storageLevelOffset}getDecodedTile(e,t){let r;for(const e of this.m_dataAdapters.values())if(e.canProcess(t)){r=e;break}if(void 0===r)return{techniques:[],geometries:[]};const i=this.estimatedTileSizeOnScreen(),n=new y.DecodeInfo(r.id,this.m_projection,e,i);if(this.m_decodedTileEmitter=new u.OmvDecodedTileEmitter(n,this.m_styleSetEvaluator,this.m_gatherFeatureIds,this.m_skipShortLabels,this.m_enableElevationOverlay,this.m_languages),this.m_createTileInfo){const e=!0;this.m_infoTileEmitter=new h.OmvTileInfoEmitter(n,this.m_styleSetEvaluator,e,this.m_gatherRoadSegments)}r.process(t,e,n.geoBox);const o=this.m_decodedTileEmitter.getDecodedTile();return this.m_createTileInfo&&(o.tileInfo=this.m_infoTileEmitter.getTileInfo()),o}getTileInfo(e,t){let r;for(const e of this.m_dataAdapters.values())if(e.canProcess(t)){r=e;break}if(void 0===r)return new i.ExtendedTileInfo(e,!1);const n=this.estimatedTileSizeOnScreen(),o=new y.DecodeInfo(r.id,this.m_projection,e,n);this.m_infoTileEmitter=new h.OmvTileInfoEmitter(o,this.m_styleSetEvaluator,!0,this.m_gatherRoadSegments);for(const r of this.m_dataAdapters.values())if(r.canProcess(t)){r.process(t,e,o.geoBox);break}return this.m_infoTileEmitter.getTileInfo()}processPointFeature(e,t,r,n,o){if(void 0!==this.m_featureModifier&&!this.m_featureModifier.doProcessPointFeature(e,n,o))return;const a=this.applyKindFilter(this.m_styleSetEvaluator.getMatchingTechniques(n,e,"point"),i.GeometryKind.Label);if(0===a.length)return void(this.m_showMissingTechniques&&g.log("OmvDecoder#processPointFeature: no techniques for object:",JSON.stringify(n.unmap())));const s={env:n,storageLevel:o,zoomLevel:this.getZoomLevel(o),cachedExprResults:this.m_styleSetEvaluator.expressionEvaluatorCache},c=n.lookup("$id");this.m_decodedTileEmitter&&this.m_decodedTileEmitter.processPointFeature(e,t,r,s,a,c),this.m_infoTileEmitter&&this.m_infoTileEmitter.processPointFeature(e,t,r,s,a,c)}processLineFeature(e,t,r,n,o){if(void 0!==this.m_featureModifier&&!this.m_featureModifier.doProcessLineFeature(e,n,o))return;const a=this.applyKindFilter(this.m_styleSetEvaluator.getMatchingTechniques(n,e,"line"),i.GeometryKind.Line);if(0===a.length)return void(this.m_showMissingTechniques&&g.log("OmvDecoder#processLineFeature: no techniques for object:",JSON.stringify(n.unmap())));const s={env:n,storageLevel:o,zoomLevel:this.getZoomLevel(o),cachedExprResults:this.m_styleSetEvaluator.expressionEvaluatorCache},c=n.lookup("$id");this.m_decodedTileEmitter&&this.m_decodedTileEmitter.processLineFeature(e,t,r,s,a,c),this.m_infoTileEmitter&&this.m_infoTileEmitter.processLineFeature(e,t,r,s,a,c)}processPolygonFeature(e,t,r,n,o){if(void 0!==this.m_featureModifier&&!this.m_featureModifier.doProcessPolygonFeature(e,n,o))return;const a=this.applyKindFilter(this.m_styleSetEvaluator.getMatchingTechniques(n,e,"polygon"),i.GeometryKind.Area);if(0===a.length)return void(this.m_showMissingTechniques&&g.log("OmvDecoder#processPolygonFeature: no techniques for object:",JSON.stringify(n.unmap())));const s={env:n,storageLevel:o,zoomLevel:this.getZoomLevel(o),cachedExprResults:this.m_styleSetEvaluator.expressionEvaluatorCache},c=n.lookup("$id");this.m_decodedTileEmitter&&this.m_decodedTileEmitter.processPolygonFeature(e,t,r,s,a,c),this.m_infoTileEmitter&&this.m_infoTileEmitter.processPolygonFeature(e,t,r,s,a,c)}estimatedTileSizeOnScreen(){return 256*Math.pow(2,-this.m_storageLevelOffset)}getZoomLevel(e){return Math.max(0,e-(this.m_storageLevelOffset||0))}applyKindFilter(e,t){return void 0!==this.m_dataFilter&&this.m_dataFilter.hasKindFilter&&(e=e.filter(e=>void 0===e.kind?this.m_dataFilter.wantsKind(t):this.m_dataFilter.wantsKind(e.kind))),e}}t.OmvDecoder=y,function(e){e.DecodeInfo=class{constructor(e,t,r,i){this.adapterId=e,this.targetProjection=t,this.tileKey=r,this.tileSizeOnScreen=i,this.projectedBoundingBox=new n.OrientedBox3,this.tileBounds=new s.Box3,this.tileSize=new s.Vector3,this.center=new s.Vector3,this.projectedTileBounds=new s.Box3,this.geoBox=this.tilingScheme.getGeoBox(r),this.targetProjection.projectBox(this.geoBox,this.projectedTileBounds),this.targetProjection.projectBox(this.geoBox,this.projectedBoundingBox),this.projectedBoundingBox.getCenter(this.center),this.tilingScheme.getWorldBox(r,this.tileBounds),this.tileBounds.getSize(this.tileSize)}get tilingScheme(){return n.webMercatorTilingScheme}get sourceProjection(){return this.tilingScheme.projection}}}(y=t.OmvDecoder||(t.OmvDecoder={}));class v extends o.ThemedTileDecoder{constructor(){super(...arguments),this.m_showMissingTechniques=!1,this.m_gatherFeatureIds=!0,this.m_createTileInfo=!1,this.m_gatherRoadSegments=!1,this.m_skipShortLabels=!0,this.m_enableElevationOverlay=!1}connect(){return Promise.resolve()}decodeThemedTile(e,t,r,i){const n=a.PerformanceTimer.now(),o=new y(i,r,this.m_showMissingTechniques,this.m_featureFilter,this.m_featureModifier,this.m_gatherFeatureIds,this.m_createTileInfo,this.m_gatherRoadSegments,this.m_skipShortLabels,this.m_storageLevelOffset,this.m_enableElevationOverlay,this.languages).getDecodedTile(t,e);return o.decodeTime=a.PerformanceTimer.now()-n,Promise.resolve(o)}getTileInfo(e,t,r){const i=a.PerformanceTimer.now(),n=this.m_styleSetEvaluator;if(void 0===n)return Promise.reject(new Error("no theme loaded"));const o=new y(r,n,this.m_showMissingTechniques,this.m_featureFilter,this.m_featureModifier,this.m_gatherFeatureIds,this.m_createTileInfo,this.m_gatherRoadSegments,this.m_skipShortLabels,this.m_storageLevelOffset,this.m_enableElevationOverlay,this.languages).getTileInfo(t,e);return o.setupTime=a.PerformanceTimer.now()-i,Promise.resolve(o)}configure(e,t,r,i){if(super.configure(e,t,r,i),i){const e=i;void 0!==e.showMissingTechniques&&(this.m_showMissingTechniques=!0===e.showMissingTechniques),e&&void 0!==e.filterDescription&&(null!==e.filterDescription?(this.m_featureFilter=new l.OmvGenericFeatureFilter(e.filterDescription),this.m_featureModifier=this.createFeatureModifier(e.filterDescription,e.featureModifierId)):(this.m_featureFilter=void 0,this.m_featureModifier=void 0)),void 0!==e.gatherFeatureIds&&(this.m_gatherFeatureIds=!0===e.gatherFeatureIds),void 0!==e.createTileInfo&&(this.m_createTileInfo=!0===e.createTileInfo),void 0!==e.gatherRoadSegments&&(this.m_gatherRoadSegments=!0===e.gatherRoadSegments),void 0!==e.skipShortLabels&&(this.m_skipShortLabels=e.skipShortLabels),void 0!==e.enableElevationOverlay&&(this.m_enableElevationOverlay=e.enableElevationOverlay)}void 0!==r&&(this.languages=r)}createFeatureModifier(e,t){return t===d.FeatureModifierId.tomTom?new m.OmvTomTomFeatureModifier(e):new l.OmvGenericFeatureModifier(e)}}t.OmvTileDecoder=v;class _{static start(){o.WorkerServiceManager.getInstance().register({serviceType:d.OMV_TILE_DECODER_SERVICE_TYPE,factory:e=>o.TileDecoderService.start(e,new v)})}}t.OmvTileDecoderService=_;t.default=class{constructor(){g.warn("OmvWorkerClient class is deprecated, please use OmvTileDecoderService.start"),_.start()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.tomTom=0]="tomTom"}(t.FeatureModifierId||(t.FeatureModifierId={})),function(e){let t;!function(e){e[e.Any=0]="Any",e[e.Match=1]="Match",e[e.StartsWith=2]="StartsWith",e[e.Contains=3]="Contains",e[e.EndsWith=4]="EndsWith"}(t=e.StringMatch||(e.StringMatch={})),e.matchString=function(t,r){switch(r.match){case e.StringMatch.Any:return!0;case e.StringMatch.Match:return t===r.value;case e.StringMatch.StartsWith:return r.value.startsWith(t);case e.StringMatch.EndsWith:return r.value.endsWith(t);default:return t.indexOf(r.value)>=0}}}(t.OmvFilterString||(t.OmvFilterString={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.POINT=1]="POINT",e[e.LINESTRING=2]="LINESTRING",e[e.POLYGON=3]="POLYGON"}(t.OmvGeometryType||(t.OmvGeometryType={})),t.OMV_TILE_DECODER_SERVICE_TYPE="omv-tile-decoder",t.OMV_TILER_SERVICE_TYPE="omv-tiler"},function(e,t,r){"use strict";var i=r(459),n=r(119),o=r(40),a=r(236),s=r(461);function c(e,t,r){var i=this._refs[r];if("string"==typeof i){if(!this._refs[i])return c.call(this,e,t,i);i=this._refs[i]}if((i=i||this._schemas[r])instanceof a)return p(i.schema,this._opts.inlineRefs)?i.schema:i.validate||this._compile(i);var n,o,s,u=l.call(this,t,r);return u&&(n=u.schema,t=u.root,s=u.baseId),n instanceof a?o=n.validate||e.call(this,n.schema,t,void 0,s):void 0!==n&&(o=p(n,this._opts.inlineRefs)?n:e.call(this,n,t,void 0,s)),o}function l(e,t){var r=i.parse(t),n=g(r),o=f(this._getId(e.schema));if(0===Object.keys(e.schema).length||n!==o){var s=v(n),c=this._refs[s];if("string"==typeof c)return u.call(this,e,c,r);if(c instanceof a)c.validate||this._compile(c),e=c;else{if(!((c=this._schemas[s])instanceof a))return;if(c.validate||this._compile(c),s==v(t))return{schema:c,root:e,baseId:o};e=c}if(!e.schema)return;o=f(this._getId(e.schema))}return h.call(this,r,o,e.schema,e)}function u(e,t,r){var i=l.call(this,e,t);if(i){var n=i.schema,o=i.baseId;e=i.root;var a=this._getId(n);return a&&(o=_(o,a)),h.call(this,r,o,n,e)}}e.exports=c,c.normalizeId=v,c.fullPath=f,c.url=_,c.ids=function(e){var t=v(this._getId(e)),r={"":t},a={"":f(t,!1)},c={},l=this;return s(e,{allKeys:!0},(function(e,t,s,u,d,h,m){if(""!==t){var p=l._getId(e),f=r[u],g=a[u]+"/"+d;if(void 0!==m&&(g+="/"+("number"==typeof m?m:o.escapeFragment(m))),"string"==typeof p){p=f=v(f?i.resolve(f,p):p);var y=l._refs[p];if("string"==typeof y&&(y=l._refs[y]),y&&y.schema){if(!n(e,y.schema))throw new Error('id "'+p+'" resolves to more than one schema')}else if(p!=v(g))if("#"==p[0]){if(c[p]&&!n(e,c[p]))throw new Error('id "'+p+'" resolves to more than one schema');c[p]=e}else l._refs[p]=g}r[t]=f,a[t]=g}})),c},c.inlineRef=p,c.schema=l;var d=o.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function h(e,t,r,i){if(e.fragment=e.fragment||"","/"==e.fragment.slice(0,1)){for(var n=e.fragment.split("/"),a=1;a<n.length;a++){var s=n[a];if(s){if(void 0===(r=r[s=o.unescapeFragment(s)]))break;var c;if(!d[s]&&((c=this._getId(r))&&(t=_(t,c)),r.$ref)){var u=_(t,r.$ref),h=l.call(this,i,u);h&&(r=h.schema,i=h.root,t=h.baseId)}}}return void 0!==r&&r!==i.schema?{schema:r,root:i,baseId:t}:void 0}}var m=o.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function p(e,t){return!1!==t&&(void 0===t||!0===t?function e(t){var r;if(Array.isArray(t)){for(var i=0;i<t.length;i++)if("object"==typeof(r=t[i])&&!e(r))return!1}else for(var n in t){if("$ref"==n)return!1;if("object"==typeof(r=t[n])&&!e(r))return!1}return!0}(e):t?function e(t){var r,i=0;if(Array.isArray(t)){for(var n=0;n<t.length;n++)if("object"==typeof(r=t[n])&&(i+=e(r)),i==1/0)return 1/0}else for(var o in t){if("$ref"==o)return 1/0;if(m[o])i++;else if("object"==typeof(r=t[o])&&(i+=e(r)+1),i==1/0)return 1/0}return i}(e)<=t:void 0)}function f(e,t){return!1!==t&&(e=v(e)),g(i.parse(e))}function g(e){return i.serialize(e).split("#")[0]+"#"}var y=/#\/?$/;function v(e){return e?e.replace(y,""):""}function _(e,t){return t=v(t),i.resolve(e,t)}},function(e,t,r){"use strict";var i=Array.isArray,n=Object.keys,o=Object.prototype.hasOwnProperty;e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){var a,s,c,l=i(t),u=i(r);if(l&&u){if((s=t.length)!=r.length)return!1;for(a=s;0!=a--;)if(!e(t[a],r[a]))return!1;return!0}if(l!=u)return!1;var d=t instanceof Date,h=r instanceof Date;if(d!=h)return!1;if(d&&h)return t.getTime()==r.getTime();var m=t instanceof RegExp,p=r instanceof RegExp;if(m!=p)return!1;if(m&&p)return t.toString()==r.toString();var f=n(t);if((s=f.length)!==n(r).length)return!1;for(a=s;0!=a--;)if(!o.call(r,f[a]))return!1;for(a=s;0!=a--;)if(!e(t[c=f[a]],r[c]))return!1;return!0}return t!=t&&r!=r}},function(e,t,r){"use strict";var i=r(118);function n(e,t,r){this.message=r||n.message(e,t),this.missingRef=i.url(e,t),this.missingSchema=i.normalizeId(i.fullPath(this.missingRef))}function o(e){return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}e.exports={Validation:o((function(e){this.message="validation failed",this.errors=e,this.ajv=this.validation=!0})),MissingRef:o(n)},n.message=function(e,t){return"can't resolve reference "+t+" from id "+e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AdapterAbstract=class{constructor(e){this.m_data=e}getRandomString(){return Math.random().toString(36).slice(2)}}},function(e,t,r){"use strict";function i(e,t){if(e.transformed)return e;var r,i,o,a=1<<e.z,s=e.x,c=e.y;for(r=0;r<e.features.length;r++){var l=e.features[r],u=l.geometry,d=l.type;if(l.geometry=[],1===d)for(i=0;i<u.length;i+=2)l.geometry.push(n(u[i],u[i+1],t,a,s,c));else for(i=0;i<u.length;i++){var h=[];for(o=0;o<u[i].length;o+=2)h.push(n(u[i][o],u[i][o+1],t,a,s,c));l.geometry.push(h)}}return e.transformed=!0,e}function n(e,t,r,i,n,o){return[Math.round(r*(e*i-n)),Math.round(r*(t*i-o))]}r.d(t,"a",(function(){return i}))},function(e,t,r){"use strict";var i=r(8),n=r(15),o=r(76),a=r(5),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function(e,t){for(var r=Object.getOwnPropertyNames(t),i=0;i<r.length;i++){var n=r[i],o=Object.getOwnPropertyDescriptor(t,n);o&&o.configurable&&void 0===e[n]&&Object.defineProperty(e,n,o)}}(e,t))}var u=function(e){function t(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return a.a(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector"],r,o),o.options=n,o.logger=i.a.create("translator"),o}return l(t,e),t.prototype.changeLanguage=function(e){e&&(this.language=e)},t.prototype.exists=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}},r=this.resolve(e,t);return r&&void 0!==r.res},t.prototype.extractFromKey=function(e,t){var r=t.nsSeparator||this.options.nsSeparator;void 0===r&&(r=":");var i=t.keySeparator||this.options.keySeparator||".",n=t.ns||this.options.defaultNS;if(r&&e.indexOf(r)>-1){var o=e.split(r);(r!==i||r===i&&this.options.ns.indexOf(o[0])>-1)&&(n=o.shift()),e=o.join(i)}return"string"==typeof n&&(n=[n]),{key:e,namespaces:n}},t.prototype.translate=function(e,t){var r=this;if("object"!==(void 0===t?"undefined":c(t))&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),t||(t={}),null==e||""===e)return"";"number"==typeof e&&(e=String(e)),"string"==typeof e&&(e=[e]);var i=t.keySeparator||this.options.keySeparator||".",n=this.extractFromKey(e[e.length-1],t),o=n.key,a=n.namespaces,l=a[a.length-1],u=t.lng||this.language,d=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u&&"cimode"===u.toLowerCase()){if(d){var h=t.nsSeparator||this.options.nsSeparator;return l+h+o}return o}var m=this.resolve(e,t),p=m&&m.res,f=m&&m.usedKey||o,g=Object.prototype.toString.apply(p),y=["[object Number]","[object Function]","[object RegExp]"],v=void 0!==t.joinArrays?t.joinArrays:this.options.joinArrays,_="string"!=typeof p&&"boolean"!=typeof p&&"number"!=typeof p;if(p&&_&&y.indexOf(g)<0&&(!v||"[object Array]"!==g)){if(!t.returnObjects&&!this.options.returnObjects)return this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(f,p,t):"key '"+o+" ("+this.language+")' returned an object instead of string.";if(t.keySeparator||this.options.keySeparator){var b="[object Array]"===g?[]:{};for(var S in p)if(Object.prototype.hasOwnProperty.call(p,S)){var T=""+f+i+S;b[S]=this.translate(T,s({},t,{joinArrays:!1,ns:a})),b[S]===T&&(b[S]=p[S])}p=b}}else if(v&&"[object Array]"===g)(p=p.join(v))&&(p=this.extendTranslation(p,e,t));else{var E=!1,w=!1;this.isValidLookup(p)||void 0===t.defaultValue||(E=!0,p=t.defaultValue),this.isValidLookup(p)||(w=!0,p=o);var C=t.defaultValue&&t.defaultValue!==p&&this.options.updateMissing;if(w||E||C){this.logger.log(C?"updateKey":"missingKey",u,l,o,C?t.defaultValue:p);var x=[],O=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if("fallback"===this.options.saveMissingTo&&O&&O[0])for(var A=0;A<O.length;A++)x.push(O[A]);else"all"===this.options.saveMissingTo?x=this.languageUtils.toResolveHierarchy(t.lng||this.language):x.push(t.lng||this.language);var P=function(e,i){r.options.missingKeyHandler?r.options.missingKeyHandler(e,l,i,C?t.defaultValue:p,C,t):r.backendConnector&&r.backendConnector.saveMissing&&r.backendConnector.saveMissing(e,l,i,C?t.defaultValue:p,C,t),r.emit("missingKey",e,l,i,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&t.count?x.forEach((function(e){r.pluralResolver.getPluralFormsOfKey(e,o).forEach((function(t){return P([e],t)}))})):P(x,o))}p=this.extendTranslation(p,e,t),w&&p===o&&this.options.appendNamespaceToMissingKey&&(p=l+":"+o),w&&this.options.parseMissingKeyHandler&&(p=this.options.parseMissingKeyHandler(p))}return p},t.prototype.extendTranslation=function(e,t,r){var i=this;r.interpolation&&this.interpolator.init(s({},r,{interpolation:s({},this.options.interpolation,r.interpolation)}));var n=r.replace&&"string"!=typeof r.replace?r.replace:r;this.options.interpolation.defaultVariables&&(n=s({},this.options.interpolation.defaultVariables,n)),e=this.interpolator.interpolate(e,n,r.lng||this.language),!1!==r.nest&&(e=this.interpolator.nest(e,(function(){return i.translate.apply(i,arguments)}),r)),r.interpolation&&this.interpolator.reset();var a=r.postProcess||this.options.postProcess,c="string"==typeof a?[a]:a;return null!=e&&c&&c.length&&!1!==r.applyPostProcessor&&(e=o.a.handle(c,e,t,r,this)),e},t.prototype.resolve=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=void 0,n=void 0;return"string"==typeof e&&(e=[e]),e.forEach((function(e){if(!t.isValidLookup(i)){var o=t.extractFromKey(e,r),a=o.key;n=a;var s=o.namespaces;t.options.fallbackNS&&(s=s.concat(t.options.fallbackNS));var c=void 0!==r.count&&"string"!=typeof r.count,l=void 0!==r.context&&"string"==typeof r.context&&""!==r.context,u=r.lngs?r.lngs:t.languageUtils.toResolveHierarchy(r.lng||t.language);s.forEach((function(e){t.isValidLookup(i)||u.forEach((function(n){if(!t.isValidLookup(i)){var o=a,s=[o],u=void 0;c&&(u=t.pluralResolver.getSuffix(n,r.count)),c&&l&&s.push(o+u),l&&s.push(o+=""+t.options.contextSeparator+r.context),c&&s.push(o+=u);for(var d=void 0;d=s.pop();)t.isValidLookup(i)||(i=t.getResource(n,e,d,r))}}))}))}})),{res:i,usedKey:n}},t.prototype.isValidLookup=function(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)},t.prototype.getResource=function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.resourceStore.getResource(e,t,r,i)},t}(n.a);t.a=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.All="_all_",e.Background="background",e.Terrain="terrain",e.Area="area",e.Line="line",e.Water="water",e.Border="border",e.Road="road",e.Building="building",e.Label="label",e.Detail="detail"}(t.GeometryKind||(t.GeometryKind={}));class i extends Set{isSuperset(e){for(const t of e)if(!this.has(t))return!1;return!0}hasIntersection(e){for(const t of e)if(this.has(t))return!0;return!1}hasOrIntersects(e){return e instanceof Set?this.hasIntersection(e):this.has(e)}hasOrIntersectsArray(e){for(const t of e)if(this.has(t))return!0;return!1}}t.GeometryKindSet=i,function(e){e.TileSpace="tile-space",e.EquirectangularSpace="equirectangular-space"}(t.TextureCoordinateType||(t.TextureCoordinateType={})),function(e){e.Show="show-in-stack",e.Hide="hide-in-stack",e.ShowParent="show-parent"}(t.PoiStackMode||(t.PoiStackMode={})),t.isTextureBuffer=function(e){return e&&e.buffer&&"string"==typeof e.type}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.FeatureGeometry=0]="FeatureGeometry",e[e.TechniqueGeometry=1]="TechniqueGeometry",e[e.TechniqueRendering=2]="TechniqueRendering"}(t.AttrScope||(t.AttrScope={})),t.mergeTechniqueDescriptor=function(...e){const t={attrScopes:{}};for(const r of e)void 0!==r.attrScopes&&(t.attrScopes=Object.assign(Object.assign({},t.attrScopes),r.attrScopes));return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ConsoleChannel=class{error(e,...t){console.error(e,...t)}debug(e,...t){console.debug(e,...t)}info(e,...t){console.info(e,...t)}log(e,...t){console.log(e,...t)}trace(e,...t){console.trace(e,...t)}warn(e,...t){console.warn(e,...t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(79);t.Logger=class{constructor(e,t,r){this.name=e,this.m_channel=t,this.enabled=!0,this.level=i.LogLevel.Trace,void 0!==r&&this.update(r)}error(e,...t){this.enabled&&this.level<=i.LogLevel.Error&&this.m_channel.error(this.prefix,e,...t)}debug(e,...t){this.enabled&&this.level<=i.LogLevel.Debug&&this.m_channel.debug(this.prefix,e,...t)}info(e,...t){this.enabled&&this.level<=i.LogLevel.Info&&this.m_channel.info(this.prefix,e,...t)}log(e,...t){this.enabled&&this.level<=i.LogLevel.Log&&this.m_channel.log(this.prefix,e,...t)}trace(e,...t){this.enabled&&this.level<=i.LogLevel.Trace&&this.m_channel.trace(this.prefix,e,...t)}warn(e,...t){this.enabled&&this.level<=i.LogLevel.Warn&&this.m_channel.warn(this.prefix,e,...t)}update(e){this.enabled=void 0===e.enabled?this.enabled:e.enabled,this.level=void 0===e.level?this.level:e.level}get prefix(){return this.name+":"}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(79);t.WORKERCHANNEL_MSG_TYPE="worker-channel-message";t.WorkerChannel=class{error(e,...r){const n={message:[e,...r],type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Error};self.postMessage(n)}debug(e,...r){const n={message:[e,...r],type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Debug};self.postMessage(n)}info(e,...r){const n={message:[e,...r],type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Info};self.postMessage(n)}log(e,...r){const n={message:[e,...r],type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Log};self.postMessage(n)}trace(e,...r){const n={message:[e,...r],type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Trace};self.postMessage(n)}warn(e,...r){const n={message:[e,...r],type:t.WORKERCHANNEL_MSG_TYPE,level:i.LogLevel.Warn};self.postMessage(n)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=new(r(0).Color),n={h:0,s:0,l:0};var o;!function(e){e[e.Meters=0]="Meters",e[e.Pixels=1]="Pixels",e[e.Hex=2]="Hex",e[e.RGB=3]="RGB",e[e.HSL=4]="HSL"}(o=t.StringEncodedNumeralType||(t.StringEncodedNumeralType={})),t.StringEncodedMeters={type:o.Meters,size:1,regExp:/((?=\.\d|\d)(?:\d+)?(?:\.?\d*))m/,decoder:e=>[Number(t.StringEncodedMeters.regExp.exec(e)[1])]},t.StringEncodedPixels={type:o.Pixels,size:1,mask:1,regExp:/((?=\.\d|\d)(?:\d+)?(?:\.?\d*))px/,decoder:e=>[Number(t.StringEncodedPixels.regExp.exec(e)[1])]},t.StringEncodedHex={type:o.Hex,size:3,regExp:/#([0-9A-Fa-f]{1,2})([0-9A-Fa-f]{1,2})([0-9A-Fa-f]{1,2})/,decoder:e=>(i.set(e).getHSL(n),[n.h,n.s,n.l])},t.StringEncodedRGB={type:o.RGB,size:3,regExp:/rgb\((?:([0-9]{1,2}|1[0-9]{1,2}|2[0-4][0-9]|25[0-5]), ?)(?:([0-9]{1,2}|1[0-9]{1,2}|2[0-4][0-9]|25[0-5]), ?)(?:([0-9]{1,2}|1[0-9]{1,2}|2[0-4][0-9]|25[0-5]))\)/,decoder:e=>{const r=t.StringEncodedRGB.regExp.exec(e);return i.setRGB(parseInt(r[1],10)/255,parseInt(r[2],10)/255,parseInt(r[3],10)/255).getHSL(n),[n.h,n.s,n.l]}},t.StringEncodedHSL={type:o.HSL,size:3,regExp:/hsl\(((?:[0-9]|[1-9][0-9]|1[0-9]{1,2}|2[0-9]{1,2}|3[0-5][0-9]|360)), ?(?:([0-9]|[1-9][0-9]|100)%), ?(?:([0-9]|[1-9][0-9]|100)%)\)/,decoder:e=>{const r=t.StringEncodedHSL.regExp.exec(e);return[parseInt(r[1],10)/360,parseInt(r[2],10)/100,parseInt(r[3],10)/100]}},t.StringEncodedNumeralFormats=[t.StringEncodedMeters,t.StringEncodedPixels,t.StringEncodedHex,t.StringEncodedRGB,t.StringEncodedHSL]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(4);t.getArrayConstructor=function(e){switch(e){case"float":return Float32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array}},function(e){e[e.Unspecified=0]="Unspecified",e[e.Point=1]="Point",e[e.Line=2]="Line",e[e.SolidLine=3]="SolidLine",e[e.Text=4]="Text",e[e.TextPath=5]="TextPath",e[e.ExtrudedLine=6]="ExtrudedLine",e[e.Polygon=7]="Polygon",e[e.ExtrudedPolygon=8]="ExtrudedPolygon",e[e.Object3D=9]="Object3D",e[e.Other=1e3]="Other"}(t.GeometryType||(t.GeometryType={})),t.getProjection=function(e){switch(e){case"mercator":return i.mercatorProjection;case"webMercator":return i.webMercatorProjection;case"sphere":return i.sphereProjection;case"normalizedEquirectangular":return i.normalizedEquirectangularProjection;case"equirectangular":return i.equirectangularProjection;default:throw new Error(`Unknown projection ${e}`)}},t.getProjectionName=function(e){if(e===i.mercatorProjection)return"mercator";if(e===i.webMercatorProjection)return"webMercator";if(e===i.sphereProjection)return"sphere";if(e===i.normalizedEquirectangularProjection)return"normalizedEquirectangular";if(e===i.equirectangularProjection)return"equirectangular";throw new Error("Unknown projection")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(42),n=r(17),o=r(29),a=r(18),s=r(30),c=r(28),l=r(31),u=r(0);class d extends l.Projection{constructor(){super(...arguments),this.type=l.ProjectionType.Planar}getScaleFactor(e){return 1}worldExtent(e,t,r){return r||(r=a.MathUtils.newEmptyBox3()),r.min.x=0,r.min.y=0,r.min.z=e,r.max.x=this.unitScale,r.max.y=this.unitScale/2,r.max.z=t,r}projectPoint(e,t){return void 0===t&&(t={x:0,y:0,z:0}),t.x=(u.Math.degToRad(e.longitude)+Math.PI)*d.geoToWorldScale*this.unitScale,t.y=(u.Math.degToRad(e.latitude)+.5*Math.PI)*d.geoToWorldScale*this.unitScale,t.z=e.altitude||0,t}unprojectPoint(e){return n.GeoCoordinates.fromRadians(e.y*d.worldToGeoScale/this.unitScale-.5*Math.PI,e.x*d.worldToGeoScale/this.unitScale-Math.PI,e.z)}unprojectAltitude(e){return e.z}projectBox(e,t){const r=this.projectPoint(new n.GeoCoordinates(e.center.latitude,e.center.longitude,0)),{latitudeSpanInRadians:i,longitudeSpanInRadians:c,altitudeSpan:l}=e,u=c*d.geoToWorldScale,h=i*d.geoToWorldScale;return t||(t=a.MathUtils.newEmptyBox3()),o.isBox3Like(t)?(t.min.x=r.x-.5*u*this.unitScale,t.min.y=r.y-.5*h*this.unitScale,t.max.x=r.x+.5*u*this.unitScale,t.max.y=r.y+.5*h*this.unitScale,void 0!==l?(t.min.z=r.z-.5*l,t.max.z=r.z+.5*l):(t.min.z=0,t.max.z=0)):s.isOrientedBox3Like(t)&&(a.MathUtils.newVector3(1,0,0,t.xAxis),a.MathUtils.newVector3(0,1,0,t.yAxis),a.MathUtils.newVector3(0,0,1,t.zAxis),t.position.x=r.x,t.position.y=r.y,t.position.z=r.z,t.extents.x=.5*u*this.unitScale,t.extents.y=.5*h*this.unitScale,t.extents.z=Math.max(Number.EPSILON,.5*(l||0))),t}unprojectBox(e){const t=this.unprojectPoint(e.min),r=this.unprojectPoint(e.max);return i.GeoBox.fromCoordinates(t,r)}groundDistance(e){return e.z}scalePointToSurface(e){return e.z=0,e}surfaceNormal(e,t){return void 0===t?t={x:0,y:0,z:1}:(t.x=0,t.y=0,t.z=1),t}}d.geoToWorldScale=1/(2*Math.PI),d.worldToGeoScale=2*Math.PI/1,t.normalizedEquirectangularProjection=new d(1),t.equirectangularProjection=new d(c.EarthConstants.EQUATORIAL_CIRCUMFERENCE)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(42),n=r(17),o=r(29),a=r(18),s=r(30),c=r(28),l=r(31);class u extends l.Projection{constructor(e){super(e),this.unitScale=e,this.type=l.ProjectionType.Planar,this.m_phi0=0,this.m_lambda0=0}static clampGeoPoint(e,t){const r=e.latitude,i=e.longitude,o=d.POLE_RADIUS,a=d.POLE_RADIUS_SQ,s=Math.round(i/90),c=90*s-i;if(s%2==0||Math.abs(c)>o)return e;const l=r-0,u=c*c+l*l;if(u<a){const e=Math.sqrt(u),t=(o-e)/e,a=1,s=0===c&&0===l?o*a:c;return new n.GeoCoordinates(r+l*t,i+s*t)}return e}getScaleFactor(e){return Math.cosh(2*(e.x/this.unitScale-.5)*Math.PI)}worldExtent(e,t,r){return r||(r=a.MathUtils.newEmptyBox3()),r.min.x=0,r.min.y=0,r.min.z=e,r.max.x=this.unitScale,r.max.y=this.unitScale,r.max.z=t,r}projectPoint(e,t){t||(t={x:0,y:0,z:0});const r=u.clampGeoPoint(e,this.unitScale),i=r.longitude/360+.5,n=1===i?0:Math.floor(i),o=a.MathUtils.degToRad(r.latitude),s=a.MathUtils.degToRad(r.longitude-360*n)-this.m_lambda0,c=Math.cos(o)*Math.sin(s);t.x=Math.atanh(c),t.y=Math.atan2(Math.tan(o),Math.cos(s))-this.m_phi0;const l=.5/Math.PI;return t.x=this.unitScale*(a.MathUtils.clamp(t.x*l+.5,0,1)+n),t.y=this.unitScale*a.MathUtils.clamp(t.y*l+.5,0,1),t.z=e.altitude||0,t}unprojectPoint(e){const t=2*Math.PI,r=e.x/this.unitScale,i=e.y/this.unitScale,o=1===r?0:Math.floor(r),a=t*(r-.5-o),s=t*(i-.5),c=e.z||0,l=s+this.m_phi0,u=Math.asin(Math.sin(l)/Math.cosh(a)),d=this.m_lambda0+Math.atan2(Math.sinh(a),Math.cos(l))+o*t;return n.GeoCoordinates.fromRadians(u,d,c)}projectBox(e,t){const{north:r,south:i,east:c,west:l}=e,u=[e.center,e.northEast,e.southWest,new n.GeoCoordinates(i,c),new n.GeoCoordinates(r,l)],h=d.POLE_EDGE_DEG,m=l<90&&c>90,p=l<0&&c>0,f=l<h&&c>-h&&r>0&&i<0;l<-90&&c>-90&&(u.push(new n.GeoCoordinates(r,-90)),u.push(new n.GeoCoordinates(i,-90))),m&&(u.push(new n.GeoCoordinates(r,90)),u.push(new n.GeoCoordinates(i,90))),p&&(u.push(new n.GeoCoordinates(r,0)),u.push(new n.GeoCoordinates(i,0))),f&&(u.push(new n.GeoCoordinates(0,l)),u.push(new n.GeoCoordinates(0,c))),d.alignLatitude(u,u[0]);const g=u.map(e=>this.projectPoint(e)),y=g.map(e=>e.x),v=g.map(e=>e.y),_=g.map(e=>e.z),b=Math.min(...y),S=Math.min(...v),T=Math.min(..._),E=Math.max(...y),w=Math.max(...v),C=Math.max(..._);if(t||(t=a.MathUtils.newEmptyBox3()),o.isBox3Like(t))t.min.x=b,t.min.y=S,t.min.z=T,t.max.x=E,t.max.y=w,t.max.z=C;else{if(!s.isOrientedBox3Like(t))throw new Error("invalid bounding box");a.MathUtils.newVector3(1,0,0,t.xAxis),a.MathUtils.newVector3(0,1,0,t.yAxis),a.MathUtils.newVector3(0,0,1,t.zAxis),t.position.x=(b+E)/2,t.position.y=(S+w)/2,t.position.z=(T+C)/2,t.extents.x=(E-b)/2,t.extents.y=(w-S)/2,t.extents.z=(C-T)/2}return t}unprojectBox(e){const t=this.unitScale,r=e.min,o=e.max,a=[{x:(r.x+o.x)/2,y:(r.y+o.y)/2,z:0},r,o,{x:r.x,y:o.y,z:0},{x:o.x,y:r.y,z:0}],s=.5*t,c=.25*t,l=.75*t,u=r.x<s&&o.x>s,h=r.y<s&&o.y>s,m=r.y<c&&o.y>c,p=r.y<l&&o.y>l;h&&(a.push({x:r.x,y:s,z:0}),a.push({x:o.x,y:s,z:0}),u&&a.push({x:s,y:s,z:0})),m&&(a.push({x:r.x,y:c,z:0}),a.push({x:o.x,y:c,z:0}),u&&a.push({x:s,y:c,z:0})),p&&(a.push({x:r.x,y:l,z:0}),a.push({x:o.x,y:l,z:0}),u&&a.push({x:s,y:l,z:0}));const f=a.map(e=>this.unprojectPoint(e));d.alignLongitude(f,f[0]);const g=f.map(e=>e.latitude),y=f.filter(e=>Math.abs(e.latitude)<90).map(e=>e.longitude),v=f.map(e=>e.altitude||0),_=new n.GeoCoordinates(Math.min(...g),Math.min(...y),Math.min(...v)),b=new n.GeoCoordinates(Math.max(...g),Math.max(...y),Math.max(...v));return i.GeoBox.fromCoordinates(_,b)}unprojectAltitude(e){return e.z}groundDistance(e){return e.z}scalePointToSurface(e){return e.z=0,e}surfaceNormal(e,t){return void 0===t?t={x:0,y:0,z:-1}:(t.x=0,t.y=0,t.z=-1),t}}class d{static alignLatitude(e,t){for(const r of e)0===r.latitude&&(r.latitude=1e-9*t.latitude)}static alignLongitude(e,t){const r=t.longitude<0?180:-180,i=t.longitude<0?-180:180;for(const t of e)t.longitude===r&&(t.longitude=i)}}t.TransverseMercatorUtils=d,d.POLE_EDGE=1.4844222297453322,d.POLE_EDGE_DEG=a.MathUtils.radToDeg(d.POLE_EDGE),d.POLE_RADIUS=90-d.POLE_EDGE_DEG,d.POLE_RADIUS_SQ=Math.pow(d.POLE_RADIUS,2),t.transverseMercatorProjection=new u(c.EarthConstants.EQUATORIAL_CIRCUMFERENCE)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(18);t.FlatTileBoundingBoxGenerator=class{constructor(e,t=0,r=0){this.tilingScheme=e,this.minElevation=t,this.maxElevation=r,this.m_tilingScheme=e,this.m_worldBox=e.projection.worldExtent(t,r);const{min:i,max:n}=this.m_worldBox;this.m_worldDimensions={x:n.x-i.x,y:n.y-i.y,z:n.z-i.z}}get projection(){return this.m_tilingScheme.projection}get subdivisionScheme(){return this.m_tilingScheme.subdivisionScheme}getWorldBox(e,t){const r=e.level,n=this.subdivisionScheme.getLevelDimensionX(r),o=this.subdivisionScheme.getLevelDimensionY(r),a=this.m_worldDimensions.x/n,s=this.m_worldDimensions.y/o,c=this.m_worldBox.min.x+a*e.column,l=this.m_worldBox.min.y+s*e.row;return t||(t=i.MathUtils.newEmptyBox3()),t.min.x=c,t.min.y=l,t.min.z=this.m_worldBox.min.z,t.max.x=c+a,t.max.y=l+s,t.max.z=this.m_worldBox.max.z,t}getGeoBox(e){const t=this.getWorldBox(e);return this.projection.unprojectBox(t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.halfQuadTreeSubdivisionScheme=new class{getSubdivisionX(){return 2}getSubdivisionY(e){return 0===e?1:2}getLevelDimensionX(e){return 1<<e}getLevelDimensionY(e){return 0!==e?1<<e-1:1}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(58);class n{constructor(e,t,r){this.tileKey=e,this.sizeX=t,this.sizeY=r}[Symbol.iterator](){return 2===this.sizeX&&2===this.sizeY?n.ZCurveIterator(this.tileKey):n.RowColumnIterator(this.tileKey,this.sizeX,this.sizeY)}}t.SubTiles=n,function(e){e.RowColumnIterator=function*(e,t,r){for(let n=0;n<r;n++)for(let o=0;o<t;o++)yield i.TileKey.fromRowColumnLevel(e.row*r+n,e.column*t+o,e.level+1)},e.ZCurveIterator=function*(e){for(let t=0;t<4;t++)yield i.TileKey.fromRowColumnLevel(e.row<<1|t>>1,e.column<<1|1&t,e.level+1)}}(n=t.SubTiles||(t.SubTiles={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(17),n=r(58);class o{static geoCoordinatesToTileKey(e,t,r){const i=e.projection.projectPoint(t);return this.worldCoordinatesToTileKey(e,i,r)}static worldCoordinatesToTileKey(e,t,r){const i=e.projection,o=e.subdivisionScheme,a=o.getLevelDimensionX(r),s=o.getLevelDimensionY(r),{min:c,max:l}=i.worldExtent(0,0),u=l.x-c.x,d=l.y-c.y;if(t.x<c.x||t.x>l.x)return null;if(t.y<c.y||t.y>l.y)return null;const h=Math.min(a-1,Math.floor(a*(t.x-c.x)/u)),m=Math.min(s-1,Math.floor(s*(t.y-c.y)/d));return n.TileKey.fromRowColumnLevel(m,h,r)}static geoRectangleToTileKeys(e,t,r){const a=(e,t,r)=>e<t?r-(t-e)%(r-t):t+(e-t)%(r-t),s=(e,t,r)=>Math.min(Math.max(e,t),r),c=a(t.southWest.longitudeInRadians,-Math.PI,Math.PI),l=s(t.southWest.latitudeInRadians,-.5*Math.PI,.5*Math.PI),u=a(t.northEast.longitudeInRadians,-Math.PI,Math.PI),d=s(t.northEast.latitudeInRadians,-.5*Math.PI,.5*Math.PI),h=o.geoCoordinatesToTileKey(e,i.GeoCoordinates.fromRadians(l,c),r),m=o.geoCoordinatesToTileKey(e,i.GeoCoordinates.fromRadians(d,u),r),p=e.subdivisionScheme.getLevelDimensionX(r);if(!h||!m)throw new Error("Invalid coordinates");const f=h.column;let g=m.column;c>u&&(g+=g!==f?p:p-1);const y=Math.min(h.row,m.row),v=Math.max(h.row,m.row),_=new Array;for(let e=y;e<=v;++e)for(let t=f;t<=g;++t)_.push(n.TileKey.fromRowColumnLevel(e,t%p,r));return _}}t.TileKeyUtils=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(135);t.TileTreeTraverse=class{constructor(e){this.m_subdivisionScheme=e}subTiles(e){const t=this.m_subdivisionScheme.getSubdivisionX(e.level),r=this.m_subdivisionScheme.getSubdivisionY(e.level);return new i.SubTiles(e,t,r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=r(19),o=r(306),a=r(41),s=r(55),c=r(125),l=r(78),u=r(54),d=i.LoggerManager.instance.create("StyleSetEvaluator"),h=c.mergeTechniqueDescriptor({});class m{classify(e){if(e._whenExpr){const t=this.switchStyle(e);e._whenExpr=e._whenExpr.accept(this,void 0),this._style=t}}visitNullLiteralExpr(e,t){return e}visitBooleanLiteralExpr(e,t){return e}visitNumberLiteralExpr(e,t){return e}visitStringLiteralExpr(e,t){return e}visitObjectLiteralExpr(e,t){return e}visitVarExpr(e,t){return e}visitHasAttributeExpr(e,t){return e}visitContainsExpr(e,t){return e}visitMatchExpr(e,t){return e}visitCaseExpr(e,t){return e}visitCallExpr(e,t){if("all"===e.op){const t=e.args.map(t=>t.accept(this,e)).filter(e=>void 0!==e);return new n.CallExpr(e.op,t)}if(t){const t=this.matchVarStringComparison(e);if(t){if(void 0===this._style.layer&&"$layer"===t.name)return void(this._style.layer=t.value);if(void 0===this._style._geometryType&&"$geometryType"===t.name)return void(this._style._geometryType=t.value)}}return e}matchVarStringComparison(e){if("=="===e.op){const t=e.args[0],r=e.args[1];if(t instanceof n.VarExpr&&r instanceof n.StringLiteralExpr)return{name:t.name,value:r.value};if(r instanceof n.VarExpr&&t instanceof n.StringLiteralExpr)return{name:r.name,value:t.value}}}switchStyle(e){const t=this._style;return this._style=e,t}}class p{constructor(e,t){this.key="",this.set(e,t)}set(e,t,r){let i=!1;if(void 0===e){const t=void 0!==r?r.lookup("$layer"):void 0;e="string"==typeof t?t:void 0}if(this.layer!==e&&(this.layer=e,i=!0),void 0===t){const e=void 0!==r?r.lookup("$geometryType"):void 0;t="string"==typeof e?e:void 0}return this.geometryType!==t&&(this.geometryType=t,i=!0),i&&this.updateKey(),this}updateKey(){void 0!==this.layer?void 0!==this.geometryType?this.key=`${this.layer}:${this.geometryType}`:this.key=`${this.layer}:`:void 0!==this.geometryType?this.key=`:${this.geometryType}`:this.key="all",this.cachedStyleSet=void 0}}function f(e,t){if(void 0!==e.renderOrderBiasGroup){const r=e.renderOrderBiasGroup?t.renderOrderBiasGroups.get(e.renderOrderBiasGroup):void 0;if(void 0!==e.renderOrderBiasRange&&void 0===r){void 0!==e.renderOrder&&d.warn("WARN: style.renderOrder will be overridden if renderOrderBiasGroup is set:",e);const[r,i]=e.renderOrderBiasRange;e.renderOrder=r<0?t.techniqueRenderOrder+Math.abs(r):t.techniqueRenderOrder,t.techniqueRenderOrder+=Math.abs(r)+i,e.renderOrderBiasGroup&&t.renderOrderBiasGroups.set(e.renderOrderBiasGroup,e.renderOrder),t.techniqueRenderOrder++}else r&&(void 0!==e.renderOrder&&d.warn("WARN: style.renderOrder will be overridden if renderOrderBiasGroup is set:",e),e.renderOrder=r)}if(void 0!==e.styles)for(const r of e.styles)f(r,t);else e._styleSetIndex=t.styleSetIndex++,void 0!==e.technique&&void 0===e.renderOrder&&(e.renderOrder=t.techniqueRenderOrder++)}function g(e){const t={};for(const r in e){if(!e.hasOwnProperty(r))continue;const i=e[r];i instanceof n.Expr||(t[r]=i)}return t}t.StyleSetEvaluator=class{constructor(e,t){this.m_techniques=[],this.m_exprPool=new o.ExprPool,this.m_cachedResults=new Map,this.m_styleConditionClassifier=new m,this.m_subStyleSetCache=new Map,this.m_definitionExprCache=new Map,this.m_tmpOptimizedSubSetKey=new p,this.m_emptyEnv=new n.Env,this.m_definitions=t,this.styleSet=function(e,t){return e.map(e=>(function e(t,r){if(n.isJsonExpr(t)){if(!u.isJsonExprReference(t))throw new Error("invalid expression in this context, only 'ref's are supported");const i=t[1],n=r&&r[i];if(!n)throw new Error(`invalid reference '${i}' - not found`);if(!u.isActualSelectorDefinition(n))throw new Error(`invalid reference '${i}' - expected style definition`);return e(n,r)}const i=t.styles&&t.styles.map(t=>e(t,r)).filter(e=>void 0!==e);return Object.assign(Object.assign({},t),{styles:i})})(e,t))}(e,t),function(e){const t={techniqueRenderOrder:0,styleSetIndex:0,renderOrderBiasGroups:new Map};for(const r of e)f(r,t)}(this.styleSet),this.compileStyleSet()}getMatchingTechniques(e,t,r){const i=[],n=new Array;this.m_cachedResults.clear();const o=this.m_tmpOptimizedSubSetKey;o.set(t,r,e);const a=o.layer,s=o.geometryType,c=this.getOptimizedStyleSet(o),l=this.changeLayer("string"==typeof a?a:void 0),u=this.changeGeometryType("string"==typeof s?s:void 0);for(const t of c){if(0!==n.length)throw this.changeLayer(l),this.changeGeometryType(u),new Error("Internal error: style stack cleanup failed");if(this.processStyle(e,n,t,i))break}return this.changeLayer(l),this.changeGeometryType(u),i}wantsLayer(e){return this.getOptimizedStyleSet(this.m_tmpOptimizedSubSetKey.set(e,void 0)).length>0}wantsFeature(e,t){return this.getOptimizedStyleSet(this.m_tmpOptimizedSubSetKey.set(e,t)).length>0}get expressionEvaluatorCache(){return this.m_cachedResults}get techniques(){return this.m_techniques}get decodedTechniques(){return this.m_techniques.map(g)}changeLayer(e){const t=this.m_layer;return this.m_layer=e,t}changeGeometryType(e){const t=this.m_geometryType;return this.m_geometryType=e,t}getOptimizedStyleSet(e){if(void 0!==e.cachedStyleSet)return e.cachedStyleSet;let t=this.m_subStyleSetCache.get(e.key);return void 0!==t?(e.cachedStyleSet=t,t):(t=this.createPreFilteredStyleSet(e),this.m_subStyleSetCache.set(e.key,t),e.cachedStyleSet=t,t)}createPreFilteredStyleSet(e){const{layer:t,geometryType:r}=e;return this.styleSet.filter(e=>(void 0===t||void 0===e.layer||e.layer===t)&&(void 0===r||void 0===e._geometryType||e._geometryType===r))}compileStyleSet(){this.styleSet.forEach(e=>this.compileStyle(e)),this.styleSet.forEach(e=>{this.getOptimizedStyleSet(this.m_tmpOptimizedSubSetKey.set(e.layer,e._geometryType))})}compileStyle(e){if(void 0!==e.when)try{e._whenExpr=Array.isArray(e.when)?n.Expr.fromJSON(e.when,this.m_definitions,this.m_definitionExprCache):n.Expr.parse(e.when),this.m_styleConditionClassifier.classify(e),void 0!==e._whenExpr&&(e._whenExpr=e._whenExpr.intern(this.m_exprPool))}catch(t){d.log("failed to evaluate expression",JSON.stringify(e.when),"error",String(t))}Array.isArray(e.styles)&&e.styles.forEach(e=>this.compileStyle(e))}processStyle(e,t,r,i){if(void 0!==this.m_layer&&void 0!==r.layer&&r.layer!==this.m_layer)return!1;if(void 0!==this.m_geometryType&&void 0!==r._geometryType&&r._geometryType!==this.m_geometryType)return!1;if(r._whenExpr)try{if(!r._whenExpr.evaluate(e,n.ExprScope.Condition,this.m_cachedResults))return!1}catch(e){return d.error(`failed to evaluate expression '${JSON.stringify(r.when)}': ${e}`),!1}if(void 0!==r.styles){t.push(r);for(const n of r.styles)if(this.processStyle(e,t,n,i))return t.pop(),!0;return t.pop(),!1}return void 0!==r.technique&&("none"!==r.technique&&i.push(this.getTechniqueForStyleMatch(e,t,r)),!0===r.final)}getTechniqueForStyleMatch(e,t,r){if(this.checkStyleDynamicAttributes(r,t),void 0!==r._dynamicTechniques){const t=this.evaluateTechniqueProperties(r,e),i=this.getDynamicTechniqueKey(r,t);let n=r._dynamicTechniques.get(i);return void 0===n&&(n=this.createTechnique(r,i,t),r._dynamicTechniques.set(i,n)),n}{let e=r._staticTechnique;return void 0===e&&(r._staticTechnique=e=this.createTechnique(r,`${r._styleSetIndex}`,[])),e}}getDynamicTechniqueKey(e,t){const r=t.map(([e,t])=>void 0===t?"U":JSON.stringify(t)).join(":");return`${e._styleSetIndex}:${r}`}checkStyleDynamicAttributes(e,t){if(void 0!==e._dynamicTechniqueAttributes||"none"===e.technique)return;e._dynamicTechniqueAttributes=[],e._dynamicFeatureAttributes=[],e._dynamicForwardedAttributes=[],e._staticAttributes=[];const r=e._dynamicFeatureAttributes,i=e._dynamicTechniqueAttributes,o=e._dynamicForwardedAttributes,u=e._staticAttributes,d=l.techniqueDescriptors[e.technique]||h,m=(e,t)=>{if(void 0===t)return;const l=d.attrScopes[e];if(n.isJsonExpr(t)?t=n.Expr.fromJSON(t,this.m_definitions,this.m_definitionExprCache).intern(this.m_exprPool):a.isInterpolatedPropertyDefinition(t)&&(t=n.Expr.fromJSON(s.interpolatedPropertyDefinitionToJsonExpr(t)).intern(this.m_exprPool)),t instanceof n.Expr){0===t.dependencies().properties.size&&(t=t.evaluate(this.m_emptyEnv))}if(a.isInterpolatedProperty(t)||t instanceof n.Expr)switch(l){case c.AttrScope.FeatureGeometry:r.push([e,t]);break;case c.AttrScope.TechniqueRendering:case c.AttrScope.TechniqueGeometry:t instanceof n.Expr?i.push([e,t]):o.push([e,t])}else null!=t&&u.push([e,t])};function p(e){if(m("renderOrder",e.renderOrder),m("renderOrderOffset",e.renderOrderOffset),m("label",e.labelProperty),m("secondaryRenderOrder",e.secondaryRenderOrder),void 0!==e.attr)for(const t in e.attr)e.attr.hasOwnProperty(t)&&m(t,e.attr[t])}for(const e of t)p(e);p(e),i.length>0&&(e._dynamicTechniques=new Map)}evaluateTechniqueProperties(e,t){return void 0===e._dynamicTechniqueAttributes?[]:e._dynamicTechniqueAttributes.map(([e,r])=>{try{return[e,r.evaluate(t,n.ExprScope.Value,this.m_cachedResults)]}catch(t){return d.error(`failed to evaluate expression '${r.toJSON()}': ${t}`),[e,null]}})}createTechnique(e,t,r){const i={};if(i.name=e.technique,void 0!==e._staticAttributes)for(const[t,r]of e._staticAttributes)null!==r&&(i[t]=r);for(const[e,t]of r)null!==t&&(i[e]=t);if(void 0!==e._dynamicFeatureAttributes)for(const[t,r]of e._dynamicFeatureAttributes)i[t]=r;if(void 0!==e._dynamicForwardedAttributes)for(const[t,r]of e._dynamicForwardedAttributes)r instanceof n.Expr||(i[t]=r);return i._index=this.m_techniques.length,i._styleSetIndex=e._styleSetIndex,i._key=t,this.m_techniques.push(i),i}},t.makeDecodedTechnique=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=r(19),o=r(41),a=i.LoggerManager.instance.create("TechniqueAttr");t.evaluateTechniqueAttr=function(e,t,r){const i=e instanceof n.Env?e:e.env;let s;if(t instanceof n.Expr)try{s=t.evaluate(i,n.ExprScope.Value,e instanceof n.Env?void 0:e.cachedExprResults)}catch(e){a.error(`failed to evaluate expression '${JSON.stringify(t)}': ${e}`),s=void 0}else if(o.isInterpolatedProperty(t)){const r=e instanceof n.Env?e.lookup("$zoom"):e.zoomLevel;s=o.getPropertyValue(t,r)}else s=t;return null==s?r:s}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(314),n=i.default||i;t.GeoJsonTiler=class{constructor(){this.indexes=new Map}dispose(){}async connect(){return Promise.resolve()}async registerIndex(e,t){if(!this.indexes.has(e))return this.updateIndex(e,t)}async updateIndex(e,t){if(t instanceof URL){const e=await fetch(t.href);if(!e.ok)throw new Error(`GeoJsonTiler: Unable to fetch ${t.href}: ${e.statusText}`);t=await e.json()}else t=t;this.indexes.set(e,n(t,{maxZoom:20,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:0,lineMetrics:!1,promoteId:null,generateId:!0,debug:0}))}async getTile(e,t){const r=this.indexes.get(e);if(void 0===r)throw new Error("Tile not found");const i=r.getTile(t.level,t.column,t.row);return null!==i&&(i.layer=e),i||{}}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(60),a=r(142),s=r(81),c=r(328),l=r(143);function u(e){return void 0!==e.getBearerToken}t.isOAuthAuthorization=u;var d=function(){function e(e){this.apiVersion=2,this.hrn=e.hrn,this.serviceUrls=void 0===e.serviceUrls?{}:e.serviceUrls;var t,r=void 0===e.downloadManager?new c.DatastoreDownloadManager:e.downloadManager;if(this.serviceUrls.lookup)t=this.serviceUrls.lookup;else switch(this.hrn.data.partition){case"here-dev":t="https://api-lookup.data.api.platform.in.here.com/lookup/v1";break;case"here-cn":t="https://api-lookup.data.api.platform.hereolp.cn/lookup/v1";break;case"here-cn-dev":t="https://api-lookup.data.api.platform.in.hereolp.cn/lookup/v1";break;case"local":t="http://localhost:31005/lookup/v1";break;default:t="https://api-lookup.data.api.platform.here.com/lookup/v1"}if(!u(e))throw new Error("Unknown authorization method");this.discoveryRequestBuilder=new l.DataStoreRequestBuilder(r,t,e.getBearerToken)}return e.prototype.getSchemaDetails=function(e){return i(this,void 0,void 0,(function(){var t;return n(this,(function(r){switch(r.label){case 0:return[4,this.getRequestBuilders()];case 1:return t=r.sent(),[2,o.ArtifactApi.getSchemaUsingGET(t.artifactApiRequestBuilder,{schemaHrn:e}).catch((function(){throw new Error("Cannot get schema details: "+e)}))]}}))}))},e.prototype.getSchema=function(e,t){return i(this,void 0,void 0,(function(){var r,i,o,a,c,l,u;return n(this,(function(n){switch(n.label){case 0:return[4,this.getRequestBuilders()];case 1:return r=n.sent(),[4,this.getSchemaDetails(e)];case 2:if(i=n.sent(),void 0===(o=i.variants.find((function(e){return"ds"===e.id}))))throw new Error("URL of the schema bundle is not found: "+i);return a=r.artifactApiRequestBuilder.baseUrl+o.url,[4,r.blobstoreApiRequestBuilder.downloadData(a,t).catch((function(){throw new Error("Cannot download Schema bundle: "+e)}))];case 3:if(200===(c=n.sent()).status)return[2,c.arrayBuffer()];throw l={401:"You are not authorized to view the schema",403:"Accessing the schema is forbidden",404:"The schema was not found",500:"Internal server error"},u=c.statusText||l[c.status],new s.ErrorHTTPResponse("Artifact Service error: HTTP "+c.status+": "+u+", HRN: "+e,c)}}))}))},e.prototype.getCatalogsBySchema=function(e){return i(this,void 0,void 0,(function(){var t;return n(this,(function(r){switch(r.label){case 0:return[4,this.getRequestBuilders()];case 1:return t=r.sent(),[2,o.ConfigApi.getCatalogs(t.configApiRequestBuilder,{verbose:"true",schemaHrn:e})]}}))}))},e.prototype.getCatalogClient=function(t){return void 0===t&&(t=e.LATEST_VERSION),i(this,void 0,void 0,(function(){var r,i,s,c,l,u,d;return n(this,(function(n){switch(n.label){case 0:return[4,this.getRequestBuilders()];case 1:if(r=n.sent(),i=!0,t!==e.LATEST_VERSION)return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,o.MetadataApi.latestVersion(r.metaDataApiRequestBuilder,{startVersion:e.LATEST_VERSION})];case 3:if(void 0===(s=n.sent()).version||-1===s.version)throw new Error("Invalid version received from latest version call, cannot proceed. Instance: "+this.hrn.data.partition);return t=s.version,[3,5];case 4:return n.sent(),i=!1,[3,5];case 5:return i&&(c=o.MetadataApi.getLayerVersion(r.metaDataApiRequestBuilder,{version:t})),l=o.ConfigApi.getCatalog(r.configApiRequestBuilder,{catalogHrn:this.hrn.toString()}),u=[l],i&&c&&u.push(c),[4,Promise.all(u)];case 6:return d=n.sent(),[2,new a.CatalogClient({configuration:d[0],layerVersions:d[1],metaDataRequestBuilder:r.metaDataApiRequestBuilder,queryRequestBuilder:r.queryApiRequestBuilder,blobStoreRequestBuilder:r.blobstoreApiRequestBuilder,volatileBlobRequestBuilder:r.volatileBlobApiRequestBuilder,coverageRequestBuilder:r.coverageApiRequestBuilder,dataStoreClient:this})]}}))}))},e.prototype.getRequestBuilders=function(){return i(this,void 0,void 0,(function(){var e=this;return n(this,(function(t){return void 0!==this.m_requestBuildersPromise?[2,this.m_requestBuildersPromise]:(this.m_requestBuildersPromise=new Promise((function(t,r){return i(e,void 0,void 0,(function(){var e,i;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.getServiceUrlsFromAPI()];case 1:return e=n.sent(),t({configApiRequestBuilder:this.discoveryRequestBuilder.clone(e.config),blobstoreApiRequestBuilder:this.discoveryRequestBuilder.clone(e.blob),volatileBlobApiRequestBuilder:this.discoveryRequestBuilder.clone(e["volatile-blob"]),queryApiRequestBuilder:this.discoveryRequestBuilder.clone(e.query),metaDataApiRequestBuilder:this.discoveryRequestBuilder.clone(e.metadata),coverageApiRequestBuilder:this.discoveryRequestBuilder.clone(e.statistics),artifactApiRequestBuilder:this.discoveryRequestBuilder.clone(e.artifact)}),[3,3];case 2:return i=n.sent(),r(i),[3,3];case 3:return[2]}}))}))})),[2,this.m_requestBuildersPromise])}))}))},e.prototype.getServiceUrlsFromAPI=function(){return i(this,void 0,void 0,(function(){var e,t;return n(this,(function(r){switch(r.label){case 0:return e={},t=function(e,t){return e[t.api]=t.baseURL,e},[4,o.LookupApi.platformAPIList(this.discoveryRequestBuilder)];case 1:return r.sent().reduce(t,e),[4,o.LookupApi.resourceAPIList(this.discoveryRequestBuilder,{hrn:this.hrn.toString()})];case 2:return[2,r.sent().reduce(t,e)]}}))}))},e.LATEST_VERSION=-1,e}();t.DataStoreClient=d},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}};Object.defineProperty(t,"__esModule",{value:!0});var a,s=r(60),c=r(10),l=r(81),u=r(327),d=r(82);!function(e){e.BITMAP="tilemap",e.SIZEMAP="heatmap/size",e.TIMEMAP="heatmap/age"}(a||(a={}));var h=function(){function e(e){var t,r,a=this;this.INDEX_CACHE_SIZE=64,this.SCHEME_CACHE_SIZE=64,this.PARTITION_INDEX_CACHE_SIZE=4,this.layers=new Map,this.indexCache=new u.LRUCache(this.INDEX_CACHE_SIZE),this.schemeCache=new u.LRUCache(this.SCHEME_CACHE_SIZE),this.partitionIndexCache=new u.LRUCache(this.PARTITION_INDEX_CACHE_SIZE),this.indexDepth=4,this.catalog=e.configuration,this.metaDataRequestBuilder=e.metaDataRequestBuilder,this.queryRequestBuilder=e.queryRequestBuilder,this.blobStoreRequestBuilder=e.blobStoreRequestBuilder,this.volatileBlobRequestBuilder=e.volatileBlobRequestBuilder,this.coverageRequestBuilder=e.coverageRequestBuilder,this.version=e.layerVersions?e.layerVersions.version:0,this.dataStoreClient=e.dataStoreClient;var s=!!e.layerVersions&&new Map(e.layerVersions.layerVersions.map((function(e){return[e.layer,e.version]}))),c=function(e){var t=e;t.apiVersion=2,t.version=s?s.get(t.id):0,t.getTile=function(e,r){return i(a,void 0,void 0,(function(){return n(this,(function(i){return[2,this.getTile(t,e,r)]}))}))},t.getPartition=function(e,r){return i(a,void 0,void 0,(function(){return n(this,(function(i){return[2,this.getPartition(t,e,r)]}))}))},t.getIndex=function(e){return i(a,void 0,void 0,(function(){return n(this,(function(r){return[2,this.getIndex(t,e)]}))}))},t.getSchemaDetails=function(){return i(a,void 0,void 0,(function(){return n(this,(function(e){return[2,this.getSchemaDetails(t)]}))}))},t.getSchema=function(e){return i(a,void 0,void 0,(function(){return n(this,(function(r){return[2,this.getSchema(t,e)]}))}))},t.getSchema=function(e){return i(a,void 0,void 0,(function(){return n(this,(function(r){return[2,this.getSchema(t,e)]}))}))},t.getDataCoverageBitmap=function(e){return i(a,void 0,void 0,(function(){return n(this,(function(r){return[2,this.getDataCoverageBitmap(t,e)]}))}))},t.getDataCoverageSizeMap=function(e){return i(a,void 0,void 0,(function(){return n(this,(function(r){return[2,this.getDataCoverageSizeMap(t,e)]}))}))},t.getDataCoverageTimeMap=function(e){return i(a,void 0,void 0,(function(){return n(this,(function(r){return[2,this.getDataCoverageTimeMap(t,e)]}))}))},t.getSummary=function(e){return i(a,void 0,void 0,(function(){return n(this,(function(r){return[2,this.getSummary(t,e)]}))}))},l.layers.set(e.id,t)},l=this;try{for(var d=o(e.configuration.layers),h=d.next();!h.done;h=d.next()){c(h.value)}}catch(e){t={error:e}}finally{try{h&&!h.done&&(r=d.return)&&r.call(d)}finally{if(t)throw t.error}}}return e.toUrlString=function(e,t){switch(e.partitioning.scheme){case"heretile":return d.mortonCodeFromQuadKey(t).toString();default:throw new Error("Unknown partitioning scheme "+e.partitioning.scheme+". HRN: "+e.hrn)}},e.subkeyAddFunction=function(e){switch(e.partitioning.scheme){case"heretile":return function(e,t){var r=d.quadKeyFromMortonCode(t);return d.addQuadKeys(e,r)};default:throw new Error("Unknown partitioning scheme "+e.partitioning.scheme+". HRN: "+e.hrn)}},e.toTileKeyFunction=function(e){switch(e.partitioning.scheme){case"heretile":return function(e){return d.quadKeyFromMortonCode(e)};default:throw new Error("Unknown partitioning scheme "+e.partitioning.scheme+". HRN: "+e.hrn)}},e.prototype.getPartitionIndex=function(e){return i(this,void 0,void 0,(function(){var t,r;return n(this,(function(i){switch(i.label){case 0:return void 0!==(t=this.partitionIndexCache.get(e.id))?[2,t]:[4,this.downloadPartitionIndex(e)];case 1:return r=i.sent(),this.partitionIndexCache.set(e.id,r),[2,r]}}))}))},e.prototype.getIndex=function(e,t){return i(this,void 0,void 0,(function(){var r;return n(this,(function(i){if(!d.isValid(t))throw Error("QuadKey is not valid");return void 0!==(r=this.findCachedIndex(e,t))?[2,r]:[2,this.downloadIndex(e,t)]}))}))},e.prototype.downloadData=function(e,t){return i(this,void 0,void 0,(function(){return n(this,(function(r){return[2,this.blobStoreRequestBuilder.downloadData(e,t)]}))}))},e.prototype.getLayer=function(e){var t=this.findLayer(e);if(void 0===t)throw new Error("Layer '"+e+"' not found in catalog");return t},e.prototype.findLayer=function(e){return this.layers.get(e)},e.prototype.getTile=function(e,t,r){return i(this,void 0,void 0,(function(){var i;return n(this,(function(n){switch(n.label){case 0:if(!d.isValid(t))throw Error("QuadKey is not valid");return[4,this.getDataTag(e,t)];case 1:return void 0===(i=n.sent())?[2,Promise.resolve(new Response(null,{status:204}))]:[2,this.downloadTile(e,i,r)]}}))}))},e.prototype.getAggregatedTile=function(e,t,r){return i(this,void 0,void 0,(function(){var i,o,a;return n(this,(function(n){switch(n.label){case 0:return[4,this.getIndexFor(e,t)];case 1:return i=n.sent(),void 0===(o=this.findAggregatedIndex(i,t))?[2,Promise.resolve(new Response(null,{status:204}))]:[4,this.downloadTile(e,o.dataHandle,r)];case 2:return(a=n.sent()).quadKey=o.quadKey,[2,a]}}))}))},e.prototype.getPartition=function(e,t,r){return i(this,void 0,void 0,(function(){var i,o,a;return n(this,(function(n){switch(n.label){case 0:return[4,this.getPartitionIndex(e)];case 1:if(i=n.sent(),void 0===(o=i.partitions.find((function(e){return e.partition===t}))))throw new Error("Unknown partition: "+t+" in layer "+e.id+". HRN: "+e.hrn);return a=this.partitionUrl(e,o),[2,this.downloadData(a,r)]}}))}))},e.prototype.getSchema=function(e,t){return i(this,void 0,void 0,(function(){return n(this,(function(r){if(void 0===e.schema||void 0===e.schema.hrn)throw new Error("Required property 'schema.hrn' missing in the layer "+e);return[2,this.dataStoreClient.getSchema(e.schema.hrn,t)]}))}))},e.prototype.getSchemaDetails=function(e){return i(this,void 0,void 0,(function(){var t,r;return n(this,(function(i){switch(i.label){case 0:if(void 0!==(t=this.findCachedScheme(e)))return[2,t];if(void 0===e.schema||void 0===e.schema.hrn)throw new Error("Required property 'schema.hrn' missing in layer "+e.name);return[4,this.dataStoreClient.getSchemaDetails(e.schema.hrn)];case 1:return r=i.sent(),void 0!==(t=this.findCachedScheme(e))?[2,t]:(this.cacheScheme(e,r),[2,r])}}))}))},e.prototype.getDataCoverageBitmap=function(e,t){return i(this,void 0,void 0,(function(){return n(this,(function(r){return[2,this.getDataCoverage(a.BITMAP,e,t)]}))}))},e.prototype.getDataCoverageSizeMap=function(e,t){return i(this,void 0,void 0,(function(){return n(this,(function(r){return[2,this.getDataCoverage(a.SIZEMAP,e,t)]}))}))},e.prototype.getDataCoverageTimeMap=function(e,t){return i(this,void 0,void 0,(function(){return n(this,(function(r){return[2,this.getDataCoverage(a.TIMEMAP,e,t)]}))}))},e.prototype.getSummary=function(e,t){return i(this,void 0,void 0,(function(){var r,i,o,a;return n(this,(function(n){switch(n.label){case 0:return r=this.coverageRequestBuilder.baseUrl+"/layers/"+e.id+"/summary",i=new c.UrlBuilder(r),void 0!==this.version&&i.appendQuery("version",this.version),[4,this.coverageRequestBuilder.downloadData(i.url,t).catch((function(e){throw new Error("Statistics Service error: "+e)}))];case 1:switch((o=n.sent()).status){case 400:a="Bad request, incorrect version type";break;case 404:a="Requested file does not exist";break;case 500:a="Internal server error"}switch(o.status){case 200:return[2,o.json()];case 400:case 404:case 500:default:throw new l.ErrorHTTPResponse("Statistics Service error: HTTP "+o.status+": "+(""!==o.statusText?o.statusText:a),o)}return[2]}}))}))},e.prototype.getLatestVersion=function(e){return void 0===e&&(e=-1),i(this,void 0,void 0,(function(){return n(this,(function(t){return[2,s.MetadataApi.latestVersion(this.metaDataRequestBuilder,{startVersion:e})]}))}))},e.prototype.getVersions=function(e,t){return void 0===e&&(e=-1),i(this,void 0,void 0,(function(){var r;return n(this,(function(i){switch(i.label){case 0:return void 0!==t?[3,2]:[4,this.getLatestVersion(e)];case 1:r=i.sent(),t=r.version,i.label=2;case 2:return[2,s.MetadataApi.listVersions(this.metaDataRequestBuilder,{startVersion:e,endVersion:t})]}}))}))},e.prototype.coverageUrl=function(e,t){var r="/layers/"+e.id+"/"+t.toString();return this.coverageRequestBuilder.baseUrl+r},e.prototype.downloadPartitionIndex=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(t){if("volatile"!==e.layerType&&void 0===e.version)throw new Error("Unable to download partitions for unversioned layer "+e.id+". HRN: "+e.hrn);return{layerId:e.id},"volatile"!==e.layerType?[2,s.MetadataApi.getPartitions(this.metaDataRequestBuilder,{layerId:e.id,version:e.version})]:[2,s.MetadataApi.getPartitions(this.metaDataRequestBuilder,{layerId:e.id})]}))}))},e.prototype.getIndexFor=function(e,t){return i(this,void 0,void 0,(function(){var r,i;return n(this,(function(n){switch(n.label){case 0:for(r=this.indexDepth;r>=0;--r)if(void 0!==(i=this.findCachedIndex(e,d.computeParentKey(t,r))))return[2,i];return[4,this.downloadIndex(e,d.computeParentKey(t,this.indexDepth))];case 1:return[2,n.sent()]}}))}))},e.prototype.getDataCoverage=function(e,t,r){return i(this,void 0,void 0,(function(){var i,o,a,s;return n(this,(function(n){switch(n.label){case 0:return i=this.coverageUrl(t,e),o=new c.UrlBuilder(i),void 0!==this.version&&o.appendQuery("version",this.version),[4,this.coverageRequestBuilder.downloadData(o.url,r).catch((function(e){throw new Error("Statistics Service error: "+e+", HRN: "+t.hrn)}))];case 1:switch((a=n.sent()).status){case 400:s="Bad request, incorrect version type";break;case 404:s="Requested file does not exist";break;case 500:s="Internal server error"}switch(s+=" HRN: "+t.hrn,a.status){case 200:return[2,a.blob()];case 400:case 404:case 500:default:throw new l.ErrorHTTPResponse("Statistics Service error: HTTP "+a.status+": "+(""!==a.statusText?a.statusText:s),a)}return[2]}}))}))},e.prototype.getDataTag=function(e,t){return i(this,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:return[4,this.getIndexFor(e,t)];case 1:return[2,r.sent().get(d.mortonCodeFromQuadKey(t))]}}))}))},e.prototype.findCachedIndex=function(e,t){var r=e.id+"/"+d.mortonCodeFromQuadKey(t).toString();return this.indexCache.get(r)},e.prototype.cacheIndex=function(e,t){this.indexCache.set(e,t)},e.prototype.cacheScheme=function(e,t){this.schemeCache.set(e.id,t)},e.prototype.findCachedScheme=function(e){return this.schemeCache.get(e.id)},e.prototype.parseIndex=function(t,r,i){var n,a,s,c,l=e.subkeyAddFunction(t),u=e.toTileKeyFunction(t),h=new Map;if(!i)return h;if(void 0===i.subQuads)return h;try{for(var m=o(i.subQuads),p=m.next();!p.done;p=m.next()){var f=p.value,g=l(r,f.subQuadKey);h.set(d.mortonCodeFromQuadKey(g),f.dataHandle)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(a=m.return)&&a.call(m)}finally{if(n)throw n.error}}if(void 0!==i.parentQuads)try{for(var y=o(i.parentQuads),v=y.next();!v.done;v=y.next()){var _=v.value,b=u(_.partition);h.set(d.mortonCodeFromQuadKey(b),_.dataHandle)}}catch(e){s={error:e}}finally{try{v&&!v.done&&(c=y.return)&&c.call(y)}finally{if(s)throw s.error}}return h},e.prototype.downloadIndex=function(t,r){return i(this,void 0,void 0,(function(){var i,o,a,c;return n(this,(function(n){switch(n.label){case 0:return i=t.id+"/"+d.mortonCodeFromQuadKey(r).toString(),"volatile"!==t.layerType?[3,2]:[4,s.QueryApi.quadTreeIndexVolatile(this.queryRequestBuilder,{layerId:t.id,quadKey:e.toUrlString(t,r),depth:this.indexDepth})];case 1:return o=n.sent(),[3,4];case 2:if(void 0===t.version)throw new Error("Unable to download tiles for unversioned layer "+t.id+". HRN: "+t.hrn);return[4,s.QueryApi.quadTreeIndex(this.queryRequestBuilder,{version:t.version,layerId:t.id,quadKey:e.toUrlString(t,r),depth:this.indexDepth})];case 3:o=n.sent(),n.label=4;case 4:return void 0!==(a=this.indexCache.get(i))?[2,a]:(c=this.parseIndex(t,r,o),this.cacheIndex(i,c),[2,c])}}))}))},e.prototype.downloadTile=function(e,t,r){return i(this,void 0,void 0,(function(){var i;return n(this,(function(n){return i=this.dataUrl(e,t),[2,this.downloadData(i,r)]}))}))},e.prototype.dataUrl=function(e,t){var r="/layers/"+e.id+"/data/"+t;return"volatile"===e.layerType?this.volatileBlobRequestBuilder.baseUrl+r:this.blobStoreRequestBuilder.baseUrl+r},e.prototype.partitionUrl=function(e,t){return this.dataUrl(e,t.dataHandle)},e.prototype.findAggregatedIndex=function(e,t){for(var r=t,i=t.level;i>=0;--i){var n=e.get(d.mortonCodeFromQuadKey(r));if(void 0!==n)return{dataHandle:n,quadKey:r};r=d.computeParentKey(r,1)}},e}();t.CatalogClient=h},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function s(e,t){return o(this,void 0,void 0,(function(){var r;return a(this,(function(i){switch(i.label){case 0:return void 0===t&&(t={}),void 0!==t.headers&&0!==Object.entries(t.headers).length||(t.headers=new Headers),[4,e()];case 1:return r=i.sent(),t.headers.append("Authorization","Bearer "+r),[2,t]}}))}))}Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(t,r,i){var n=e.call(this,r)||this;return n.downloadManager=t,n.getBearerToken=i,n}return n(t,e),t.prototype.clone=function(e){return new t(this.downloadManager,void 0===e?this.baseUrl:e,this.getBearerToken)},t.prototype.download=function(e,t){return o(this,void 0,void 0,(function(){var r,i=this;return a(this,(function(n){switch(n.label){case 0:return[4,this.addBearerToken(t)];case 1:return r=n.sent(),[2,this.downloadManager.download(e,r).then((function(e){return o(i,void 0,void 0,(function(){return a(this,(function(t){if(e.ok)return[2,e.json()];throw new Error(JSON.stringify(e))}))}))})).catch((function(e){throw e}))]}}))}))},t.prototype.downloadData=function(e,t){return o(this,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this.addBearerToken(t)];case 1:return t=r.sent(),[2,this.downloadManager.download(e,t)]}}))}))},t.prototype.addBearerToken=function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){return[2,s(this.getBearerToken,e)]}))}))},t}(r(60).RequestBuilder);t.DataStoreRequestBuilder=c},function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(r){var i=e.call(this,r)||this;return Object.setPrototypeOf(i,t.prototype),i}return n(t,e),t}(Error);t.NotFoundError=o},function(e,t,r){"use strict";function i(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),i(r(331)),i(r(189)),i(r(383)),i(r(190)),i(r(384)),i(r(385)),i(r(386)),i(r(228));var n=r(186);t.EmptyPartitionError=n.default;var o=r(187);t.NotFoundVolatilePartitionError=o.default;var a=r(185);t.DecodingError=a.default;var s=r(444);t.PluginError=s.default,i(r(188)),i(r(70)),i(r(191)),i(r(445)),i(r(446))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);t.CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n    varying vec2 vUv;\n    void main() {\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }",fragmentShader:"\n    uniform float opacity;\n    uniform sampler2D tDiffuse;\n    varying vec2 vUv;\n    void main() {\n        vec4 texel = texture2D( tDiffuse, vUv );\n        gl_FragColor = opacity * texel;\n    }"};class n extends i.ShaderMaterial{constructor(e){super({name:"CopyMaterial",uniforms:e,vertexShader:t.CopyShader.vertexShader,fragmentShader:t.CopyShader.fragmentShader,premultipliedAlpha:!0,transparent:!1,blending:i.NoBlending,depthTest:!1,depthWrite:!1})}}t.CopyMaterial=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(85),o=r(86);t.LineCapsDefinitions={Square:"CAPS_SQUARE",Round:"CAPS_ROUND",None:"CAPS_NONE",TriangleIn:"CAPS_TRIANGLE_IN",TriangleOut:"CAPS_TRIANGLE_OUT"};const a="\n#define SEGMENT_OFFSET 0.1\n\nattribute vec3 extrusionCoord;\nattribute vec3 position;\nattribute vec4 bitangent;\nattribute vec3 tangent;\nattribute vec2 uv;\nattribute vec3 normal;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float lineWidth;\nuniform float outlineWidth;\n\n#ifdef USE_DISPLACEMENTMAP\nuniform sampler2D displacementMap;\n#endif\n\nvarying vec3 vPosition;\nvarying vec3 vRange;\nvarying vec4 vCoords;\n#if USE_COLOR\nattribute vec3 color;\nvarying vec3 vColor;\n#endif\n\n#ifdef USE_FADING\n#include <fading_pars_vertex>\n#endif\n\n#include <fog_pars_vertex>\n\n#include <extrude_line_vert_func>\n\nvoid main() {\n    // Calculate the vertex position inside the line (segment) and extrusion direction and factor.\n    float linePos = mix(\n        abs(extrusionCoord.x) - SEGMENT_OFFSET,\n        abs(extrusionCoord.y) - SEGMENT_OFFSET,\n        sign(extrusionCoord.x) / 2.0 + 0.5);\n    vec2 extrusionDir = sign(extrusionCoord.xy);\n    float extrusionFactor = extrusionDir.y * tan(bitangent.w / 2.0);\n\n    // Calculate the extruded vertex position (and scale the extrusion direction).\n    vec3 pos = extrudeLine(\n        position, linePos, lineWidth + outlineWidth, bitangent, tangent, extrusionDir);\n\n    // Store the normalized extrusion coordinates in vCoords (with their ranges in vRange).\n    vRange = vec3(extrusionCoord.z, lineWidth, extrusionFactor);\n    vCoords = vec4(extrusionDir / vRange.xy, (abs(extrusionCoord.xy) - SEGMENT_OFFSET) / vRange.x);\n\n    // Transform position.\n    #ifdef USE_DISPLACEMENTMAP\n    pos += normalize( normal ) * texture2D( displacementMap, uv ).x;\n    #endif\n    vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n    gl_Position = projectionMatrix * mvPosition;\n\n    // Pass extruded position to fragment shader.\n    vPosition = pos;\n\n    #if USE_COLOR\n    // Pass vertex color to fragment shader.\n    vColor = color;\n    #endif\n\n    #ifdef USE_FADING\n    #include <fading_vertex>\n    #endif\n\n    #include <fog_vertex>\n}",s="\nprecision highp float;\nprecision highp int;\n\nuniform vec3 diffuse;\nuniform vec3 outlineColor;\nuniform float opacity;\nuniform float lineWidth;\nuniform float outlineWidth;\nuniform vec2 tileSize;\n\n#if DASHED_LINE\nuniform float dashSize;\nuniform float gapSize;\nuniform vec3 dashColor;\n#endif\n\nvarying vec3 vPosition;\nvarying vec3 vRange;\nvarying vec4 vCoords;\n#if USE_COLOR\nvarying vec3 vColor;\n#endif\n\n#include <round_edges_and_add_caps>\n#include <tile_clip_func>\n\n#ifdef USE_FADING\n#include <fading_pars_fragment>\n#endif\n\n#include <fog_pars_fragment>\n\nvoid main() {\n    float alpha = opacity;\n    vec3 outputDiffuse = diffuse;\n\n    #if TILE_CLIP\n    tileClip(vPosition.xy, tileSize);\n    #endif\n\n    // Calculate distance to center (0.0: lineCenter, 1.0: lineEdge).\n    float distToCenter = roundEdgesAndAddCaps(vCoords, vRange);\n    // Calculate distance to edge (-1.0: lineCenter, 0.0: lineEdge).\n    float distToEdge = distToCenter - (lineWidth + outlineWidth) / lineWidth;\n\n    // Decrease the line opacity by the distToEdge, making the transition steeper when the slope\n    // of distToChange increases (i.e. the line is further away).\n    float width = fwidth(distToEdge);\n    alpha *= (1.0 - smoothstep(-width, width, distToEdge));\n\n    #if DASHED_LINE\n    // Compute the distance to the dash origin (0.0: dashOrigin, 1.0: dashEnd, (d+g)/d: gapEnd).\n    float d = dashSize / vRange.x;\n    float g = gapSize / vRange.x;\n    float distToDashOrigin = mod(vCoords.x, d + g) / d;\n\n    // Compute distance to dash edge (0.5: dashCenter, 0.0: dashEdge) and compute the\n    // dashBlendFactor similarly on how we did it for the line opacity.\n    float distToDashEdge = 0.5 - distance(distToDashOrigin, (d + g) / d * 0.5);\n    float dashWidth = fwidth(distToDashEdge);\n    float dashBlendFactor = 1.0 - smoothstep(-dashWidth, dashWidth, distToDashEdge);\n\n    #if USE_DASH_COLOR\n    outputDiffuse = mix(diffuse, dashColor, dashBlendFactor);\n    #endif\n    #endif\n\n    #ifdef USE_OUTLINE\n    // Calculate distance to outline (0.0: lineEdge, outlineWidth/lineWidth: outlineEdge) and\n    // compute the outlineBlendFactor (used to mix line and outline colors).\n    float distToOutline = distToCenter - 1.0;\n    float outlineWidth = fwidth(distToOutline);\n    float outlineBlendFactor = smoothstep(-outlineWidth, outlineWidth, distToOutline);\n\n    // Mix the colors using the different computed factors.\n    #if DASHED_LINE && USE_DASH_COLOR == 0\n    float colorBlendFactor = smoothstep(-1.0, 1.0, dashBlendFactor - outlineBlendFactor);\n    outputDiffuse = mix(\n      mix(\n        mix(outlineColor, diffuse, colorBlendFactor),\n        outputDiffuse,\n        dashBlendFactor\n      ),\n      outlineColor,\n      outlineBlendFactor\n    );\n    #else\n    outputDiffuse = mix(outputDiffuse, outlineColor, outlineBlendFactor);\n    #endif\n    #endif\n\n    // Multiply the alpha by the dashBlendFactor.\n    #if DASHED_LINE && defined(USE_OUTLINE) && USE_DASH_COLOR == 0\n    alpha *= clamp(dashBlendFactor + outlineBlendFactor, 0.0, 1.0);\n    #elif DASHED_LINE && USE_DASH_COLOR == 0\n    alpha *= 1.0 - dashBlendFactor;\n    #endif\n\n    #if USE_COLOR\n    gl_FragColor = vec4( outputDiffuse * vColor, alpha );\n    #else\n    gl_FragColor = vec4( outputDiffuse, alpha );\n    #endif\n\n    #include <fog_fragment>\n\n    #ifdef USE_FADING\n    #include <fading_fragment>\n    #endif\n}";class c extends i.RawShaderMaterial{constructor(e){Object.assign(i.ShaderChunk,o.default),n.FadingFeature.patchGlobalShaderChunks();const r={DASHED_LINE:0,TILE_CLIP:0,USE_COLOR:0,USE_DASH_COLOR:0},l=void 0!==e&&!0===e.fog;l&&(r.USE_FOG="");const u=void 0!==e&&void 0!==e.displacementMap;u&&(r.USE_DISPLACEMENTMAP=""),void 0!==e&&void 0!==e.outlineWidth&&e.outlineWidth>0&&(r.USE_OUTLINE=""),super({name:"SolidLineMaterial",vertexShader:a,fragmentShader:s,uniforms:i.UniformsUtils.merge([{diffuse:new i.Uniform(new i.Color(c.DEFAULT_COLOR)),dashColor:new i.Uniform(new i.Color(c.DEFAULT_COLOR)),outlineColor:new i.Uniform(new i.Color(c.DEFAULT_COLOR)),lineWidth:new i.Uniform(c.DEFAULT_WIDTH),outlineWidth:new i.Uniform(c.DEFAULT_OUTLINE_WIDTH),opacity:new i.Uniform(c.DEFAULT_OPACITY),tileSize:new i.Uniform(new i.Vector2),fadeNear:new i.Uniform(n.FadingFeature.DEFAULT_FADE_NEAR),fadeFar:new i.Uniform(n.FadingFeature.DEFAULT_FADE_FAR),displacementMap:new i.Uniform(u?e.displacementMap:new i.Texture)},i.UniformsLib.fog]),defines:r,transparent:!0,fog:!0}),this.extensions.derivatives=!0,void 0!==e&&(void 0!==e.color&&this.color.set(e.color),void 0!==e.outlineColor&&this.outlineColor.set(e.outlineColor),void 0!==e.lineWidth&&(this.lineWidth=e.lineWidth),void 0!==e.outlineWidth&&(this.outlineWidth=e.outlineWidth),void 0!==e.opacity&&(this.opacity=e.opacity),void 0!==e.depthTest&&(this.depthTest=e.depthTest),void 0!==e.depthWrite&&(this.depthWrite=e.depthWrite),void 0!==e.fadeNear&&(this.fadeNear=e.fadeNear),void 0!==e.fadeFar&&(this.fadeFar=e.fadeFar),void 0!==e.displacementMap&&(this.displacementMap=e.displacementMap),void 0!==e.caps&&t.LineCapsDefinitions.hasOwnProperty(e.caps)&&(r[t.LineCapsDefinitions[e.caps]]=1),this.fog=l)}updateFog(e){e?this.defines.USE_FOG="":delete this.defines.USE_FOG}updateOutline(e){e?this.defines.USE_OUTLINE="":delete this.defines.USE_OUTLINE}get opacity(){return this.uniforms.opacity.value}set opacity(e){void 0!==this.uniforms&&(this.uniforms.opacity.value=e)}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}get outlineColor(){return this.uniforms.outlineColor.value}set outlineColor(e){this.uniforms.outlineColor.value=e}get lineWidth(){return this.uniforms.lineWidth.value}set lineWidth(e){this.uniforms.lineWidth.value=e}get outlineWidth(){return this.uniforms.outlineWidth.value}set outlineWidth(e){this.uniforms.outlineWidth.value=e,this.updateOutline(e>0)}get fadeNear(){return this.uniforms.fadeNear.value}set fadeNear(e){this.uniforms.fadeNear.value=e}get fadeFar(){return this.uniforms.fadeFar.value}set fadeFar(e){const t=this.uniforms.fadeFar.value;this.uniforms.fadeFar.value=e,void 0!==t&&t>0?this.defines.USE_FADING="":delete this.defines.USE_FADING}get displacementMap(){return this.uniforms.displacementMap.value}set displacementMap(e){this.uniforms.displacementMap.value=e,void 0!==e?(this.uniforms.displacementMap.value.needsUpdate=!0,this.defines.USE_DISPLACEMENTMAP=""):delete this.defines.USE_DISPLACEMENTMAP,this.needsUpdate=!0}}t.SolidLineMaterial=c,c.DEFAULT_COLOR=16711680,c.DEFAULT_WIDTH=1,c.DEFAULT_OUTLINE_WIDTH=0,c.DEFAULT_OPACITY=1},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(4),n=r(0),o=r(349),a=[new n.Vector3,new n.Vector3,new n.Vector3];class s extends o.SubdivisionModifier{constructor(e,t=i.sphereProjection){super(),this.angle=e,this.projection=t}shouldSplitTriangle(e,t,r){const n=i.sphereProjection.reprojectPoint(this.projection,e,a[0]),o=i.sphereProjection.reprojectPoint(this.projection,t,a[1]),s=i.sphereProjection.reprojectPoint(this.projection,r,a[2]),c=n.angleTo(o),l=o.angleTo(s),u=s.angleTo(n),d=Math.max(c,Math.max(l,u));if(!(d<this.angle)){if(d===c)return 0;if(d===l)return 1;if(d===u)return 2;throw new Error("failed to split triangle")}}}t.SphericalGeometrySubdivisionModifier=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n={sdf_attributes:"\n        attribute vec4 position;\n        attribute vec4 uv;\n        attribute vec4 color;\n        attribute vec4 bgColor;\n        ",sdf_varying:"\n        varying vec4 vColor;\n        varying float vWeight;\n        varying vec2 vUv;\n        varying float vRotation;\n        ",sdf_varying_computation:"\n        #if BG_TEXT\n        vColor = bgColor;\n        vWeight = uv.w;\n        #else\n        vColor = color;\n        vWeight = uv.z;\n        #endif\n        vUv = vec2(uv.xy);\n        vRotation = position.w;\n        ",sdf_frag_uniforms:"\n        uniform sampler2D sdfTexture;\n        uniform vec4 sdfParams;\n        ",sdf_sampling_functions:"\n        float median(float r, float g, float b) {\n            return max(min(r, g), min(max(r, g), b));\n        }\n\n        float getDistance(vec2 uvOffset) {\n            vec3 sample = texture2D(sdfTexture, vUv.xy + uvOffset).rgb;\n            #if MSDF\n            return median(sample.r, sample.g, sample.b);\n            #else\n            return sample.r;\n            #endif\n        }\n\n        float getOpacity(vec2 uvOffset, float weight) {\n            vec2 uv = vUv + uvOffset;\n            vec2 rotatedUVs = abs(vec2(\n                cos(vRotation) * uv.x - sin(vRotation) * uv.y,\n                sin(vRotation) * uv.x + cos(vRotation) * uv.y));\n\n            float dx = dFdx(rotatedUVs.x) * sdfParams.x;\n            float dy = dFdy(rotatedUVs.y) * sdfParams.y;\n            float toPixels = sdfParams.w * inversesqrt( dx * dx + dy * dy );\n\n            float dist = getDistance(uvOffset) + min(weight, 0.5 - 1.0 / sdfParams.w) - 0.5;\n            return clamp(dist * toPixels + 0.5, 0.0, 1.0);\n        }\n        "};Object.assign(i.ShaderChunk,n);const o="\n    attribute vec2 position;\n\n    uniform mat4 modelViewMatrix;\n    uniform mat4 projectionMatrix;\n\n    void main() {\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xy, 0.0, 1.0);\n    }",a="\n    precision highp float;\n    precision highp int;\n\n    void main() {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }",s="\n    attribute vec3 position;\n    attribute vec2 uv;\n\n    uniform mat4 modelViewMatrix;\n    uniform mat4 projectionMatrix;\n\n    varying vec3 vUv;\n\n    void main() {\n        vUv = vec3(uv.xy, position.z);\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xy, 0.0, 1.0);\n    }",c="\n    precision highp float;\n    precision highp int;\n\n    uniform float pageOffset;\n    uniform sampler2D page0;\n    uniform sampler2D page1;\n    uniform sampler2D page2;\n    uniform sampler2D page3;\n    uniform sampler2D page4;\n    uniform sampler2D page5;\n    uniform sampler2D page6;\n    uniform sampler2D page7;\n\n    varying vec3 vUv;\n\n    void main() {\n        vec4 sample = vec4(0.0);\n        if (vUv.z < pageOffset || vUv.z > (pageOffset + 7.0)) discard;\n        else if (vUv.z < pageOffset + 1.0) sample = texture2D(page0, vUv.xy);\n        else if (vUv.z < pageOffset + 2.0) sample = texture2D(page1, vUv.xy);\n        else if (vUv.z < pageOffset + 3.0) sample = texture2D(page2, vUv.xy);\n        else if (vUv.z < pageOffset + 4.0) sample = texture2D(page3, vUv.xy);\n        else if (vUv.z < pageOffset + 5.0) sample = texture2D(page4, vUv.xy);\n        else if (vUv.z < pageOffset + 6.0) sample = texture2D(page5, vUv.xy);\n        else if (vUv.z < pageOffset + 7.0) sample = texture2D(page6, vUv.xy);\n        else sample = texture2D(page7, vUv.xy);\n\n        gl_FragColor = sample;\n    }",l="\n    #include <sdf_attributes>\n    #include <sdf_varying>\n\n    uniform mat4 modelViewMatrix;\n    uniform mat4 projectionMatrix;\n\n    void main() {\n        #include <sdf_varying_computation>\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xyz, 1.0);\n    }",u="\n    precision highp float;\n    precision highp int;\n\n    #include <sdf_varying>\n    #include <sdf_frag_uniforms>\n    #include <sdf_sampling_functions>\n\n    void main() {\n        vec4 color = vColor;\n        color.a *= getOpacity(vec2(0.0), vWeight);\n        if (color.a < 0.05) {\n            discard;\n        }\n        gl_FragColor = color;\n    }";class d extends i.RawShaderMaterial{constructor(){super({name:"GlyphClearMaterial",vertexShader:o,fragmentShader:a,uniforms:{},depthTest:!1,depthWrite:!1})}}t.GlyphClearMaterial=d;class h extends i.RawShaderMaterial{constructor(){super({name:"GlyphCopyMaterial",vertexShader:s,fragmentShader:c,uniforms:{pageOffset:new i.Uniform(0),page0:new i.Uniform(i.Texture.DEFAULT_IMAGE),page1:new i.Uniform(i.Texture.DEFAULT_IMAGE),page2:new i.Uniform(i.Texture.DEFAULT_IMAGE),page3:new i.Uniform(i.Texture.DEFAULT_IMAGE),page4:new i.Uniform(i.Texture.DEFAULT_IMAGE),page5:new i.Uniform(i.Texture.DEFAULT_IMAGE),page6:new i.Uniform(i.Texture.DEFAULT_IMAGE),page7:new i.Uniform(i.Texture.DEFAULT_IMAGE)},depthTest:!1,depthWrite:!1})}}t.GlyphCopyMaterial=h;class m extends i.RawShaderMaterial{constructor(e){super({name:"SdfTextMaterial",vertexShader:void 0!==e.vertexSource?e.vertexSource:l,fragmentShader:void 0!==e.fragmentSource?e.fragmentSource:u,uniforms:{sdfTexture:new i.Uniform(e.texture),sdfParams:new i.Uniform(new i.Vector4(e.textureSize.x,e.textureSize.y,e.size,e.distanceRange))},defines:{MSDF:e.isMsdf?1:0,BG_TEXT:e.isBackground?1:0},depthTest:!0,depthWrite:!0,side:i.DoubleSide,transparent:!0}),this.extensions.derivatives=!0}}t.SdfTextMaterial=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TextBufferObject=class{constructor(e,t,r,i,n,o){this.glyphs=e,this.buffer=t,this.bounds=r,this.characterBounds=i,this.textRenderStyle=n,this.textLayoutStyle=o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(149);t.createSdfTextMaterial=function(e){return new i.SdfTextMaterial({texture:e.fontCatalog.texture,textureSize:e.fontCatalog.textureSize,size:e.fontCatalog.size,distanceRange:e.fontCatalog.distanceRange,isMsdf:"msdf"===e.fontCatalog.type,isBackground:!0===e.isBackground,vertexSource:e.vertexSource,fragmentSource:e.fragmentSource})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);t.toPixelFormat=function(e){switch(e){case"Alpha":return i.AlphaFormat;case"RGB":return i.RGBFormat;case"RGBA":return i.RGBAFormat;case"Luminance":return i.LuminanceFormat;case"LuminanceAlpha":return i.LuminanceAlphaFormat;case"RGBE":return i.RGBEFormat;case"Depth":return i.DepthFormat;case"DepthStencil":return i.DepthStencilFormat;case"Red":return i.RedFormat;default:throw new Error(`invalid pixel format: ${e}`)}},t.toTextureDataType=function(e){switch(e){case"UnsignedByte":return i.UnsignedByteType;case"Byte":return i.ByteType;case"Short":return i.ShortType;case"UnsignedShort":return i.UnsignedShortType;case"Int":return i.IntType;case"UnsignedInt":return i.UnsignedIntType;case"Float":return i.FloatType;case"HalfFloat":return i.HalfFloatType;default:throw new Error(`invalid texture data type: ${e}`)}},t.toWrappingMode=function(e){switch(e){case"clamp":return i.ClampToEdgeWrapping;case"repeat":return i.RepeatWrapping;case"mirror":return i.MirroredRepeatWrapping;default:throw new Error(`invalid wrapping mode: ${e}`)}},t.toTextureFilter=function(e){switch(e){case"nearest":return i.NearestFilter;case"nearestMipMapNearest":return i.NearestMipMapNearestFilter;case"nearestMipMapLinear":return i.NearestMipMapLinearFilter;case"linear":return i.LinearFilter;case"linearMipMapNearest":return i.LinearMipMapNearestFilter;case"linearMipMapLinear":return i.LinearMipMapLinearFilter;default:throw new Error(`invalid texture filter: ${e}`)}},t.createLight=function(e){switch(e.type){case"ambient":{const t=new i.AmbientLight(e.color,e.intensity);return t.name=e.name,t}case"directional":{const t=new i.DirectionalLight(e.color,e.intensity);return t.name=e.name,void 0!==e.castShadow&&(t.castShadow=e.castShadow),t.position.set(e.direction.x,e.direction.y,e.direction.z),t.position.normalize(),t}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);t.DEPTH_PRE_PASS_STENCIL_MASK=1;const n=1e-6;function o(e){e.depthWrite=!1,e.depthFunc=i.EqualDepth,e.colorWrite=!0,e.transparent=!0;const t=e.clone();return t.depthWrite=!0,t.depthTest=!0,t.depthFunc=i.LessDepth,t.colorWrite=!1,t.transparent=!1,t.opacity=1,t}t.isRenderDepthPrePassEnabled=function(e){return!1!==e.enableDepthPrePass&&void 0!==e.opacity&&e.opacity>0&&e.opacity<1},t.createDepthPrePassMaterial=o,t.createDepthPrePassMesh=function(e){const t=e.geometry;if(!(t instanceof i.BufferGeometry))throw new Error("#createDepthPassMesh only BufferGeometry is supported");const r=t.getAttribute("position");if(!r)throw new Error("#createDepthPassMesh position attribute not found");const a=new i.BufferGeometry;a.setAttribute("position",r);const s=t.getAttribute("uv");s&&a.setAttribute("uv",s);const c=t.getAttribute("normal");c&&a.setAttribute("normal",c);const l=t.getAttribute("extrusionAxis");l&&a.setAttribute("extrusionAxis",l),t.index&&a.setIndex(t.index);for(const e of t.groups){const{start:t,count:r,materialIndex:i}=e;a.addGroup(t,r,i)}const u=e.material instanceof Array?e.material.map(o):o(e.material),d=new i.Mesh(a,u);return d.renderOrder=e.renderOrder-n,d},t.setDepthPrePassStencil=function(e,r){const n=e.material;n.stencilWrite=!0,n.stencilFail=i.KeepStencilOp,n.stencilZFail=i.KeepStencilOp,n.stencilZPass=i.ReplaceStencilOp,n.stencilFunc=i.AlwaysStencilFunc,n.stencilRef=255,n.stencilFuncMask=t.DEPTH_PRE_PASS_STENCIL_MASK;const o=r.material;o.stencilWrite=!0,o.stencilFail=i.KeepStencilOp,o.stencilZFail=i.KeepStencilOp,o.stencilZPass=i.ZeroStencilOp,o.stencilFunc=i.EqualStencilFunc,o.stencilRef=255,o.stencilFuncMask=t.DEPTH_PRE_PASS_STENCIL_MASK}},function(e,t,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Undefined=0]="Undefined",e[e.FadingIn=1]="FadingIn",e[e.FadedIn=2]="FadedIn",e[e.FadingOut=-1]="FadingOut",e[e.FadedOut=-2]="FadedOut"}(i=t.FadingState||(t.FadingState={})),t.DEFAULT_FADE_TIME=800;t.RenderState=class{constructor(e=i.Undefined,r=0,n=0,o=1,a=Number.MIN_SAFE_INTEGER,s=t.DEFAULT_FADE_TIME){this.state=e,this.value=r,this.startTime=n,this.opacity=o,this.lastFrameNumber=a,this.fadingTime=s}reset(){this.state=i.Undefined,this.value=0,this.startTime=0,this.opacity=1,this.lastFrameNumber=Number.MIN_SAFE_INTEGER}isFading(){return this.state===i.FadingIn||this.state===i.FadingOut}isFadingIn(){return this.state===i.FadingIn}isFadingOut(){return this.state===i.FadingOut}isFadedIn(){return this.state===i.FadedIn}isFadedOut(){return this.state===i.FadedOut}isVisible(){return this.state===i.FadingIn||this.state===i.FadedIn||this.state===i.FadingOut}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n="undefined"==typeof window;class o extends i.EventDispatcher{constructor(e){super(),this.value=e}set(e,t){this.value=e,this.dispatchEvent({type:o.SET_EVENT_TYPE,name:t,value:e})}}o.SET_EVENT_TYPE="set";class a{constructor(){if(this.m_optionsMap=new Map,!n&&"undefined"!=typeof window&&window){window.__debugContext=this}}setValue(e,t){let r=this.m_optionsMap.get(e);r?r.set(t,e):(r=new o(t),this.m_optionsMap.set(e,r))}getValue(e){const t=this.m_optionsMap.get(e);return t?t.value:void 0}hasOption(e){return void 0!==this.m_optionsMap.get(e)}addEventListener(e,t){const r=this.m_optionsMap.get(e);if(!r)throw Error("Unknown option: "+e);r.addEventListener(o.SET_EVENT_TYPE,t)}hasEventListener(e,t){const r=this.m_optionsMap.get(e);if(r)return r.hasEventListener(o.SET_EVENT_TYPE,t);throw Error("Unknown option: "+e)}removeEventListener(e,t){const r=this.m_optionsMap.get(e);if(!r)throw Error("Unknown option: "+e);r.removeEventListener(o.SET_EVENT_TYPE,t)}get options(){return this.m_optionsMap}clear(){this.m_optionsMap.forEach(e=>{e.set(void 0,"")})}}t.DebugContext=a,t.debugContext=new a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(1),o=r(66),a=n.LoggerManager.instance.create("RoadPicker"),s=.01;t.RoadPicker=class{constructor(e){this.m_mapView=e}registerTile(e){if(n.assert(void 0!==e.decodedTile),void 0===e.decodedTile||void 0===e.decodedTile.tileInfo)return;const t=e.decodedTile.tileInfo,r=t.lineGroup;if(void 0===r||0===r.numFeatures)return;const o=[];o.length=r.numFeatures;const a=this.m_mapView;for(let e=0;e<r.numFeatures;e++){const n=t.techniqueCatalog[r.techniqueIndex[e]],s="Pixel"===n.metricUnit||i.isInterpolatedProperty(n.lineWidth)||"string"==typeof n.lineWidth;o[e]=void 0!==n.lineWidth?s?()=>{const e="Pixel"===n.metricUnit?a.pixelToWorld:1;return i.getPropertyValue(n.lineWidth,a.zoomLevel,a.pixelToWorld)*e*.5}:n.lineWidth:1}const s=t.lineGroup.userData;return{ids:r.featureIds,techniqueIndex:r.techniqueIndex,starts:r.positionIndex,widths:o,positions:r.positions,techniques:t.techniqueCatalog,objInfos:s}}intersectRoads(e,t,r,i){if(e.boundingBox.distanceToPoint(r)>s)return!1;const c=e.roadIntersectionData;if(void 0===c)return!1;const l=c.ids,u=c.techniques,d=c.techniqueIndex,h=l.length,m=c.positions,p=c.widths,f=r.x-e.center.x,g=r.y-e.center.y,y=r.distanceTo(t);if(p.length!==l.length||l.length!==d.length||d.length!==c.starts.length)return a.error("The amount of widths, ids, techniqueIndices and starts has to be the same"),!1;for(let e=0;e<h;e++){const t=u[d[e]];if(!0===t.transient)continue;const a=c.starts[e],s=e<h-1?c.starts[e+1]:c.positions.length;let v=m[a],_=m[a+1];const b=p[e],S=Math.max(1,"function"==typeof b?b():b),T=S*S;let E=Number.MAX_VALUE;for(let e=a+2;e<s;e+=2){const t=m[e],r=m[e+1],i=n.Math2D.distToSegmentSquared(f,g,v,_,t,r);i<T&&i<E&&(E=i),v=t,_=r}if(E<Number.MAX_VALUE){const n={type:o.PickObjectType.Line,point:r,distance:y,distFromCenter:Math.sqrt(E),featureId:l[e],positions:m.slice(a,s),technique:t};this.addUserData(n,e,c.objInfos),i.push(n)}}return!1}addUserData(e,t,r){void 0!==r&&r.length>0&&(e.userData=Object.assign({},r[t]))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.TopLeft=0]="TopLeft",e[e.BottomLeft=1]="BottomLeft"}(t.ImageOrigin||(t.ImageOrigin={}));t.IconTexture=class{constructor(e){this.image=e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(20),o=300;t.CameraMovementDetector=class{constructor(e,t,r){this.m_throttlingTimeout=e,this.m_movementStartedFunc=t,this.m_movementFinishedFunc=r,this.m_lastCameraPos=new i.Vector3,this.m_newCameraPos=new i.Vector3,this.m_throttlingTimerId=void 0,this.m_movementDetectorDeadline=0,this.onDeadlineTimer=()=>{this.m_throttlingTimerId=void 0;const e=performance.now();e>=this.m_movementDetectorDeadline?this.movementFinished():this.startMovementFinishedTimer(e)},void 0===this.m_throttlingTimeout&&(this.m_throttlingTimeout=o)}checkCameraMoved(e,t){const r=n.MapViewUtils.extractAttitude(e,e.camera),i=e.camera.getWorldPosition(this.m_newCameraPos),o=void 0===this.m_lastAttitude||!this.m_lastCameraPos.equals(i)||r.yaw!==this.m_lastAttitude.yaw||r.pitch!==this.m_lastAttitude.pitch||r.roll!==this.m_lastAttitude.roll;return o&&(this.m_lastCameraPos.copy(i),this.m_lastAttitude=r),o!==this.m_cameraMovedLastFrame&&(o&&this.movementStarted(),this.m_cameraMovedLastFrame=o),o&&(this.m_movementDetectorDeadline=t+this.m_throttlingTimeout,this.startMovementFinishedTimer(t)),this.m_cameraMovedLastFrame}clear(e){const t=e.camera.getWorldPosition(this.m_newCameraPos);this.m_lastCameraPos.set(t.x,t.y,t.z);const r=n.MapViewUtils.extractAttitude(e,e.camera);this.m_lastAttitude=r}forceMoved(){this.m_lastCameraPos.set(Number.NaN,Number.NaN,Number.NaN)}get cameraIsMoving(){return void 0!==this.m_throttlingTimerId}dispose(){this.removeMovementFinishedTimer(),this.m_movementStartedFunc=void 0,this.m_movementFinishedFunc=void 0}get cameraMovedLastFrame(){return!0===this.m_cameraMovedLastFrame}movementStarted(){void 0!==this.m_movementStartedFunc&&this.m_movementStartedFunc()}movementFinished(){this.removeMovementFinishedTimer(),void 0!==this.m_movementFinishedFunc&&this.m_movementFinishedFunc()}startMovementFinishedTimer(e){if(void 0===this.m_throttlingTimerId){const t=Math.max(0,this.m_movementDetectorDeadline-e);this.m_throttlingTimerId=setTimeout(this.onDeadlineTimer,t)}}removeMovementFinishedTimer(){void 0!==this.m_throttlingTimerId&&(clearTimeout(this.m_throttlingTimerId),this.m_throttlingTimerId=void 0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(4),n=r(1),o=r(0),a=r(20),s=1e-6;t.InterpolatedClipPlanesEvaluator=class{constructor(e=.1,t=.1,r=50,i=200){this.nearMin=e,this.nearMultiplier=t,this.nearFarMultiplier=r,this.farOffset=i,this.m_tmpVectors=[new o.Vector3,new o.Vector3,new o.Vector3],this.m_tmpQuaternion=new o.Quaternion,n.assert(e>0),n.assert(r>=0),n.assert(i>=0),this.farMin=e*r+i}set minElevation(e){}get minElevation(){return 0}set maxElevation(e){}get maxElevation(){return 0}evaluateClipPlanes(e){let t=this.nearMin,r=this.farMin;if(e.projection.type===i.ProjectionType.Spherical){const n=i.EarthConstants.EQUATORIAL_RADIUS,o=e.camera.position.length(),a=Math.asin(n/o);e.camera.matrixWorld.extractBasis(this.m_tmpVectors[0],this.m_tmpVectors[1],this.m_tmpVectors[2]),this.m_tmpQuaternion.setFromAxisAngle(this.m_tmpVectors[0],a);const s=this.m_tmpVectors[2].negate(),c=this.m_tmpVectors[1].copy(s).applyQuaternion(this.m_tmpQuaternion),l=this.m_tmpVectors[0].copy(e.camera.position);l.addScaledVector(c,Math.sqrt(o*o-n*n)),r=l.sub(e.camera.position).dot(s),t=Math.max(this.nearMin,e.projection.groundDistance(e.camera.position)*this.nearMultiplier)}else if(e.projection.type===i.ProjectionType.Planar){const i=e.projection.groundDistance(e.camera.position);r=(t=Math.max(this.nearMin,i*this.nearMultiplier))*this.nearFarMultiplier+this.farOffset}else n.assert(!1,"Unsupported projection type");return{near:t,far:r,minimum:this.nearMin,maximum:r}}};class c{constructor(e,t){n.assert(e>=t),this.m_minElevation=t,this.m_maxElevation=e}set maxElevation(e){this.m_maxElevation=e,this.m_minElevation=Math.min(e,this.m_minElevation)}get maxElevation(){return this.m_maxElevation}set minElevation(e){this.m_minElevation=e,this.m_maxElevation=Math.max(e,this.m_maxElevation)}get minElevation(){return this.m_minElevation}}t.ElevationBasedClipPlanesEvaluator=c;class l extends c{constructor(e=i.EarthConstants.MAX_BUILDING_HEIGHT,t=0,r=1,a=.05,c=1.8){super(e,t),this.nearMin=r,this.nearFarMarginRatio=a,this.farMaxRatio=c,this.m_tmpVectors=[new o.Vector3,new o.Vector3,new o.Vector3],this.m_tmpQuaternion=new o.Quaternion,n.assert(r>0),n.assert(a>s),n.assert(c>1);const l=a*r;this.m_minimumViewRange={near:r,far:r+l,minimum:this.nearMin,maximum:Math.max(r*c,r+l)}}evaluateClipPlanes(e){return e.projection.type===i.ProjectionType.Spherical?this.evaluateDistanceSphericalProj(e.camera,e.projection):e.projection.type===i.ProjectionType.Planar?this.evaluateDistancePlanarProj(e.camera,e.projection):(n.assert(!1,"Unsupported projection type"),Object.assign({},this.minimumViewRange))}get minimumViewRange(){return this.m_minimumViewRange}getCameraAltitude(e,t){return t.groundDistance(e.position)}evaluateDistancePlanarProj(e,t){n.assert(t.type!==i.ProjectionType.Spherical);let r=this.nearMin,o=this.nearMin*this.farMaxRatio;const a=this.getCameraAltitude(e,t),s=a*this.farMaxRatio;r=a-this.maxElevation,o=a-this.minElevation,r=Math.max(r,this.nearMin),o=Math.min(o,s);const c=this.nearFarMarginRatio*(r+o)/2;return{near:r=Math.max(r-c/2,this.nearMin),far:o=Math.max(o+c/2,r+c),minimum:this.nearMin,maximum:Math.max(s,o)}}evaluateDistanceSphericalProj(e,t){n.assert(t.type===i.ProjectionType.Spherical);let r=this.nearMin,o=this.nearMin*this.farMaxRatio;const a=this.getCameraAltitude(e,t);r=a-this.maxElevation;const c=i.EarthConstants.EQUATORIAL_RADIUS;let l=e.position.length();if(l=0===l?s:l,"PerspectiveCamera"===e.type){const t=Math.asin(c/l),r=Math.sqrt(l*l-c*c),i=this.maxElevation<s?0:Math.sqrt(2*c*this.maxElevation+this.maxElevation*this.maxElevation);e.matrixWorld.extractBasis(this.m_tmpVectors[0],this.m_tmpVectors[1],this.m_tmpVectors[2]),this.m_tmpQuaternion.setFromAxisAngle(this.m_tmpVectors[0],t);const n=this.m_tmpVectors[2].negate(),a=this.m_tmpVectors[1].copy(n).applyQuaternion(this.m_tmpQuaternion);a.multiplyScalar(r+i),o=a.dot(n)}else{o=l+(this.maxElevation<s?0:Math.sqrt(c+this.maxElevation)*(c+this.maxElevation)-c*c)}const u=a-this.minElevation;r=Math.max(r,this.nearMin),o=Math.max(o,u);const d=this.nearFarMarginRatio*(r+o)/2;return{near:r=Math.max(r-d/2,this.nearMin),far:o=Math.max(o+d/2,r+d),minimum:this.nearMin,maximum:o}}}t.TopViewClipPlanesEvaluator=l;class u extends l{constructor(){super(...arguments),this.m_tmpPlane=new o.Plane}evaluateClipPlanes(e){return e.projection.type===i.ProjectionType.Spherical?this.evaluateSphericalProj(e.camera,e.projection):e.projection.type===i.ProjectionType.Planar?this.evaluatePlanarProj(e):(n.assert(!1,"Unsupported projection type"),Object.assign({},this.minimumViewRange))}getCameraLookAtDistance(e,t){n.assert(t.type!==i.ProjectionType.Spherical);const r=this.m_tmpVectors[0];e.getWorldDirection(r).normalize();const o=this.m_tmpVectors[1];t.surfaceNormal(e.position,o),o.negate();let a=r.dot(o);return a=0===a?s:a,this.getCameraAltitude(e,t)/a}getFrustumGroundIntersectionDist(e){n.assert(e.projection.type!==i.ProjectionType.Spherical);const t=Math.PI/2-s,r=this.getCameraAltitude(e.camera,e.projection),c=a.MapViewUtils.rayCastWorldCoordinates(e,0,0);if(null===c)throw new Error("MapView does not support a view pointing in the void.");const l=a.MapViewUtils.extractSphericalCoordinatesFromLocation(e,e.camera,e.projection.unprojectPoint(c)).tilt;let u,d,h,m;if("PerspectiveCamera"===e.camera.type){const i=e.camera,n=1,a=o.Math.degToRad(i.fov*n/2);u=o.Math.clamp(l+a,-t,t),d=o.Math.clamp(l-a,-t,t),h=m=r}else{const t=e.camera;u=d=l;const i=Math.sin(l);m=r+i*t.top,h=r-i*t.bottom}const p=(m-this.minElevation)/Math.cos(u),f=(h-this.maxElevation)/Math.cos(d);return{top:Math.max(p,0),bottom:Math.max(f,0)}}evaluatePlanarProj(e){n.assert(e.projection.type!==i.ProjectionType.Spherical);const t=Object.assign({},this.minimumViewRange),r=this.getFrustumGroundIntersectionDist(e);if("PerspectiveCamera"===e.camera.type){const i=e.camera,n=1,a=o.Math.degToRad(i.fov*n/2),s=Math.cos(a);t.near=r.bottom*s,t.far=r.top*s}else t.near=r.bottom,t.far=r.top;const a=this.getCameraLookAtDistance(e.camera,e.projection)*this.farMaxRatio;t.near=Math.max(t.near,this.nearMin),t.far=Math.min(t.far,a);const s=this.nearFarMarginRatio*(t.near+t.far)/2;return t.near=Math.max(t.near-s/2,this.nearMin),t.far=Math.max(t.far+s/2,t.near+s),t.minimum=this.nearMin,t.maximum=a,t}evaluateSphericalProj(e,t){n.assert(t.type===i.ProjectionType.Spherical);const r=Object.assign({},this.minimumViewRange),a=this.getCameraAltitude(e,t);if(r.near=a-this.maxElevation,e instanceof o.PerspectiveCamera){const t=1,i=o.Math.degToRad(e.fov/2*t);r.near*=Math.cos(i)}const c=new o.Vector3(0,0,0).sub(e.position);e.matrixWorld.extractBasis(this.m_tmpVectors[0],this.m_tmpVectors[1],this.m_tmpVectors[2]);const l=this.m_tmpVectors[0],u=this.m_tmpVectors[1],d=i.EarthConstants.EQUATORIAL_RADIUS,h=c.length(),m=this.m_tmpVectors[2].copy(c).multiplyScalar(1/h),p=d/h,f=Math.asin(p),g=Math.sqrt(1-p*p);let y;if(this.maxElevation<s)y=c.multiplyScalar(g);else{const e=g*h,t=Math.sqrt(2*d*this.maxElevation-this.maxElevation*this.maxElevation);y=c.copy(m).multiplyScalar(e+t)}const v=this.m_tmpQuaternion.setFromAxisAngle(u.cross(m),f),_=y.clone().applyQuaternion(v),b=this.m_tmpQuaternion.setFromAxisAngle(l.cross(m),f),S=y.clone().applyQuaternion(b),T=this.m_tmpQuaternion.copy(b).inverse(),E=y.applyQuaternion(T),w=this.m_tmpPlane.setFromCoplanarPoints(S,_,E);r.far=w.constant;const C=a-this.minElevation;r.near=Math.max(r.near,this.nearMin),r.far=Math.max(r.far,C);const x=this.nearFarMarginRatio*(r.near+r.far)/2;return r.near=Math.max(r.near-x/2,this.nearMin),r.far=Math.max(r.far+x/2,r.near+x),r.minimum=this.nearMin,r.maximum=r.far,r}}t.TiltViewClipPlanesEvaluator=u;t.FixedClipPlanesEvaluator=class{constructor(e=1,t=10){this.minNear=e,this.minFarOffset=t,this.minFar=e+t,this.m_nearPlane=e,this.m_farPlane=this.minFar}get nearPlane(){return this.m_nearPlane}set nearPlane(e){this.invalidatePlanes(e,this.m_farPlane)}get farPlane(){return this.m_farPlane}set farPlane(e){this.invalidatePlanes(this.m_nearPlane,e)}set minElevation(e){}get minElevation(){return 0}set maxElevation(e){}get maxElevation(){return 0}evaluateClipPlanes(e){return{near:this.m_nearPlane,far:this.m_farPlane,minimum:this.minNear,maximum:this.m_farPlane}}invalidatePlanes(e,t){const r=Math.max(this.minNear,e),i=Math.max(this.minFar,t,r+this.minFarOffset);this.m_nearPlane=r,this.m_farPlane=i}},t.createDefaultClipPlanesEvaluator=()=>new u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(362);t.MapRenderingManager=i.MapRenderingManager;var n=r(49);t.Pass=n.Pass;var o=r(161);t.MSAARenderPass=o.MSAARenderPass,t.MSAASampling=o.MSAASampling},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(9),n=r(0),o=r(49);var a;!function(e){e[e.Level_0=0]="Level_0",e[e.Level_1=1]="Level_1",e[e.Level_2=2]="Level_2",e[e.Level_3=3]="Level_3",e[e.Level_4=4]="Level_4",e[e.Level_5=5]="Level_5"}(a=t.MSAASampling||(t.MSAASampling={}));class s extends o.Pass{constructor(){super(),this.samplingLevel=a.Level_1,this.m_renderTarget=null,this.m_localCamera=new n.OrthographicCamera(-1,1,1,-1,0,1),this.m_quadScene=new n.Scene,this.m_quadUniforms=i.CopyShader.uniforms,this.m_quadMaterial=new i.MSAAMaterial(this.m_quadUniforms),this.m_quad=new n.Mesh(new n.PlaneBufferGeometry(2,2),this.m_quadMaterial),this.m_quad.frustumCulled=!1,this.m_quadScene.add(this.m_quad)}dispose(){null!==this.m_renderTarget&&(this.m_renderTarget.dispose(),this.m_renderTarget=null)}render(e,t,r,i,o){if(!this.enabled)return;null===this.m_renderTarget&&(this.m_renderTarget=new n.WebGLRenderTarget(o.width,o.height,{minFilter:n.LinearFilter,magFilter:n.LinearFilter,format:n.RGBAFormat}),this.m_renderTarget.texture.name="MSAARenderPass.sample"),this.m_quadUniforms.tDiffuse.value=this.m_renderTarget.texture;const a=s.OffsetVectors[this.samplingLevel],c=e.getClearColor(),l=void 0!==c?c.getHex():0,u={enabled:null!==r.view&&r.view.enabled,fullWidth:o.width,fullHeight:o.height,x:0,y:0,width:o.width,height:o.height};u.enabled&&null!==r.view&&(u.fullWidth=r.view.fullWidth,u.fullHeight=r.view.fullHeight,u.x=r.view.offsetX,u.y=r.view.offsetY,u.width=r.view.width,u.height=r.view.height);const d=e.getRenderTarget();for(let n=0;n<a.length;n++){const o=a[n];r.setViewOffset(u.fullWidth,u.fullHeight,u.x+o[0]/16,u.y+o[1]/16,u.width,u.height);const s=(n+.5)/a.length-.5,d=1/a.length+s/32;this.m_quadUniforms.opacity.value=d,e.setRenderTarget(this.m_renderTarget),e.clear(),e.render(t,r),e.setRenderTarget(this.renderToScreen?null:i),0===n&&(e.setClearColor(0),e.clear()),e.render(this.m_quadScene,this.m_localCamera),0===n&&void 0!==c&&e.setClearColor(l)}e.setRenderTarget(d),null!==r.view&&(r.view.enabled=u.enabled,r.view.offsetX=u.x,r.view.offsetY=u.y)}setSize(e,t){this.m_renderTarget&&this.m_renderTarget.setSize(e,t)}}t.MSAARenderPass=s,s.OffsetVectors=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(1),o=r(163),a=r(0),s=n.LoggerManager.instance.create("ConcurrentWorkerSet");function c(e){return e&&"number"==typeof e.level&&e.type===n.WORKERCHANNEL_MSG_TYPE}t.isLoggingMessage=c;const l=2;t.DEFAULT_WORKER_INITIALIZATION_TIMEOUT=1e4;t.ConcurrentWorkerSet=class{constructor(e){this.m_options=e,this.m_workerChannelLogger=n.LoggerManager.instance.create("WorkerChannel"),this.m_eventListeners=new Map,this.m_workers=new Array,this.m_availableWorkers=new Array,this.m_workerPromises=new Array,this.m_readyPromises=new Map,this.m_requests=new Map,this.m_workerRequestQueue=[],this.m_nextMessageId=0,this.m_stopped=!0,this.m_referenceCount=0,this.onWorkerMessage=(e,t)=>{if(i.WorkerServiceProtocol.isResponseMessage(t.data)){const r=t.data;if(null===r.messageId)return void s.error(`[${this.m_options.scriptUrl}]: Bad ResponseMessage: no messageId`);const i=this.m_requests.get(r.messageId);if(void 0===i)return void s.error(`[${this.m_options.scriptUrl}]: Bad ResponseMessage: invalid messageId`);if(e>=0&&e<this.m_workers.length){const t=this.m_workers[e];this.m_availableWorkers.push(t),this.checkWorkerRequestQueue()}else s.error(`[${this.m_options.scriptUrl}]: onWorkerMessage: invalid workerId`);if(void 0!==r.errorMessage){const e=new Error(r.errorMessage);void 0!==r.errorStack&&(e.stack=r.errorStack),i.resolver(e)}else i.resolver(void 0,r.response)}else if(i.WorkerServiceProtocol.isInitializedMessage(t.data)){const e=this.getReadyPromise(t.data.service);++e.count===this.m_workerPromises.length&&e.resolve()}else if(c(t.data))switch(t.data.level){case n.LogLevel.Trace:this.m_workerChannelLogger.trace(...t.data.message);break;case n.LogLevel.Debug:this.m_workerChannelLogger.debug(...t.data.message);break;case n.LogLevel.Log:this.m_workerChannelLogger.log(...t.data.message);break;case n.LogLevel.Info:this.m_workerChannelLogger.info(...t.data.message);break;case n.LogLevel.Warn:this.m_workerChannelLogger.warn(...t.data.message);break;case n.LogLevel.Error:this.m_workerChannelLogger.error(...t.data.message)}else this.eventHandler(t)},this.start()}addReference(){this.m_referenceCount+=1,1===this.m_referenceCount&&this.m_stopped&&this.start()}removeReference(){this.m_referenceCount-=1,0===this.m_referenceCount&&this.destroy()}start(e){if(void 0!==e&&(this.m_options=e),!this.m_stopped)throw new Error("ConcurrentWorker set already started");this.m_workerCount=n.getOptionValue(this.m_options.workerCount,"undefined"!=typeof navigator&&void 0!==navigator.hardwareConcurrency?a.Math.clamp(navigator.hardwareConcurrency-1,1,2):void 0,l);const r=n.getOptionValue(this.m_options.workerConnectionTimeout,t.DEFAULT_WORKER_INITIALIZATION_TIMEOUT);for(let e=0;e<this.m_workerCount;++e){const t=o.WorkerLoader.startWorker(this.m_options.scriptUrl,r).then(t=>{const r=t=>{this.onWorkerMessage(e,t)};return t.addEventListener("message",r),this.m_workers.push(t),this.m_availableWorkers.push(t),{worker:t,listener:r}});this.m_workerPromises.push(t)}this.m_stopped=!1}get workerCount(){return this.m_workerCount}async stop(){this.m_stopped=!0,await this.waitForAllResponses().then(()=>{this.terminateWorkers()})}destroy(){this.m_stopped=!0,this.m_requests.forEach(e=>{e.resolver(new Error("worker destroyed"))}),this.m_requests.clear(),this.m_workerRequestQueue=[],this.terminateWorkers(),this.m_eventListeners.clear()}async connect(e){return this.ensureStarted(),await Promise.all(this.m_workerPromises),this.getReadyPromise(e).promise}addEventListener(e,t){this.m_eventListeners.set(e,t)}removeEventListener(e){this.m_eventListeners.delete(e)}invokeRequest(e,t,r,n){this.ensureStarted();const o=this.m_nextMessageId++;let a;const s=new Promise((e,t)=>{a=(r,i)=>{this.m_requests.delete(o),void 0!==r?t(r):e(i)}});this.m_requests.set(o,{promise:s,resolver:a});const c={service:e,type:i.WorkerServiceProtocol.ServiceMessageName.Request,messageId:o,request:t};return this.postRequestMessage(c,r,n),s}broadcastRequest(e,t,r){this.ensureStarted();const n=[];for(const o of this.m_workers){const a=this.m_nextMessageId++;let s;const c=new Promise((e,t)=>{s=(r,i)=>{this.m_requests.delete(a),void 0!==r?t(r):e(i)}});n.push(c),this.m_requests.set(a,{promise:c,resolver:s});const l={service:e,type:i.WorkerServiceProtocol.ServiceMessageName.Request,messageId:a,request:t};void 0!==r?o.postMessage(l,r):o.postMessage(l)}return Promise.all(n)}broadcastMessage(e,t){this.ensureStarted(),void 0!==t?this.m_workers.forEach(r=>r.postMessage(e,t)):this.m_workers.forEach(t=>t.postMessage(e))}get requestQueueSize(){return this.m_workerRequestQueue.length}get numWorkers(){return this.m_workers.length}get numIdleWorkers(){return this.m_availableWorkers.length}eventHandler(e){"string"==typeof e.data.type&&this.dispatchEvent(e.data.type,e)}postRequestMessage(e,t,r){if(this.ensureStarted(),0===this.m_workers.length)throw new Error("ConcurrentWorkerSet#postMessage: no workers started");if(void 0!==r&&r.signal.aborted){const t=this.m_requests.get(e.messageId);if(void 0===t)return void s.error(`[${this.m_options.scriptUrl}]: Bad RequestMessage: invalid messageId`);const r=new Error("Aborted");return r.name="AbortError",void t.resolver(r,void 0)}if(this.m_availableWorkers.length>0){const r=this.m_availableWorkers.pop();void 0!==t?r.postMessage(e,t):r.postMessage(e)}else void 0===r&&(r=new i.RequestController(0)),0===r.priority&&(r.priority=-this.m_nextMessageId),this.m_workerRequestQueue.unshift({message:e,buffers:t,requestController:r})}ensureStarted(){if(this.m_stopped)throw new Error("ConcurrentWorkerSet stopped")}async waitForAllResponses(){const e=new Array;this.m_requests.forEach(t=>{e.push(t.promise)}),await Promise.all(e)}dispatchEvent(e,t){const r=this.m_eventListeners.get(e);void 0!==r&&r(t)}terminateWorkers(){this.m_workerPromises.forEach(e=>{e.then(e=>{void 0!==e&&(e.worker.removeEventListener("message",e.listener),e.worker.terminate())})}),this.m_workers=[],this.m_workerPromises=[],this.m_availableWorkers=[],this.m_readyPromises.clear()}getReadyPromise(e){const t=this.m_readyPromises.get(e);if(void 0!==t)return t;const r={count:0,promise:void 0,resolve:()=>{},reject:e=>{r.error=e},error:void 0};return r.promise=new Promise((e,t)=>{const i=r;void 0!==i.error?t(i.error):i.count===this.m_workerPromises.length&&e(),i.resolve=e,i.reject=t}),this.m_readyPromises.set(e,r),r}checkWorkerRequestQueue(){if(0!==this.m_workerRequestQueue.length&&0!==this.m_availableWorkers.length)for(this.m_workerRequestQueue.sort((e,t)=>e.requestController.priority-t.requestController.priority);this.m_availableWorkers.length>0&&this.m_workerRequestQueue.length>0;){const e=this.m_workerRequestQueue.pop();this.postRequestMessage(e.message,e.buffers,e.requestController)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(68);const i=r(1),n=r(366),o=i.LoggerManager.instance.create("WorkerLoader");class a{static startWorker(e,t=1e4){return e.startsWith("blob:")?this.startWorkerImmediately(e,t):this.directlyFallbackToBlobBasedLoading?this.startWorkerBlob(e,t):this.startWorkerImmediately(e,t).catch(r=>{if("undefined"!=typeof window){const n=window.location.href,s=new URL(e,n).href;if(i.getUrlOrigin(s)===i.getUrlOrigin(n))throw r;return o.log("#startWorker: cross-origin worker construction failed, trying load with blob"),this.directlyFallbackToBlobBasedLoading=!0,a.startWorkerBlob(e,t)}throw r})}static startWorkerImmediately(e,t){try{const r=new Worker(e);return this.waitWorkerInitialized(r,t)}catch(e){return Promise.reject(e)}}static startWorkerBlob(e,t){return this.fetchScriptSourceToBlobUrl(e).then(e=>this.startWorkerImmediately(e,t))}static fetchScriptSourceToBlobUrl(e){let t=this.sourceLoaderCache.get(e);return void 0!==t?t:(t=fetch(e).then(e=>e.text()).catch(e=>{throw new Error(`WorkerLoader#fetchScriptSourceToBlob: failed to load worker script: ${e}`)}).then(t=>{this.sourceLoaderCache.delete(e);const r=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(r)}),this.sourceLoaderCache.set(e,t),t)}static waitWorkerInitialized(e,t){return new Promise((r,i)=>{const o=t=>{const o=t.data;if(n.isWorkerBootstrapRequest(o)){const t=o.dependencies,r=[];for(const e of t){const t=this.dependencyUrlMapping[e];if(!t)return s(),void i(new Error(`#waitWorkerInitialized: Unable to resolve '${e}'`+" as needed by worker script."));r.push(t)}const n={type:"worker-bootstrap-response",resolvedDependencies:r};e.postMessage(n)}else s(),r(e),setTimeout(()=>{e.dispatchEvent(t)},0)},a=e=>{s();let t="Error during worker initialization";e.message&&(t+=`: ${e.message}`),"string"==typeof e.filename&&"number"==typeof e.lineno&&(t+=` in ${e.filename}:${e.lineno}`),i(new Error(t))},s=()=>{clearTimeout(c),e.removeEventListener("message",o),e.removeEventListener("error",a)};e.addEventListener("error",a),e.addEventListener("message",o);const c=setTimeout(()=>{s(),i(new Error("Timeout exceeded when waiting for first message from worker."))},t)})}}t.WorkerLoader=a,a.directlyFallbackToBlobBasedLoading=!1,a.sourceLoaderCache=new Map,a.dependencyUrlMapping={}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2);let n=0;t.WorkerBasedDecoder=class{constructor(e,t){this.workerSet=e,this.decoderServiceType=t,this.m_serviceCreated=!1,this.workerSet.addReference(),this.serviceId=`${this.decoderServiceType}-${n++}`}dispose(){this.m_serviceCreated&&this.workerSet.broadcastRequest(i.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID,{type:i.WorkerServiceProtocol.Requests.DestroyService,targetServiceId:this.serviceId}).catch(()=>{}),this.workerSet.removeReference()}async connect(){await this.workerSet.connect(i.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID),this.m_serviceCreated||(await this.workerSet.broadcastRequest(i.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID,{type:i.WorkerServiceProtocol.Requests.CreateService,targetServiceType:this.decoderServiceType,targetServiceId:this.serviceId}),this.m_serviceCreated=!0)}decodeTile(e,t,r,n){const o=t.mortonCode(),a={type:i.WorkerDecoderProtocol.Requests.DecodeTileRequest,tileKey:o,data:e,projection:i.getProjectionName(r)},s=e instanceof ArrayBuffer?[e]:void 0;return this.workerSet.invokeRequest(this.serviceId,a,s,n)}getTileInfo(e,t,r,n){const o=t.mortonCode(),a={type:i.WorkerDecoderProtocol.Requests.TileInfoRequest,tileKey:o,data:e,projection:i.getProjectionName(r)},s=e instanceof ArrayBuffer?[e]:void 0;return this.workerSet.invokeRequest(this.serviceId,a,s,n)}configure(e,t,r,n){const o={service:this.serviceId,type:i.WorkerDecoderProtocol.DecoderMessageName.Configuration,styleSet:e,definitions:t,options:n,languages:r};this.workerSet.broadcastMessage(o)}get workerCount(){return this.workerSet.workerCount}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.PendingApproximate=0]="PendingApproximate",e[e.FinalPrecise=1]="FinalPrecise"}(t.CalculationStatus||(t.CalculationStatus={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(94);class o{constructor(e){this.mapView=e,this.enableFilterByKind=!0,this.enabledKinds=new i.GeometryKindSet,this.disabledKinds=new i.GeometryKindSet,this.hiddenKinds=new i.GeometryKindSet,this.m_visibilityCounter=1}get enabledGeometryKinds(){return this.enabledKinds}set enabledGeometryKinds(e){this.enabledKinds=e}get disabledGeometryKinds(){return this.disabledKinds}set disabledGeometryKinds(e){this.disabledKinds=e}get hiddenGeometryKinds(){return this.hiddenKinds}set hiddenGeometryKinds(e){this.hiddenKinds=e,this.incrementVisibilityCounter()}get visibilityCounter(){return this.m_visibilityCounter}clear(){this.enabledKinds.clear(),this.disabledKinds.clear(),this.hiddenKinds.clear()}enableKind(e,t=!0){this.enableDisableKinds(this.enabledKinds,e,t)}disableKind(e,t=!0){this.enableDisableKinds(this.disabledKinds,e,t)}hideKind(e,t=!0){let r=!1;if(Array.isArray(e))for(const i of e)r=r||this.addRemove(this.hiddenKinds,i,t);else if(e instanceof Set){const i=e;for(const e of i)r=r||this.addRemove(this.hiddenKinds,e,t)}else void 0!==e&&(r=r||this.addRemove(this.hiddenKinds,e,t));r&&this.incrementVisibilityCounter()}getAvailableKinds(e){const t=new i.GeometryKindSet;for(const r of e){const e=r.tileGeometryLoader;if(void 0!==e){const r=e.availableGeometryKinds;if(void 0!==r)for(const e of r)t.add(e)}}return t}updateTileObjectVisibility(e){let t=!1;for(const r of e)if(0!==r.objects.length&&r.visibilityCounter!==this.visibilityCounter){r.visibilityCounter=this.visibilityCounter;for(const e of r.objects){const r=void 0!==e.userData?e.userData.kind:void 0;if(void 0!==r){const i=!r.some(e=>this.hiddenKinds.has(e));t=t||e.visible!==i,e.visible=i}}}return t}setTileUpdateCallback(e){this.m_tileUpdateCallback=e}incrementVisibilityCounter(){return++this.m_visibilityCounter}enableDisableKinds(e,t,r){if(Array.isArray(t))for(const i of t)this.addRemove(e,i,r);else if(t instanceof Set){const i=t;for(const t of i)this.addRemove(e,t,r)}else void 0!==t&&this.addRemove(e,t,r)}addRemove(e,t,r){if(r){if(!e.has(t))return e.add(t),!0}else if(e.has(t))return e.delete(t),!0;return!1}}t.TileGeometryManagerBase=o;t.SimpleTileGeometryManager=class extends o{constructor(e){super(e)}initTile(e){e.dataSource.useGeometryLoader&&(e.tileGeometryLoader=new n.SimpleTileGeometryLoader(e))}updateTiles(e){for(const t of e){const e=t.tileGeometryLoader;void 0!==e&&(e.update(this.enableFilterByKind?this.enabledGeometryKinds:void 0,this.enableFilterByKind?this.disabledGeometryKinds:void 0),this.m_tileUpdateCallback&&this.m_tileUpdateCallback(t))}this.updateTileObjectVisibility(e)&&this.mapView.update()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(168);t.MapViewImageCache=class{constructor(e){this.mapView=e,this.m_name2Url=new Map,this.m_url2Name=new Map}registerImage(e,t,r){if(void 0!==e){if(this.hasName(e))throw new Error("duplicate name in cache");const r=this.m_url2Name.get(t);void 0!==r?r.indexOf(e)<0&&r.push(e):this.m_url2Name.set(t,[e]),this.m_name2Url.set(e,t)}const n=i.ImageCache.instance.findImage(t);return void 0===n?i.ImageCache.instance.registerImage(this.mapView,t,r):n}addImage(e,t,r=!0){const n=this.registerImage(e,t,void 0);return!0===r?i.ImageCache.instance.loadImage(n):n}findImageByName(e){const t=this.m_name2Url.get(e);if(void 0!==t)return i.ImageCache.instance.findImage(t)}findImageByUrl(e){return i.ImageCache.instance.findImage(e)}loadImage(e){return i.ImageCache.instance.loadImage(e)}clear(){i.ImageCache.instance.clear(this.mapView),this.m_name2Url=new Map,this.m_url2Name=new Map}get numberOfNames(){return this.m_name2Url.size}get numberOfUrls(){return this.m_url2Name.size}hasName(e){return void 0!==this.m_name2Url.get(e)}hasUrl(e){return void 0!==this.m_url2Name.get(e)}findNames(e){return this.m_url2Name.get(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=r(0),o=i.LoggerManager.instance.create("ImageCache");class a{constructor(){this.m_images=new Map}static get instance(){return void 0===a.m_instance&&(a.m_instance=new a),a.m_instance}static dispose(){a.m_instance=void 0}registerImage(e,t,r){let i=this.findImageCacheItem(t);if(void 0!==i)return void 0!==e&&i.mapViews.indexOf(e)<0&&i.mapViews.push(e),i.imageItem;if(void 0!==(i=this.findImageCacheItem(t)))return void 0!==e&&i.mapViews.indexOf(e)<0&&i.mapViews.push(e),i.imageItem;const n=[];return void 0!==e&&n.push(e),i={imageItem:{url:t,imageData:r,loaded:!1},mapViews:n},this.m_images.set(t,i),i.imageItem}addImage(e,t,r=!0){const i=this.registerImage(e,t,void 0);return void 0!==i&&!0===r?this.loadImage(i):i}findImage(e){const t=this.m_images.get(e);if(void 0!==t)return t.imageItem}clear(e){const t=[];this.m_images.forEach(r=>{const i=r.mapViews.indexOf(e);i>=0&&r.mapViews.splice(i,1),0===r.mapViews.length&&t.push(r.imageItem.url)});for(const e of t)this.m_images.delete(e)}clearAll(){this.m_images=new Map}get size(){return this.m_images.size}loadImage(e){if(void 0!==e.imageData)return e;if(void 0!==e.loadingPromise)return e.loadingPromise;const t=new n.ImageLoader;return e.loadingPromise=new Promise(r=>{o.debug(`Loading image: ${e.url}`),t.load(e.url,t=>{o.debug(`... finished loading image: ${e.url}`),this.renderImage(e,t).then(()=>{e.loadingPromise=void 0,r(e)}).catch(t=>{o.error(`... loading image failed: ${e.url} : ${t}`),r(void 0)})},void 0,t=>{o.error(`... loading image failed: ${e.url} : ${t}`),e.loadingPromise=void 0,r(void 0)})}),e.loadingPromise}findImageCacheItem(e){return this.m_images.get(e)}renderImage(e,t){return new Promise((r,i)=>{if("function"==typeof createImageBitmap){const i={premultiplyAlpha:"default",imageOrientation:"flipY"};o.debug(`Creating bitmap image: ${e.url}`),createImageBitmap(t,0,0,t.width,t.height,i).then(t=>{o.debug(`... finished creating bitmap image: ${e.url}`),e.loadingPromise=void 0,e.imageData=t,e.loaded=!0,r(t)}).catch(t=>{o.error(`... loading image failed: ${e.url} : ${t}`),r(void 0)})}else try{"undefined"==typeof document&&(o.error("Error: document is not available, cannot generate image"),i(new Error("ImageCache#renderImage: document is not available, cannot render image to create texture")));const n=document.createElement("canvas");n.width=t.width,n.height=t.height;const a=n.getContext("2d");if(null!==a){o.debug(`... finished creating bitmap image in canvas: ${e.url} ${t}`),a.drawImage(t,0,0,t.width,t.height,0,0,n.width,n.height);const i=a.getImageData(0,0,t.width,t.height);e.imageData=i,e.loaded=!0,r(i)}else o.error("renderImage: no context found"),i(new Error("ImageCache#renderImage: no context found"))}catch(t){o.error(`renderImage failed: ${t}`),e.imageData=void 0,e.loaded=!0,i(new Error(`ImageCache#renderImage failed: ${t}`))}})}}t.ImageCache=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(9),n=r(1),o=r(0),a=r(20);t.MapViewFog=class{constructor(e){this.m_scene=e,this.m_enabled=!0,this.m_fog=new o.Fog(0),this.m_fogIsDefined=!1,this.m_cachedTheme={styles:{}}}set enabled(e){this.m_enabled=e,e&&this.m_fogIsDefined&&null===this.m_scene.fog?this.add():e||null===this.m_scene.fog||this.remove()}get enabled(){return this.m_enabled}reset(e){this.m_cachedTheme=e,void 0!==e&&void 0!==e.fog&&void 0!==e.fog.color&&void 0!==e.fog.startRatio?(this.m_fogIsDefined=!0,this.m_fog.color.set(e.fog.color),this.m_enabled&&null===this.m_scene.fog&&this.add()):(this.m_fogIsDefined=!1,null!==this.m_scene.fog&&this.remove())}update(e,t){if(null!==this.m_scene.fog&&void 0!==this.m_cachedTheme&&this.m_cachedTheme.fog&&void 0!==this.m_cachedTheme.fog.startRatio&&(void 0!==e.camera.far||void 0!==t)){const r=void 0!==t?t:e.camera.far,i=1,o=0,s=this.m_cachedTheme.fog.startRatio,c=1;n.assert(s<=c);const l=a.MapViewUtils.rayCastWorldCoordinates(e,0,0);if(null===l)throw new Error("MapView does not support a view pointing in the void.");const u=Math.abs(Math.cos(a.MapViewUtils.extractSphericalCoordinatesFromLocation(e,e.camera,e.projection.unprojectPoint(l)).tilt)),d=n.MathUtils.smoothStep(i,o,u);this.m_fog.near=n.MathUtils.lerp(r*s,r,1-d),this.m_fog.far=n.MathUtils.lerp(r*c,r,d),this.m_fog.near=Math.min(this.m_fog.near,e.camera.far),this.m_fog.far=Math.min(this.m_fog.far,e.camera.far)}}add(){this.m_scene.fog=this.m_fog,this.setFogInRawShaderMaterials(!0)}remove(){this.m_scene.fog=null,this.setFogInRawShaderMaterials(!1)}setFogInRawShaderMaterials(e){this.m_scene.traverse(t=>{if(t instanceof o.Mesh&&t.material instanceof o.Material&&t.material instanceof o.Material&&!(t.material instanceof i.HighPrecisionLineMaterial)){if(t.material instanceof i.SolidLineMaterial){t.material.updateFog(e)}t.material.fog=e,t.material.needsUpdate=!0}})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(45),o=r(1),a=r(0),s=r(34),c=r(64),l=r(65),u=r(47),d=o.LoggerManager.instance.create("PoiManager");class h{constructor(e){this.mapView=e,this.m_imageTextures=new Map,this.m_poiShieldGroups=new Map,this.m_colorMap=new Map}static notifyMissingPoiTable(e,t){void 0===e&&(e="undefined"),void 0===h.m_missingPoiTableName.get(e)&&(h.m_missingPoiTableName.set(e,!0),void 0===t||t.loadedOk?d.error(`updatePoiFromPoiTable: No POI table with name '${e}' found!`):d.error(`updatePoiFromPoiTable: Could not load POI table '${e}'!`))}static notifyMissingPoi(e,t){void 0===e&&(e="undefined");const r=`${t}[${e}]`;void 0===h.m_missingPoiName.get(r)&&(h.m_missingPoiName.set(r,!0),d.warn("updatePoiFromPoiTable: "+`Cannot find POI info for '${e}' in table '${t}'.`))}addPois(e,t){const r=o.assertExists(t.poiGeometries);for(const n of r){o.assert(void 0!==n.technique);const r=o.assertExists(n.technique),s=t.techniques[r];if(!1===s.enabled||!i.isLineMarkerTechnique(s)&&!i.isPoiTechnique(s))continue;if(!1===s.showOnMap)continue;const c=new a.BufferAttribute(new Float32Array(n.positions.buffer),n.positions.itemCount);i.isLineMarkerTechnique(s)&&c.count>0?this.addLineMarker(e,n,s,c):i.isPoiTechnique(s)&&this.addPoi(e,n,s,r,c)}}addTextureAtlas(e,t){fetch(t).then(e=>{if(!e.ok)throw new Error(`addTextureAtlas: Cannot load textureAtlas: ${e.statusText}`);return e.json()}).then(r=>{if(void 0!==r){try{d.debug(`addTextureAtlas: Loading textureAtlas '${t}' for image '${e}'`);for(const t of Object.getOwnPropertyNames(r)){const i=r[t],n={name:t,image:e,xOffset:i.x,yOffset:i.y,width:i.width,height:i.height};this.addImageTexture(n)}}catch(e){d.error("addTextureAtlas: Failed to load textureAtlas "+`'${t}' : ${e}`)}this.mapView.update()}else d.info(`addTextureAtlas: TextureAtlas empty: ${t}`)}).catch(e=>{d.error(`addTextureAtlas: Failed to load textureAtlas '${t}' : ${e}`)})}addImageTexture(e){void 0!==e.name?(void 0!==this.m_imageTextures.get(e.name)&&d.warn(`addImageTexture: Name already used: ${e.name}`+" (overriding it)"),this.m_imageTextures.set(e.name,e)):d.error("addImageTexture: Name required",e)}getImageTexture(e){return this.m_imageTextures.get(e)}updatePoiFromPoiTable(e){const t=e.poiInfo;if(void 0===t||void 0===t.poiTableName||void 0===t.poiName)return!0;const r=t.poiTableName,n=this.mapView.poiTableManager.getPoiTable(r);if(void 0!==n&&n.isLoading)return!1;if(void 0===n||!n.loadedOk)return h.notifyMissingPoiTable(r,n),!0;const o=t.poiName,a=n.getEntry(o);return void 0===a?(h.notifyMissingPoi(o,r),!0):(void 0!==a.iconName&&a.iconName.length>0&&(t.imageTextureName=i.composeTechniqueTextureName(a.iconName,t.technique)),e.visible=void 0!==a.visible?a.visible:e.visible,e.priority=void 0!==a.priority?a.priority:e.priority,t.iconMinZoomLevel=void 0!==a.iconMinLevel?a.iconMinLevel:t.iconMinZoomLevel,t.iconMaxZoomLevel=void 0!==a.iconMaxLevel?a.iconMaxLevel:t.iconMaxZoomLevel,t.textMinZoomLevel=void 0!==a.textMinLevel?a.textMinLevel:t.textMinZoomLevel,t.textMaxZoomLevel=void 0!==a.textMaxLevel?a.textMaxLevel:t.textMaxZoomLevel,e.updateMinMaxZoomLevelsFromPoiInfo(),!0)}clear(){this.m_imageTextures.clear(),this.m_poiShieldGroups.clear()}addLineMarker(e,t,r,n){let s,c=void 0!==r.imageTexture?i.composeTechniqueTextureName(r.imageTexture,r):void 0,l="";void 0!==t.stringCatalog&&(o.assert(t.texts.length>0),l=t.stringCatalog[t.texts[0]]||"",s=t.objInfos?t.objInfos[0]:void 0,void 0!==t.imageTextures&&(o.assert(t.imageTextures.length>0),c=t.stringCatalog[t.imageTextures[0]]));const u=String(c)+"-"+l;let d=this.m_poiShieldGroups.get(u);void 0===d&&(d=this.m_poiShieldGroups.size,this.m_poiShieldGroups.set(u,d));const h=[];for(let e=0;e<n.count;e+=3){const t=n.getX(e),r=n.getY(e),i=n.getZ(e);h.push(new a.Vector3(t,r,i))}const m=this.checkCreateTextElement(e,l,r,c,void 0,void 0,d,t.featureId,h,void 0,void 0,s);m.ignoreDistance=!1,e.addTextElement(m)}addPoi(e,t,r,n,a){if(void 0===t.stringCatalog)return;const s=void 0!==r.imageTexture?i.composeTechniqueTextureName(r.imageTexture,r):void 0,c=r,l=c.poiTable;let u=c.poiName;for(let i=0;i<a.count;++i){const n=a.getX(i),d=a.getY(i),h=a.getZ(i);o.assert(t.texts.length>i);let m=s;const p=t.stringCatalog[t.texts[i]]||"",f=t.objInfos?t.objInfos[i]:void 0;void 0!==t.imageTextures&&t.imageTextures[i]>=0&&(o.assert(t.imageTextures.length>i),m=t.stringCatalog[t.imageTextures[i]]),void 0!==l&&(u=void 0===c.poiName?m:c.poiName,m=void 0);const g=this.checkCreateTextElement(e,p,r,m,l,u,0,t.featureId,n,d,h,f);e.addTextElement(g)}}checkCreateTextElement(e,t,r,o,s,u,h,m,p,f,g,y){const v=void 0!==r.priority?r.priority:0,_=Array.isArray(p)?p:new a.Vector3(p,f,g),b=this.mapView.zoomLevel,S=void 0!==r.fadeNear?i.getPropertyValue(r.fadeNear,b):r.fadeNear,T=void 0!==r.fadeFar?i.getPropertyValue(r.fadeFar,b):r.fadeFar,E=i.getPropertyValue(r.xOffset,b),w=i.getPropertyValue(r.yOffset,b),C=new c.TextElement(n.ContextualArabicConverter.instance.convert(t),_,this.getRenderStyle(e.dataSource.name,r),this.getLayoutStyle(e.dataSource.name,r),i.getPropertyValue(v,b),void 0!==E?E:0,void 0!==w?w:0,m,r.style,S,T);if(C.mayOverlap=!0===r.textMayOverlap,C.reserveSpace=!1!==r.textReserveSpace,C.alwaysOnTop=!0===r.alwaysOnTop,C.userData=y,void 0===o&&void 0!==s?o="":void 0!==o&&void 0!==s&&d.warn("Possible duplicate POI icon definition via imageTextureName and poiTable!"),void 0!==o){const e=!0===r.textIsOptional,t=!1!==r.iconIsOptional,i=!(!1===r.renderTextDuringMovements),n=void 0===r.iconMayOverlap?C.textMayOverlap:!0===r.iconMayOverlap,a=void 0===r.iconReserveSpace?C.textReservesSpace:!1!==r.iconReserveSpace;C.poiInfo={technique:r,imageTextureName:o,poiTableName:s,poiName:u,shieldGroupIndex:h,textElement:C,textIsOptional:e,iconIsOptional:t,renderTextDuringMovements:i,mayOverlap:n,reserveSpace:a,featureId:m,iconMinZoomLevel:r.iconMinZoomLevel,iconMaxZoomLevel:r.iconMaxZoomLevel,textMinZoomLevel:r.textMinZoomLevel,textMaxZoomLevel:r.textMaxZoomLevel},C.updateMinMaxZoomLevelsFromPoiInfo()}else void 0===C.minZoomLevel&&(C.minZoomLevel=r.textMinZoomLevel),void 0===C.maxZoomLevel&&(C.maxZoomLevel=r.textMaxZoomLevel);return C.distanceScale=void 0!==r.distanceScale?r.distanceScale:l.DEFAULT_TEXT_DISTANCE_SCALE,C.isPointLabel=!0,C}getRenderStyle(e,t){const r=this.mapView,a=r.zoomLevel,c=u.computeStyleCacheId(e,t,Math.floor(a)),l=this.mapView.textElementsRenderer;let d=r.textRenderStyleCache.get(c);if(void 0===d){const e=void 0!==l?l.defaultStyle.renderParams:{fontSize:{unit:n.FontUnit.Pixel,size:32,backgroundSize:8}};if(void 0!==t.color){const e=i.getPropertyValue(t.color,Math.floor(a));this.m_colorMap.set(c,s.ColorCache.instance.getColor(e))}if(void 0!==t.backgroundColor){const e=i.getPropertyValue(t.backgroundColor,Math.floor(a));this.m_colorMap.set(c+"_bg",s.ColorCache.instance.getColor(e))}const u={fontName:o.getOptionValue(t.fontName,e.fontName),fontSize:{unit:n.FontUnit.Pixel,size:void 0!==t.size?i.getPropertyValue(t.size,Math.floor(a)):e.fontSize.size,backgroundSize:void 0!==t.backgroundSize?i.getPropertyValue(t.backgroundSize,Math.floor(a)):e.fontSize.backgroundSize},fontStyle:"Regular"===t.fontStyle||"Bold"===t.fontStyle||"Italic"===t.fontStyle||"BoldItalic"===t.fontStyle?n.FontStyle[t.fontStyle]:e.fontStyle,fontVariant:"Regular"===t.fontVariant||"AllCaps"===t.fontVariant||"SmallCaps"===t.fontVariant?n.FontVariant[t.fontVariant]:e.fontVariant,rotation:o.getOptionValue(t.rotation,e.rotation),color:o.getOptionValue(this.m_colorMap.get(c),e.color),backgroundColor:o.getOptionValue(this.m_colorMap.get(c+"_bg"),e.backgroundColor),opacity:void 0!==t.opacity?i.getPropertyValue(t.opacity,Math.floor(a)):e.opacity,backgroundOpacity:void 0!==t.backgroundOpacity?i.getPropertyValue(t.backgroundOpacity,Math.floor(a)):void 0!==t.backgroundColor&&void 0!==t.backgroundSize&&i.getPropertyValue(t.backgroundSize,Math.floor(a))>0?1:e.backgroundOpacity},h=void 0!==r.textElementsRenderer?r.textElementsRenderer.getTextElementStyle(t.style).renderParams:{};d=new n.TextRenderStyle(Object.assign(Object.assign({},h),u)),r.textRenderStyleCache.set(c,d)}return d}getLayoutStyle(e,t){const r=Math.floor(this.mapView.zoomLevel),a=u.computeStyleCacheId(e,t,r),s=this.mapView.textElementsRenderer;let c=this.mapView.textLayoutStyleCache.get(a);if(void 0===c){const e=void 0!==s?s.defaultStyle.layoutParams:{},l=i.getPropertyValue(t.hAlignment,r),u=i.getPropertyValue(t.vAlignment,r),d="Left"===l||"Center"===l||"Right"===l?n.HorizontalAlignment[l]:e.horizontalAlignment,h="Above"===u||"Center"===u||"Below"===u?n.VerticalAlignment[u]:e.verticalAlignment,m={tracking:o.getOptionValue(t.tracking,e.tracking),leading:o.getOptionValue(t.leading,e.leading),maxLines:o.getOptionValue(t.maxLines,e.maxLines),lineWidth:o.getOptionValue(t.lineWidth,e.lineWidth),canvasRotation:o.getOptionValue(t.canvasRotation,e.canvasRotation),lineRotation:o.getOptionValue(t.lineRotation,e.lineRotation),wrappingMode:"None"===t.wrappingMode||"Character"===t.wrappingMode||"Word"===t.wrappingMode?n.WrappingMode[t.wrappingMode]:e.wrappingMode,horizontalAlignment:d,verticalAlignment:h},p=void 0!==this.mapView.textElementsRenderer?this.mapView.textElementsRenderer.getTextElementStyle(t.style).layoutParams:{};c=new n.TextLayoutStyle(Object.assign(Object.assign({},p),m)),this.mapView.textLayoutStyleCache.set(a,c)}return c}}t.PoiManager=h,h.m_missingPoiTableName=new Map,h.m_missingPoiName=new Map},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(1).LoggerManager.instance.create("PoiTable");class o{static verifyJSON(e){let t="string"==typeof e.name&&e.name.length>0&&(void 0===e.altNames||Array.isArray(e.altNames))&&(void 0===e.stackMode||"yes"===e.stackMode||"no"===e.stackMode||"parent"===e.stackMode)&&(void 0===e.visible||"boolean"==typeof e.visible)&&(void 0===e.priority||"number"==typeof e.priority)&&(void 0===e.iconMinLevel||"number"==typeof e.iconMinLevel)&&(void 0===e.iconMaxLevel||"number"==typeof e.iconMaxLevel)&&(void 0===e.textMinLevel||"number"==typeof e.textMinLevel)&&(void 0===e.textMaxLevel||"number"==typeof e.textMaxLevel);if(t&&void 0!==e.altNames){const r=e.altNames;for(const e in r)if("string"!=typeof e){t=!1;break}}return t}setup(e){switch(this.name=e.name,this.altNames=e.altNames,this.iconName=e.iconName,this.visible=e.visible,this.priority=e.priority,this.iconMinLevel=e.iconMinLevel,this.iconMaxLevel=e.iconMaxLevel,this.textMinLevel=e.textMinLevel,this.textMaxLevel=e.textMaxLevel,e.stackMode){case"yes":this.stackMode=i.PoiStackMode.Show;break;case"no":this.stackMode=i.PoiStackMode.Hide;break;case"parent":this.stackMode=i.PoiStackMode.ShowParent}}}class a{constructor(e,t){this.name=e,this.useAltNamesForKey=t,this.poiList=new Array,this.poiDict=new Map,this.m_isLoading=!1,this.m_loadedOk=void 0}get isLoading(){return this.m_isLoading}get loadedOk(){return!0===this.m_loadedOk}getEntry(e){const t=this.poiDict.get(e);if(void 0!==t){if(t<this.poiList.length)return this.poiList[t];throw new Error("Poi table entry index out of stored list!")}}async load(e){if(void 0!==this.m_loadedOk)return!0;this.m_loadedOk=!1;const t=await fetch(e);if(!t.ok)throw new Error(`load: Cannot load POI table at ${e}:`+` ${t.statusText}`);const r=await t.json();if(void 0===r)return n.info(`load: TextureAtlas empty: ${e}`),!0;this.startLoading();try{if(n.debug(`load: Loading POI table '${e}' for table '${this.name}'`),void 0!==r.poiList&&Array.isArray(r.poiList))for(const t of r.poiList)if(o.verifyJSON(t)){const r=new o;r.setup(t);const i=this.poiList.push(r)-1;if(this.useAltNamesForKey)if(void 0!==r.altNames&&r.altNames.length>0)for(const e of r.altNames)this.poiDict.set(e,i);else n.warn(`load: Invalid entry in POI table '${e}' : `+`No alternative names set in entry: ${JSON.stringify(t)}.`);else void 0===r.name?n.warn(`load: Invalid entry in POI table '${e}' : `+`. No name set in entry: ${t}.`):this.poiDict.set(r.name,i)}else n.warn(`load: Invalid entry in POI table '${e}' : ${JSON.stringify(t)}`);this.m_loadedOk=!0,this.finishedLoading()}catch(t){return n.error("load: Failed to load POI table "+`'${e}' : ${t}`),this.m_loadedOk=!1,this.finishedLoading(),!1}return!0}startLoading(){this.m_isLoading=!0}finishedLoading(){this.m_isLoading=!1}}t.PoiTable=a;t.PoiTableManager=class{constructor(e){this.mapView=e,this.m_isLoading=!1,this.m_poiTables=new Map}async loadPoiTables(e){return new Promise(t=>{if(this.clear(),void 0!==e.poiTables){this.startLoading();const r=new Array;e.poiTables.forEach(e=>{if(void 0!==e&&void 0!==e.name&&"string"==typeof e.name){const t=new a(e.name,!1!==e.useAltNamesForKey);void 0!==e.url&&"string"==typeof e.url?(this.addTable(t),r.push(t.load(e.url))):n.error(`POI table definition has no valid url: ${e}`)}else n.error(`POI table definition has no valid name: ${e}`)}),r.length>0?Promise.all(r).finally(()=>{this.finishLoading(),t()}):(this.finishLoading(),t())}else this.finishLoading(),t()})}clear(){this.m_poiTables=new Map}get poiTables(){return this.m_poiTables}addTable(e){this.m_poiTables.set(e.name,e)}getPoiTable(e){return void 0===e?void 0:this.m_poiTables.get(e)}get finishedLoading(){return!this.m_isLoading}startLoading(){this.m_isLoading=!0}finishLoading(){this.m_isLoading=!1}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(12),o=r(4),a=r(87),s=r(91),c=r(67);class l extends a.DataSource{constructor({name:e="polar",styleSetName:t,minZoomLevel:r,maxZoomLevel:i,storageLevelOffset:n=-2,geometryLevelOffset:a=-1,debugTiles:s=!1}){super(e,t,r,i,n),this.m_tilingScheme=o.polarTilingScheme,this.m_maxLatitude=o.MathUtils.radToDeg(o.MercatorConstants.MAXIMUM_LATITUDE),this.m_geometryLevelOffset=a,this.m_debugTiles=s,this.cacheable=!1}dispose(){this.m_northPoleMaterial&&(this.m_northPoleMaterial.dispose(),delete this.m_northPoleMaterial),this.m_southPoleMaterial&&(this.m_southPoleMaterial.dispose(),delete this.m_southPoleMaterial),this.m_styleSetEvaluator&&delete this.m_styleSetEvaluator}createMaterial(e,t){const r=new n.MapEnv({$geometryType:"polygon",$layer:"earth",kind:e}),i=t.getMatchingTechniques(r);return 0!==i.length?s.createMaterial({technique:i[0],level:1}):void 0}setStyleSet(e,t,r){this.dispose(),void 0!==e&&(this.m_styleSetEvaluator=new n.StyleSetEvaluator(e,t),this.m_northPoleMaterial=this.createMaterial("north_pole",this.m_styleSetEvaluator),this.m_southPoleMaterial=this.createMaterial("south_pole",this.m_styleSetEvaluator)),this.mapView.markTilesDirty(this)}setTheme(e,t){const r=void 0!==this.styleSetName&&e.styles&&e.styles[this.styleSetName]||[];this.setStyleSet(r,e.definitions,t)}shouldRender(e,t){if(e!==t.level||t.level<1)return!1;const{north:r,south:i}=this.m_tilingScheme.getGeoBox(t);return r>this.m_maxLatitude||i<-this.m_maxLatitude}shouldSubdivide(e,t){if(e<=t.level)return!1;const{north:r,south:i}=this.m_tilingScheme.getGeoBox(t);return r>this.m_maxLatitude||i<-this.m_maxLatitude}getTilingScheme(){return this.m_tilingScheme}getTile(e){const t=new c.Tile(this,e);return this.createTileGeometry(t),t}get geometryLevelOffset(){return this.m_geometryLevelOffset}set geometryLevelOffset(e){this.m_geometryLevelOffset=e}intersectEdge(e,t,r){const i=t.latitude,n=r.latitude;let a=t.longitude,s=r.longitude;90===Math.abs(i)&&(a=s),90===Math.abs(n)&&(s=a);const c=s-a,l=(e-i)/(n-i);return new o.GeoCoordinates(e,a+c*l,0)}createTileGeometry(e){const{north:t,south:r}=e.geoBox,n=t>0&&r>=0,a=n?this.m_northPoleMaterial:this.m_southPoleMaterial;if(void 0===a)return;const s=this.m_tilingScheme.projection,c=this.projection,l=this.m_maxLatitude,u=n?l:-l,d=this.m_tilingScheme.boundingBoxGenerator.getWorldBox(e.tileKey),h=s.unprojectPoint(new i.Vector3(d.min.x,d.min.y,0)),m=s.unprojectPoint(new i.Vector3(d.max.x,d.min.y,0)),p=s.unprojectPoint(new i.Vector3(d.max.x,d.max.y,0)),f=s.unprojectPoint(new i.Vector3(d.min.x,d.max.y,0));let g,y=!1;if(1===e.tileKey.level){const e=0===d.min.x,t=e?d.max.x:d.min.x,r=(d.max.y+d.min.y)/2,o=s.unprojectPoint(new i.Vector3(t,r,0)),a=e?h:m;g=n?e?[o,p,a,m]:[o,h,a,f]:e?[o,m,a,p]:[o,f,a,h],y=!0}else{const e=(g=n?[h,m,p,f]:[h,f,p,m]).map(e=>e.latitude),t=Math.max(...e),r=Math.min(...e);if(n?t<u:r>u)return;if(y=n?r<u:t>u){const i=e.indexOf(n?t:r);if(0!==i)for(let e=0;e<i;e++)g.push(g.shift())}}if(y){const t=(d.min.x+d.max.x)/2,r=(d.min.y+d.max.y)/2,n=s.unprojectPoint(new i.Vector3(t,r,0));o.TransverseMercatorUtils.alignLongitude(g,n);const a=g[0],c=g[1],h=g[2],m=g[3],p=Math.abs(c.latitude)>=l,f=Math.abs(m.latitude)>=l,y=p?this.intersectEdge(u,c,h):this.intersectEdge(u,a,c),v=f?this.intersectEdge(u,m,h):this.intersectEdge(u,a,m);g.splice(p?2:1,4,y);const _=e.tileKey.level-this.storageLevelOffset+this.m_geometryLevelOffset,b=360/(1<<Math.max(0,_)),S=Math.floor((y.longitude+180)/b),T=Math.ceil((v.longitude+180)/b);for(let e=S+1;e<T;e++)g.push(new o.GeoCoordinates(u,e*b-180,0));g.push(v),f&&g.push(m)}const v=new i.Geometry;for(const t of g){const r=c.projectPoint(t,new i.Vector3);v.vertices.push(r.sub(e.center))}for(let e=1;e<g.length-1;e++)v.faces.push(n?new i.Face3(0,e,e+1):new i.Face3(0,e+1,e));const _=new i.BufferGeometry;_.fromGeometry(v),v.dispose();const b=new i.Mesh(_,a);if(b.userData={dataSource:this.name,tileKey:e.tileKey},this.m_debugTiles){const t=Math.round(16777215*Math.abs(Math.sin(11*e.tileKey.mortonCode())));b.material=new i.MeshBasicMaterial({color:t,transparent:!0,opacity:.5}),e.objects.push(new i.Mesh(_,new i.MeshBasicMaterial({color:t,wireframe:!0})))}e.objects.push(b)}}t.PolarTileDataSource=l},function(e,t,r){e.exports=function(){"use strict";function e(e,i,n,o,a){!function e(r,i,n,o,a){for(;o>n;){if(o-n>600){var s=o-n+1,c=i-n+1,l=Math.log(s),u=.5*Math.exp(2*l/3),d=.5*Math.sqrt(l*u*(s-u)/s)*(c-s/2<0?-1:1);e(r,i,Math.max(n,Math.floor(i-c*u/s+d)),Math.min(o,Math.floor(i+(s-c)*u/s+d)),a)}var h=r[i],m=n,p=o;for(t(r,n,i),a(r[o],h)>0&&t(r,n,o);m<p;){for(t(r,m,p),m++,p--;a(r[m],h)<0;)m++;for(;a(r[p],h)>0;)p--}0===a(r[n],h)?t(r,n,p):t(r,++p,o),p<=i&&(n=p+1),i<=p&&(o=p-1)}}(e,i,n||0,o||e.length-1,a||r)}function t(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function r(e,t){return e<t?-1:e>t?1:0}var i=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function n(e,t,r){if(!r)return t.indexOf(e);for(var i=0;i<t.length;i++)if(r(e,t[i]))return i;return-1}function o(e,t){a(e,0,e.children.length,t,e)}function a(e,t,r,i,n){n||(n=p(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var o=t;o<r;o++){var a=e.children[o];s(n,e.leaf?i(a):a)}return n}function s(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function c(e,t){return e.minX-t.minX}function l(e,t){return e.minY-t.minY}function u(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function d(e){return e.maxX-e.minX+(e.maxY-e.minY)}function h(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function m(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function p(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function f(t,r,i,n,o){for(var a=[r,i];a.length;)if(!((i=a.pop())-(r=a.pop())<=n)){var s=r+Math.ceil((i-r)/n/2)*n;e(t,s,r,i,o),a.push(r,s,s,i)}}return i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(e){var t=this.data,r=[];if(!m(e,t))return r;for(var i=this.toBBox,n=[];t;){for(var o=0;o<t.children.length;o++){var a=t.children[o],s=t.leaf?i(a):a;m(e,s)&&(t.leaf?r.push(a):h(e,s)?this._all(a,r):n.push(a))}t=n.pop()}return r},i.prototype.collides=function(e){var t=this.data;if(!m(e,t))return!1;for(var r=[];t;){for(var i=0;i<t.children.length;i++){var n=t.children[i],o=t.leaf?this.toBBox(n):n;if(m(e,o)){if(t.leaf||h(e,o))return!0;r.push(n)}}t=r.pop()}return!1},i.prototype.load=function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},i.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},i.prototype.clear=function(){return this.data=p([]),this},i.prototype.remove=function(e,t){if(!e)return this;for(var r,i,o,a=this.data,s=this.toBBox(e),c=[],l=[];a||c.length;){if(a||(a=c.pop(),i=c[c.length-1],r=l.pop(),o=!0),a.leaf){var u=n(e,a.children,t);if(-1!==u)return a.children.splice(u,1),c.push(a),this._condense(c),this}o||a.leaf||!h(a,s)?i?(r++,a=i.children[r],o=!1):a=null:(c.push(a),l.push(r),r=0,i=a,a=a.children[0])}return this},i.prototype.toBBox=function(e){return e},i.prototype.compareMinX=function(e,t){return e.minX-t.minX},i.prototype.compareMinY=function(e,t){return e.minY-t.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(e){return this.data=e,this},i.prototype._all=function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},i.prototype._build=function(e,t,r,i){var n,a=r-t+1,s=this._maxEntries;if(a<=s)return o(n=p(e.slice(t,r+1)),this.toBBox),n;i||(i=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,i-1))),(n=p([])).leaf=!1,n.height=i;var c=Math.ceil(a/s),l=c*Math.ceil(Math.sqrt(s));f(e,t,r,l,this.compareMinX);for(var u=t;u<=r;u+=l){var d=Math.min(u+l-1,r);f(e,u,d,c,this.compareMinY);for(var h=u;h<=d;h+=c){var m=Math.min(h+c-1,d);n.children.push(this._build(e,h,m,i-1))}}return o(n,this.toBBox),n},i.prototype._chooseSubtree=function(e,t,r,i){for(;i.push(t),!t.leaf&&i.length-1!==r;){for(var n=1/0,o=1/0,a=void 0,s=0;s<t.children.length;s++){var c=t.children[s],l=u(c),d=(h=e,m=c,(Math.max(m.maxX,h.maxX)-Math.min(m.minX,h.minX))*(Math.max(m.maxY,h.maxY)-Math.min(m.minY,h.minY))-l);d<o?(o=d,n=l<n?l:n,a=c):d===o&&l<n&&(n=l,a=c)}t=a||t.children[0]}var h,m;return t},i.prototype._insert=function(e,t,r){var i=r?e:this.toBBox(e),n=[],o=this._chooseSubtree(i,this.data,t,n);for(o.children.push(e),s(o,i);t>=0&&n[t].children.length>this._maxEntries;)this._split(n,t),t--;this._adjustParentBBoxes(i,n,t)},i.prototype._split=function(e,t){var r=e[t],i=r.children.length,n=this._minEntries;this._chooseSplitAxis(r,n,i);var a=this._chooseSplitIndex(r,n,i),s=p(r.children.splice(a,r.children.length-a));s.height=r.height,s.leaf=r.leaf,o(r,this.toBBox),o(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(r,s)},i.prototype._splitRoot=function(e,t){this.data=p([e,t]),this.data.height=e.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(e,t,r){for(var i,n,o,s,c,l,d,h=1/0,m=1/0,p=t;p<=r-t;p++){var f=a(e,0,p,this.toBBox),g=a(e,p,r,this.toBBox),y=(n=f,o=g,s=Math.max(n.minX,o.minX),c=Math.max(n.minY,o.minY),l=Math.min(n.maxX,o.maxX),d=Math.min(n.maxY,o.maxY),Math.max(0,l-s)*Math.max(0,d-c)),v=u(f)+u(g);y<h?(h=y,i=p,m=v<m?v:m):y===h&&v<m&&(m=v,i=p)}return i||r-t},i.prototype._chooseSplitAxis=function(e,t,r){var i=e.leaf?this.compareMinX:c,n=e.leaf?this.compareMinY:l;this._allDistMargin(e,t,r,i)<this._allDistMargin(e,t,r,n)&&e.children.sort(i)},i.prototype._allDistMargin=function(e,t,r,i){e.children.sort(i);for(var n=this.toBBox,o=a(e,0,t,n),c=a(e,r-t,r,n),l=d(o)+d(c),u=t;u<r-t;u++){var h=e.children[u];s(o,e.leaf?n(h):h),l+=d(o)}for(var m=r-t-1;m>=t;m--){var p=e.children[m];s(c,e.leaf?n(p):p),l+=d(c)}return l},i.prototype._adjustParentBBoxes=function(e,t,r){for(var i=r;i>=0;i--)s(t[i],e)},i.prototype._condense=function(e){for(var t=e.length-1,r=void 0;t>=0;t--)0===e[t].children.length?t>0?(r=e[t-1].children).splice(r.indexOf(e[t]),1):this.clear():o(e[t],this.toBBox)},i}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=r(0),o=i.LoggerManager.instance.create("SkyCubemapTexture");var a;t.SKY_CUBEMAP_FACE_COUNT=6,function(e){e[e.positiveX=0]="positiveX",e[e.negativeX=1]="negativeX",e[e.positiveY=2]="positiveY",e[e.negativeY=3]="negativeY",e[e.positiveZ=4]="positiveZ",e[e.negativeZ=5]="negativeZ"}(a=t.SkyCubemapFaceId||(t.SkyCubemapFaceId={}));t.SkyCubemapTexture=class{constructor(e){const t=this.createCubemapFaceArray(e);this.m_skybox=void 0!==t?(new n.CubeTextureLoader).load(t):new n.CubeTexture}dispose(){this.m_skybox.dispose()}get texture(){return this.m_skybox}updateTexture(e){const t=this.createCubemapFaceArray(e);void 0!==t&&(this.m_skybox=(new n.CubeTextureLoader).load(t))}createCubemapFaceArray(e){const r=[void 0,void 0,void 0,void 0,void 0,void 0];for(let i=0;i<t.SKY_CUBEMAP_FACE_COUNT;++i){const t=e[a[i]];if(void 0===t)return void o.error(`Face "${a[i]}" was not defined.`);r[i]=t}return r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(54),n=r(1),o=r(174);r(68),t.DEFAULT_MAX_THEME_INTHERITANCE_DEPTH=4;class a{static async load(e,t){if(t=t||{},"string"==typeof e){const r=t.uriResolver,i=void 0!==r?r.resolveUri(e):e,o=await fetch(i,{signal:t.signal});if(!o.ok)throw new Error(`ThemeLoader#load: cannot load theme: ${o.statusText}`);(e=await o.json()).url=n.resolveReferenceUri(n.getAppBaseUrl(),i),e=this.resolveUrls(e,r)}else void 0===e.url&&(e.url=n.getAppBaseUrl(),e=this.resolveUrls(e,t.uriResolver));if(null==e)throw new Error("ThemeLoader#load: loaded resource is not valid JSON");e=e;const r=n.getOptionValue(t.resolveDefinitions,!1);if(e=await a.resolveBaseTheme(e,t),r){const r=new n.ContextLogger(t.logger||console,`when processing Theme ${e.url}:`);a.resolveThemeReferences(e,r)}return e}static isThemeLoaded(e){return void 0===e.extends}static async loadAsync(e){return a.load(e)}static resolveUrls(e,t){if(void 0===e.url)return e;const r=n.composeUriResolvers(new n.RelativeUriResolver(e.url),t);if(e.extends&&("string"==typeof e.extends?e.extends=r.resolveUri(e.extends):void 0===e.extends.url&&(e.extends.url=e.url,e.extends=this.resolveUrls(e.extends,t))),e.sky&&"cubemap"===e.sky.type)for(let t=0;t<o.SKY_CUBEMAP_FACE_COUNT;++t){const i=e.sky[o.SkyCubemapFaceId[t]];void 0!==i&&(e.sky[o.SkyCubemapFaceId[t]]=r.resolveUri(i))}if(e.images)for(const t of Object.keys(e.images)){const i=e.images[t];i.url=r.resolveUri(i.url),void 0!==i.atlas&&(i.atlas=r.resolveUri(i.atlas))}if(e.fontCatalogs)for(const t of e.fontCatalogs)t.url=r.resolveUri(t.url);if(e.poiTables)for(const t of e.poiTables)t.url=r.resolveUri(t.url);if(e.styles)for(const t in e.styles){if(!e.styles.hasOwnProperty(t))continue;const i=e.styles[t];for(const e of i)e.attr&&["map","normalMap","displacementMap","roughnessMap"].forEach(t=>{const i=e.attr[t];i&&"string"==typeof i&&(e.attr[t]=r.resolveUri(i))})}return e}static resolveThemeReferences(e,t){if(void 0!==e.definitions){t.pushAttr("definitions");for(const r in e.definitions){if(!e.definitions.hasOwnProperty(r))continue;const n=e.definitions[r];if(i.isActualSelectorDefinition(n)){t.pushAttr(r);const i=a.resolveStyle(n,e.definitions,t);t.pop(),void 0===i?(t.pushAttr(r),t.warn("skipping invalid style in definition"),t.pop(),delete e.definitions[r]):e.definitions[r]=i}}t.pop()}if(void 0!==e.styles)for(const r in e.styles)e.styles.hasOwnProperty(r)&&(t.pushAttr("styles"),t.pushAttr(r),e.styles[r]=a.resolveStyleSet(e.styles[r],e.definitions,t),t.pop(),t.pop());return e}static resolveStyleSet(e,t,r){const i=[];for(let n=0;n<e.length;++n){const o=e[n];r.pushIndex(n);const s=a.resolveStyle(o,t,r);void 0!==s?i.push(s):r.warn("invalid style, ignored"),r.pop()}return i}static resolveStyle(e,t,r){if(i.isJsonExprReference(e)){const o=t&&t[e[1]];if(!o)return void r.warn(`invalid reference '${e[1]}' - not found`);if(!i.isActualSelectorDefinition(o))return void r.warn(`invalid reference '${e[1]}' - expected style definition`);e=n.cloneDeep(o)}if(e=e,Array.isArray(e.when)){r.pushAttr("when");const i=this.resolveExpressionReferences(e.when,t,r);if(r.pop(),void 0===i)return;e.when=i}if(void 0!==e.attr){const i=e.attr;r.pushAttr("attr");for(const e in i){if(!i.hasOwnProperty(e))continue;const n=i[e];if(!Array.isArray(n))continue;r.pushAttr(e);const o=this.resolveExpressionReferences(n,t,r);r.pop(),void 0!==o?i[e]=o:delete i[e]}r.pop()}return e}static resolveExpressionReferences(e,t,r){let n=!1;const o=function e(o){if(i.isJsonExprReference(o)){const e=o[1],a=t&&t[e];return void 0===a?(r.warn(`invalid reference '${e}' - not found`),void(n=!0)):i.isValueDefinition(a)?a.value:(r.warn(`invalid reference '${e}' - expected value definition`),void(n=!0))}if(Array.isArray(o)){const t=[...o];for(let r=1;r<t.length;++r)t[r]=e(t[r]);return t}return o}(e);if(!n)return o}static async resolveBaseTheme(e,r){if(r=r||{},void 0===e.extends)return e;const i=n.getOptionValue(r.maxInheritanceDepth,t.DEFAULT_MAX_THEME_INTHERITANCE_DEPTH);if(i<=0)throw new Error("maxInheritanceDepth reached when attempting to load base theme");const o=e.extends;delete e.extends;const s=await a.load(o,Object.assign(Object.assign({},r),{resolveDefinitions:!1,maxInheritanceDepth:i-1})),c=Object.assign(Object.assign({},s.definitions),e.definitions),l=Object.assign(Object.assign({},s.styles),e.styles);return Object.assign(Object.assign(Object.assign({},s),e),{definitions:c,styles:l})}}t.ThemeLoader=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(4),n=r(61),o=r(1),a=r(0),s=r(20);var c;!function(e){e[e.EstimationInMb=0]="EstimationInMb",e[e.NumberOfTiles=1]="NumberOfTiles"}(c=t.ResourceComputationType||(t.ResourceComputationType={}));const l=1/1048576;class u{constructor(e,t=c.EstimationInMb){this.m_disposedTiles=[],this.m_resourceComputationType=t,this.m_tileCache=new n.LRUCache(e,e=>this.m_resourceComputationType===c.EstimationInMb?e.memoryUsage*l:1),this.m_tileCache.evictionCallback=(e,t)=>{void 0!==t.tileLoader&&t.tileLoader.cancel(),this.m_disposedTiles.push(t)},this.m_tileCache.canEvict=(e,t)=>!t.isVisible}static getKey(e,t,r){return`${r.name}_${e}_${t}`}static getKeyForTile(e){return u.getKey(e.tileKey.mortonCode(),e.offset,e.dataSource)}get resourceComputationType(){return this.m_resourceComputationType}get capacity(){return this.m_tileCache.capacity}get size(){return this.m_tileCache.size}setCapacity(e,t){this.m_resourceComputationType=t,this.m_tileCache.setCapacityAndMeasure(e,e=>this.m_resourceComputationType===c.EstimationInMb?e.memoryUsage*l:1)}get(e,t,r){return this.m_tileCache.get(u.getKey(e,t,r))}set(e,t,r,i){this.m_tileCache.set(u.getKey(e,t,r),i)}delete(e){const t=u.getKeyForTile(e);this.deleteByKey(t)}deleteByKey(e){this.m_tileCache.delete(e)}disposeTiles(){this.m_disposedTiles.forEach(e=>{e.dispose()}),this.m_disposedTiles.length=0}shrinkToCapacity(){this.m_tileCache.shrinkToCapacity()}evictAll(){this.m_tileCache.evictAll()}evictSelected(e){this.m_tileCache.evictSelected(e)}forEach(e,t){this.m_tileCache.forEach((r,i)=>{void 0!==t&&r.dataSource!==t||e(r,i)})}}t.VisibleTileSet=class{constructor(e,t,r){this.m_frustumIntersection=e,this.m_tileGeometryManager=t,this.dataSourceTileList=[],this.allVisibleTilesLoaded=!1,this.m_projectionMatrixOverride=new a.Matrix4,this.m_viewRange={near:.1,far:1/0,minimum:.1,maximum:1/0},this.m_resourceComputationType=c.EstimationInMb,this.options=r,this.m_resourceComputationType=void 0===r.resourceComputationType?c.EstimationInMb:r.resourceComputationType,this.m_dataSourceCache=new u(this.options.tileCacheSize,this.m_resourceComputationType)}getDataSourceCacheSize(){return this.options.tileCacheSize}setDataSourceCacheSize(e,t=c.EstimationInMb){this.options.tileCacheSize=e,this.resourceComputationType=t}getNumberOfVisibleTiles(){return this.options.maxVisibleDataSourceTiles}setNumberOfVisibleTiles(e){this.options.maxVisibleDataSourceTiles=e}get resourceComputationType(){return this.m_resourceComputationType}set resourceComputationType(e){this.m_resourceComputationType=e,this.m_dataSourceCache.setCapacity(this.options.tileCacheSize,e)}updateClipPlanes(e,t){return void 0!==e&&(this.options.clipPlanesEvaluator.maxElevation=e),void 0!==t&&(this.options.clipPlanesEvaluator.minElevation=t),this.m_viewRange=this.options.clipPlanesEvaluator.evaluateClipPlanes(this.m_frustumIntersection.mapView),this.m_viewRange}updateRenderList(e,t,r,i){let n=!0;const a=this.getVisibleTileKeysForDataSources(t,r,i);this.dataSourceTileList=[];for(const{dataSource:r,visibleTileKeys:i}of a.tileKeys){i.sort((e,t)=>{const r=t.area-e.area,i=.001*(e.area+t.area);return Math.abs(r)<i?t.tileKey.mortonCode()-e.tileKey.mortonCode():r});const o=[];let a=!0,s=0;const c=r.getDisplayZoomLevel(t);for(let e=0;e<i.length&&o.length<this.options.maxVisibleDataSourceTiles;e++){const t=i[e];if(!r.shouldRender(c,t.tileKey))continue;const n=this.getTile(r,t.tileKey,t.offset);void 0!==n&&(n.prepareTileInfo(),a=a&&n.allGeometryLoaded,n.allGeometryLoaded?(n.numFramesVisible++,n.frameNumVisible<0&&(n.frameNumVisible=r.mapView.frameNumber)):s++,n.visibleArea=t.area,n.minElevation=t.minElevation,n.maxElevation=t.maxElevation,o.push(n))}this.m_tileGeometryManager.updateTiles(o),this.dataSourceTileList.push({dataSource:r,storageLevel:e,zoomLevel:c,allVisibleTileLoaded:a,numTilesLoading:s,visibleTiles:o,renderedTiles:new Map}),n=n&&a}let s,c;this.allVisibleTilesLoaded=n&&a.allBoundingBoxesFinal,this.fillMissingTilesFromCache(),this.forEachCachedTile(e=>{e.isVisible||void 0===e.tileLoader||e.tileLoader.isFinished||this.disposeTile(e)}),this.m_dataSourceCache.shrinkToCapacity(),this.dataSourceTileList.forEach(e=>{e.renderedTiles.forEach(e=>{s=o.MathUtils.min2(s,e.minElevation),c=o.MathUtils.max2(c,e.maxElevation+e.maxGeometryHeight)})}),void 0===s&&(s=0),void 0===c&&(c=0);let l=!1;const u=this.m_viewRange,d=this.updateClipPlanes(c,s);var h,m;return{viewRanges:d,viewRangesChanged:l=!1==(m=u,(h=d).far===m.far&&h.maximum===m.maximum&&h.minimum===m.minimum&&h.near===m.near)}}getTile(e,t,r=0){return this.getTileImpl(e,t,r,!1)}getCachedTile(e,t,r=0){o.assert(e.cacheable);return this.getTileImpl(e,t,r,!0)}getRenderedTile(e,t,r=0){const i=this.dataSourceTileList.find(t=>t.dataSource===e);if(void 0!==i)return i.renderedTiles.get(s.TileOffsetUtils.getKeyForTileKeyAndOffset(t,r))}getRenderedTileAtLocation(e,t,r=0){const n=this.dataSourceTileList.find(t=>t.dataSource===e);if(void 0===n)return;const o=e.getTilingScheme(),a=n.zoomLevel,c=o.getTileKey(t,a);if(!c)return;let l=n.renderedTiles.get(s.TileOffsetUtils.getKeyForTileKeyAndOffset(c,r));if(void 0!==l)return l;const{searchLevelsUp:u,searchLevelsDown:d}=this.getCacheSearchLevels(e,a);let h=c;for(let e=1;e<=u;++e)if(h=h.parent(),void 0!==(l=n.renderedTiles.get(s.TileOffsetUtils.getKeyForTileKeyAndOffset(h,r))))return l;const m=o.projection.projectPoint(t);for(let e=1;e<=d;++e){const t=a+e,c=i.TileKeyUtils.worldCoordinatesToTileKey(o,m,t);if(c&&void 0!==(l=n.renderedTiles.get(s.TileOffsetUtils.getKeyForTileKeyAndOffset(c,r))))return l}}removeDataSource(e){this.clearTileCache(e),this.dataSourceTileList=this.dataSourceTileList.filter(t=>t.dataSource!==e)}clearTileCache(e){void 0!==e?this.m_dataSourceCache.evictSelected((t,r)=>t.dataSource===e):this.m_dataSourceCache.evictAll()}markTilesDirty(e){if(void 0===e)this.dataSourceTileList.forEach(e=>{this.markDataSourceTilesDirty(e)});else{const t=this.dataSourceTileList.find(t=>t.dataSource===e);if(void 0===t)return;this.markDataSourceTilesDirty(t)}}disposePendingTiles(){this.m_dataSourceCache.disposeTiles()}forEachVisibleTile(e){for(const t of this.dataSourceTileList)t.renderedTiles.forEach(e)}forEachCachedTile(e,t){this.m_dataSourceCache.forEach((t,r)=>e(t),t)}disposeTile(e){this.m_dataSourceCache.delete(e),e.dispose()}getCacheSearchLevels(e,t){return{searchLevelsUp:Math.min(this.options.quadTreeSearchDistanceUp,Math.max(0,t-e.minZoomLevel)),searchLevelsDown:Math.min(this.options.quadTreeSearchDistanceDown,Math.max(0,e.maxZoomLevel-t))}}fillMissingTilesFromCache(){const e=this.m_dataSourceCache;this.dataSourceTileList.forEach(t=>{const r=t.dataSource,n=r.getTilingScheme(),o=t.zoomLevel,a=t.renderedTiles,c=new Set;let l;!function(e){e[e.NONE=0]="NONE",e[e.UP=1]="UP",e[e.DOWN=2]="DOWN",e[e.BOTH=3]="BOTH"}(l||(l={}));let u=l.NONE;const{searchLevelsUp:d,searchLevelsDown:h}=this.getCacheSearchLevels(r,o);u=h>0&&d>0?l.BOTH:h>0?l.DOWN:d>0?l.UP:l.NONE;let m=new Map;if(t.visibleTiles.forEach(e=>{const t=s.TileOffsetUtils.getKeyForTileKeyAndOffset(e.tileKey,e.offset);e.levelOffset=0,e.hasGeometry||u===l.NONE?a.set(t,e):m.set(t,u)}),0!==m.size)for(;0!==m.size;){const t=new Map;m.forEach((u,d)=>{if(u===l.BOTH||u===l.UP){const n=s.TileOffsetUtils.getParentKeyFromKey(d);if(!c.has(n)&&!a.get(n)){c.add(n);const{offset:u,mortonCode:d}=s.TileOffsetUtils.extractOffsetAndMortonKeyFromKey(n),h=e.get(d,u,r),m=h?h.tileKey:i.TileKey.fromMortonCode(d),p=Math.abs(o-m.level);if(void 0!==h&&h.hasGeometry)return a.set(n,h),void(h.levelOffset=-p);p<this.options.quadTreeSearchDistanceUp&&t.set(n,l.UP)}}if(u===l.BOTH||u===l.DOWN){const{offset:u,mortonCode:h}=s.TileOffsetUtils.extractOffsetAndMortonKeyFromKey(d),m=i.TileKey.fromMortonCode(h);for(const i of n.getSubTileKeys(m)){const n=s.TileOffsetUtils.getKeyForTileKeyAndOffset(i,u);c.add(n);const d=e.get(i.mortonCode(),u,r),h=Math.abs(i.level-o);void 0!==d&&d.hasGeometry?(a.set(n,d),d.levelOffset=h):h<this.options.quadTreeSearchDistanceDown&&t.set(n,l.DOWN)}}}),m=t}})}getTileImpl(e,t,r,i){function n(t){void 0!==t&&(t.frameNumLastRequested=e.mapView.frameNumber)}if(!e.cacheable&&!i){const r=e.getTile(t);return n(r),r}const o=this.m_dataSourceCache;let a=o.get(t.mortonCode(),r,e);return void 0!==a&&a.offset===r?(n(a),a):i?void 0:(void 0!==(a=e.getTile(t))&&(a.offset=r,n(a),o.set(t.mortonCode(),r,e,a),this.m_tileGeometryManager.initTile(a)),a)}markDataSourceTilesDirty(e){const t=this.m_dataSourceCache,r=new Set;function i(e,t){const i=u.getKeyForTile(e);r.has(i)||(r.add(i),void 0!==e.tileGeometryLoader&&e.tileGeometryLoader.reset(),e.clearTextElements(),e.load())}e.visibleTiles.forEach(e=>{i(e,this.m_tileGeometryManager)}),e.renderedTiles.forEach(e=>{i(e,this.m_tileGeometryManager)}),t.forEach((e,i)=>{r.has(i)||(t.deleteByKey(i),e.dispose())},e.dataSource)}getVisibleTileKeysForDataSources(e,t,r){const i=Array();let n=!0;if(0===t.length)return{tileKeys:i,allBoundingBoxesFinal:n};const o=new Map;if(t.forEach(e=>{const t=e.getTilingScheme(),r=o.get(t);void 0===r?o.set(t,[e]):r.push(e)}),void 0!==r){const e=s.MapViewUtils.getCameraFrustumPlanes(this.m_frustumIntersection.camera);e.near=this.m_viewRange.minimum,e.far=this.m_viewRange.maximum,this.m_projectionMatrixOverride.makePerspective(e.left,e.right,e.bottom,e.top,e.near,e.far),this.m_frustumIntersection.updateFrustum(this.m_projectionMatrixOverride)}else this.m_frustumIntersection.updateFrustum();for(const[t,a]of o){const o=a.map(t=>t.getDisplayZoomLevel(e)),s=Math.max(...o),c=this.m_frustumIntersection.compute(t,s,r,o,a);n=n&&c.calculationFinal;for(const t of a){const r=[],n=t.getDisplayZoomLevel(e);for(const e of c.tileKeyEntries.values())t.shouldRender(n,e.tileKey)&&r.push(e);i.push({dataSource:t,visibleTileKeys:r})}}return{tileKeys:i,allBoundingBoxesFinal:n}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(162),n=r(178);class o{static getTiler(e,t,r){const i=this.getWorkerSet(t,r);return new n.WorkerBasedTiler(i,e)}static getWorkerSet(e,t){void 0===e&&(e=this.defaultScriptUrl);let r=this.workerSets[e];return void 0===r&&(r=new i.ConcurrentWorkerSet({scriptUrl:e,workerCount:void 0===t?this.defaultWorkerCount:t}),this.workerSets[e]=r),r}static destroyWorkerSet(e){const t=this.workerSets[e];void 0!==t&&(t.destroy(),delete this.workerSets[e])}static destroy(){Object.keys(this.workerSets).forEach(e=>{this.workerSets[e].destroy()}),this.workerSets={}}}t.ConcurrentTilerFacade=o,o.defaultScriptUrl="./decoder.bundle.js",o.defaultWorkerCount=1,o.workerSets={}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2);let n=0;t.WorkerBasedTiler=class{constructor(e,t){this.workerSet=e,this.tilerServiceType=t,this.m_serviceCreated=!1,this.workerSet.addReference(),this.serviceId=`${this.tilerServiceType}-${n++}`}dispose(){this.m_serviceCreated&&this.workerSet.broadcastRequest(i.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID,{type:i.WorkerServiceProtocol.Requests.DestroyService,targetServiceId:this.serviceId}).catch(()=>{}),this.workerSet.removeReference()}async connect(){await this.workerSet.connect(i.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID),this.m_serviceCreated||(await this.workerSet.broadcastRequest(i.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID,{type:i.WorkerServiceProtocol.Requests.CreateService,targetServiceType:this.tilerServiceType,targetServiceId:this.serviceId}),this.m_serviceCreated=!0)}registerIndex(e,t){const r={type:i.WorkerTilerProtocol.Requests.RegisterIndex,id:e,input:t instanceof URL?t.href:t};return this.workerSet.invokeRequest(this.serviceId,r)}updateIndex(e,t){const r={type:i.WorkerTilerProtocol.Requests.UpdateIndex,id:e,input:t instanceof URL?t.href:t};return this.workerSet.invokeRequest(this.serviceId,r)}getTile(e,t){const r=t.mortonCode(),n={type:i.WorkerTilerProtocol.Requests.TileRequest,index:e,tileKey:r};return this.workerSet.invokeRequest(this.serviceId,n)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=r(173);t.CopyrightCoverageProvider=class{constructor(){this.logger=i.LoggerManager.instance.create("CopyrightCoverageProvider")}getTree(){return void 0!==this.m_cachedTreePromise?this.m_cachedTreePromise:(this.m_cachedTreePromise=this.getCopyrightCoverageData().then(e=>this.initRBush(e)).catch(e=>(this.logger.error(e),new n)),this.m_cachedTreePromise)}async getCopyrights(e,t){const r=[],n=(await this.getTree()).search({minX:e.west,minY:e.south,maxX:e.east,maxY:e.north});for(const e of n){const n=i.getOptionValue(e.minLevel,0),o=i.getOptionValue(e.maxLevel,1/0);t>=n&&t<=o&&void 0===r.find(t=>t.id===e.label)&&r.push({id:e.label})}return r}initRBush(e){const t=new n;if(!e)return this.logger.warn("No copyright coverage data provided"),t;for(const r of e){const{minLevel:e,maxLevel:i,label:n,alt:o}=r;if(r.boxes)for(const a of r.boxes){const[r,s,c,l]=a;t.insert({minX:s,minY:r,maxX:l,maxY:c,minLevel:e,maxLevel:i,label:n,alt:o})}else t.insert({minX:-180,minY:-90,maxX:180,maxY:180,minLevel:e,maxLevel:i,label:n,alt:o})}return t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(378))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(97),o=r(1),a=o.LoggerManager.instance.create("TileGeometry");t.isLineAccessor=function(e){return"function"==typeof e.isLineAccessor&&!0===e.isLineAccessor()},t.isObject3dAccessor=function(e){return"function"==typeof e.isObject3dAccessor&&!0===e.isObject3dAccessor()};class s{constructor(e,t,r){this.object=e,this.geometryType=t,this.bufferGeometry=r,this.start=-1,this.end=-1,this.startCapSize=0,this.endCapSize=0,o.assert(!!e),"BufferGeometry"!==r.type&&a.error("IndexedBufferedGeometryAccessor#constructor: BufferGeometry has wrong type"),o.assert("BufferGeometry"===r.type,"IndexedBufferedGeometryAccessor#constructor: BufferGeometry has wrong type"),this.position=this.bufferGeometry.getAttribute("position"),this.itemSize=this.position.itemSize,this.position||a.warn("BufferedGeometryAccessor#constructor: BufferGeometry has no position attribute"),this.position.array.constructor!==Float32Array&&a.warn("BufferedGeometryAccessor#constructor: BufferGeometry.position: unsupported ArrayBuffer")}getCount(){return this.position.count}get renderOrder(){return this.object.renderOrder}setRange(e,t,r=0,i=0){o.assert(e>=0),o.assert(t>=0),o.assert(e<=t),this.start=e,this.end=t,this.startCapSize=r,this.endCapSize=i}get color(){const e=e=>{const t=e;if("MeshBasicMaterial"===t.type||"MeshStandardMaterial"===t.type)return t.color;if("RawShaderMaterial"===t.type){const t=e;if("SolidLineMaterial"===t.name)return t.uniforms.diffuse.value;a.warn("BufferedGeometryAccessor#color: unknown shader material name",t.name)}else a.warn("BufferedGeometryAccessor#color: unknown material type",t.type)};if(Array.isArray(this.object.material)){const t=new Array,r=this.object.material;for(const i of r)t.push(e(i));return t}return e(this.object.material)}}t.BufferedGeometryAccessorBase=s;class c extends s{constructor(e,t,r,i){super(e,t,r),this.object=e,this.geometryType=t,this.bufferGeometry=r,this.stride=i}clear(){o.assert(this.checkSetUp(),"BufferedGeometryAccessor not setup");const e=this.position.array,t=this.start*this.itemSize,r=this.end*this.itemSize;for(let i=t;i<r;i++)e[i]=0;this.position.needsUpdate=!0}getVertices(){o.assert(this.checkSetUp(),"BufferedGeometryAccessor not setup");const e=this.start,t=this.end;return this.position.array.subarray(e*this.itemSize,t*this.itemSize)}checkSetUp(){return void 0!==this.position&&void 0!==this.start&&void 0!==this.end&&this.start>=0&&this.end<=this.position.count&&this.start<=this.end}}t.BufferedGeometryAccessor=c;t.BufferedGeometryLineAccessor=class extends c{constructor(e,t,r){super(e,t,r,3),this.object=e,this.geometryType=t,this.bufferGeometry=r}isLineAccessor(){return!0}get width(){o.assert(this.checkSetUp(),"RoBufferedGeometryLineAccessor not setup")}};t.BufferedGeometryObject3dAccessor=class extends c{constructor(e,t,r){super(e,t,r,1),this.object=e,this.geometryType=t,this.bufferGeometry=r}isObject3dAccessor(){return!0}getVertices(){return super.getVertices()}};class l extends s{constructor(e,t,r,i,n){super(e,t,r),this.object=e,this.geometryType=t,this.bufferGeometry=r,this.indices=this.bufferGeometry.index.array,this.indices?this.indices instanceof Uint32Array||(a.warn("IndexedBufferedGeometryAccessor#constructor: BufferGeometry index has wrong type"),o.assert(this.indices instanceof Uint32Array)):(a.warn("IndexedBufferedGeometryAccessor#constructor: BufferGeometry has no index"),o.assert(!!this.indices))}getCount(){return this.indices.length}checkSetUp(){return!!this.indices&&void 0!==this.start&&void 0!==this.end&&this.start>=0&&this.end<=this.indices.length&&this.start<=this.end}}t.IndexedBufferedGeometryAccessor=l;t.IndexedBufferedGeometryLineAccessor=class extends l{constructor(e,t,r){super(e,t,r,3),this.object=e,this.geometryType=t,this.bufferGeometry=r}isLineAccessor(){return!0}get width(){if(o.assert(this.checkSetUp(),"RoIndexedBufferedGeometryLineAccessor not setup"),this.geometryType===i.GeometryType.ExtrudedLine){const e=this.start+this.startCapSize,t=this.position.array;return n.reconstructLineWidth(t,e)}}clear(){o.assert(this.checkSetUp(),"RoIndexedBufferedGeometryLineAccessor not setup");const e=this.start,t=this.end;for(let r=e;r<t;r++)this.indices[r]=0;this.bufferGeometry.index.needsUpdate=!0}getVertices(){o.assert(this.checkSetUp(),"RoIndexedBufferedGeometryLineAccessor not setup");const e=this.itemSize,t=this.start,r=this.end,i=new Float32Array((r-t)*e),n=this.position.array;if(2===e)for(let o=t,a=0;o<r;o++,a+=e){const t=this.indices[o];i[a+0]=n[t*e+0],i[a+1]=n[t*e+1]}if(3===e)for(let o=t,a=0;o<r;o++,a+=e){const t=this.indices[o];i[a+0]=n[t*e+0],i[a+1]=n[t*e+1],i[a+2]=n[t*e+2]}else for(let o=t,a=0;o<r;o++,a++){const t=this.indices[o];for(let r=0;r<e;r++)i[a*e+r]=n[t*e+r]}return i}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=r(0),o=new n.Vector3,a=new n.Vector3,s=new n.Vector3,c=new n.Vector3,l=new n.Vector3,u=.1,d={attributes:[{name:"uv",itemSize:2,offset:13},{name:"normal",itemSize:3,offset:15}],stride:5},h={attributes:[{name:"extrusionCoord",itemSize:3,offset:0},{name:"position",itemSize:3,offset:3},{name:"tangent",itemSize:3,offset:6},{name:"bitangent",itemSize:4,offset:9}],stride:13},m={attributes:[...h.attributes,...d.attributes],stride:h.stride+d.stride},p={attributes:[{name:"extrusionCoord",itemSize:2,offset:0},{name:"position",itemSize:3,offset:2},{name:"positionLow",itemSize:3,offset:5},{name:"tangent",itemSize:3,offset:8},{name:"bitangent",itemSize:4,offset:11}],stride:15},f={attributes:[...p.attributes,...d.attributes],stride:p.stride+d.stride};class g{constructor(){this.vertices=[],this.vertexColors=[],this.indices=[]}}function y(e,t){return t?e?f:p:e?m:h}function v(e,t,r,n,d=new g,h=!1){if(0===t.length)return d;const m=y(void 0!==r,h).stride,p=t.length/3,f=new Array(p),v=new Array(t.length-3),_=d.vertices.length/m,b=void 0!==r&&r.length>0,S=void 0!==n&&n.length&&t.length;i.assert(!b||r.length/2===p),i.assert(!S||n.length===t.length);let T=u;f[0]=T;let E=!0;for(let e=0;e<p-1;++e){let r=0;for(let i=0;i<3;++i){const n=t[3*(e+1)+i]-t[3*e+i];v[3*e+i]=n,r+=n*n,E=2===i?E&&0===t[3*(e+1)+i]:E}T+=Math.sqrt(r),f[e+1]=T}const w=f[f.length-1];let C=!0;for(let e=0;e<3;++e)C=C&&t[e]===t[t.length-3+e];const x=[],O=(i,u,m,p,f)=>{x.length=0,d.vertices.push(p,-1*f,w),x.push(p,1*f,w);for(let e=0;e<3;++e){if(h){const r=Math.fround(t[3*i+e]),n=t[3*i+e]-r;d.vertices.push(r,n),x.push(r,n)}else d.vertices.push(t[3*i+e]),x.push(t[3*i+e]);a.setComponent(e,t[3*i+e])}for(let e=0;e<3;++e)s.setComponent(e,v[u+e]),c.setComponent(e,v[m+e]);s.normalize(),d.vertices.push(s.x,s.y,s.z),x.push(s.x,s.y,s.z);const g=function(e,t,r,i){let n=0;t.equals(r)||(n=Math.acos(t.dot(r))*Math.sign(e.dot(o.copy(t).cross(r))),Number.isNaN(n)&&(n=0));return i.copy(t).add(r).normalize().cross(e).normalize(),n}(E?a.set(0,0,1):a.add(e).normalize(),s,c.normalize(),l);d.vertices.push(l.x,l.y,l.z,g),x.push(l.x,l.y,l.z,g),b&&(d.vertices.push(r[2*i],r[2*i+1]),x.push(r[2*i],r[2*i+1]),d.vertices.push(a.x,a.y,a.z),x.push(a.x,a.y,a.z)),d.vertices.push(...x),S&&(d.vertexColors.push(n[3*i],n[3*i+1],n[3*i+2]),d.vertexColors.push(n[3*i],n[3*i+1],n[3*i+2]))};for(let e=0;e<p;++e){const t=C&&0===e?v.length-3:3*Math.max(0,e-1),r=C&&e===p-1?0:Math.min(3*e,v.length-3);e>0&&O(e,t,r,f[e-1],f[e]),e+1<p&&O(e,t,r,-1*f[Math.min(e,f.length-1)],f[Math.min(e+1,f.length-1)])}for(let e=0;e<p-1;++e){const t=_+4*e;d.indices.push(t,t+1,t+2,t+2,t+1,t+3)}return d}function _(e,t,r=new g){if(0===e.length)return r;const i=e.length/3;let n=r.vertices.length/3;const o=void 0!==t&&t.length&&e.length;for(let a=0;a<i;++a,n++){a>0&&r.indices.push(n),a<i-1&&r.indices.push(n);for(let i=0;i<3;++i)r.vertices.push(e[3*a+i]),o&&r.vertexColors.push(t[3*a+i])}return r}t.LineGeometry=g,t.createLineGeometry=v,t.createSimpleLineGeometry=_;class b{constructor(e=!1,t=!1,r=!1){this.hasNormalsAndUvs=e,this.highPrecision=t,this.isSimple=r,this.m_geometry=new g}static createGeometry(e,t,r,i,o=!1,a=!1,s=!1){if(s)return i.setAttribute("position",new n.BufferAttribute(new Float32Array(e),3)),t.length===e.length&&i.setAttribute("color",new n.BufferAttribute(new Float32Array(t),3)),i.setIndex(new n.BufferAttribute(new Uint32Array(r),1)),i;{const s=y(o,a),c=new n.InterleavedBuffer(new Float32Array(e),s.stride);return s.attributes.forEach(e=>{const t=new n.InterleavedBufferAttribute(c,e.itemSize,e.offset,!1);i.setAttribute(e.name,t)}),t.length===e.length&&i.setAttribute("color",new n.BufferAttribute(new Float32Array(t),3)),i.setIndex(new n.BufferAttribute(new Uint32Array(r),1)),i}}clear(){this.m_geometry.vertices=[],this.m_geometry.vertexColors=[],this.m_geometry.indices=[]}add(e,t,r,n){return this.isSimple?_(t,n,this.m_geometry):(i.assert(!this.hasNormalsAndUvs||void 0!==r),v(e,t,r,n,this.m_geometry,this.highPrecision)),this}get vertices(){return this.m_geometry.vertices}get vertexColors(){return this.m_geometry.vertexColors}get indices(){return this.m_geometry.indices}get vertexAttributes(){return y(this.hasNormalsAndUvs,this.highPrecision).attributes}get stride(){return y(this.hasNormalsAndUvs,this.highPrecision).stride}createGeometry(e){return void 0===e&&(e=new n.BufferGeometry),b.createGeometry(this.m_geometry.vertices,this.m_geometry.vertexColors,this.m_geometry.indices,e,this.hasNormalsAndUvs,this.highPrecision)}}t.LineGroup=b},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(9),n=r(0),o=r(99);class a extends n.Line{constructor(e,t,r,o,a){super(void 0===e?new n.BufferGeometry:e,t),void 0===t&&(t=new i.HighPrecisionLineMaterial({color:o||i.HighPrecisionLineMaterial.DEFAULT_COLOR,opacity:void 0!==a?a:i.HighPrecisionLineMaterial.DEFAULT_OPACITY})),this.matrixWorldInverse=new n.Matrix4,r&&this.setPositions(r)}get bufferGeometry(){return this.geometry}get shaderMaterial(){return this.material}setPositions(e){o.HighPrecisionUtils.setPositions(this,e)}setupForRendering(){this.onBeforeRender=(e,t,r,i,n,a)=>{o.HighPrecisionUtils.updateHpUniforms(this,r,this.shaderMaterial)}}updateMatrixWorld(e){const t=this.matrixWorldNeedsUpdate||e;super.updateMatrixWorld(e),t&&this.matrixWorldInverse.getInverse(this.matrixWorld)}}t.HighPrecisionWireFrameLine=a;class s extends n.Mesh{constructor(e,t,r,o,a){super(void 0===e?new n.BufferGeometry:e,t),void 0===t&&(t=new i.HighPrecisionLineMaterial({color:o||i.HighPrecisionLineMaterial.DEFAULT_COLOR,opacity:void 0!==a?a:i.HighPrecisionLineMaterial.DEFAULT_OPACITY})),this.matrixWorldInverse=new n.Matrix4,r&&this.setPositions(r)}get bufferGeometry(){return this.geometry}get shaderMaterial(){return this.material}setPositions(e){o.HighPrecisionUtils.setPositions(this,e)}setupForRendering(){this.onBeforeRender=(e,t,r,i,n,a)=>{o.HighPrecisionUtils.updateHpUniforms(this,r,this.shaderMaterial)}}updateMatrixWorld(e){const t=this.matrixWorldNeedsUpdate||e;super.updateMatrixWorld(e),t&&this.matrixWorldInverse.getInverse(this.matrixWorld)}}t.HighPrecisionLine=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(68);const i=r(2),n=r(83),o=r(1).LoggerManager.instance.create("TileLoader");class a{constructor(e,t,r,i,o){this.dataSource=e,this.tileKey=t,this.dataProvider=r,this.tileDecoder=i,this.priority=o,this.state=n.TileLoaderState.Initialized,this.loadAbortController=new AbortController,this.countRequests=0}loadAndDecode(){switch(this.state){case n.TileLoaderState.Loading:return this.countRequests++,this.donePromise;case n.TileLoaderState.Ready:case n.TileLoaderState.Failed:case n.TileLoaderState.Initialized:case n.TileLoaderState.Canceled:return this.countRequests++,this.ensureLoadingStarted(),this.donePromise;case n.TileLoaderState.Loaded:return this.countRequests++,this.startDecodeTile(),this.donePromise;case n.TileLoaderState.Decoding:return this.cancelDecoding(),this.ensureLoadingStarted(),this.donePromise}}waitSettled(){return this.donePromise?this.donePromise:Promise.resolve(this.state)}cancel(){if(0==--this.countRequests){switch(this.state){case n.TileLoaderState.Loading:this.loadAbortController.abort(),this.loadAbortController=new AbortController;break;case n.TileLoaderState.Decoding:this.requestController&&(this.requestController.abort(),this.requestController=void 0)}this.onDone(n.TileLoaderState.Canceled)}}get isFinished(){return this.state===n.TileLoaderState.Ready||this.state===n.TileLoaderState.Canceled||this.state===n.TileLoaderState.Failed}updatePriority(e){this.priority=e,void 0!==this.requestController&&(this.requestController.priority=e)}ensureLoadingStarted(){switch(this.state){case n.TileLoaderState.Ready:case n.TileLoaderState.Initialized:case n.TileLoaderState.Canceled:return void this.doStartLoad();case n.TileLoaderState.Loading:case n.TileLoaderState.Loaded:return void o.info("reusing already started load operation");case n.TileLoaderState.Decoding:return this.cancelDecoding(),void this.doStartLoad()}}doStartLoad(){const e=this.loadAbortController.signal;this.dataProvider.getTile(this.tileKey,e).then(t=>{if(e.aborted){const e=new Error("Aborted");throw e.name="AbortError",e}this.onLoaded(t)}).catch(e=>{"AbortError"!==e.name&&"AbortError: Aborted"!==e.message&&this.onError(e)}),void 0===this.donePromise&&(this.donePromise=new Promise((e,t)=>{this.resolveDonePromise=e,this.rejectedDonePromise=t})),this.state=n.TileLoaderState.Loading}onLoaded(e){this.state=n.TileLoaderState.Loaded,this.payload=e,(void 0===e.byteLength||0!==e.byteLength)&&e!=={}?this.startDecodeTile():this.onDone(n.TileLoaderState.Ready)}startDecodeTile(){const e=this.payload;if(void 0===e)return void o.error("TileLoader#startDecodeTile: Cannot decode without payload");this.state=n.TileLoaderState.Decoding,this.payload=void 0;const t=new i.RequestController(this.priority);this.requestController=t;const r=this.dataSource;this.tileDecoder.decodeTile(e,this.tileKey,r.projection,t).then(e=>{t.signal.aborted||this.onDecoded(e)}).catch(e=>{"AbortError"!==e.name&&"AbortError: Aborted"!==e.message&&this.onError(e)})}onDecoded(e){this.decodedTile=e,this.onDone(n.TileLoaderState.Ready)}cancelDecoding(){void 0!==this.requestController&&(this.requestController.abort(),this.requestController=void 0)}onDone(e){this.resolveDonePromise&&e===n.TileLoaderState.Ready?this.resolveDonePromise(e):this.rejectedDonePromise&&this.rejectedDonePromise(e),this.resolveDonePromise=void 0,this.rejectedDonePromise=void 0,this.donePromise=void 0,this.state=e}onError(e){if(this.state===n.TileLoaderState.Canceled)return;const t=this.dataSource;o.error(`[${t.name}]: failed to load tile ${this.tileKey.mortonCode()}`,e),this.error=e,this.onDone(n.TileLoaderState.Failed)}}t.TileLoader=a;t.TileInfoLoader=class extends a{startDecodeTile(){const e=this.payload;if(void 0===e)return void o.error("TileInfoLoader#startDecodeTile: Cannot decode without payload");this.state=n.TileLoaderState.Decoding,this.payload=void 0;const t=new i.RequestController(this.priority);this.requestController=t;const r=this.dataSource;this.tileDecoder.getTileInfo(e,this.tileKey,r.projection,t).then(e=>{t.signal.aborted||(this.tileInfo=e,this.onDone(n.TileLoaderState.Ready))}).catch(e=>{"AbortError"!==e.name&&"AbortError: Aborted"!==e.message&&this.onError(e)})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e){super(e),Object.setPrototypeOf(this,i.prototype)}}t.default=i,i.NO_CATALOG_CONNECTION="Data service catalog connection was not initialized",i.SCHEMA_DOWNLOAD_FAILURE="Failed to fetch catalog schema",i.DECODING_ERROR="There was an error while decoding the data"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e){super(i.NO_PARTITION_DATA.replace("%partitionId%",e.toString())),Object.setPrototypeOf(this,i.prototype)}}t.default=i,i.NO_PARTITION_DATA="There is no data in partition %partitionId%"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e){super(i.NO_PARTITION_DATA.replace("%partitionId%",e.toString())),Object.setPrototypeOf(this,i.prototype)}}t.default=i,i.NO_PARTITION_DATA="Partition %partitionId% is empty or contains expired data"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(44),n=r(145);function o(e){return new i.DataStoreClient(e)}t.commonSchemaProviderFactory=async function(e,t,r){let i;if(e&&Object.keys(e).length>1)throw new Error("It is allowed to set only one schema source.");if(e&&e.schemaArchive)i=new n.FileSchemaProvider(e.schemaArchive,r);else if(t&&e&&e.schemaHRN){const a=o(t);i=new n.HRNSchemaProvider(a,e.schemaHRN,r)}else if(t){const e=o(t),a=await e.getCatalogClient(t.catalogVersion);if(void 0===a)throw new Error("Cannot get CatalogClient instance.");const s=a.getLayer(t.layer);if(!s)throw new Error("Catalog layer is not defined. Schema provider was not created.");i=new n.CatalogSchemaProvider(s,r)}if(void 0===i)throw new Error("Schema source is not defined.");return await i.connect(),i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(190),o=r(21);class a extends i.EventDispatcher{constructor(e){super(),this.m_objects=new Array,this.m_intersectionFilters=new Map,this.m_intersectionSorters=new Map,this.m_selectionCounter=0,this.m_mapView=e,this.m_mouseMoveHandler=this.onMouseMove.bind(this),this.m_mouseOutHandler=this.onMouseOut.bind(this),e.canvas.addEventListener("mousemove",this.m_mouseMoveHandler),e.canvas.addEventListener("mouseout",this.m_mouseOutHandler),n.MapControlHandler.getInstance(e).addEventHandler("select",(t,r)=>this.onClick(e,t,r.ctrlKey))}raycastObjectsAtCoordinates(e,t){void 0!==this.m_raycastTimeout&&clearTimeout(this.m_raycastTimeout),this.m_raycastTimeout=window.setTimeout(()=>{const r=o.getCanvasCoordinates(this.m_mapView,e,t),i=this.raycastIntersections(r.x,r.y);i.length?this.dispatchEvent({type:a.EVENT_INTERSECTION_CHANGE,intersected:!0,intersection:i[0],mouseX:e,mouseY:t}):this.dispatchEvent({type:a.EVENT_INTERSECTION_CHANGE,intersected:!1,mouseX:e,mouseY:t})},a.DE_BOUNCE_DELAY)}raycastIntersections(e,t){return this.filterAndSortIntersections(this.raycastObjects(this.getRaycaster(e,t)))}getRaycaster(e=0,t=0){return this.m_mapView.raycasterFromScreenPoint(e,t)}setIntersectionFilter(e,t){this.m_intersectionFilters.set(e,t)}setIntersectionSort(e,t){this.m_intersectionSorters.set(e,t)}attachObjects(e,t=!0){void 0!==e&&(t?o.appendToArray(this.m_objects,e):this.m_objects=e)}detachObject(e){const t=this.m_objects.indexOf(e);t>=0&&this.m_objects.splice(t,1)}dispose(){this.m_mapView.canvas.removeEventListener("mousemove",this.m_mouseMoveHandler),this.m_mapView.canvas.removeEventListener("mouseout",this.m_mouseOutHandler)}onMouseMove(e){e.preventDefault(),this.raycastObjectsAtCoordinates(e.pageX,e.pageY)}onMouseOut(e){e.preventDefault(),void 0!==this.m_mouseOutTimeout&&clearTimeout(this.m_mouseOutTimeout),this.m_mouseOutTimeout=window.setTimeout(()=>{this.dispatchEvent({type:a.EVENT_MOUSE_OUT_OF_CANVAS,newTargetElement:e.target})},a.DE_BOUNCE_DELAY)}onClick(e,t,r){const i=e.getScreenPosition(t);if(void 0===i)return;this.m_lastSelectionPoint&&this.m_lastSelectionPoint.equals(i)?this.m_selectionCounter++:this.m_selectionCounter=0;const n=this.raycastIntersections(i.x,i.y),o=n[this.m_selectionCounter%n.length];n.length&&this.dispatchEvent({type:a.EVENT_OBJECT_SELECT,intersected:!0,intersection:o,ctrlKey:r,mouseX:i.x,mouseY:i.y}),this.m_lastSelectionPoint=i}filterAndSortIntersections(e){return this.m_intersectionFilters.forEach(t=>e=e.filter(t)),this.m_intersectionSorters.forEach(t=>e.sort(t)),e=e.filter((t,r)=>e.findIndex(e=>e.object===t.object)===r)}raycastObjects(e){const t=[],r=this.m_mapView.pixelToWorld,n=r/2,a=e.linePrecision;void 0===e.params.Points&&(e.params.Points={threshold:1});const s=e.params.Points.threshold;for(const c of this.m_objects){const l=c instanceof i.LineSegments&&c.material instanceof i.LineBasicMaterial&&c.material.userData&&c.material.userData.lineWidth?c.material.userData.lineWidthUnits===o.Units.meters?c.material.userData.lineWidth:c.material.userData.lineWidth*n:a;if(e.linePrecision=Math.max(l,r),c instanceof i.Points){const t=c.material instanceof i.ShaderMaterial&&c.material.uniforms.uSize&&c.material.uniforms.uSize.value||c.material instanceof i.PointsMaterial&&c.material.sizeAttenuation&&c.material.size/2||s;e.params.Points.threshold=t*r}const u=e.intersectObject(c,!0);for(const e of u)void 0!==e&&t.push(e)}return t.sort((e,t)=>e.distance-t.distance),e.linePrecision=a,e.params.Points.threshold=s,t}}t.InteractiveIntersectionAgent=a,a.EVENT_INTERSECTION_CHANGE="intersectionchange",a.EVENT_OBJECT_SELECT="objectselect",a.EVENT_MOUSE_OUT_OF_CANVAS="mouseoutofcanvas",a.DE_BOUNCE_DELAY=40},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(21);class o{constructor(e){this.mapView=e,this.m_touchState={touches:[]},this.m_buttonId=1,this.mouseDownClickEvent=void 0,this.touchEvent=void 0,this.eventHandlers=[],this.clickTimeout=0,this.contextMenuTimeout=0,this.contextMenu=e=>{if(void 0!==this.rmbClickEvent&&!this.mouseWasMoved(e,this.rmbClickEvent))return clearTimeout(this.contextMenuTimeout),this.rmbClickEvent=void 0,void this.dispatchMouseEvents("rmbdblclick",e);this.rmbClickEvent=e,this.contextMenuTimeout=window.setTimeout(this.dispatchMouseEvents.bind(this,"contextmenu",e),o.singleClickDelay)},this.dispatchMouseEvents=(e,t,r=!0)=>{const i=this.getGeoPosByEvent(t);null!==i&&this.eventHandlers.filter(t=>t.eventType===e).forEach(e=>{e.eventHandler(i,this.keyModifierPressed(t),t)}),!0===r&&this.mapView.update()},this.mouseClick=e=>{if(e.detail>1||this.mouseWasMoved(e,this.mouseDownClickEvent))return this.mouseDownClickEvent=void 0,void clearTimeout(this.clickTimeout);this.mouseDownClickEvent=void 0,this.clickTimeout=window.setTimeout(this.dispatchMouseEvents.bind(this,"select",e),o.singleClickDelay)},this.mouseWasMoved=(e,t)=>void 0!==t&&(t.pageX!==e.pageX||t.pageY!==e.pageY),this.mouseDoubleClick=e=>{clearTimeout(this.clickTimeout),this.dispatchMouseEvents("zoom",e)},this.mouseDown=e=>{e.buttons===this.m_buttonId&&(this.mouseDownClickEvent=e)},this.getGeoPosByEvent=e=>{const t=n.getRelativeScreenCoordinates(this.mapView,e.pageX,e.pageY,!1);return this.mapView.getGeoCoordinatesAt(t.x,t.y)},this.keyModifierPressed=e=>({altKey:e.altKey,ctrlKey:e.ctrlKey||e.metaKey,shiftKey:e.shiftKey}),this.mouseMoveHandler=e=>{this.mouseWasMoved(e,this.mouseDownClickEvent)?this.domElement.classList.add(o.MAP_MOVE_CLASS_NAME):this.domElement.classList.remove(o.MAP_MOVE_CLASS_NAME),this.dispatchMouseEvents("hover",e,!1)},this.touchStart=e=>{this.touchEvent=e,this.setTouchState(e.touches),this.domElement.addEventListener("touchend",this.touchEnd),this.domElement.addEventListener("touchmove",this.touchMove,!1)},this.touchMove=e=>{this.cleanupTouchEventListeners()},this.touchEnd=e=>{void 0!==this.touchEvent&&1===this.m_touchState.touches.length&&this.eventHandlers.forEach(t=>t.eventHandler(this.m_touchState.touches[0].currentGeoCoordinates,this.keyModifierPressed(e))),this.cleanupTouchEventListeners()},this.domElement=e.renderer.domElement,this.bindInputEvents()}static getInstance(e){const t=this.m_instances.get(e)||new o(e);return this.m_instances.has(e)||this.m_instances.set(e,t),t}addEventHandler(e,t){return this.eventHandlers.push({eventType:e,eventHandler:t}),this}dispose(){this.domElement.removeEventListener("touchstart",this.touchStart),this.domElement.removeEventListener("mousemove",this.mouseMoveHandler),this.domElement.removeEventListener("mousedown",this.mouseDown),this.domElement.removeEventListener("click",this.mouseClick),this.domElement.removeEventListener("dblclick",this.mouseDoubleClick),this.domElement.removeEventListener("contextmenu",this.contextMenu),o.m_instances=new Map}bindInputEvents(){this.domElement.addEventListener("touchstart",this.touchStart),this.domElement.addEventListener("mousemove",this.mouseMoveHandler),this.domElement.addEventListener("mousedown",this.mouseDown),this.domElement.addEventListener("click",this.mouseClick),this.domElement.addEventListener("dblclick",this.mouseDoubleClick),this.domElement.addEventListener("contextmenu",this.contextMenu)}convertTouchPoint(e){const t=new i.Vector2(e.pageX,e.pageY),r=n.getRelativeScreenCoordinates(this.mapView,t.x,t.y),o=this.mapView.getGeoCoordinatesAt(r.x,r.y);return o?{currentTouchPoint:t.clone(),currentGeoCoordinates:o.clone()}:null}setTouchState(e){this.m_touchState.touches=[];for(const t of Array.from(e)){const e=this.convertTouchPoint(t);e&&this.m_touchState.touches.push(e)}}cleanupTouchEventListeners(){this.domElement.removeEventListener("touchend",this.touchEnd),this.domElement.removeEventListener("touchmove",this.touchMove),this.touchEvent=void 0,this.m_touchState.touches=[]}}t.MapControlHandler=o,o.singleClickDelay=300,o.MAP_MOVE_CLASS_NAME="map-move",o.m_instances=new Map},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(70);class n extends i.SchemaProviderAbstract{constructor(e,t){super(t),this.m_catalogLayer=e,this.m_params=t}async fetchSchemaDetails(){const e=await this.m_catalogLayer.getSchemaDetails().catch(e=>{this.m_logger.info(e.message)});return e?e.schema:void 0}async getSchemaArchive(){return await this.m_catalogLayer.getSchema().catch(e=>{this.m_logger.info(e.message)})||void 0}}t.CatalogSchemaProvider=n},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){e.exports=r(391)},function(e,t,r){"use strict";(function(t,i){var n=r(72);e.exports=_;var o,a=r(192);_.ReadableState=v;r(100).EventEmitter;var s=function(e,t){return e.listeners(t).length},c=r(195),l=r(102).Buffer,u=t.Uint8Array||function(){};var d=r(50);d.inherits=r(37);var h=r(392),m=void 0;m=h&&h.debuglog?h.debuglog("stream"):function(){};var p,f=r(393),g=r(196);d.inherits(_,c);var y=["error","close","destroy","pause","resume"];function v(e,t){e=e||{};var i=t instanceof(o=o||r(26));this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,a=e.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:i&&(a||0===a)?a:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(p||(p=r(198).StringDecoder),this.decoder=new p(e.encoding),this.encoding=e.encoding)}function _(e){if(o=o||r(26),!(this instanceof _))return new _(e);this._readableState=new v(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),c.call(this)}function b(e,t,r,i,n){var o,a=e._readableState;null===t?(a.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,w(e)}(e,a)):(n||(o=function(e,t){var r;i=t,l.isBuffer(i)||i instanceof u||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));var i;return r}(a,t)),o?e.emit("error",o):a.objectMode||t&&t.length>0?("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),i?a.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):S(e,a,t,!0):a.ended?e.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!r?(t=a.decoder.write(t),a.objectMode||0!==t.length?S(e,a,t,!1):x(e,a)):S(e,a,t,!1))):i||(a.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(a)}function S(e,t,r,i){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&w(e)),x(e,t)}Object.defineProperty(_.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),_.prototype.destroy=g.destroy,_.prototype._undestroy=g.undestroy,_.prototype._destroy=function(e,t){this.push(null),t(e)},_.prototype.push=function(e,t){var r,i=this._readableState;return i.objectMode?r=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=l.from(e,t),t=""),r=!0),b(this,e,t,!1,r)},_.prototype.unshift=function(e){return b(this,e,null,!0,!1)},_.prototype.isPaused=function(){return!1===this._readableState.flowing},_.prototype.setEncoding=function(e){return p||(p=r(198).StringDecoder),this._readableState.decoder=new p(e),this._readableState.encoding=e,this};var T=8388608;function E(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=T?e=T:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function w(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(m("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?n.nextTick(C,e):C(e))}function C(e){m("emit readable"),e.emit("readable"),R(e)}function x(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(O,e,t))}function O(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(m("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function A(e){m("readable nexttick read 0"),e.read(0)}function P(e,t){t.reading||(m("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),R(e),t.flowing&&!t.reading&&e.read(0)}function R(e){var t=e._readableState;for(m("flow",t.flowing);t.flowing&&null!==e.read(););}function I(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var i;e<t.head.data.length?(i=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):i=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,i=1,n=r.data;e-=n.length;for(;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(a===o.length?n+=o:n+=o.slice(0,e),0===(e-=a)){a===o.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++i}return t.length-=i,n}(e,t):function(e,t){var r=l.allocUnsafe(e),i=t.head,n=1;i.data.copy(r),e-=i.data.length;for(;i=i.next;){var o=i.data,a=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,a),0===(e-=a)){a===o.length?(++n,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=o.slice(a));break}++n}return t.length-=n,r}(e,t);return i}(e,t.buffer,t.decoder),r);var r}function D(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,n.nextTick(L,t,e))}function L(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function M(e,t){for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1}_.prototype.read=function(e){m("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return m("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?D(this):w(this),null;if(0===(e=E(e,t))&&t.ended)return 0===t.length&&D(this),null;var i,n=t.needReadable;return m("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&m("length less than watermark",n=!0),t.ended||t.reading?m("reading or ended",n=!1):n&&(m("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=E(r,t))),null===(i=e>0?I(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&D(this)),null!==i&&this.emit("data",i),i},_.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},_.prototype.pipe=function(e,t){var r=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,m("pipe count=%d opts=%j",o.pipesCount,t);var c=(!t||!1!==t.end)&&e!==i.stdout&&e!==i.stderr?u:_;function l(t,i){m("onunpipe"),t===r&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,m("cleanup"),e.removeListener("close",y),e.removeListener("finish",v),e.removeListener("drain",d),e.removeListener("error",g),e.removeListener("unpipe",l),r.removeListener("end",u),r.removeListener("end",_),r.removeListener("data",f),h=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}function u(){m("onend"),e.end()}o.endEmitted?n.nextTick(c):r.once("end",c),e.on("unpipe",l);var d=function(e){return function(){var t=e._readableState;m("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,R(e))}}(r);e.on("drain",d);var h=!1;var p=!1;function f(t){m("ondata"),p=!1,!1!==e.write(t)||p||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==M(o.pipes,e))&&!h&&(m("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,p=!0),r.pause())}function g(t){m("onerror",t),_(),e.removeListener("error",g),0===s(e,"error")&&e.emit("error",t)}function y(){e.removeListener("finish",v),_()}function v(){m("onfinish"),e.removeListener("close",y),_()}function _(){m("unpipe"),r.unpipe(e)}return r.on("data",f),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?a(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",g),e.once("close",y),e.once("finish",v),e.emit("pipe",r),o.flowing||(m("pipe resume"),r.resume()),e},_.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var i=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<n;o++)i[o].emit("unpipe",this,r);return this}var a=M(t.pipes,e);return-1===a?this:(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)},_.prototype.on=function(e,t){var r=c.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&w(this):n.nextTick(A,this))}return r},_.prototype.addListener=_.prototype.on,_.prototype.resume=function(){var e=this._readableState;return e.flowing||(m("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(P,e,t))}(this,e)),this},_.prototype.pause=function(){return m("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(m("pause"),this._readableState.flowing=!1,this.emit("pause")),this},_.prototype.wrap=function(e){var t=this,r=this._readableState,i=!1;for(var n in e.on("end",(function(){if(m("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(n){(m("wrapped data"),r.decoder&&(n=r.decoder.write(n)),r.objectMode&&null==n)||(r.objectMode||n&&n.length)&&(t.push(n)||(i=!0,e.pause()))})),e)void 0===this[n]&&"function"==typeof e[n]&&(this[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n));for(var o=0;o<y.length;o++)e.on(y[o],this.emit.bind(this,y[o]));return this._read=function(t){m("wrapped _read",t),i&&(i=!1,e.resume())},this},Object.defineProperty(_.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),_._fromList=I}).call(this,r(23),r(71))},function(e,t,r){e.exports=r(100).EventEmitter},function(e,t,r){"use strict";var i=r(72);function n(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var r=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||i.nextTick(n,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(i.nextTick(n,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,r){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(n.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new o(n.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r(395),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(23))},function(e,t,r){"use strict";var i=r(397).Buffer,n=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===n||!n(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=l,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=u,this.end=d,t=3;break;default:return this.write=h,void(this.end=m)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function l(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function u(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function m(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},o.prototype.text=function(e,t){var r=function(e,t,r){var i=t.length-1;if(i<r)return 0;var n=a(t[i]);if(n>=0)return n>0&&(e.lastNeed=n-1),n;if(--i<r||-2===n)return 0;if((n=a(t[i]))>=0)return n>0&&(e.lastNeed=n-2),n;if(--i<r||-2===n)return 0;if((n=a(t[i]))>=0)return n>0&&(2===n?n=0:e.lastNeed=n-3),n;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var i=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,r){"use strict";e.exports=a;var i=r(26),n=r(50);function o(e,t){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),i(e);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function a(e){if(!(this instanceof a))return new a(e);i.call(this,e),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",s)}function s(){var e=this;"function"==typeof this._flush?this._flush((function(t,r){c(e,t,r)})):c(this,null,null)}function c(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}n.inherits=r(37),n.inherits(a,i),a.prototype.push=function(e,t){return this._transformState.needTransform=!1,i.prototype.push.call(this,e,t)},a.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},a.prototype._write=function(e,t,r){var i=this._transformState;if(i.writecb=r,i.writechunk=e,i.writeencoding=t,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},a.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},a.prototype._destroy=function(e,t){var r=this;i.prototype._destroy.call(this,e,(function(e){t(e),r.emit("close")}))}},function(e,t,r){"use strict";var i=r(6),n=r(22),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.encode=function(e){for(var t,r,n,a,s,c,l,u=[],d=0,h=e.length,m=h,p="string"!==i.getTypeOf(e);d<e.length;)m=h-d,p?(t=e[d++],r=d<h?e[d++]:0,n=d<h?e[d++]:0):(t=e.charCodeAt(d++),r=d<h?e.charCodeAt(d++):0,n=d<h?e.charCodeAt(d++):0),a=t>>2,s=(3&t)<<4|r>>4,c=m>1?(15&r)<<2|n>>6:64,l=m>2?63&n:64,u.push(o.charAt(a)+o.charAt(s)+o.charAt(c)+o.charAt(l));return u.join("")},t.decode=function(e){var t,r,i,a,s,c,l=0,u=0;if("data:"===e.substr(0,"data:".length))throw new Error("Invalid base64 input, it looks like a data url.");var d,h=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===o.charAt(64)&&h--,e.charAt(e.length-2)===o.charAt(64)&&h--,h%1!=0)throw new Error("Invalid base64 input, bad content length.");for(d=n.uint8array?new Uint8Array(0|h):new Array(0|h);l<e.length;)t=o.indexOf(e.charAt(l++))<<2|(a=o.indexOf(e.charAt(l++)))>>4,r=(15&a)<<4|(s=o.indexOf(e.charAt(l++)))>>2,i=(3&s)<<6|(c=o.indexOf(e.charAt(l++))),d[u++]=t,64!==s&&(d[u++]=r),64!==c&&(d[u++]=i);return d}},function(e,t,r){"use strict";(function(t){var i=r(6),n=r(406),o=r(11),a=r(200),s=r(22),c=r(51),l=null;if(s.nodestream)try{l=r(407)}catch(e){}function u(e,r){return new c.Promise((function(n,o){var s=[],c=e._internalType,l=e._outputType,u=e._mimeType;e.on("data",(function(e,t){s.push(e),r&&r(t)})).on("error",(function(e){s=[],o(e)})).on("end",(function(){try{var e=function(e,t,r){switch(e){case"blob":return i.newBlob(i.transformTo("arraybuffer",t),r);case"base64":return a.encode(t);default:return i.transformTo(e,t)}}(l,function(e,r){var i,n=0,o=null,a=0;for(i=0;i<r.length;i++)a+=r[i].length;switch(e){case"string":return r.join("");case"array":return Array.prototype.concat.apply([],r);case"uint8array":for(o=new Uint8Array(a),i=0;i<r.length;i++)o.set(r[i],n),n+=r[i].length;return o;case"nodebuffer":return t.concat(r);default:throw new Error("concat : unsupported type '"+e+"'")}}(c,s),u);n(e)}catch(e){o(e)}s=[]})).resume()}))}function d(e,t,r){var a=t;switch(t){case"blob":case"arraybuffer":a="uint8array";break;case"base64":a="string"}try{this._internalType=a,this._outputType=t,this._mimeType=r,i.checkSupport(a),this._worker=e.pipe(new n(a)),e.lock()}catch(e){this._worker=new o("error"),this._worker.error(e)}}d.prototype={accumulate:function(e){return u(this,e)},on:function(e,t){var r=this;return"data"===e?this._worker.on(e,(function(e){t.call(r,e.data,e.meta)})):this._worker.on(e,(function(){i.delay(t,arguments,r)})),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(i.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new l(this,{objectMode:"nodebuffer"!==this._outputType},e)}},e.exports=d}).call(this,r(36).Buffer)},function(e,t,r){"use strict";t.base64=!1,t.binary=!1,t.dir=!1,t.createFolders=!0,t.date=null,t.compression=null,t.compressionOptions=null,t.comment=null,t.unixPermissions=null,t.dosPermissions=null},function(e,t,r){"use strict";var i=r(6),n=r(11);function o(e){n.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=i.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}i.inherits(o,n),o.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=o},function(e,t,r){"use strict";var i=r(6),n=r(11);function o(e){n.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}i.inherits(o,n),o.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}n.prototype.processChunk.call(this,e)},e.exports=o},function(e,t,r){"use strict";var i=r(11),n=r(105);function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r(6).inherits(o,i),o.prototype.processChunk=function(e){this.streamInfo.crc32=n(e.data,this.streamInfo.crc32||0),this.push(e)},e.exports=o},function(e,t,r){"use strict";var i=r(11);t.STORE={magic:"\0\0",compressWorker:function(e){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},t.DEFLATE=r(410)},function(e,t,r){"use strict";e.exports=function(e,t,r,i){for(var n=65535&e|0,o=e>>>16&65535|0,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{o=o+(n=n+t[i++]|0)|0}while(--a);n%=65521,o%=65521}return n|o<<16|0}},function(e,t,r){"use strict";var i=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();e.exports=function(e,t,r,n){var o=i,a=n+r;e^=-1;for(var s=n;s<a;s++)e=e>>>8^o[255&(e^t[s])];return-1^e}},function(e,t,r){"use strict";var i=r(24),n=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var a=new i.Buf8(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function c(e,t){if(t<65534&&(e.subarray&&o||!e.subarray&&n))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var r="",a=0;a<t;a++)r+=String.fromCharCode(e[a]);return r}a[254]=a[254]=1,t.string2buf=function(e){var t,r,n,o,a,s=e.length,c=0;for(o=0;o<s;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(n=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(n-56320),o++),c+=r<128?1:r<2048?2:r<65536?3:4;for(t=new i.Buf8(c),a=0,o=0;a<c;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(n=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(n-56320),o++),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|63&r):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|63&r):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|63&r);return t},t.buf2binstring=function(e){return c(e,e.length)},t.binstring2buf=function(e){for(var t=new i.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},t.buf2string=function(e,t){var r,i,n,o,s=t||e.length,l=new Array(2*s);for(i=0,r=0;r<s;)if((n=e[r++])<128)l[i++]=n;else if((o=a[n])>4)l[i++]=65533,r+=o-1;else{for(n&=2===o?31:3===o?15:7;o>1&&r<s;)n=n<<6|63&e[r++],o--;o>1?l[i++]=65533:n<65536?l[i++]=n:(n-=65536,l[i++]=55296|n>>10&1023,l[i++]=56320|1023&n)}return c(l,i)},t.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0?t:0===r?t:r+a[e[r]]>t?r:t}},function(e,t,r){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t,r){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,r){"use strict";t.LOCAL_FILE_HEADER="PK",t.CENTRAL_FILE_HEADER="PK",t.CENTRAL_DIRECTORY_END="PK",t.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",t.ZIP64_CENTRAL_DIRECTORY_END="PK",t.DATA_DESCRIPTOR="PK\b"},function(e,t,r){"use strict";var i=r(6),n=r(22),o=r(214),a=r(424),s=r(425),c=r(216);e.exports=function(e){var t=i.getTypeOf(e);return i.checkSupport(t),"string"!==t||n.uint8array?"nodebuffer"===t?new s(e):n.uint8array?new c(i.transformTo("uint8array",e)):new o(i.transformTo("array",e)):new a(e)}},function(e,t,r){"use strict";var i=r(215);function n(e){i.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}r(6).inherits(n,i),n.prototype.byteAt=function(e){return this.data[this.zero+e]},n.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),i=e.charCodeAt(2),n=e.charCodeAt(3),o=this.length-4;o>=0;--o)if(this.data[o]===t&&this.data[o+1]===r&&this.data[o+2]===i&&this.data[o+3]===n)return o-this.zero;return-1},n.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),i=e.charCodeAt(2),n=e.charCodeAt(3),o=this.readData(4);return t===o[0]&&r===o[1]&&i===o[2]&&n===o[3]},n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=n},function(e,t,r){"use strict";var i=r(6);function n(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return i.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readAndCheckSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},e.exports=n},function(e,t,r){"use strict";var i=r(214);function n(e){i.call(this,e)}r(6).inherits(n,i),n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=n},function(e,t,r){"use strict";var i=t;function n(){i.Reader._configure(i.BufferReader),i.util._configure()}i.build="minimal",i.Writer=r(107),i.BufferWriter=r(436),i.Reader=r(108),i.BufferReader=r(437),i.util=r(16),i.rpc=r(220),i.roots=r(221),i.configure=n,i.Writer._configure(i.BufferWriter),n()},function(e,t,r){"use strict";e.exports=function(e,t){var r=new Array(arguments.length-1),i=0,n=2,o=!0;for(;n<arguments.length;)r[i++]=arguments[n++];return new Promise((function(n,a){r[i]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];n.apply(null,t)}};try{e.apply(t||null,r)}catch(e){o&&(o=!1,a(e))}}))}},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},function(e,t,r){"use strict";t.Service=r(438)},function(e,t,r){"use strict";e.exports={}},function(e,t,r){"use strict";e.exports=function(e){for(var t,r=o.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),s=e.fieldsArray.slice().sort(o.compareFieldsById),c=0;c<s.length;++c){var l=s[c].resolve(),u=e._fieldsArray.indexOf(l),d=l.resolvedType instanceof i?"int32":l.type,h=n.basic[d];t="m"+o.safeProp(l.name),l.map?(r("if(%s!=null&&m.hasOwnProperty(%j)){",t,l.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",t)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(l.id<<3|2)>>>0,8|n.mapKey[l.keyType],l.keyType),void 0===h?r("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",u,t):r(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|h,d,t),r("}")("}")):l.repeated?(r("if(%s!=null&&%s.length){",t,t),l.packed&&void 0!==n.packed[d]?r("w.uint32(%i).fork()",(l.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",t)("w.%s(%s[i])",d,t)("w.ldelim()"):(r("for(var i=0;i<%s.length;++i)",t),void 0===h?a(r,l,u,t+"[i]"):r("w.uint32(%i).%s(%s[i])",(l.id<<3|h)>>>0,d,t)),r("}")):(l.optional&&r("if(%s!=null&&m.hasOwnProperty(%j))",t,l.name),void 0===h?a(r,l,u,t):r("w.uint32(%i).%s(%s)",(l.id<<3|h)>>>0,d,t))}return r("return w")};var i=r(14),n=r(39),o=r(7);function a(e,t,r,i){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",r,i,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",r,i,(t.id<<3|2)>>>0)}},function(e,t,r){"use strict";e.exports=function(e){var t=o.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter((function(e){return e.map})).length?",k":""))("while(r.pos<c){")("var t=r.uint32()");e.group&&t("if((t&7)===4)")("break");t("switch(t>>>3){");for(var r=0;r<e.fieldsArray.length;++r){var s=e._fieldsArray[r].resolve(),c=s.resolvedType instanceof i?"int32":s.type,l="m"+o.safeProp(s.name);t("case %i:",s.id),s.map?(t("r.skip().pos++")("if(%s===util.emptyObject)",l)("%s={}",l)("k=r.%s()",s.keyType)("r.pos++"),void 0!==n.long[s.keyType]?void 0===n.basic[c]?t('%s[typeof k==="object"?util.longToHash(k):k]=types[%i].decode(r,r.uint32())',l,r):t('%s[typeof k==="object"?util.longToHash(k):k]=r.%s()',l,c):void 0===n.basic[c]?t("%s[k]=types[%i].decode(r,r.uint32())",l,r):t("%s[k]=r.%s()",l,c)):s.repeated?(t("if(!(%s&&%s.length))",l,l)("%s=[]",l),void 0!==n.packed[c]&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",l,c)("}else"),void 0===n.basic[c]?t(s.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",l,r):t("%s.push(r.%s())",l,c)):void 0===n.basic[c]?t(s.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",l,r):t("%s=r.%s()",l,c),t("break")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),r=0;r<e._fieldsArray.length;++r){var u=e._fieldsArray[r];u.required&&t("if(!m.hasOwnProperty(%j))",u.name)("throw util.ProtocolError(%j,{instance:m})",a(u))}return t("return m")};var i=r(14),n=r(39),o=r(7);function a(e){return"missing required '"+e.name+"'"}},function(e,t,r){"use strict";e.exports=function(e){var t=n.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),r=e.oneofsArray,i={};r.length&&t("var p={}");for(var c=0;c<e.fieldsArray.length;++c){var l=e._fieldsArray[c].resolve(),u="m"+n.safeProp(l.name);if(l.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",u,l.name),l.map)t("if(!util.isObject(%s))",u)("return%j",o(l,"object"))("var k=Object.keys(%s)",u)("for(var i=0;i<k.length;++i){"),s(t,l,"k[i]"),a(t,l,c,u+"[k[i]]")("}");else if(l.repeated)t("if(!Array.isArray(%s))",u)("return%j",o(l,"array"))("for(var i=0;i<%s.length;++i){",u),a(t,l,c,u+"[i]")("}");else{if(l.partOf){var d=n.safeProp(l.partOf.name);1===i[l.partOf.name]&&t("if(p%s===1)",d)("return%j",l.partOf.name+": multiple values"),i[l.partOf.name]=1,t("p%s=1",d)}a(t,l,c,u)}l.optional&&t("}")}return t("return null")};var i=r(14),n=r(7);function o(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function a(e,t,r,n){if(t.resolvedType)if(t.resolvedType instanceof i){e("switch(%s){",n)("default:")("return%j",o(t,"enum value"));for(var a=Object.keys(t.resolvedType.values),s=0;s<a.length;++s)e("case %i:",t.resolvedType.values[a[s]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",r,n)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",n)("return%j",o(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",n,n,n,n)("return%j",o(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',n)("return%j",o(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',n)("return%j",o(t,"boolean"));break;case"string":e("if(!util.isString(%s))",n)("return%j",o(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',n,n,n)("return%j",o(t,"buffer"))}return e}function s(e,t,r){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",r)("return%j",o(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",r)("return%j",o(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",r)("return%j",o(t,"boolean key"))}return e}},function(e,t,r){"use strict";var i=t,n=r(14),o=r(7);function a(e,t,r,i){if(t.resolvedType)if(t.resolvedType instanceof n){e("switch(d%s){",i);for(var o=t.resolvedType.values,a=Object.keys(o),s=0;s<a.length;++s)t.repeated&&o[a[s]]===t.typeDefault&&e("default:"),e("case%j:",a[s])("case %i:",o[a[s]])("m%s=%j",i,o[a[s]])("break");e("}")}else e('if(typeof d%s!=="object")',i)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",i,r,i);else{var c=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",i,i);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",i,i);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",i,i);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",i,i,c)('else if(typeof d%s==="string")',i)("m%s=parseInt(d%s,10)",i,i)('else if(typeof d%s==="number")',i)("m%s=d%s",i,i)('else if(typeof d%s==="object")',i)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",i,i,i,c?"true":"");break;case"bytes":e('if(typeof d%s==="string")',i)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",i,i,i)("else if(d%s.length)",i)("m%s=d%s",i,i);break;case"string":e("m%s=String(d%s)",i,i);break;case"bool":e("m%s=Boolean(d%s)",i,i)}}return e}function s(e,t,r,i){if(t.resolvedType)t.resolvedType instanceof n?e("d%s=o.enums===String?types[%i].values[m%s]:m%s",i,r,i,i):e("d%s=types[%i].toObject(m%s,o)",i,r,i);else{var o=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",i,i,i,i);break;case"uint64":o=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',i)("d%s=o.longs===String?String(m%s):m%s",i,i,i)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",i,i,i,i,o?"true":"",i);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",i,i,i,i,i);break;default:e("d%s=m%s",i,i)}}return e}i.fromObject=function(e){var t=e.fieldsArray,r=o.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return r("return new this.ctor");r("var m=new this.ctor");for(var i=0;i<t.length;++i){var s=t[i].resolve(),c=o.safeProp(s.name);s.map?(r("if(d%s){",c)('if(typeof d%s!=="object")',c)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",c)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",c),a(r,s,i,c+"[ks[i]]")("}")("}")):s.repeated?(r("if(d%s){",c)("if(!Array.isArray(d%s))",c)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",c)("for(var i=0;i<d%s.length;++i){",c),a(r,s,i,c+"[i]")("}")("}")):(s.resolvedType instanceof n||r("if(d%s!=null){",c),a(r,s,i,c),s.resolvedType instanceof n||r("}"))}return r("return m")},i.toObject=function(e){var t=e.fieldsArray.slice().sort(o.compareFieldsById);if(!t.length)return o.codegen()("return {}");for(var r=o.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),i=[],a=[],c=[],l=0;l<t.length;++l)t[l].partOf||(t[l].resolve().repeated?i:t[l].map?a:c).push(t[l]);if(i.length){for(r("if(o.arrays||o.defaults){"),l=0;l<i.length;++l)r("d%s=[]",o.safeProp(i[l].name));r("}")}if(a.length){for(r("if(o.objects||o.defaults){"),l=0;l<a.length;++l)r("d%s={}",o.safeProp(a[l].name));r("}")}if(c.length){for(r("if(o.defaults){"),l=0;l<c.length;++l){var u=c[l],d=o.safeProp(u.name);if(u.resolvedType instanceof n)r("d%s=o.enums===String?%j:%j",d,u.resolvedType.valuesById[u.typeDefault],u.typeDefault);else if(u.long)r("if(util.Long){")("var n=new util.Long(%i,%i,%j)",u.typeDefault.low,u.typeDefault.high,u.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",d)("}else")("d%s=o.longs===String?%j:%i",d,u.typeDefault.toString(),u.typeDefault.toNumber());else if(u.bytes){var h="["+Array.prototype.slice.call(u.typeDefault).join(",")+"]";r("if(o.bytes===String)d%s=%j",d,String.fromCharCode.apply(String,u.typeDefault))("else{")("d%s=%s",d,h)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",d,d)("}")}else r("d%s=%j",d,u.typeDefault)}r("}")}var m=!1;for(l=0;l<t.length;++l){u=t[l];var p=e._fieldsArray.indexOf(u);d=o.safeProp(u.name);u.map?(m||(m=!0,r("var ks2")),r("if(m%s&&(ks2=Object.keys(m%s)).length){",d,d)("d%s={}",d)("for(var j=0;j<ks2.length;++j){"),s(r,u,p,d+"[ks2[j]]")("}")):u.repeated?(r("if(m%s&&m%s.length){",d,d)("d%s=[]",d)("for(var j=0;j<m%s.length;++j){",d),s(r,u,p,d+"[j]")("}")):(r("if(m%s!=null&&m.hasOwnProperty(%j)){",d,u.name),s(r,u,p,d),u.partOf&&r("if(o.oneofs)")("d%s=%j",o.safeProp(u.partOf.name),u.name)),r("}")}return r("return d")}},function(e,t,r){"use strict";var i=t,n=r(113);i[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=this.lookup(e["@type"]);if(t){var r="."===e["@type"].charAt(0)?e["@type"].substr(1):e["@type"];return this.create({type_url:"/"+r,value:t.encode(t.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){if(t&&t.json&&e.type_url&&e.value){var r=e.type_url.substring(e.type_url.lastIndexOf("/")+1),i=this.lookup(r);i&&(e=i.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof n){var o=e.$type.toObject(e,t);return o["@type"]=e.$type.fullName,o}return this.toObject(e,t)}}},function(e,t,r){"use strict";e.exports=m;var i=/[\s{}=;:[\],'"()<>]/g,n=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,o=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,a=/^ *[*/]+ */,s=/^\s*\*?\/*/,c=/\n/g,l=/\s/,u=/\\(.?)/g,d={0:"\0",r:"\r",n:"\n",t:"\t"};function h(e){return e.replace(u,(function(e,t){switch(t){case"\\":case"":return t;default:return d[t]||""}}))}function m(e,t){e=e.toString();var r=0,u=e.length,d=1,m=null,p=null,f=0,g=!1,y=[],v=null;function _(e){return Error("illegal "+e+" (line "+d+")")}function b(t){return e.charAt(t)}function S(r,i){m=e.charAt(r++),f=d,g=!1;var n,o=r-(t?2:3);do{if(--o<0||"\n"===(n=e.charAt(o))){g=!0;break}}while(" "===n||"\t"===n);for(var l=e.substring(r,i).split(c),u=0;u<l.length;++u)l[u]=l[u].replace(t?s:a,"").trim();p=l.join("\n").trim()}function T(t){var r=E(t),i=e.substring(t,r);return/^\s*\/{1,2}/.test(i)}function E(e){for(var t=e;t<u&&"\n"!==b(t);)t++;return t}function w(){if(y.length>0)return y.shift();if(v)return function(){var t="'"===v?o:n;t.lastIndex=r-1;var i=t.exec(e);if(!i)throw _("string");return r=t.lastIndex,C(v),v=null,h(i[1])}();var a,s,c,m,p;do{if(r===u)return null;for(a=!1;l.test(c=b(r));)if("\n"===c&&++d,++r===u)return null;if("/"===b(r)){if(++r===u)throw _("comment");if("/"===b(r))if(t){if(m=r,p=!1,T(r)){p=!0;do{if((r=E(r))===u)break;r++}while(T(r))}else r=Math.min(u,E(r)+1);p&&S(m,r),d++,a=!0}else{for(p="/"===b(m=r+1);"\n"!==b(++r);)if(r===u)return null;++r,p&&S(m,r-1),++d,a=!0}else{if("*"!==(c=b(r)))return"/";m=r+1,p=t||"*"===b(m);do{if("\n"===c&&++d,++r===u)throw _("comment");s=c,c=b(r)}while("*"!==s||"/"!==c);++r,p&&S(m,r-2),a=!0}}}while(a);var f=r;if(i.lastIndex=0,!i.test(b(f++)))for(;f<u&&!i.test(b(f));)++f;var g=e.substring(r,r=f);return'"'!==g&&"'"!==g||(v=g),g}function C(e){y.push(e)}function x(){if(!y.length){var e=w();if(null===e)return null;C(e)}return y[0]}return Object.defineProperty({next:w,peek:x,push:C,skip:function(e,t){var r=x();if(r===e)return w(),!0;if(!t)throw _("token '"+r+"', '"+e+"' expected");return!1},cmnt:function(e){var r=null;return void 0===e?f===d-1&&(t||"*"===m||g)&&(r=p):(f<e&&x(),f!==e||g||!t&&"/"!==m||(r=p)),r}},"line",{get:function(){return d}})}m.unescape=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(83),n=r(63);class o extends i.Tile{constructor(){super(...arguments),this.objects=[]}set decodedTile(e){this.m_decodedInteractiveTile=e,e&&(this.partitionData=e.partitionData,this.dataSize=e.dataSize,this.createGeometries(e))}get decodedTile(){return this.m_decodedInteractiveTile}get jsonData(){if(void 0===this.m_jsonData&&void 0!==this.decodedTile){const e=this.decodedTile;this.m_jsonData=e.jsonData&&e.jsonData.$type?e.jsonData.$type.toObject(e.jsonData,{defaults:!0,enums:String,bytes:String,json:!0}):e.jsonData}return this.m_jsonData}set jsonData(e){this.m_jsonData=e}copyObjectFromTile(e){const t=e.tileKey.mortonCode();e.objects.forEach(r=>{const i=this.center.clone();i.sub(e.center),i.multiplyScalar(-1),r.displacement=i,this.objects.push(r),r.tileKeyCode=t})}createGeometries(e){n.TileGeometryCreator.instance.createObjects(this,e)}}t.InteractiveTile=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(4),n=r(228),o=r(0);class a extends n.InteractiveTile{createGeometries(e){super.createGeometries(e);const t=this.objects.find(e=>e.userData.geometryId===`${this.tileKey.mortonCode()}-grid`);void 0!==t&&(t.onBeforeRender=this.onBeforeCoverageRender.bind(this));const r=this.objects.find(e=>e.userData.geometryId===`${this.tileKey.mortonCode()}-fill`);void 0!==r&&(r.onBeforeRender=this.onBeforeCoverageRender.bind(this))}onBeforeCoverageRender(e,t,r,n,s,c){const l=this.dataSource,u=s,d=i.TileKey.fromMortonCode(l.highlightedTile||0);if(u.uniforms.uHighlightedTile.value=new o.Vector3(d.row,d.column,d.level),u.uniforms.uSelectedTiles){const e=[];l.tilesToRender.forEach(t=>{const r=i.TileKey.fromMortonCode(t);e.push(r.row,r.column,r.level)}),u.uniforms.uSelectedTiles.value=e.concat(new Array(3*a.MAX_TILES_PER_GRID-e.length).fill(0))}if(u.uniforms.uLastSelectedTile){const e=i.TileKey.fromMortonCode(l.lastSelectedTile||0);u.uniforms.uLastSelectedTile.value=new o.Vector3(e.row,e.column,e.level)}const h=i.TileKey.fromMortonCode(l.decodedTileMortonCode||0);u.uniforms.uDecodedTile.value=new o.Vector3(h.row,h.column,h.level)}}t.CoverageTile=a,a.MAX_TILES_PER_GRID=256},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(12),n=r(0),o=r(75),a=4096;var s;!function(e){e[e.Unknown=0]="Unknown",e[e.Point=1]="Point",e[e.LineString=2]="LineString",e[e.Polygon=3]="Polygon"}(s||(s={})),t.VTJsonDataAdapterId="vt-json";t.VTJsonDataAdapter=class{constructor(e,r,i){this.m_processor=e,this.m_dataFilter=r,this.m_logger=i,this.id=t.VTJsonDataAdapterId}get dataFilter(){return this.m_dataFilter}set dataFilter(e){this.m_dataFilter=e}canProcess(e){if(o.isArrayBufferLike(e))return!1;const t=e;return void 0!==t.features&&void 0!==t.source&&void 0!==t.x&&void 0!==t.y&&void 0!==t.z}process(e,t,r){for(const r of e.features){const o=new i.MapEnv(Object.assign({$layer:e.layer,$geometryType:this.convertGeometryType(r.type),$level:t.level,$zoom:Math.max(0,t.level-(this.m_processor.storageLevelOffset||0)),$id:r.id},r.tags));switch(r.type){case s.Point:for(const i of r.geometry){const r=i[0],s=i[1],c=new n.Vector2(r,s);this.m_processor.processPointFeature(e.layer,a,[c],o,t.level)}break;case s.LineString:for(const i of r.geometry){const r={positions:[]};for(const[e,t]of i){const i=new n.Vector2(e,t);r.positions.push(i)}this.m_processor.processLineFeature(e.layer,a,[r],o,t.level)}break;case s.Polygon:{const i={rings:[]};for(const e of r.geometry){const t=[];for(const[r,i]of e){const e=new n.Vector2(r,i);t.push(e)}i.rings.push(t)}this.m_processor.processPolygonFeature(e.layer,a,[i],o,t.level);break}case s.Unknown:}}}convertGeometryType(e){switch(e){case s.Point:return"point";case s.LineString:return"line";case s.Polygon:return"polygon";default:return"unknown"}}}},function(e,t,r){"use strict";e.exports=r(217)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(117);t.OmvFeatureFilterDescriptionBuilder=class{constructor(e){this.m_processLayersDefault=!0,this.m_processPointsDefault=!0,this.m_processLinesDefault=!0,this.m_processPolygonsDefault=!0,this.m_layersToProcess=new Array,this.m_layersToIgnore=new Array,this.m_pointsToProcess=new Array,this.m_ignoredPoints=new Array,this.m_linesToProcess=new Array,this.m_linesToIgnore=new Array,this.m_polygonsToProcess=new Array,this.m_polygonsToIgnore=new Array,this.m_kindsToProcess=[],this.m_kindsToIgnore=[],e&&(this.m_processLayersDefault=void 0===e.processLayersDefault||e.processLayersDefault,this.m_processPointsDefault=void 0===e.processPointsDefault||e.processPointsDefault,this.m_processLinesDefault=void 0===e.processLinesDefault||e.processLinesDefault,this.m_processPolygonsDefault=void 0===e.processPolygonsDefault||e.processPolygonsDefault)}processLayer(e,t=n.OmvFilterString.StringMatch.Match,r=0,i=1/0){this.m_layersToProcess.push({name:{value:e,match:t},minLevel:r,maxLevel:i})}ignoreLayer(e,t=n.OmvFilterString.StringMatch.Match,r=0,i=1/0){this.m_layersToIgnore.push({name:{value:e,match:t},minLevel:r,maxLevel:i})}processPoint(e){this.addItem(this.m_pointsToProcess,e)}processPoints(e){this.addItems(this.m_pointsToProcess,e)}ignorePoint(e){this.addItem(this.m_ignoredPoints,e)}ignorePoints(e){this.addItems(this.m_ignoredPoints,e)}processLine(e){this.addItem(this.m_linesToProcess,e)}processLines(e){this.addItems(this.m_linesToProcess,e)}ignoreLine(e){this.addItem(this.m_linesToIgnore,e)}ignoreLines(e){this.addItems(this.m_linesToIgnore,e)}processPolygon(e){this.addItem(this.m_polygonsToProcess,e)}processPolygons(e){this.addItems(this.m_polygonsToProcess,e)}ignorePolygon(e){this.addItem(this.m_polygonsToIgnore,e)}ignorePolygons(e){this.addItems(this.m_polygonsToIgnore,e)}processKinds(e){this.m_kindsToProcess=this.m_kindsToProcess.concat(e)}ignoreKinds(e){this.m_kindsToIgnore=this.m_kindsToIgnore.concat(e)}createDescription(){return{processLayersDefault:this.m_processLayersDefault,processPointsDefault:this.m_processPointsDefault,processLinesDefault:this.m_processLinesDefault,processPolygonsDefault:this.m_processPolygonsDefault,layersToProcess:this.m_layersToProcess,layersToIgnore:this.m_layersToIgnore,pointsToProcess:this.m_pointsToProcess,pointsToIgnore:this.m_ignoredPoints,linesToProcess:this.m_linesToProcess,linesToIgnore:this.m_linesToIgnore,polygonsToProcess:this.m_polygonsToProcess,polygonsToIgnore:this.m_polygonsToIgnore,kindsToProcess:this.m_kindsToProcess,kindsToIgnore:this.m_kindsToIgnore}}addItem(e,t){(void 0===t.minLevel||isNaN(t.minLevel))&&(t.minLevel=0),(void 0===t.maxLevel||isNaN(t.maxLevel))&&(t.maxLevel=1/0);const r={layerName:{value:t.layer,match:void 0===t.matchLayer?n.OmvFilterString.StringMatch.Match:t.matchLayer},geometryTypes:void 0!==t.geomType?Array.isArray(t.geomType)?t.geomType:[t.geomType]:void 0,classes:[{value:t.featureClass,match:void 0===t.matchClass?n.OmvFilterString.StringMatch.Match:t.matchClass}],minLevel:t.minLevel,maxLevel:t.maxLevel,featureAttribute:t.featureAttribute};e.push(r)}addItems(e,t){(void 0===t.minLevel||isNaN(t.minLevel))&&(t.minLevel=0),(void 0===t.maxLevel||isNaN(t.maxLevel))&&(t.maxLevel=1/0);const r={layerName:{value:t.layer,match:void 0===t.matchLayer?n.OmvFilterString.StringMatch.Match:t.matchLayer},geometryTypes:void 0!==t.geomTypes?Array.isArray(t.geomTypes)?t.geomTypes:[t.geomTypes]:void 0,classes:t.featureClasses,minLevel:t.minLevel,maxLevel:t.maxLevel,featureAttribute:t.featureAttribute};e.push(r)}};class o{constructor(e){this.description=e,this.description.kindsToProcess.length>0&&(this.enabledKinds=new i.GeometryKindSet(this.description.kindsToProcess)),this.description.kindsToIgnore.length>0&&(this.disabledKinds=new i.GeometryKindSet(this.description.kindsToIgnore))}static matchLayer(e,t,r){for(const i of t)if(!(r<i.minLevel||r>i.maxLevel)&&n.OmvFilterString.matchString(e,i.name))return!0;return!1}wantsLayer(e,t){return!!o.matchLayer(e,this.description.layersToProcess,t)||!o.matchLayer(e,this.description.layersToIgnore,t)&&this.description.processLayersDefault}wantsPointFeature(e,t,r){return this.wantsFeature(this.description.pointsToProcess,this.description.pointsToIgnore,e,t,r,this.description.processPointsDefault)}wantsLineFeature(e,t,r){return this.wantsFeature(this.description.linesToProcess,this.description.linesToIgnore,e,t,r,this.description.processLinesDefault)}wantsPolygonFeature(e,t,r){return this.wantsFeature(this.description.polygonsToProcess,this.description.polygonsToIgnore,e,t,r,this.description.processPolygonsDefault)}wantsKind(e){return void 0===e||(!(void 0!==this.disabledKinds&&this.disabledKinds.hasOrIntersects(e))||void 0!==this.enabledKinds&&this.enabledKinds.hasOrIntersects(e))}get hasKindFilter(){return void 0!==this.enabledKinds||void 0!==this.disabledKinds}wantsFeature(e,t,r,i,o,a){for(const t of e)if(!(o<t.minLevel||o>t.maxLevel)&&n.OmvFilterString.matchString(r,t.layerName)&&void 0!==t.geometryTypes&&t.geometryTypes.indexOf(i)>=0)return!0;for(const e of t)if(n.OmvFilterString.matchString(r,e.layerName)&&void 0!==e.geometryTypes&&e.geometryTypes.indexOf(i)>=0)return!1;return a}}t.OmvGenericFeatureFilter=o;t.ComposedDataFilter=class{constructor(e){this.filters=e}get hasKindFilter(){return this.filters.reduce((e,t)=>e&&t.hasKindFilter,!0)}wantsLayer(e,t){return this.filters.reduce((r,i)=>r&&i.wantsLayer(e,t),!0)}wantsPointFeature(e,t,r){return this.filters.reduce((i,n)=>i&&n.wantsPointFeature(e,t,r),!0)}wantsLineFeature(e,t,r){return this.filters.reduce((i,n)=>i&&n.wantsLineFeature(e,t,r),!0)}wantsPolygonFeature(e,t,r){return this.filters.reduce((i,n)=>i&&n.wantsPolygonFeature(e,t,r),!0)}wantsKind(e){return this.filters.reduce((t,r)=>t&&r.wantsKind(e),!0)}};class a{constructor(e){this.description=e}static matchItems(e,t,r){for(const i of r)if(void 0!==i.classes){if(!n.OmvFilterString.matchString(e,i.layerName))continue;for(const e of i.classes)if(n.OmvFilterString.matchString(t,e))return!0}return!1}static matchAttribute(e,t,r){for(const i of r)if(void 0!==i.featureAttribute&&n.OmvFilterString.matchString(e,i.layerName)&&t.lookup(i.featureAttribute.key)===i.featureAttribute.value)return!0;return!1}doProcessPointFeature(e,t){return this.doProcessFeature(this.description.pointsToProcess,this.description.pointsToIgnore,e,t,this.description.processPointsDefault)}doProcessLineFeature(e,t){return this.doProcessFeature(this.description.linesToProcess,this.description.linesToIgnore,e,t,this.description.processLinesDefault)}doProcessPolygonFeature(e,t){return this.doProcessFeature(this.description.polygonsToProcess,this.description.polygonsToIgnore,e,t,this.description.processPolygonsDefault)}doProcessFeature(e,t,r,i,n){if(void 0===r||0===e.length&&0===t.length)return n;let o;const s=i.lookup("class");return null!=s&&(o=s.toString()),!(!o||!a.matchItems(r,o,e))||(!o||!a.matchItems(r,o,t))&&(!!a.matchAttribute(r,i,e)||!a.matchAttribute(r,i,t)&&n)}}t.OmvGenericFeatureModifier=a},function(e,t,r){"use strict";function i(e,t,r){r=r||2;var i,s,c,l,u,m,p,g=t&&t.length,y=g?t[0]*r:e.length,v=n(e,0,y,r,!0),_=[];if(!v||v.next===v.prev)return _;if(g&&(v=function(e,t,r,i){var a,s,c,l,u,m=[];for(a=0,s=t.length;a<s;a++)c=t[a]*i,l=a<s-1?t[a+1]*i:e.length,(u=n(e,c,l,i,!1))===u.next&&(u.steiner=!0),m.push(f(u));for(m.sort(d),a=0;a<m.length;a++)h(m[a],r),r=o(r,r.next);return r}(e,t,v,r)),e.length>80*r){i=c=e[0],s=l=e[1];for(var b=r;b<y;b+=r)(u=e[b])<i&&(i=u),(m=e[b+1])<s&&(s=m),u>c&&(c=u),m>l&&(l=m);p=0!==(p=Math.max(c-i,l-s))?1/p:0}return a(v,_,r,i,s,p),_}function n(e,t,r,i,n){var o,a;if(n===A(e,t,r,i)>0)for(o=t;o<r;o+=i)a=C(o,e[o],e[o+1],a);else for(o=r-i;o>=t;o-=i)a=C(o,e[o],e[o+1],a);return a&&_(a,a.next)&&(x(a),a=a.next),a}function o(e,t){if(!e)return e;t||(t=e);var r,i=e;do{if(r=!1,i.steiner||!_(i,i.next)&&0!==v(i.prev,i,i.next))i=i.next;else{if(x(i),(i=t=i.prev)===i.next)break;r=!0}}while(r||i!==t);return t}function a(e,t,r,i,n,d,h){if(e){!h&&d&&function(e,t,r,i){var n=e;do{null===n.z&&(n.z=p(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,function(e){var t,r,i,n,o,a,s,c,l=1;do{for(r=e,e=null,o=null,a=0;r;){for(a++,i=r,s=0,t=0;t<l&&(s++,i=i.nextZ);t++);for(c=l;s>0||c>0&&i;)0!==s&&(0===c||!i||r.z<=i.z)?(n=r,r=r.nextZ,s--):(n=i,i=i.nextZ,c--),o?o.nextZ=n:e=n,n.prevZ=o,o=n;r=i}o.nextZ=null,l*=2}while(a>1)}(n)}(e,i,n,d);for(var m,f,g=e;e.prev!==e.next;)if(m=e.prev,f=e.next,d?c(e,i,n,d):s(e))t.push(m.i/r),t.push(e.i/r),t.push(f.i/r),x(e),e=f.next,g=f.next;else if((e=f)===g){h?1===h?a(e=l(o(e),t,r),t,r,i,n,d,2):2===h&&u(e,t,r,i,n,d):a(o(e),t,r,i,n,d,1);break}}}function s(e){var t=e.prev,r=e,i=e.next;if(v(t,r,i)>=0)return!1;for(var n=e.next.next;n!==e.prev;){if(g(t.x,t.y,r.x,r.y,i.x,i.y,n.x,n.y)&&v(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function c(e,t,r,i){var n=e.prev,o=e,a=e.next;if(v(n,o,a)>=0)return!1;for(var s=n.x<o.x?n.x<a.x?n.x:a.x:o.x<a.x?o.x:a.x,c=n.y<o.y?n.y<a.y?n.y:a.y:o.y<a.y?o.y:a.y,l=n.x>o.x?n.x>a.x?n.x:a.x:o.x>a.x?o.x:a.x,u=n.y>o.y?n.y>a.y?n.y:a.y:o.y>a.y?o.y:a.y,d=p(s,c,t,r,i),h=p(l,u,t,r,i),m=e.prevZ,f=e.nextZ;m&&m.z>=d&&f&&f.z<=h;){if(m!==e.prev&&m!==e.next&&g(n.x,n.y,o.x,o.y,a.x,a.y,m.x,m.y)&&v(m.prev,m,m.next)>=0)return!1;if(m=m.prevZ,f!==e.prev&&f!==e.next&&g(n.x,n.y,o.x,o.y,a.x,a.y,f.x,f.y)&&v(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;m&&m.z>=d;){if(m!==e.prev&&m!==e.next&&g(n.x,n.y,o.x,o.y,a.x,a.y,m.x,m.y)&&v(m.prev,m,m.next)>=0)return!1;m=m.prevZ}for(;f&&f.z<=h;){if(f!==e.prev&&f!==e.next&&g(n.x,n.y,o.x,o.y,a.x,a.y,f.x,f.y)&&v(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function l(e,t,r){var i=e;do{var n=i.prev,a=i.next.next;!_(n,a)&&b(n,i,i.next,a)&&E(n,a)&&E(a,n)&&(t.push(n.i/r),t.push(i.i/r),t.push(a.i/r),x(i),x(i.next),i=e=a),i=i.next}while(i!==e);return o(i)}function u(e,t,r,i,n,s){var c=e;do{for(var l=c.next.next;l!==c.prev;){if(c.i!==l.i&&y(c,l)){var u=w(c,l);return c=o(c,c.next),u=o(u,u.next),a(c,t,r,i,n,s),void a(u,t,r,i,n,s)}l=l.next}c=c.next}while(c!==e)}function d(e,t){return e.x-t.x}function h(e,t){if(t=function(e,t){var r,i=t,n=e.x,o=e.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=n&&s>a){if(a=s,s===n){if(o===i.y)return i;if(o===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!r)return null;if(n===a)return r;var c,l=r,u=r.x,d=r.y,h=1/0;i=r;do{n>=i.x&&i.x>=u&&n!==i.x&&g(o<d?n:a,o,u,d,o<d?a:n,o,i.x,i.y)&&(c=Math.abs(o-i.y)/(n-i.x),E(i,e)&&(c<h||c===h&&(i.x>r.x||i.x===r.x&&m(r,i)))&&(r=i,h=c)),i=i.next}while(i!==l);return r}(e,t)){var r=w(t,e);o(r,r.next)}}function m(e,t){return v(e.prev,e,t.prev)<0&&v(t.next,e,e.next)<0}function p(e,t,r,i,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function f(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function g(e,t,r,i,n,o,a,s){return(n-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(i-s)-(r-a)*(t-s)>=0&&(r-a)*(o-s)-(n-a)*(i-s)>=0}function y(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&b(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(E(e,t)&&E(t,e)&&function(e,t){var r=e,i=!1,n=(e.x+t.x)/2,o=(e.y+t.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==e);return i}(e,t)&&(v(e.prev,e,t.prev)||v(e,t.prev,t))||_(e,t)&&v(e.prev,e,e.next)>0&&v(t.prev,t,t.next)>0)}function v(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function _(e,t){return e.x===t.x&&e.y===t.y}function b(e,t,r,i){var n=T(v(e,t,r)),o=T(v(e,t,i)),a=T(v(r,i,e)),s=T(v(r,i,t));return n!==o&&a!==s||(!(0!==n||!S(e,r,t))||(!(0!==o||!S(e,i,t))||(!(0!==a||!S(r,e,i))||!(0!==s||!S(r,t,i)))))}function S(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function T(e){return e>0?1:e<0?-1:0}function E(e,t){return v(e.prev,e,e.next)<0?v(e,t,e.next)>=0&&v(e,e.prev,t)>=0:v(e,t,e.prev)<0||v(e,e.next,t)<0}function w(e,t){var r=new O(e.i,e.x,e.y),i=new O(t.i,t.x,t.y),n=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,o.next=i,i.prev=o,i}function C(e,t,r,i){var n=new O(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function x(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function O(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A(e,t,r,i){for(var n=0,o=t,a=r-i;o<r;o+=i)n+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return n}e.exports=i,e.exports.default=i,i.deviation=function(e,t,r,i){var n=t&&t.length,o=n?t[0]*r:e.length,a=Math.abs(A(e,0,o,r));if(n)for(var s=0,c=t.length;s<c;s++){var l=t[s]*r,u=s<c-1?t[s+1]*r:e.length;a-=Math.abs(A(e,l,u,r))}var d=0;for(s=0;s<i.length;s+=3){var h=i[s]*r,m=i[s+1]*r,p=i[s+2]*r;d+=Math.abs((e[h]-e[p])*(e[m+1]-e[h+1])-(e[h]-e[m])*(e[p+1]-e[h+1]))}return 0===a&&0===d?0:Math.abs((d-a)/a)},i.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,n=0;n<e.length;n++){for(var o=0;o<e[n].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[n][o][a]);n>0&&(i+=e[n-1].length,r.holes.push(i))}return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(12),o=r(4),a=r(97),s=r(32),c=r(1),l=r(21),u=r(233),d=r(0),h=r(456),m=r(492),p=r(244),f=r(235),g={style:{opacity:new h.Normalizer(.6).addValidator(f.opacityValidation),hoverOpacity:new h.Normalizer(1).addValidator(f.opacityValidation)},width:new h.Normalizer(2).addValidator(f.moreThanZeroWithUnits),minWidth:new h.Normalizer(1).addValidator(f.moreThanZeroWithUnits),radius:new h.Normalizer("2.5px").addValidator(f.moreThanZeroWithUnits),minRadius:new h.Normalizer(6).addValidator(f.moreThanZeroWithUnits),"marker-size":new h.Normalizer("medium").addValidator(f.markerValidation),"stroke-opacity":new h.Normalizer(1).addValidator(f.opacityValidation),"stroke-width":new h.Normalizer(2).addValidator(f.moreThanZeroWithUnits),"fill-opacity":new h.Normalizer(.6).addValidator(f.opacityValidation)},y=.2,v=2,_=128,b=40;function S(e){return"string"==typeof e&&"px"===(e=e.trim()).slice(-2)?l.Units.pixels:l.Units.meters}t.DEFAULT_MARKER_SYMBOL="__defaultMarker";class T{constructor(){this.points=new E,this.lines=[],this.polygons=[],this.invisibleLinesInfo=[],this.thinLinesInfo=[],this.identifierRanges=new Map,this.identifiers=[],this.tooltipRanges=new Map,this.protobufRefs=new Map}}t.GeometryData=T;class E{constructor(){this.coordinates=[],this.borderColors=[],this.fillColors=[],this.selectedBorderColors=[],this.selectedFillColors=[],this.hoverColorRanges=new Map,this.radiuses=[],this.minRadiuses=[],this.sizes=[]}}class w{constructor(e,t,r,i,a=console,s=!1){this.m_tileKey=e,this.m_projection=t,this.m_evaluator=i,this.m_logger=a,this.m_geometries=[],this.m_geometryGroups=new Map,this.m_currentObjectIdentifier=1,this.m_colorCache=new Map,this.circlesCache=new Map,this.markersCache=new Map,this.m_tempVector3=new d.Vector3,this.m_tempGeoCoord=new o.GeoCoordinates(0,0),this.m_tempColorArray=new Uint8Array(4),this.m_tempColor=new d.Color,this.m_imagesMap={};const c=o.hereTilingScheme.getGeoBox(o.TileKey.fromMortonCode(this.m_tileKey.mortonCode())),u=this.m_projection.projectBox(c,new d.Box3);this.m_center=new d.Vector3,u.getCenter(this.m_center),this.m_scaleFactor=this.m_projection.getScaleFactor(this.m_center),this.m_invisibleMarkerTechniqueIndex=i.getMatchingTechniques(new n.MapEnv({type:"invisibleMarker"}))[0]._index,this.m_thinLineTechniqueIndex=i.getMatchingTechniques(new n.MapEnv({type:"thin-line"}))[0]._index,this.m_polygonFillTechnique=i.getMatchingTechniques(new n.MapEnv({type:"polygonFillShader"}))[0],this.m_polygonBorderTechnique=i.getMatchingTechniques(new n.MapEnv({type:"polygonBorder"}))[0],this.m_segmentTechnique=i.getMatchingTechniques(new n.MapEnv({type:"lineShader"}))[0],this.m_lineInMetersTechnique=i.getMatchingTechniques(new n.MapEnv({type:"lineShader",units:l.Units.meters}))[0],this.m_markerPointTechnique=i.getMatchingTechniques(new n.MapEnv({type:"point",mode:"markerPoint"}))[0],this.m_circleCenterTechnique=i.getMatchingTechniques(new n.MapEnv({type:"point",mode:"circleCenter",units:l.Units.meters}))[0],(s||f.isValidGeoJSON(r).isValid)&&this.processData(r)}getDecodedTile(){return{tileMortonCode:this.m_tileKey.mortonCode(),geometries:this.m_geometries,techniques:this.m_evaluator.techniques,imagesMap:this.m_imagesMap}}processData(e){switch(e.type){case"Feature":this.processFeature(e,".geometry");break;case"FeatureCollection":void 0!==e["marker-symbol-images"]&&(this.m_imagesMap=e["marker-symbol-images"]),e.features.forEach((e,t)=>this.processFeature(e,`.features[${t}].geometry`));break;default:const t={type:"Feature",properties:{},geometry:e};"GeometryCollection"===e.type?this.processFeature(t,""):this.processFeature(t,".coordinates")}this.createGeometry()}processFeature(e,r=""){e.properties=h.Normalizer.run(g,e.properties);const i=this.extractTooltip(e.properties);let n=!1;void 0===e.properties.protobufRef&&"GeometryCollection"!==e.geometry.type&&(e.properties.protobufRef=r,n=!0);const o=this.m_currentObjectIdentifier++;let a,s="GeometryCollection"!==e.geometry.type?this.convertGeo2WorldCoordinates(e.geometry.coordinates):[[]];switch(e.geometry.type){case"Point":s=[s];case"MultiPoint":if(void 0!==e.properties.radius)a=this.findTechniqueIndex(e,{type:"point",mode:"circleCenter"}),this.processPointWithRadius(s,e,o,a,i);else{if(void 0===(e.properties["marker-image"]||e.properties["marker-symbol"]&&this.m_imagesMap[e.properties["marker-symbol"]]))a=this.m_markerPointTechnique._index,e.properties["marker-symbol"]=t.DEFAULT_MARKER_SYMBOL,void 0===this.m_imagesMap[t.DEFAULT_MARKER_SYMBOL]&&(this.m_imagesMap[t.DEFAULT_MARKER_SYMBOL]=m.defaultMarkerMask),this.addMarkerSelectionGeometry(s,e,o,i,this.getMarkerSize(e));else{let t;void 0===e.properties["marker-image"]?t=e.properties["marker-symbol"]:(t=this.getMarkerSymbol(e.properties["marker-image"],o),e.properties["marker-symbol"]=t),a=this.findTechniqueIndex(e,{type:"point",mode:"customIcon"})}}this.processPoint(s,e,o,a,a===this.m_markerPointTechnique._index?void 0:i);break;case"LineString":s=[s];case"MultiLineString":const n=e.properties["stroke-width"]||e.properties.width;a=l.getUnits(n)===l.Units.meters?this.m_lineInMetersTechnique._index:this.m_segmentTechnique._index,this.processLineString(s,e,o,a),this.processAsLineSegments(s,e,o,i);break;case"Polygon":s=[s];case"MultiPolygon":this.processPolygon(s,e,o,i);break;case"GeometryCollection":e.geometry.geometries.forEach((t,i)=>{const n={type:"Feature",properties:e.properties,geometry:t};this.processFeature(n,`${r}.geometries[${i}]`)})}n&&delete e.properties.protobufRef}convertGeo2WorldCoordinates(e){const t=e[0],r=e[1];if(t instanceof Array||r instanceof Array){return e.map(e=>this.convertGeo2WorldCoordinates(e))}return this.m_tempGeoCoord.latitude=r,this.m_tempGeoCoord.longitude=t,this.m_projection.projectPoint(this.m_tempGeoCoord,this.m_tempVector3).sub(this.m_center),[this.m_tempVector3.x,this.m_tempVector3.y]}extractTooltip(e){if(0===Object.keys(e).length)return;const t=e.title,r=e.description||e.tooltip;let i,n;if("string"==typeof t?i=t.trim():"number"==typeof t&&(i=t.toString()),"string"==typeof r?n=r.trim():"number"==typeof r&&(n=r.toString()),"string"!=typeof i&&"string"!=typeof n)return{content:Object.assign({},e)};let o="";return"string"==typeof i&&i.length>0&&(o+=`<h3>${i}</h3>`),"string"==typeof n&&n.length>0&&(o+=`<div>${n}</div>`),o||void 0}getRGBAColor(e,t){const r=void 0===t?e:`${e}@${t}`;let i=this.m_colorCache.get(r);return void 0===i&&(void 0===(i=this.m_colorCache.get(e))&&(i=this.m_tempColor.set(e).toArray(),this.m_colorCache.set(e,i)),void 0!==t&&(i=i.concat([t]),this.m_colorCache.set(r,i))),i}processPoint(e,r,i,n,o){const a=this.findOrCreateGeometryBuffer(n,r);a.type="point";const s=this.m_evaluator.techniques[n],c=this.getMarkerFillDefaultStyle(r,s).color.map(e=>255*e),l=this.getMarkerHoverStyle(r,s).color,u=a.points.coordinates.length/3;e.forEach(e=>{a.points.coordinates.push(e[0],e[1],0),a.identifiers.push(i),void 0===r.properties.radius&&(a.points.fillColors.push.apply(a.points.fillColors,c),a.points.sizes.push(this.getMarkerSize(r)))});const d={start:u,end:u+e.length-1};this.aggregateRange(a.identifierRanges,i,d),this.aggregateRange(a.points.hoverColorRanges,l,{start:i,end:i}),void 0!==o&&this.aggregateRange(a.tooltipRanges,o,d),void 0===r.properties.protobufRef||void 0===r.properties.radius&&r.properties["marker-symbol"]===t.DEFAULT_MARKER_SYMBOL||this.aggregateRange(a.protobufRefs,r.properties.protobufRef,d),a.points.symbol=r.properties["marker-symbol"]}addMarkerSelectionGeometry(e,t,r,i,n){const o=this.findOrCreateGeometryBuffer(this.m_invisibleMarkerTechniqueIndex,t);o.type="invisible-polygon",o.uuid="invisibleMarker";const a=n/_,s=m.generatePointMarkerShape(3,a),c=s.length/3,l=this.generateMarker(a,s);e.forEach(e=>{const n=new Array(s.length);for(let t=0;t<c;t++){const r=3*t;n[r]=e[0],n[r+1]=e[1],n[r+2]=0}o.polygons.push({vertices:l.vertices,triangles:l.triangles,holes:[],markerCenter:n,markerShape:s,tooltip:i,identifier:r,protobufRef:t.properties.protobufRef})})}processPointWithRadius(e,t,r,i,n){const o=this.getFillDefaultStyle(t).color.map(e=>255*e),a=this.getBorderDefaultStyle(t).color.map(e=>255*e),s=this.getFillSelectStyle(t).color.map(e=>255*e),c=this.getBorderSelectStyle(t).color.map(e=>255*e),u=t.properties.radius,d=t.properties.minRadius||this.m_circleCenterTechnique.userData.minRadius,h=parseFloat(u),m=parseFloat(d);if(S(u)===l.Units.pixels)return void e.forEach(()=>{const e=this.findOrCreateGeometryBuffer(i,t).points;e.radiuses.push(h),e.fillColors.push.apply(e.fillColors,o),e.selectedFillColors.push.apply(e.selectedFillColors,s)});const p=h>500?h/500:1,f=2*Math.acos(1-p/h),g=Math.max(Math.ceil(2*Math.PI/f),16),y=this.generateCircle(g);e.forEach(e=>{this.m_tempVector3.x=e[0],this.m_tempVector3.y=e[1],this.m_tempVector3.z=0;const u=this.m_tempVector3.add(this.m_center),d=h*this.m_projection.getScaleFactor(u),p=this.findOrCreateGeometryBuffer(i,t).points;p.radiuses.push(d),p.minRadiuses.push(m),l.appendToArray(p.fillColors,o),l.appendToArray(p.borderColors,a),l.appendToArray(p.selectedFillColors,s),l.appendToArray(p.selectedBorderColors,c);const f=y.vertices.length/2,g=new Array(f);for(let t=0;t<f;t++){const r=2*t;g[t]=[e[0]+d*y.vertices[r],e[1]+d*y.vertices[r+1]]}this.processPolygon([[g]],t,r,n)})}generateCircle(e){let t=this.circlesCache.get(e);if(void 0===t){const r=2*Math.PI/e,i=[];for(let t=0;t<e;t++){const e=r*t;i.push(Math.cos(e),Math.sin(e))}i.push(i[0],i[1]),t={vertices:i,triangles:u.default(i,[])},this.circlesCache.set(e,t)}return t}generateMarker(e,t){let r=this.markersCache.get(e);if(void 0!==r)return r;const i=[];for(let e=0;e<t.length/3;e++)i.push(t[3*e]),i.push(t[3*e+1]);return r={vertices:i,triangles:u.default(i,[])},this.markersCache.set(e,r),r}processLineString(e,t,r,i){const n=this.findOrCreateGeometryBuffer(i,t);n.type="solid-line-shader";const o=this.getSegmentDefaultStyle(t),a=o.color,s=this.getSegmentHoverStyle(t).color,c=this.getSegmentSelectStyle(t).color,u=this.getSegmentSelectHoverStyle(t).color;let d=o.lineWidth;o.units===l.Units.meters&&(d*=this.m_scaleFactor);const h=o.lineMinWidth;e.forEach(e=>{const i=[];e.forEach((t,r)=>{const n=e[r-1];void 0!==n&&t[0]===n[0]&&t[1]===n[1]||i.push(t[0],t[1],0)}),n.lines.push({vertices:i,identifier:r,groupId:t.properties.groupId,defaultColor:a,hoverColor:s,selectColor:c,selectHoverColor:u,lineWidth:d,lineMinWidth:h})})}processPolygon(e,t,r,i){const n=this.getFillDefaultStyle(t).color,o=this.getFillHoverStyle(t).color,a=this.getFillSelectStyle(t).color,s=this.getFillSelectHoverStyle(t).color,c=this.findOrCreateGeometryBuffer(this.m_polygonFillTechnique._index,t);c.type="polygon-shader";for(const l of e){const e=[],u=[];for(const t of l){e.length&&u.push(e.length/2);for(const r of t)e.push(r[0],r[1])}c.polygons.push({vertices:e,holes:u,tooltip:i,identifier:r,defaultColor:n,hoverColor:o,selectColor:a,selectHoverColor:s,protobufRef:t.properties.protobufRef}),.5===this.getBorderDefaultStyle(t).lineWidth?this.processAsLineSegments(l,t,r,void 0,"thin-line"):this.processLineString(l,t,r,this.m_polygonBorderTechnique._index)}}processAsLineSegments(e,t,r,i,n="invisible-line"){const o="thin-line"===n?this.m_thinLineTechniqueIndex:this.findTechniqueIndex(t,{type:n}),a=this.findOrCreateGeometryBuffer(o,t);a.type=n;const s=this.getSegmentDefaultStyle(t);let c=s.lineWidth;s.units===l.Units.meters&&(c*=this.m_scaleFactor);const u=[];switch(e.forEach(e=>{if(e.length>2)for(let t=1,r=e.length-1;t<r;t++){const r=2*t-1;e.splice(r,0,e[r])}e.forEach(e=>{u.push(e[0],e[1],0)})}),n){case"invisible-line":a.invisibleLinesInfo.push({vertices:u,identifier:r,tooltip:i,protobufRef:t.properties.protobufRef,lineWidth:c});break;case"thin-line":a.thinLinesInfo.push({vertices:u,identifier:r,defaultColor:this.getSegmentDefaultStyle(t).color,hoverColor:this.getSegmentHoverStyle(t).color,selectColor:this.getSegmentSelectStyle(t).color,selectHoverColor:this.getSegmentSelectHoverStyle(t).color})}}createGeometry(){this.m_geometryGroups.forEach(e=>{e.forEach((e,t)=>{e.forEach(e=>{switch(e.type){case"point":this.createPointGeometry(t,e);break;case"solid-line-shader":this.createLineGeometry(t,e);break;case"thin-line":this.createThinLineGeometry(t,e);break;case"invisible-line":this.createInvisibleSegmentsGeometry(t,e);break;case"polygon":case"polygon-shader":this.createPolygonGeometry(t,e);break;case"invisible-polygon":this.createPolygonGeometry(t,e,!0)}})})})}aggregateRange(e,t,r){let i=e.get(t);void 0===i&&(i=[],e.set(t,i));const n=r.end,o=i[i.length-1];if(void 0!==o){if(o.start===r.start&&o.end===r.end)return;if(o.end+1===r.start)return void(o.end=n)}i.push({start:r.start,end:n})}createPointGeometry(e,t){const r=[{name:"position",buffer:new Float32Array(t.points.coordinates).buffer,itemCount:3,type:"float"},{name:"objectIdentifier",buffer:new Float32Array(t.identifiers).buffer,itemCount:1,type:"float"}];t.points.radiuses.length>0&&r.push({name:"radius",buffer:new Float32Array(t.points.radiuses).buffer,itemCount:1,type:"float"}),t.points.minRadiuses.length>0&&r.push({name:"minRadius",buffer:new Float32Array(t.points.minRadiuses).buffer,itemCount:1,type:"float"}),t.points.sizes.length>0&&r.push({name:"size",buffer:new Float32Array(t.points.sizes).buffer,itemCount:1,type:"float"}),t.points.borderColors.length>0&&r.push({name:"borderColor",buffer:new Uint8Array(t.points.borderColors).buffer,normalized:!0,itemCount:4,type:"uint8"}),t.points.fillColors.length>0&&r.push({name:0===t.points.radiuses.length?"defaultColor":"fillColor",buffer:new Uint8Array(t.points.fillColors).buffer,normalized:!0,itemCount:4,type:"uint8"}),t.points.selectedBorderColors.length>0&&r.push({name:"selectedBorderColor",buffer:new Uint8Array(t.points.selectedBorderColors).buffer,normalized:!0,itemCount:4,type:"uint8"}),t.points.selectedFillColors.length>0&&r.push({name:"selectedFillColor",buffer:new Uint8Array(t.points.selectedFillColors).buffer,normalized:!0,itemCount:4,type:"uint8"});const n=new Map;n.set(this.getRGBAColor(this.m_markerPointTechnique.userData.selectColor,1),[{start:0,end:1/0}]);const o=new Map;o.set(this.getRGBAColor(this.m_markerPointTechnique.userData.selectHoverColor,1),[{start:0,end:1/0}]),this.m_geometries.push({type:i.GeometryType.Point,vertexAttributes:r,groups:[{start:0,count:0,technique:e,createdOffsets:[]}],objInfos:{identifierRanges:t.identifierRanges,tooltipRanges:t.tooltipRanges,hoverColorRanges:t.points.hoverColorRanges,protobufRefs:t.protobufRefs,groupId:t.groupId,uuid:t.uuid,selectColorRanges:n,selectHoverColorRanges:o,symbol:t.points.symbol}})}createLineGeometry(e,t){const r=new a.LineGroup,n=[],o=new Map,s=new Map,c=new Map,l=new d.Vector3(0,0,0);let u=0;t.lines.forEach(e=>{r.add(l,e.vertices);const t=r.vertices.length/r.stride;n.push({start:u,end:t-1}),u=t});const h=r.vertices.length/r.stride,m=new Float32Array(h),p=new Float32Array(h),f=new Float32Array(h),g=new Uint8Array(4*h);t.lines.forEach((e,t)=>{const r=n[t];m.fill(e.identifier,r.start,r.end+1),p.fill(e.lineWidth,r.start,r.end+1),f.fill(e.lineMinWidth,r.start,r.end+1);const i=this.getColorTypedArray(e.defaultColor);for(let e=r.start,t=r.end+1;e<t;e++)g.set(i,4*e);const a={start:e.identifier,end:e.identifier};this.aggregateRange(o,e.hoverColor,a),this.aggregateRange(s,e.selectColor,a),this.aggregateRange(c,e.selectHoverColor,a)});const{vertices:y,indices:v}=r,_={type:i.GeometryType.SolidLine,index:{name:"index",buffer:new Uint32Array(v).buffer,itemCount:1,type:"uint32"},interleavedVertexAttributes:[{type:"float",stride:r.stride,buffer:new Float32Array(y).buffer,attributes:r.vertexAttributes}],vertexAttributes:[{name:"objectIdentifier",buffer:m.buffer,itemCount:1,type:"float"},{name:"lineWidth",buffer:p.buffer,itemCount:1,type:"float"},{name:"lineMinWidth",buffer:f.buffer,itemCount:1,type:"float"},{name:"defaultColor",buffer:g.buffer,itemCount:4,type:"uint8",normalized:!0}],groups:[{start:0,count:0,technique:e,createdOffsets:[]}],objInfos:{hoverColorRanges:o,selectColorRanges:s,selectHoverColorRanges:c,groupId:t.groupId},uuid:t.uuid};this.m_geometries.push(_)}createThinLineGeometry(e,t){const r=new Map,n=new Map,o=new Map,a=t.thinLinesInfo.reduce((e,t)=>e+t.vertices.length,0),s=a/3,c=new Float32Array(a),l=new Float32Array(s),u=new Uint8Array(4*s);let d=0,h=0;t.thinLinesInfo.forEach(e=>{const t=h+e.vertices.length,i={start:h/3,end:t/3-1};h=t,c.set(e.vertices,d),d+=e.vertices.length,l.fill(e.identifier,i.start,i.end+1);const a=this.getColorTypedArray(e.defaultColor);for(let e=i.start,t=i.end+1;e<t;e++)u.set(a,4*e);const s={start:e.identifier,end:e.identifier};this.aggregateRange(r,e.hoverColor,s),this.aggregateRange(n,e.selectColor,s),this.aggregateRange(o,e.selectHoverColor,s)});const m={type:i.GeometryType.Unspecified,vertexAttributes:[{name:"position",buffer:c.buffer,itemCount:3,type:"float"},{name:"objectIdentifier",buffer:l.buffer,itemCount:1,type:"float"},{name:"defaultColor",buffer:u.buffer,itemCount:4,type:"uint8",normalized:!0}],groups:[{start:0,count:0,technique:e,createdOffsets:[]}],objInfos:{hoverColorRanges:r,selectColorRanges:n,selectHoverColorRanges:o,groupId:t.groupId},uuid:t.uuid};this.m_geometries.push(m)}createPolygonGeometry(e,t,r=!1){const n=[],o=[],a=new Map,s=new Map,c=new Map,d=new Map,h=new Map,m=new Map,p=1.5*t.polygons.reduce((e,t)=>e+t.vertices.length,0)/3,f=new Float32Array(3*p),g=new Float32Array(p);let y;r||(y=new Uint8Array(4*p));const v=[],_=[],b=[];let S=0;t.polygons.forEach(e=>{const t=S;g.fill(e.identifier,S,S+e.vertices.length/2);for(let t=0;t<e.vertices.length;t+=2,S++){const r=3*S;f[r]=e.vertices[t],f[r+1]=e.vertices[t+1];const i=e.defaultColor;if(y&&i){const e=4*S;y[e]=255*i[0],y[e+1]=255*i[1],y[e+2]=255*i[2],y[e+3]=255*i[3]}}const i=void 0!==e.triangles?e.triangles:u.default(e.vertices,e.holes),o=n.length/3;for(let e=0;e<i.length;e+=3)n.push(i[e]+t,i[e+1]+t,i[e+2]+t);const p={start:o,end:n.length/3-1};e.tooltip&&this.aggregateRange(s,e.tooltip,p),void 0!==e.protobufRef&&this.aggregateRange(c,e.protobufRef,p),this.aggregateRange(a,e.identifier,p);const v={start:e.identifier,end:e.identifier};r||(void 0!==e.hoverColor&&this.aggregateRange(d,e.hoverColor,v),void 0!==e.selectColor&&this.aggregateRange(h,e.selectColor,v),void 0!==e.selectHoverColor&&this.aggregateRange(m,e.selectHoverColor,v)),e.markerCenter&&e.markerShape&&(l.appendToArray(_,e.markerCenter),l.appendToArray(b,e.markerShape))}),v.push({name:"position",buffer:f.buffer,itemCount:3,type:"float"},{name:"objectIdentifier",buffer:g.buffer,itemCount:1,type:"float"}),y&&v.push({name:"defaultColor",buffer:y.buffer,itemCount:4,type:"uint8",normalized:!0}),_.length>0&&b.length>0&&v.push({name:"markerCenter",buffer:new Float32Array(_).buffer,itemCount:3,type:"float"},{name:"markerShape",buffer:new Float32Array(b).buffer,itemCount:3,type:"float"});const T={type:i.GeometryType.Polygon,vertexAttributes:v,groups:o,uuid:t.uuid,objInfos:{tooltipRanges:s,identifierRanges:a,protobufRefs:c,hoverColorRanges:d,selectColorRanges:h,selectHoverColorRanges:m,groupId:t.groupId}};n.length>0&&(o.push({start:0,count:n.length,technique:e,createdOffsets:[]}),T.index={name:"index",buffer:new Uint32Array(n).buffer,itemCount:1,type:"uint32"}),this.m_geometries.push(T)}createInvisibleSegmentsGeometry(e,t){const r=new Map,n=new Map,o=new Map,a=[];let s=0;t.invisibleLinesInfo.forEach(e=>{const t=e.vertices.length,r=s+t;a.push({start:s/3,end:r/3-1}),s=r});const c=new Float32Array(s),l=new Float32Array(s);let u=0;t.invisibleLinesInfo.forEach((e,t)=>{const i=a[t];c.set(e.vertices,u),u+=e.vertices.length,this.aggregateRange(r,e.identifier,i),void 0!==e.tooltip&&this.aggregateRange(n,e.tooltip,i),void 0!==e.protobufRef&&this.aggregateRange(o,e.protobufRef,i),void 0!==e.lineWidth&&l.fill(e.lineWidth,i.start,i.end+1)}),this.m_geometries.push({type:i.GeometryType.Unspecified,vertexAttributes:[{name:"position",buffer:c.buffer,itemCount:3,type:"float"},{name:"lineWidth",buffer:l.buffer,itemCount:1,type:"float"}],groups:[{start:0,count:0,technique:e,createdOffsets:[]}],objInfos:{identifierRanges:r,tooltipRanges:n,protobufRefs:o,groupId:t.groupId},uuid:"invisibleLine"})}getFillDefaultStyle(e){const t=e.properties.style,r=e.properties["fill-opacity"]||t&&t.opacity||this.m_polygonFillTechnique.defaultAlpha,i=e.properties.fill||t&&(t.fill||t.color)||this.m_polygonFillTechnique.defaultColor;return{rawColor:i,opacity:r,color:this.getRGBAColor(i,r)}}getMarkerFillDefaultStyle(e,t){const r=e.properties.style,i=e.properties["marker-color"]||e.properties.fill||r&&(r.fill||r.color)||t&&t.userData&&t.userData.defaultColor||this.m_polygonFillTechnique.defaultColor;return{rawColor:i,opacity:1,color:this.getRGBAColor(i,1)}}getFillHoverStyle(e){const t=this.getFillDefaultStyle(e);t.opacity=void 0!==e.properties.style&&e.properties.style.hoverOpacity||t.opacity+y;const r=void 0!==e.properties.style&&e.properties.style.hoverColor||t.rawColor;return t.color=this.getRGBAColor(r,t.opacity),t}getMarkerHoverStyle(e,t){const r=this.getMarkerFillDefaultStyle(e,t),i=void 0!==e.properties.style&&e.properties.style.hoverColor||r.rawColor;return r.color=this.getRGBAColor(i,1),r}getFillSelectStyle(e){return{rawColor:this.m_polygonFillTechnique.selectColor,color:this.getRGBAColor(this.m_polygonFillTechnique.selectColor,this.m_polygonFillTechnique.selectAlpha),opacity:this.m_polygonFillTechnique.selectAlpha}}getFillSelectHoverStyle(e){const t=this.getFillSelectStyle(e);return t.opacity+=y,t.color=this.getRGBAColor(t.rawColor,t.opacity),t}getBorderDefaultStyle(e){const t=e.properties.style,r=e.properties["stroke-opacity"]||this.m_polygonBorderTechnique.userData.defaultAlpha,i=e.properties["stroke-width"]||e.properties.width||1,n=l.getValue(i)/2,o=e.properties.stroke||t&&t.color||this.m_polygonBorderTechnique.userData.defaultColor;return{rawColor:o,color:this.getRGBAColor(o,r),opacity:r,lineWidth:n,lineMinWidth:1,units:l.Units.pixels}}getBorderSelectStyle(e){const t=this.getSegmentSelectStyle(e);return t.color=this.getRGBAColor(this.m_polygonBorderTechnique.userData.selectColor,t.opacity),t}getSegmentDefaultStyle(e){const t=e.properties.style,r=e.properties["stroke-opacity"]||t&&t.opacity||this.m_segmentTechnique.userData.defaultAlpha,i=e.properties["stroke-width"]||e.properties.width||this.m_segmentTechnique.lineWidth,n=l.getUnits(i),o=l.getValue(i)/2,a=(parseFloat(e.properties.minWidth)||this.m_lineInMetersTechnique.lineMinWidth||1)/2,s=e.properties.stroke||t&&t.color||this.m_segmentTechnique.userData.defaultColor;return{rawColor:s,color:this.getRGBAColor(s,r),opacity:r,lineWidth:o,lineMinWidth:a,units:n}}getSegmentHoverStyle(e){const t=this.getSegmentDefaultStyle(e);t.lineWidth*=v,t.opacity=void 0!==e.properties.style&&e.properties.style.hoverOpacity||t.opacity+y;const r=void 0!==e.properties.style&&e.properties.style.hoverColor||t.rawColor;return t.color=this.getRGBAColor(r,t.opacity),t}getSegmentSelectStyle(e){const t=this.getSegmentDefaultStyle(e),r=this.m_segmentTechnique.userData;return{rawColor:r.selectColor,color:this.getRGBAColor(r.selectColor,r.selectAlpha),opacity:r.selectAlpha,lineWidth:t.lineWidth,lineMinWidth:t.lineMinWidth,units:t.units}}getSegmentSelectHoverStyle(e){const t=this.getSegmentSelectStyle(e);return t.lineWidth*=v,t.opacity+=y,t.color=this.getRGBAColor(t.rawColor,t.opacity),t}getColorTypedArray(e){return this.m_tempColorArray[0]=255*e[0],this.m_tempColorArray[1]=255*e[1],this.m_tempColorArray[2]=255*e[2],this.m_tempColorArray[3]=255*e[3],this.m_tempColorArray}findTechniqueIndex(e,t){const r={};if("circleCenter"===t.mode&&void 0!==e.properties.radius){const t=e.properties.radius,i=l.getValue(t),n=S(t);r.units=n,r.radius=i}else if("invisible-line"===t.type){const t=e.properties["stroke-width"]||e.properties.width,i=l.getValue(t),n=l.getUnits(t);i&&1!==i&&(r.lineWidth=i),r.units=n}Object.keys(r).length;Object.assign(t,r);const i=new n.MapEnv(t);return this.m_evaluator.getMatchingTechniques(i)[0]._index}findOrCreateGeometryBuffer(e,t){const r=t.properties.groupId;let i=this.m_geometryGroups.get(r);void 0===i&&(i=new Map,this.m_geometryGroups.set(r,i));let n=i.get(e);void 0===n&&(n=[],i.set(e,n));let o=n.find(e=>e.points.symbol===t.properties["marker-symbol"]);return o||((o=new T).groupId=r,void 0!==t.properties["marker-symbol"]&&(o.points.symbol=t.properties["marker-symbol"]),n.push(o),o)}getMarkerSymbol(e,t){let r=Object.keys(this.m_imagesMap).find(t=>this.m_imagesMap[t]===e);return void 0===r&&(r=`__${t}`,this.m_imagesMap[r]=e),r}getMarkerSize(e){const r=e.properties["marker-size"];if("number"==typeof r)return r;const i=parseInt(r,10);if(!isNaN(i))return i;const n=e.properties["marker-symbol"]===t.DEFAULT_MARKER_SYMBOL?_:b;switch(r){case"small":return.75*n;case"large":return 1.25*n;case"medium":default:return n}}}t.GeoJsonDecoder=w;class C extends s.ThemedTileDecoder{constructor(){super(),this.m_logger=c.LoggerManager.instance.create("GeoJsonDecoder"),this.configure([])}async connect(){return Promise.resolve()}async decodeThemedTile(e,t,r,i){const o=JSON.parse(JSON.stringify(p.geoJsonTheme)),a=new n.StyleSetEvaluator(o.styles),s=new w(t,i,e,a,this.m_logger).getDecodedTile();return Promise.resolve(Object.assign(Object.assign({},s),{tileMortonCode:t.mortonCode()}))}}t.GeoJsonTileDecoder=C;t.GeoJsonWorkerClient=class{constructor(e="geojson"){s.WorkerServiceManager.getInstance().register({serviceType:e,factory:e=>s.TileDecoderService.start(e,new C)})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(457),n=r(491);let o;t.isObject=e=>e&&"[object Object]"===e.toString(),t.moreThanZeroWithUnits=e=>("number"!=typeof e&&(e=parseFloat(e)),e>0),t.opacityValidation=e=>"number"==typeof e&&e>=0&&e<=1,t.markerValidation=e=>"number"==typeof e||/^\d+(?:\s*px)?$/.test(e)||-1!==["small","medium","large"].indexOf(e),t.b64toBlob=function(e,t=512){const r=atob(e),i=[];for(let e=0;e<r.length;e+=t){const n=r.slice(e,e+t),o=new Array(n.length);for(let e=0;e<n.length;e++)o[e]=n.charCodeAt(e);const a=new Uint8Array(o);i.push(a)}return new Blob(i)},t.mergeDeep=function e(r,...i){if(!i.length)return r;const n=i.shift();if(t.isObject(r)&&t.isObject(n))for(const i in n)n.hasOwnProperty(i)&&t.isObject(n[i])?(r[i]||Object.assign(r,{[i]:{}}),e(r[i],n[i])):Object.assign(r,{[i]:n[i]});return e(r,...i)},t.isValidGeoJSON=function(e){return void 0===o&&(o=i().compile(n.geoJSONSchema)),{isValid:o(e),errors:o.errors}}},function(e,t,r){"use strict";var i=r(40);e.exports=function(e){i.copy(e,this)}},function(e,t,r){"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var r,i="boolean"==typeof t.cycles&&t.cycles,n=t.cmp&&(r=t.cmp,function(e){return function(t,i){var n={key:t,value:e[t]},o={key:i,value:e[i]};return r(n,o)}}),o=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var r,a;if(Array.isArray(t)){for(a="[",r=0;r<t.length;r++)r&&(a+=","),a+=e(t[r])||"null";return a+"]"}if(null===t)return"null";if(-1!==o.indexOf(t)){if(i)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=o.push(t)-1,c=Object.keys(t).sort(n&&n(t));for(a="",r=0;r<c.length;r++){var l=c[r],u=e(t[l]);u&&(a&&(a+=","),a+=JSON.stringify(l)+":"+u)}return o.splice(s,1),"{"+a+"}"}}(e)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i="",n=!0===e.schema.$async,o=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),a=e.self._getId(e.schema);if(e.opts.strictKeywords){var s=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(s){var c="unknown keyword: "+s;if("log"!==e.opts.strictKeywords)throw new Error(c);e.logger.warn(c)}}if(e.isTop&&(i+=" var validate = ",n&&(e.async=!0,i+="async "),i+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",a&&(e.opts.sourceCode||e.opts.processCode)&&(i+=" /*# sourceURL="+a+" */ ")),"boolean"==typeof e.schema||!o&&!e.schema.$ref){var l=e.level,u=e.dataLevel,d=e.schema["false schema"],h=e.schemaPath+e.util.getProperty("false schema"),m=e.errSchemaPath+"/false schema",p=!e.opts.allErrors,f="data"+(u||""),g="valid"+l;if(!1===e.schema){e.isTop?p=!0:i+=" var "+g+" = false; ",(J=J||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'false schema' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: {} ",!1!==e.opts.messages&&(i+=" , message: 'boolean schema is false' "),e.opts.verbose&&(i+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var y=i;i=J.pop(),!e.compositeRule&&p?e.async?i+=" throw new ValidationError(["+y+"]); ":i+=" validate.errors = ["+y+"]; return false; ":i+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?i+=n?" return data; ":" validate.errors = null; return true; ":i+=" var "+g+" = true; ";return e.isTop&&(i+=" }; return validate; "),i}if(e.isTop){var v=e.isTop;l=e.level=0,u=e.dataLevel=0,f="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[void 0],void 0!==e.schema.default&&e.opts.useDefaults&&e.opts.strictDefaults){var _="default is ignored in the schema root";if("log"!==e.opts.strictDefaults)throw new Error(_);e.logger.warn(_)}i+=" var vErrors = null; ",i+=" var errors = 0;     ",i+=" if (rootData === undefined) rootData = data; "}else{l=e.level,f="data"+((u=e.dataLevel)||"");if(a&&(e.baseId=e.resolve.url(e.baseId,a)),n&&!e.async)throw new Error("async schema in sync schema");i+=" var errs_"+l+" = errors;"}g="valid"+l,p=!e.opts.allErrors;var b="",S="",T=e.schema.type,E=Array.isArray(T);if(T&&e.opts.nullable&&!0===e.schema.nullable&&(E?-1==T.indexOf("null")&&(T=T.concat("null")):"null"!=T&&(T=[T,"null"],E=!0)),E&&1==T.length&&(T=T[0],E=!1),e.schema.$ref&&o){if("fail"==e.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');!0!==e.opts.extendRefs&&(o=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(i+=" "+e.RULES.all.$comment.code(e,"$comment")),T){if(e.opts.coerceTypes)var w=e.util.coerceToTypes(e.opts.coerceTypes,T);var C=e.RULES.types[T];if(w||E||!0===C||C&&!X(C)){h=e.schemaPath+".type",m=e.errSchemaPath+"/type",h=e.schemaPath+".type",m=e.errSchemaPath+"/type";var x=E?"checkDataTypes":"checkDataType";if(i+=" if ("+e.util[x](T,f,!0)+") { ",w){var O="dataType"+l,A="coerced"+l;i+=" var "+O+" = typeof "+f+"; ","array"==e.opts.coerceTypes&&(i+=" if ("+O+" == 'object' && Array.isArray("+f+")) "+O+" = 'array'; "),i+=" var "+A+" = undefined; ";var P="",R=w;if(R)for(var I,D=-1,L=R.length-1;D<L;)I=R[D+=1],D&&(i+=" if ("+A+" === undefined) { ",P+="}"),"array"==e.opts.coerceTypes&&"array"!=I&&(i+=" if ("+O+" == 'array' && "+f+".length == 1) { "+A+" = "+f+" = "+f+"[0]; "+O+" = typeof "+f+";  } "),"string"==I?i+=" if ("+O+" == 'number' || "+O+" == 'boolean') "+A+" = '' + "+f+"; else if ("+f+" === null) "+A+" = ''; ":"number"==I||"integer"==I?(i+=" if ("+O+" == 'boolean' || "+f+" === null || ("+O+" == 'string' && "+f+" && "+f+" == +"+f+" ","integer"==I&&(i+=" && !("+f+" % 1)"),i+=")) "+A+" = +"+f+"; "):"boolean"==I?i+=" if ("+f+" === 'false' || "+f+" === 0 || "+f+" === null) "+A+" = false; else if ("+f+" === 'true' || "+f+" === 1) "+A+" = true; ":"null"==I?i+=" if ("+f+" === '' || "+f+" === 0 || "+f+" === false) "+A+" = null; ":"array"==e.opts.coerceTypes&&"array"==I&&(i+=" if ("+O+" == 'string' || "+O+" == 'number' || "+O+" == 'boolean' || "+f+" == null) "+A+" = ["+f+"]; ");i+=" "+P+" if ("+A+" === undefined) {   ",(J=J||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: { type: '",i+=E?""+T.join(","):""+T,i+="' } ",!1!==e.opts.messages&&(i+=" , message: 'should be ",i+=E?""+T.join(","):""+T,i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";y=i;i=J.pop(),!e.compositeRule&&p?e.async?i+=" throw new ValidationError(["+y+"]); ":i+=" validate.errors = ["+y+"]; return false; ":i+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else {  ";var M=u?"data"+(u-1||""):"parentData";i+=" "+f+" = "+A+"; ",u||(i+="if ("+M+" !== undefined)"),i+=" "+M+"["+(u?e.dataPathArr[u]:"parentDataProperty")+"] = "+A+"; } "}else{(J=J||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: { type: '",i+=E?""+T.join(","):""+T,i+="' } ",!1!==e.opts.messages&&(i+=" , message: 'should be ",i+=E?""+T.join(","):""+T,i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";y=i;i=J.pop(),!e.compositeRule&&p?e.async?i+=" throw new ValidationError(["+y+"]); ":i+=" validate.errors = ["+y+"]; return false; ":i+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}i+=" } "}}if(e.schema.$ref&&!o)i+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",p&&(i+=" } if (errors === ",i+=v?"0":"errs_"+l,i+=") { ",S+="}");else{var k=e.RULES;if(k)for(var N=-1,F=k.length-1;N<F;)if(X(C=k[N+=1])){if(C.type&&(i+=" if ("+e.util.checkDataType(C.type,f)+") { "),e.opts.useDefaults)if("object"==C.type&&e.schema.properties){d=e.schema.properties;var U=Object.keys(d);if(U)for(var j,V=-1,B=U.length-1;V<B;){if(void 0!==(q=d[j=U[V+=1]]).default){var G=f+e.util.getProperty(j);if(e.compositeRule){if(e.opts.strictDefaults){_="default is ignored for: "+G;if("log"!==e.opts.strictDefaults)throw new Error(_);e.logger.warn(_)}}else i+=" if ("+G+" === undefined ","empty"==e.opts.useDefaults&&(i+=" || "+G+" === null || "+G+" === '' "),i+=" ) "+G+" = ","shared"==e.opts.useDefaults?i+=" "+e.useDefault(q.default)+" ":i+=" "+JSON.stringify(q.default)+" ",i+="; "}}}else if("array"==C.type&&Array.isArray(e.schema.items)){var z=e.schema.items;if(z){D=-1;for(var q,H=z.length-1;D<H;)if(void 0!==(q=z[D+=1]).default){G=f+"["+D+"]";if(e.compositeRule){if(e.opts.strictDefaults){_="default is ignored for: "+G;if("log"!==e.opts.strictDefaults)throw new Error(_);e.logger.warn(_)}}else i+=" if ("+G+" === undefined ","empty"==e.opts.useDefaults&&(i+=" || "+G+" === null || "+G+" === '' "),i+=" ) "+G+" = ","shared"==e.opts.useDefaults?i+=" "+e.useDefault(q.default)+" ":i+=" "+JSON.stringify(q.default)+" ",i+="; "}}}var W=C.rules;if(W)for(var K,Y=-1,$=W.length-1;Y<$;)if(Q(K=W[Y+=1])){var Z=K.code(e,K.keyword,C.type);Z&&(i+=" "+Z+" ",p&&(b+="}"))}if(p&&(i+=" "+b+" ",b=""),C.type&&(i+=" } ",T&&T===C.type&&!w)){i+=" else { ";var J;h=e.schemaPath+".type",m=e.errSchemaPath+"/type";(J=J||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: { type: '",i+=E?""+T.join(","):""+T,i+="' } ",!1!==e.opts.messages&&(i+=" , message: 'should be ",i+=E?""+T.join(","):""+T,i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";y=i;i=J.pop(),!e.compositeRule&&p?e.async?i+=" throw new ValidationError(["+y+"]); ":i+=" validate.errors = ["+y+"]; return false; ":i+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } "}p&&(i+=" if (errors === ",i+=v?"0":"errs_"+l,i+=") { ",S+="}")}}function X(e){for(var t=e.rules,r=0;r<t.length;r++)if(Q(t[r]))return!0}function Q(t){return void 0!==e.schema[t.keyword]||t.implements&&function(t){for(var r=t.implements,i=0;i<r.length;i++)if(void 0!==e.schema[r[i]])return!0}(t)}return p&&(i+=" "+S+" "),v?(n?(i+=" if (errors === 0) return data;           ",i+=" else throw new ValidationError(vErrors); "):(i+=" validate.errors = vErrors; ",i+=" return errors === 0;       "),i+=" }; return validate;"):i+=" var "+g+" = errors === errs_"+l+";",i=e.util.cleanUpCode(i),v&&(i=e.util.finalCleanUpCode(i,n)),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,n=" ",o=e.level,a=e.dataLevel,s=e.schema[t],c=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&s&&s.$data;h?(n+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",i="schema"+o):i=s;var m="maximum"==t,p=m?"exclusiveMaximum":"exclusiveMinimum",f=e.schema[p],g=e.opts.$data&&f&&f.$data,y=m?"<":">",v=m?">":"<",_=void 0;if(g){var b=e.util.getData(f.$data,a,e.dataPathArr),S="exclusive"+o,T="exclType"+o,E="exclIsNumber"+o,w="' + "+(O="op"+o)+" + '";n+=" var schemaExcl"+o+" = "+b+"; ",n+=" var "+S+"; var "+T+" = typeof "+(b="schemaExcl"+o)+"; if ("+T+" != 'boolean' && "+T+" != 'undefined' && "+T+" != 'number') { ";var C;_=p;(C=C||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(_||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: '"+p+" should be boolean' "),e.opts.verbose&&(n+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var x=n;n=C.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+x+"]); ":n+=" validate.errors = ["+x+"]; return false; ":n+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else if ( ",h&&(n+=" ("+i+" !== undefined && typeof "+i+" != 'number') || "),n+=" "+T+" == 'number' ? ( ("+S+" = "+i+" === undefined || "+b+" "+y+"= "+i+") ? "+d+" "+v+"= "+b+" : "+d+" "+v+" "+i+" ) : ( ("+S+" = "+b+" === true) ? "+d+" "+v+"= "+i+" : "+d+" "+v+" "+i+" ) || "+d+" !== "+d+") { var op"+o+" = "+S+" ? '"+y+"' : '"+y+"='; ",void 0===s&&(_=p,l=e.errSchemaPath+"/"+p,i=b,h=g)}else{w=y;if((E="number"==typeof f)&&h){var O="'"+w+"'";n+=" if ( ",h&&(n+=" ("+i+" !== undefined && typeof "+i+" != 'number') || "),n+=" ( "+i+" === undefined || "+f+" "+y+"= "+i+" ? "+d+" "+v+"= "+f+" : "+d+" "+v+" "+i+" ) || "+d+" !== "+d+") { "}else{E&&void 0===s?(S=!0,_=p,l=e.errSchemaPath+"/"+p,i=f,v+="="):(E&&(i=Math[m?"min":"max"](f,s)),f===(!E||i)?(S=!0,_=p,l=e.errSchemaPath+"/"+p,v+="="):(S=!1,w+="="));O="'"+w+"'";n+=" if ( ",h&&(n+=" ("+i+" !== undefined && typeof "+i+" != 'number') || "),n+=" "+d+" "+v+" "+i+" || "+d+" !== "+d+") { "}}_=_||t,(C=C||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(_||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { comparison: "+O+", limit: "+i+", exclusive: "+S+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be "+w+" ",n+=h?"' + "+i:i+"'"),e.opts.verbose&&(n+=" , schema:  ",n+=h?"validate.schema"+c:""+s,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";x=n;return n=C.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+x+"]); ":n+=" validate.errors = ["+x+"]; return false; ":n+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",u&&(n+=" else { "),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,n=" ",o=e.level,a=e.dataLevel,s=e.schema[t],c=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&s&&s.$data;h?(n+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",i="schema"+o):i=s,n+="if ( ",h&&(n+=" ("+i+" !== undefined && typeof "+i+" != 'number') || "),n+=" "+d+".length "+("maxItems"==t?">":"<")+" "+i+") { ";var m=t,p=p||[];p.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(m||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+i+" } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT have ",n+="maxItems"==t?"more":"fewer",n+=" than ",n+=h?"' + "+i+" + '":""+s,n+=" items' "),e.opts.verbose&&(n+=" , schema:  ",n+=h?"validate.schema"+c:""+s,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var f=n;return n=p.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+f+"]); ":n+=" validate.errors = ["+f+"]; return false; ":n+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",u&&(n+=" else { "),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,n=" ",o=e.level,a=e.dataLevel,s=e.schema[t],c=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&s&&s.$data;h?(n+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",i="schema"+o):i=s;var m="maxLength"==t?">":"<";n+="if ( ",h&&(n+=" ("+i+" !== undefined && typeof "+i+" != 'number') || "),!1===e.opts.unicode?n+=" "+d+".length ":n+=" ucs2length("+d+") ",n+=" "+m+" "+i+") { ";var p=t,f=f||[];f.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(p||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+i+" } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT be ",n+="maxLength"==t?"longer":"shorter",n+=" than ",n+=h?"' + "+i+" + '":""+s,n+=" characters' "),e.opts.verbose&&(n+=" , schema:  ",n+=h?"validate.schema"+c:""+s,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var g=n;return n=f.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+g+"]); ":n+=" validate.errors = ["+g+"]; return false; ":n+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",u&&(n+=" else { "),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,n=" ",o=e.level,a=e.dataLevel,s=e.schema[t],c=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&s&&s.$data;h?(n+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",i="schema"+o):i=s,n+="if ( ",h&&(n+=" ("+i+" !== undefined && typeof "+i+" != 'number') || "),n+=" Object.keys("+d+").length "+("maxProperties"==t?">":"<")+" "+i+") { ";var m=t,p=p||[];p.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(m||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+i+" } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT have ",n+="maxProperties"==t?"more":"fewer",n+=" than ",n+=h?"' + "+i+" + '":""+s,n+=" properties' "),e.opts.verbose&&(n+=" , schema:  ",n+=h?"validate.schema"+c:""+s,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var f=n;return n=p.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+f+"]); ":n+=" validate.errors = ["+f+"]; return false; ":n+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",u&&(n+=" else { "),n}},function(e){e.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(493),n=r(494),o=r(495),a=r(496),s=r(497),c=r(21),l={defaultColor:"#1EE0FF",defaultAlpha:1,hoverColor:"#1EE0FF",hoverAlpha:1,selectColor:"#FCDB7F",selectAlpha:1,selectHoverColor:"#FCDB7F",selectHoverAlpha:1};t.geoJsonTheme={name:"geojson",styles:[{when:"type == 'invisibleMarker'",renderOrder:2201,technique:"fill",attr:{color:"#000",transparent:!0,opacity:0}},{when:"type == 'polygon'",renderOrder:2200,technique:"fill",attr:{color:"#1EE0FF",transparent:!0,opacity:.2}},{when:`type == 'point' && mode == 'circleCenter' && units == ${c.Units.pixels}`,renderOrder:2203,technique:"shader",attr:{params:i.default(c.Units.pixels),primitive:"point"}},{when:`type == 'point' && mode == 'circleCenter' && units == ${c.Units.meters}`,renderOrder:2203,technique:"shader",attr:{params:i.default(c.Units.meters),primitive:"point",userData:{minRadius:6}}},{when:"type == 'point' && mode == 'markerPoint'",renderOrder:2203,technique:"shader",attr:{params:n.default(),userData:{marker:!0,defaultColor:"#1EE0FF",selectColor:"#FCDB7F",hoverColor:"#1EE0FF",selectHoverColor:"#FCDB7F"},primitive:"point"}},{when:"type == 'point' && mode == 'customIcon'",renderOrder:2203,technique:"shader",attr:{params:s.default(),userData:{defaultColor:"#000000",hoverColor:"#000000",selectColor:"#FCDB7F",selectHoverColor:"#FCDB7F"},primitive:"point"}},{when:`type == 'invisible-line' && units == ${c.Units.meters}`,renderOrder:2203,technique:"segments",attr:{color:"rgb(0, 255, 0)",userData:{lineWidth:1,lineWidthUnits:c.Units.meters},visible:!1}},{when:`type == 'invisible-line' && units == ${c.Units.pixels}`,renderOrder:2203,technique:"segments",attr:{color:"rgb(255, 0, 0)",userData:{lineWidth:1,lineWidthUnits:c.Units.pixels},visible:!1}},{when:"type == 'polygonFillShader'",renderOrder:2200,technique:"shader",attr:Object.assign(Object.assign({},l),{id:"polygonFillShader",defaultAlpha:.2,hoverAlpha:.4,selectAlpha:.2,selectHoverAlpha:.4,params:o.default,primitive:"mesh"})},{when:"type == 'polygonBorder'",renderOrder:2202,technique:"solid-line",attr:{id:"line-shader",lineWidth:1,userData:Object.assign(Object.assign({},l),{scaleByHover:!1})}},{when:"type == 'thin-line'",renderOrder:2202,technique:"shader",attr:Object.assign(Object.assign({id:"segment-shader"},l),{params:a.default,primitive:"segments"})},{when:`type == 'lineShader' && units == ${c.Units.meters}`,renderOrder:2202,technique:"solid-line",attr:{id:"line-shader",lineWidth:2,lineMinWidth:1,userData:Object.assign(Object.assign({},l),{scaleByHover:!0,lineWidthUnits:c.Units.meters})}},{when:"type == 'lineShader'",renderOrder:2202,technique:"solid-line",attr:{id:"line-shader",lineWidth:2,userData:Object.assign(Object.assign({},l),{scaleByHover:!0})}}]}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i=r(246),n=r(25);function o(e,t){var r=[];if("FeatureCollection"===e.type)for(var i=0;i<e.features.length;i++)a(r,e.features[i],t,i);else"Feature"===e.type?a(r,e,t):a(r,{geometry:e},t);return r}function a(e,t,r,i){if(t.geometry){var o=t.geometry.coordinates,u=t.geometry.type,d=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),h=[],m=t.id;if(r.promoteId?m=t.properties[r.promoteId]:r.generateId&&(m=i||0),"Point"===u)s(o,h);else if("MultiPoint"===u)for(var p=0;p<o.length;p++)s(o[p],h);else if("LineString"===u)c(o,h,d,!1);else if("MultiLineString"===u){if(r.lineMetrics){for(p=0;p<o.length;p++)h=[],c(o[p],h,d,!1),e.push(Object(n.a)(m,"LineString",h,t.properties));return}l(o,h,d,!1)}else if("Polygon"===u)l(o,h,d,!0);else{if("MultiPolygon"!==u){if("GeometryCollection"===u){for(p=0;p<t.geometry.geometries.length;p++)a(e,{id:m,geometry:t.geometry.geometries[p],properties:t.properties},r,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(p=0;p<o.length;p++){var f=[];l(o[p],f,d,!0),h.push(f)}}e.push(Object(n.a)(m,u,h,t.properties))}}function s(e,t){t.push(u(e[0])),t.push(d(e[1])),t.push(0)}function c(e,t,r,n){for(var o,a,s=0,c=0;c<e.length;c++){var l=u(e[c][0]),h=d(e[c][1]);t.push(l),t.push(h),t.push(0),c>0&&(s+=n?(o*h-l*a)/2:Math.sqrt(Math.pow(l-o,2)+Math.pow(h-a,2))),o=l,a=h}var m=t.length-3;t[2]=1,Object(i.a)(t,0,m,r),t[m+2]=1,t.size=Math.abs(s),t.start=0,t.end=t.size}function l(e,t,r,i){for(var n=0;n<e.length;n++){var o=[];c(e[n],o,r,i),t.push(o)}}function u(e){return e/360+.5}function d(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}},function(e,t,r){"use strict";function i(e,t,r,o){for(var a,s=o,c=r-t>>1,l=r-t,u=e[t],d=e[t+1],h=e[r],m=e[r+1],p=t+3;p<r;p+=3){var f=n(e[p],e[p+1],u,d,h,m);if(f>s)a=p,s=f;else if(f===s){var g=Math.abs(p-c);g<l&&(a=p,l=g)}}s>o&&(a-t>3&&i(e,t,a,o),e[a+2]=s,r-a>3&&i(e,a,r,o))}function n(e,t,r,i,n,o){var a=n-r,s=o-i;if(0!==a||0!==s){var c=((e-r)*a+(t-i)*s)/(a*a+s*s);c>1?(r=n,i=o):c>0&&(r+=a*c,i+=s*c)}return(a=e-r)*a+(s=t-i)*s}r.d(t,"a",(function(){return i}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i=r(13),n=r(25);function o(e,t){var r=t.buffer/t.extent,n=e,o=Object(i.a)(e,1,-1-r,r,0,-1,2,t),s=Object(i.a)(e,1,1-r,2+r,0,-1,2,t);return(o||s)&&(n=Object(i.a)(e,1,-r,1+r,0,-1,2,t)||[],o&&(n=a(o,1).concat(n)),s&&(n=n.concat(a(s,-1)))),n}function a(e,t){for(var r=[],i=0;i<e.length;i++){var o,a=e[i],c=a.type;if("Point"===c||"MultiPoint"===c||"LineString"===c)o=s(a.geometry,t);else if("MultiLineString"===c||"Polygon"===c){o=[];for(var l=0;l<a.geometry.length;l++)o.push(s(a.geometry[l],t))}else if("MultiPolygon"===c)for(o=[],l=0;l<a.geometry.length;l++){for(var u=[],d=0;d<a.geometry[l].length;d++)u.push(s(a.geometry[l][d],t));o.push(u)}r.push(Object(n.a)(a.id,c,o,a.tags))}return r}function s(e,t){var r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(var i=0;i<e.length;i+=3)r.push(e[i]+t,e[i+1],e[i+2]);return r}},function(e,t,r){"use strict";function i(e,t,r,i,o){for(var a=t===o.maxZoom?0:o.tolerance/((1<<t)*o.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:i,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},c=0;c<e.length;c++){s.numFeatures++,n(s,e[c],a,o);var l=e[c].minX,u=e[c].minY,d=e[c].maxX,h=e[c].maxY;l<s.minX&&(s.minX=l),u<s.minY&&(s.minY=u),d>s.maxX&&(s.maxX=d),h>s.maxY&&(s.maxY=h)}return s}function n(e,t,r,i){var n=t.geometry,a=t.type,s=[];if("Point"===a||"MultiPoint"===a)for(var c=0;c<n.length;c+=3)s.push(n[c]),s.push(n[c+1]),e.numPoints++,e.numSimplified++;else if("LineString"===a)o(s,n,e,r,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(c=0;c<n.length;c++)o(s,n[c],e,r,"Polygon"===a,0===c);else if("MultiPolygon"===a)for(var l=0;l<n.length;l++){var u=n[l];for(c=0;c<u.length;c++)o(s,u[c],e,r,!0,0===c)}if(s.length){var d=t.tags||null;if("LineString"===a&&i.lineMetrics){for(var h in d={},t.tags)d[h]=t.tags[h];d.mapbox_clip_start=n.start/n.size,d.mapbox_clip_end=n.end/n.size}var m={geometry:s,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:d};null!==t.id&&(m.id=t.id),e.features.push(m)}}function o(e,t,r,i,n,o){var a=i*i;if(i>0&&t.size<(n?a:i))r.numPoints+=t.length/3;else{for(var s=[],c=0;c<t.length;c+=3)(0===i||t[c+2]>a)&&(r.numSimplified++,s.push(t[c]),s.push(t[c+1])),r.numPoints++;n&&function(e,t){for(var r=0,i=0,n=e.length,o=n-2;i<n;o=i,i+=2)r+=(e[i]-e[o])*(e[i+1]+e[o+1]);if(r>0===t)for(i=0,n=e.length;i<n/2;i+=2){var a=e[i],s=e[i+1];e[i]=e[n-2-i],e[i+1]=e[n-1-i],e[n-2-i]=a,e[n-1-i]=s}}(s,o),e.push(s)}}r.d(t,"a",(function(){return i}))},function(e,t,r){"use strict";var i=r(15),n=r(5),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function(e,t){for(var r=Object.getOwnPropertyNames(t),i=0;i<r.length;i++){var n=r[i],o=Object.getOwnPropertyDescriptor(t,n);o&&o.configurable&&void 0===e[n]&&Object.defineProperty(e,n,o)}}(e,t))}var s=function(e){function t(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return n.data=r||{},n.options=i,n}return a(t,e),t.prototype.addNamespaces=function(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)},t.prototype.removeNamespaces=function(e){var t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)},t.prototype.getResource=function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=i.keySeparator||this.options.keySeparator;void 0===o&&(o=".");var a=[e,t];return r&&"string"!=typeof r&&(a=a.concat(r)),r&&"string"==typeof r&&(a=a.concat(o?r.split(o):r)),e.indexOf(".")>-1&&(a=e.split(".")),n.d(this.data,a)},t.prototype.addResource=function(e,t,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},a=this.options.keySeparator;void 0===a&&(a=".");var s=[e,t];r&&(s=s.concat(a?r.split(a):r)),e.indexOf(".")>-1&&(i=t,t=(s=e.split("."))[1]),this.addNamespaces(t),n.h(this.data,s,i),o.silent||this.emit("added",e,t,r,i)},t.prototype.addResources=function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var n in r)"string"==typeof r[n]&&this.addResource(e,t,n,r[n],{silent:!0});i.silent||this.emit("added",e,t,r)},t.prototype.addResourceBundle=function(e,t,r,i,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},c=[e,t];e.indexOf(".")>-1&&(i=r,r=t,t=(c=e.split("."))[1]),this.addNamespaces(t);var l=n.d(this.data,c)||{};i?n.b(l,r,a):l=o({},l,r),n.h(this.data,c,l),s.silent||this.emit("added",e,t,r)},t.prototype.removeResourceBundle=function(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)},t.prototype.hasResourceBundle=function(e,t){return void 0!==this.getResource(e,t)},t.prototype.getResourceBundle=function(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?o({},this.getResource(e,t)):this.getResource(e,t)},t.prototype.toJSON=function(){return this.data},t}(i.a);t.a=s},function(e,t,r){"use strict";var i=r(8);function n(e){return e.charAt(0).toUpperCase()+e.slice(1)}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.whitelist=this.options.whitelist||!1,this.logger=i.a.create("languageUtils")}return e.prototype.getScriptPartFromCode=function(e){if(!e||e.indexOf("-")<0)return null;var t=e.split("-");return 2===t.length?null:(t.pop(),this.formatLanguageCode(t.join("-")))},e.prototype.getLanguagePartFromCode=function(e){if(!e||e.indexOf("-")<0)return e;var t=e.split("-");return this.formatLanguageCode(t[0])},e.prototype.formatLanguageCode=function(e){if("string"==typeof e&&e.indexOf("-")>-1){var t=["hans","hant","latn","cyrl","cans","mong","arab"],r=e.split("-");return this.options.lowerCaseLng?r=r.map((function(e){return e.toLowerCase()})):2===r.length?(r[0]=r[0].toLowerCase(),r[1]=r[1].toUpperCase(),t.indexOf(r[1].toLowerCase())>-1&&(r[1]=n(r[1].toLowerCase()))):3===r.length&&(r[0]=r[0].toLowerCase(),2===r[1].length&&(r[1]=r[1].toUpperCase()),"sgn"!==r[0]&&2===r[2].length&&(r[2]=r[2].toUpperCase()),t.indexOf(r[1].toLowerCase())>-1&&(r[1]=n(r[1].toLowerCase())),t.indexOf(r[2].toLowerCase())>-1&&(r[2]=n(r[2].toLowerCase()))),r.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e},e.prototype.isWhitelisted=function(e){return("languageOnly"===this.options.load||this.options.nonExplicitWhitelist)&&(e=this.getLanguagePartFromCode(e)),!this.whitelist||!this.whitelist.length||this.whitelist.indexOf(e)>-1},e.prototype.getFallbackCodes=function(e,t){if(!e)return[];if("string"==typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];var r=e[t];return r||(r=e[this.getScriptPartFromCode(t)]),r||(r=e[this.formatLanguageCode(t)]),r||(r=e.default),r||[]},e.prototype.toResolveHierarchy=function(e,t){var r=this,i=this.getFallbackCodes(t||this.options.fallbackLng||[],e),n=[],o=function(e){e&&(r.isWhitelisted(e)?n.push(e):r.logger.warn("rejecting non-whitelisted language code: "+e))};return"string"==typeof e&&e.indexOf("-")>-1?("languageOnly"!==this.options.load&&o(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&o(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&o(this.getLanguagePartFromCode(e))):"string"==typeof e&&o(this.formatLanguageCode(e)),i.forEach((function(e){n.indexOf(e)<0&&o(r.formatLanguageCode(e))})),n},e}();t.a=o},function(e,t,r){"use strict";var i=r(8);var n=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","he","hi","hu","hy","ia","it","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","id","ja","jbo","ka","kk","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21}],o={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},5:function(e){return Number(0===e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0===e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0===e||e%100>0&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)}};var a=function(){function e(t){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.languageUtils=t,this.options=a,this.logger=i.a.create("pluralResolver"),this.rules=(r={},n.forEach((function(e){e.lngs.forEach((function(t){r[t]={numbers:e.nr,plurals:o[e.fc]}}))})),r)}return e.prototype.addRule=function(e,t){this.rules[e]=t},e.prototype.getRule=function(e){return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]},e.prototype.needsPlural=function(e){var t=this.getRule(e);return t&&t.numbers.length>1},e.prototype.getPluralFormsOfKey=function(e,t){var r=this,i=[],n=this.getRule(e);return n?(n.numbers.forEach((function(n){var o=r.getSuffix(e,n);i.push(""+t+o)})),i):i},e.prototype.getSuffix=function(e,t){var r=this,i=this.getRule(e);if(i){var n=i.noAbs?i.plurals(t):i.plurals(Math.abs(t)),o=i.numbers[n];this.options.simplifyPluralSuffix&&2===i.numbers.length&&1===i.numbers[0]&&(2===o?o="plural":1===o&&(o=""));var a=function(){return r.options.prepend&&o.toString()?r.options.prepend+o.toString():o.toString()};return"v1"===this.options.compatibilityJSON?1===o?"":"number"==typeof o?"_plural_"+o.toString():a():"v2"===this.options.compatibilityJSON||2===i.numbers.length&&1===i.numbers[0]?a():2===i.numbers.length&&1===i.numbers[0]?a():this.options.prepend&&n.toString()?this.options.prepend+n.toString():n.toString()}return this.logger.warn("no plural rule found for: "+e),""},e}();t.a=a},function(e,t,r){"use strict";var i=r(5),n=r(8),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logger=n.a.create("interpolator"),this.init(t,!0)}return e.prototype.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];t&&(this.options=e,this.format=e.interpolation&&e.interpolation.format||function(e){return e},this.escape=e.interpolation&&e.interpolation.escape||i.c),e.interpolation||(e.interpolation={escapeValue:!0});var r=e.interpolation;this.escapeValue=void 0===r.escapeValue||r.escapeValue,this.prefix=r.prefix?i.g(r.prefix):r.prefixEscaped||"{{",this.suffix=r.suffix?i.g(r.suffix):r.suffixEscaped||"}}",this.formatSeparator=r.formatSeparator?r.formatSeparator:r.formatSeparator||",",this.unescapePrefix=r.unescapeSuffix?"":r.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":r.unescapeSuffix||"",this.nestingPrefix=r.nestingPrefix?i.g(r.nestingPrefix):r.nestingPrefixEscaped||i.g("$t("),this.nestingSuffix=r.nestingSuffix?i.g(r.nestingSuffix):r.nestingSuffixEscaped||i.g(")"),this.maxReplaces=r.maxReplaces?r.maxReplaces:1e3,this.resetRegExp()},e.prototype.reset=function(){this.options&&this.init(this.options)},e.prototype.resetRegExp=function(){var e=this.prefix+"(.+?)"+this.suffix;this.regexp=new RegExp(e,"g");var t=""+this.prefix+this.unescapePrefix+"(.+?)"+this.unescapeSuffix+this.suffix;this.regexpUnescape=new RegExp(t,"g");var r=this.nestingPrefix+"(.+?)"+this.nestingSuffix;this.nestingRegexp=new RegExp(r,"g")},e.prototype.interpolate=function(e,t,r){var n=this,o=void 0,a=void 0,s=void 0;function c(e){return e.replace(/\$/g,"$$$$")}var l=function(e){if(e.indexOf(n.formatSeparator)<0)return i.d(t,e);var o=e.split(n.formatSeparator),a=o.shift().trim(),s=o.join(n.formatSeparator).trim();return n.format(i.d(t,a),s,r)};for(this.resetRegExp(),s=0;(o=this.regexpUnescape.exec(e))&&(a=l(o[1].trim()),e=e.replace(o[0],a),this.regexpUnescape.lastIndex=0,!(++s>=this.maxReplaces)););for(s=0;o=this.regexp.exec(e);){if("string"!=typeof(a=l(o[1].trim()))&&(a=i.e(a)),!a)if("function"==typeof this.options.missingInterpolationHandler){var u=this.options.missingInterpolationHandler(e,o);a="string"==typeof u?u:""}else this.logger.warn("missed to pass in variable "+o[1]+" for interpolating "+e),a="";if(a=this.escapeValue?c(this.escape(a)):c(a),e=e.replace(o[0],a),this.regexp.lastIndex=0,++s>=this.maxReplaces)break}return e},e.prototype.nest=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=void 0,a=void 0,s=o({},r);function c(e,t){if(e.indexOf(",")<0)return e;var r=e.split(",");e=r.shift();var i=r.join(",");i=(i=this.interpolate(i,s)).replace(/'/g,'"');try{s=JSON.parse(i),t&&(s=o({},t,s))}catch(t){this.logger.error("failed parsing options string in nesting for key "+e,t)}return e}for(s.applyPostProcessor=!1;n=this.nestingRegexp.exec(e);){if((a=t(c.call(this,n[1].trim(),s),s))&&n[0]===e&&"string"!=typeof a)return a;"string"!=typeof a&&(a=i.e(a)),a||(this.logger.warn("missed to resolve "+n[1]+" for nesting "+e),a=""),e=e.replace(n[0],a),this.regexp.lastIndex=0}return e},e}();t.a=a},function(e,t,r){"use strict";var i=r(5),n=r(8),o=r(15),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},s=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],i=!0,n=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);i=!0);}catch(e){n=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function(e,t){for(var r=Object.getOwnPropertyNames(t),i=0;i<r.length;i++){var n=r[i],o=Object.getOwnPropertyDescriptor(t,n);o&&o.configurable&&void 0===e[n]&&Object.defineProperty(e,n,o)}}(e,t))}var l=function(e){function t(r,i,o){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return s.backend=r,s.store=i,s.languageUtils=o.languageUtils,s.options=a,s.logger=n.a.create("backendConnector"),s.state={},s.queue=[],s.backend&&s.backend.init&&s.backend.init(o,a.backend,a),s}return c(t,e),t.prototype.queueLoad=function(e,t,r){var i=this,n=[],o=[],a=[],s=[];return e.forEach((function(e){var r=!0;t.forEach((function(t){var a=e+"|"+t;i.store.hasResourceBundle(e,t)?i.state[a]=2:i.state[a]<0||(1===i.state[a]?o.indexOf(a)<0&&o.push(a):(i.state[a]=1,r=!1,o.indexOf(a)<0&&o.push(a),n.indexOf(a)<0&&n.push(a),s.indexOf(t)<0&&s.push(t)))})),r||a.push(e)})),(n.length||o.length)&&this.queue.push({pending:o,loaded:{},errors:[],callback:r}),{toLoad:n,pending:o,toLoadLanguages:a,toLoadNamespaces:s}},t.prototype.loaded=function(e,t,r){var n=this,o=e.split("|"),a=s(o,2),c=a[0],l=a[1];t&&this.emit("failedLoading",c,l,t),r&&this.store.addResourceBundle(c,l,r),this.state[e]=t?-1:2,this.queue.forEach((function(r){i.f(r.loaded,[c],l),function(e,t){for(var r=e.indexOf(t);-1!==r;)e.splice(r,1),r=e.indexOf(t)}(r.pending,e),t&&r.errors.push(t),0!==r.pending.length||r.done||(n.emit("loaded",r.loaded),r.done=!0,r.errors.length?r.callback(r.errors):r.callback())})),this.queue=this.queue.filter((function(e){return!e.done}))},t.prototype.read=function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=this,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:250,a=arguments[5];return e.length?this.backend[r](e,t,(function(s,c){s&&c&&i<5?setTimeout((function(){n.read.call(n,e,t,r,i+1,2*o,a)}),o):a(s,c)})):a(null,{})},t.prototype.load=function(e,t,r){var n=this;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();var o=a({},this.backend.options,this.options.backend);"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"==typeof t&&(t=[t]);var c=this.queueLoad(e,t,r);if(!c.toLoad.length)return c.pending.length||r(),null;o.allowMultiLoading&&this.backend.readMulti?this.read(c.toLoadLanguages,c.toLoadNamespaces,"readMulti",null,null,(function(e,t){e&&n.logger.warn("loading namespaces "+c.toLoadNamespaces.join(", ")+" for languages "+c.toLoadLanguages.join(", ")+" via multiloading failed",e),!e&&t&&n.logger.log("successfully loaded namespaces "+c.toLoadNamespaces.join(", ")+" for languages "+c.toLoadLanguages.join(", ")+" via multiloading",t),c.toLoad.forEach((function(r){var o=r.split("|"),a=s(o,2),c=a[0],l=a[1],u=i.d(t,[c,l]);if(u)n.loaded(r,e,u);else{var d="loading namespace "+l+" for language "+c+" via multiloading failed";n.loaded(r,d),n.logger.error(d)}}))})):c.toLoad.forEach((function(e){n.loadOne(e)}))},t.prototype.reload=function(e,t){var r=this;this.backend||this.logger.warn("No backend was added via i18next.use. Will not load resources.");var n=a({},this.backend.options,this.options.backend);"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"==typeof t&&(t=[t]),n.allowMultiLoading&&this.backend.readMulti?this.read(e,t,"readMulti",null,null,(function(n,o){n&&r.logger.warn("reloading namespaces "+t.join(", ")+" for languages "+e.join(", ")+" via multiloading failed",n),!n&&o&&r.logger.log("successfully reloaded namespaces "+t.join(", ")+" for languages "+e.join(", ")+" via multiloading",o),e.forEach((function(e){t.forEach((function(t){var a=i.d(o,[e,t]);if(a)r.loaded(e+"|"+t,n,a);else{var s="reloading namespace "+t+" for language "+e+" via multiloading failed";r.loaded(e+"|"+t,s),r.logger.error(s)}}))}))})):e.forEach((function(e){t.forEach((function(t){r.loadOne(e+"|"+t,"re")}))}))},t.prototype.loadOne=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=e.split("|"),n=s(i,2),o=n[0],a=n[1];this.read(o,a,"read",null,null,(function(i,n){i&&t.logger.warn(r+"loading namespace "+a+" for language "+o+" failed",i),!i&&n&&t.logger.log(r+"loaded namespace "+a+" for language "+o,n),t.loaded(e,i,n)}))},t.prototype.saveMissing=function(e,t,r,i,n){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.backend&&this.backend.create&&this.backend.create(e,t,r,i,null,a({},o,{isUpdate:n})),e&&e[0]&&this.store.addResource(e[0],t,r,i)},t}(o.a);t.a=l},function(e,t,r){"use strict";var i=r(8),n=r(15),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function(e,t){for(var r=Object.getOwnPropertyNames(t),i=0;i<r.length;i++){var n=r[i],o=Object.getOwnPropertyDescriptor(t,n);o&&o.configurable&&void 0===e[n]&&Object.defineProperty(e,n,o)}}(e,t))}var s=function(e){function t(r,n,o){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return s.cache=r,s.store=n,s.services=o,s.options=a,s.logger=i.a.create("cacheConnector"),s.cache&&s.cache.init&&s.cache.init(o,a.cache,a),s}return a(t,e),t.prototype.load=function(e,t,r){var i=this;if(!this.cache)return r&&r();var n=o({},this.cache.options,this.options.cache),a="string"==typeof e?this.services.languageUtils.toResolveHierarchy(e):e;n.enabled?this.cache.load(a,(function(e,t){if(e&&i.logger.error("loading languages "+a.join(", ")+" from cache failed",e),t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))for(var o in t[n])if(Object.prototype.hasOwnProperty.call(t[n],o)&&"i18nStamp"!==o){var s=t[n][o];s&&i.store.addResourceBundle(n,o,s)}r&&r()})):r&&r()},t.prototype.save=function(){this.cache&&this.options.cache&&this.options.cache.enabled&&this.cache.save(this.store.data)},t}(n.a);t.a=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),self.importScripts("three.min.js");const i=r(256),n=r(116),o=r(234),a=r(498),s=r(500),c=r(501);n.OmvTileDecoderService.start(),new c.SensorDataWorkerClient,new o.GeoJsonWorkerClient,new s.RibWorkerClient,new a.TrafficWorkerClient,i.CoverageTileDecoderService.start()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(12),o=r(4),a=r(32),s=r(0),c=r(316),l=r(115);var u,d;!function(e){e.EXTRACTED_SIZE_MAP="extracted-size-map"}(u=t.InfoRequestType||(t.InfoRequestType={})),function(e){e.BITMAP="bitmap",e.SIZEMAP="sizemap"}(d=t.CoverageImageType||(t.CoverageImageType={}));class h{constructor(e){this.m_config=e,this.m_geometries=[],this.m_tempLineVertices=new Float32Array(24).fill(0),this.m_tempFillVertices=new Float32Array(18).fill(0),this.m_tempTileBounds=new s.Box3,this.GRID_VERTEX_DATA=new Uint8Array([0,0,1,1,2,2,3,3]);const t=this.m_config.tilingScheme.getGeoBox(e.tileKey),r=this.m_config.projection.projectBox(t,new s.Box3);this.m_center=new s.Vector3,r.getCenter(this.m_center)}getDecodedTile(e){return this.createHeatmapGeometry(e.tileKeys,e.sizemapData,e.timemapData,e.dataLevel),e.drawStaticObject||this.createTileGrid(e.tileKeys),{geometries:this.m_geometries,techniques:this.m_config.styleSetEvaluator.techniques}}createTileGrid(e){const t=new Float32Array(24*e.length),r=new Float32Array(18*e.length),a=new Uint16Array(24*e.length),s=new Uint16Array(18*e.length),c=new Uint8Array(8*e.length),l=new Uint16Array(3);e.forEach((e,i)=>{const n=o.TileKey.fromMortonCode(e),u=this.getTileBounds(n);t.set(this.getLineVertices(u),24*i),r.set(this.getFillVertices(u),18*i),l[0]=n.row,l[1]=n.column,l[2]=n.level;for(let e=0;e<8;e++)a.set(l,24*i+3*e);for(let e=0;e<6;e++)s.set(l,18*i+3*e);c.set(this.GRID_VERTEX_DATA,8*i)});const u=this.m_config.styleSetEvaluator.getMatchingTechniques(new n.MapEnv({type:"coverageGrid"}));if(u.length){const e=u[0]._index;if(void 0===e)throw new Error("Internal error - No technique index for the 'coverageGrid'");this.m_geometries.push({type:i.GeometryType.Line,uuid:`${this.m_config.tileKey.mortonCode()}-grid`,vertexAttributes:[{name:"position",buffer:t.buffer,type:"float",itemCount:3},{name:"tileKeyData",buffer:a.buffer,type:"uint16",itemCount:3,normalized:!1},{name:"vertexData",buffer:c.buffer,type:"uint8",itemCount:1,normalized:!1}],groups:[{start:0,count:0,technique:e,createdOffsets:[]}],tileCode:this.m_config.tileKey.mortonCode()})}const d=this.m_config.styleSetEvaluator.getMatchingTechniques(new n.MapEnv({type:"coverageFill"}));if(d.length){const e=d[0]._index;if(void 0===e)throw new Error("Internal error - No technique index for the 'coverageFill'");this.m_geometries.push({type:i.GeometryType.Polygon,uuid:`${this.m_config.tileKey.mortonCode()}-fill`,vertexAttributes:[{name:"position",buffer:r.buffer,type:"float",itemCount:3},{name:"tileKeyData",buffer:s.buffer,type:"uint16",itemCount:3,normalized:!1}],groups:[{start:0,count:0,technique:e,createdOffsets:[]}],tileCode:this.m_config.tileKey.mortonCode()})}}getTileBounds(e){const t=this.m_config.tilingScheme.getGeoBox(e),r=this.m_config.projection.projectBox(t,this.m_tempTileBounds);return r.min.sub(this.m_center),r.max.sub(this.m_center),r}getLineVertices(e){return this.m_tempLineVertices[0]=e.min.x,this.m_tempLineVertices[1]=e.min.y,this.m_tempLineVertices[3]=e.max.x,this.m_tempLineVertices[4]=e.min.y,this.m_tempLineVertices[6]=e.max.x,this.m_tempLineVertices[7]=e.min.y,this.m_tempLineVertices[9]=e.max.x,this.m_tempLineVertices[10]=e.max.y,this.m_tempLineVertices[12]=e.max.x,this.m_tempLineVertices[13]=e.max.y,this.m_tempLineVertices[15]=e.min.x,this.m_tempLineVertices[16]=e.max.y,this.m_tempLineVertices[18]=e.min.x,this.m_tempLineVertices[19]=e.max.y,this.m_tempLineVertices[21]=e.min.x,this.m_tempLineVertices[22]=e.min.y,this.m_tempLineVertices}getFillVertices(e){return this.m_tempFillVertices[0]=e.min.x,this.m_tempFillVertices[1]=e.min.y,this.m_tempFillVertices[3]=e.max.x,this.m_tempFillVertices[4]=e.min.y,this.m_tempFillVertices[6]=e.max.x,this.m_tempFillVertices[7]=e.max.y,this.m_tempFillVertices[9]=e.max.x,this.m_tempFillVertices[10]=e.max.y,this.m_tempFillVertices[12]=e.min.x,this.m_tempFillVertices[13]=e.max.y,this.m_tempFillVertices[15]=e.min.x,this.m_tempFillVertices[16]=e.min.y,this.m_tempFillVertices}createHeatmapGeometry(e,t,r,a){if(0===e.length)return;let s,l,u=!1,d=!1;const h=o.TileKey.fromMortonCode(e[0]).level,m=new o.TileKey(0,0,h).mortonCode();void 0!==t&&void 0!==t[h]&&(s=t[h].heatMap,void 0!==t[h].min&&t[h].min===t[h].max&&(u=!0)),void 0!==r&&void 0!==r[h]&&(l=r[h].heatMap,void 0!==r[h].min&&r[h].min===r[h].max&&(d=!0));let p=0;h===a&&(p=c.CoverageDataSource.getTileKeysOnLevel(this.m_config.tileKey,o.TileKey.fromMortonCode(e[0]).level)[0].mortonCode()-m);const f=new Float32Array(18*e.length),g=new Uint8Array(6*e.length).fill(255),y=new Uint8Array(6*e.length).fill(255),v=new Uint16Array(18*e.length).fill(0);e.forEach((e,t)=>{const r=o.TileKey.fromMortonCode(e),i=this.getTileBounds(r),n=this.getFillVertices(i);if(f.set(n,18*t),void 0!==s&&!u){const r=s[e-m-p];y.fill(r,6*t,6*t+6)}if(void 0!==l&&!d){const r=l[e-m];g.fill(r,6*t,6*t+6)}v[18*t+0]=r.row,v[18*t+1]=r.column,v[18*t+2]=r.level});const _=[];_.push({name:"position",buffer:f.buffer,type:"float",itemCount:3}),y.length>0&&_.push({name:"sizeData",buffer:y.buffer,type:"uint8",itemCount:1,normalized:!1}),g.length>0&&_.push({name:"timeData",buffer:g.buffer,type:"uint8",itemCount:1,normalized:!1}),_.push({name:"tileKeyData",buffer:v.buffer,type:"uint16",itemCount:3,normalized:!1});const b=this.m_config.styleSetEvaluator.getMatchingTechniques(new n.MapEnv({type:"heatmap"}));if(b.length){const e=b[0]._index;if(void 0===e)throw new Error("Internal error - No technique index for the 'heatmap'");this.m_geometries.push({uuid:`${this.m_config.tileKey.mortonCode()}-heatmap`,type:i.GeometryType.Polygon,vertexAttributes:_,groups:[{start:0,count:0,technique:e,createdOffsets:[]}],tileCode:0})}}}class m extends a.ThemedTileDecoder{constructor(){super(...arguments),this.m_isDataExtracted=new Map,this.m_imageData=new Map,this.m_imageDataLevel=new Map}async connect(){}async decodeTile(e,t,r){const i=e,a=o.TileKey.fromMortonCode(i.tileKeys[0]).level;if(!0===i.drawStaticObject&&i.tileKeys.length){let e,r;if(4===t.mortonCode()&&11===a)e=m.MORTON_CODE_4_SUB_TILES_FROM,r=m.MORTON_CODE_4_SUB_TILES_TO;else if(5===t.mortonCode()&&11===a)e=m.MORTON_CODE_5_SUB_TILES_FROM,r=m.MORTON_CODE_5_SUB_TILES_TO;else{c.CoverageDataSource.getTileKeysOnLevel(t,a).forEach(t=>{const i=t.mortonCode();(void 0===e||i<e)&&(e=i),(void 0===r||i>r)&&(r=i)})}const n=[],s=this.m_imageData.get(d.BITMAP),l=this.m_imageDataLevel.get(d.BITMAP);if(void 0!==s&&void 0!==l&&void 0!==e&&void 0!==r){const t=o.hereTilingScheme.subdivisionScheme.getLevelDimensionX(l),i=o.hereTilingScheme.subdivisionScheme.getLevelDimensionY(l);for(let a=e;a<=r;a++){const e=o.TileKey.fromMortonCode(a);255===s[e.column+(i-e.row-1)*t]&&n.push(a)}}i.tileKeys=n}const s=JSON.parse(JSON.stringify(l.coverageTheme)),u=new n.StyleSetEvaluator(s.styles);return this.decodeThemedTile(i,t,u,r)}async decodeThemedTile(e,t,r,i){return new h({tileKey:t,projection:i,styleSetEvaluator:r,tilingScheme:o.hereTilingScheme}).getDecodedTile(e)}async getTileInfo(e,t,r){if(!1===this.m_isDataExtracted.get(d.SIZEMAP)){const e=this.m_imageData.get(d.SIZEMAP),t=this.m_imageDataLevel.get(d.SIZEMAP);void 0!==e&&void 0!==t&&(this.extractSizeMapData(e,t),this.m_isDataExtracted.set(d.SIZEMAP,!0))}let i;return this.isCoverageTileInfoRequest(e)?e.requestType===u.EXTRACTED_SIZE_MAP&&(i={setupTime:0,numBytes:0,tileKey:t,transferList:this.m_extractedSizeMapData?[this.m_extractedSizeMapData.buffer]:void 0}):i=await super.getTileInfo(e,t,r),i}configure(e,t,r,i){super.configure(e,t,r,i),void 0!==i&&(this.m_imageData.set(i.imageType,i.imageData),this.m_imageDataLevel.set(i.imageType,i.imageDataLevel),this.m_isDataExtracted.set(i.imageType,!1))}isCoverageTileInfoRequest(e){return"requestType"in e}extractSizeMapData(e,t){const r=new o.TileKey(0,0,t).mortonCode(),i=o.hereTilingScheme.subdivisionScheme.getLevelDimensionX(t),n=o.hereTilingScheme.subdivisionScheme.getLevelDimensionY(t),a=new o.TileKey(n,i,t).mortonCode();this.m_extractedSizeMapData=new Uint8ClampedArray(a-r),e.forEach((e,a)=>{let s=0;a>0&&(s=Math.floor(a/i));const c=a-s*i;this.m_extractedSizeMapData[o.TileKey.fromRowColumnLevel(n-s-1,c,t).mortonCode()-r]=255-e})}}t.CoverageTileDecoder=m,m.MORTON_CODE_4_SUB_TILES_FROM=4194304,m.MORTON_CODE_4_SUB_TILES_TO=5242879,m.MORTON_CODE_5_SUB_TILES_FROM=5242880,m.MORTON_CODE_5_SUB_TILES_TO=6291455;t.CoverageTileDecoderService=class{static start(){a.WorkerServiceManager.getInstance().register({serviceType:"coverage-tile-decoder",factory:e=>a.TileDecoderService.start(e,new m)})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t=new Array){this.priority=e,this.elements=t}clone(){return new i(this.priority,this.elements.slice())}}t.PriorityListGroup=i;t.GroupedPriorityList=class{constructor(){this.groups=new Map}add(e){this.getGroup(e.priority).elements.push(e)}remove(e){const t=this.getGroup(e.priority);if(void 0!==t){const r=t.elements.indexOf(e);if(r>=0){if(t.elements.splice(r,1),0===t.elements.length){const t=Math.floor(e.priority);this.groups.delete(t),this.m_sortedGroups&&(this.m_sortedGroups=[])}return!0}}return!1}clear(){this.groups.clear(),this.m_sortedGroups&&(this.m_sortedGroups=[])}merge(e){for(const t of e.groups){const e=this.findGroup(t[1].priority);void 0!==e?e.elements=e.elements.concat(t[1].elements):(this.groups.set(Math.floor(t[1].priority),t[1].clone()),this.m_sortedGroups&&(this.m_sortedGroups=[]))}return this}get sortedGroups(){if(this.m_sortedGroups&&this.m_sortedGroups.length>0)return this.m_sortedGroups;this.m_sortedGroups||(this.m_sortedGroups=[]);for(const e of this.groups)this.m_sortedGroups.push(e[1]);return this.m_sortedGroups.sort((e,t)=>t.priority-e.priority),this.m_sortedGroups}forEach(e){for(const t of this.groups)t[1].elements.forEach(e)}count(){let e=0;for(const t of this.groups)e+=t[1].elements.length;return e}findGroup(e){const t=Math.floor(e);return this.groups.get(t)}getGroup(e){let t=this.findGroup(e);if(void 0===t){const r=Math.floor(e);t=new i(r),this.groups.set(r,t),this.m_sortedGroups&&(this.m_sortedGroups=[])}return t}}},function(e,t,r){"use strict";function i(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),i(r(126)),i(r(79)),i(r(127)),i(r(259)),i(r(261)),i(r(128))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(260);t.LoggerManager=class{static get instance(){return this.m_instance||(this.m_instance=new i.LoggerManagerImpl)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(126),n=r(127),o=r(128);t.LoggerManagerImpl=class{constructor(){this.m_loggers=[],this.channel="undefined"==typeof self||void 0!==self.document?new i.ConsoleChannel:new o.WorkerChannel}getLoggerNames(){return this.m_loggers.map(e=>e.name)}getLogger(e){return this.m_loggers.find(t=>t.name===e)}create(e,t={}){void 0!==this.m_levelSetForAll&&(void 0===t.level||t.level<this.m_levelSetForAll)&&(t.level=this.m_levelSetForAll);const r=new n.Logger(e,this.channel,t);return this.m_loggers.push(r),r}dispose(e){const t=this.m_loggers.indexOf(e);if(t<0)throw new Error(`Cannot unregister "${e}" : no such logger registered.`);this.m_loggers.splice(t,1)}updateAll(e){for(const t of this.m_loggers)t.update(e)}update(e,t){for(const r of this.m_loggers)r.name===e&&r.update(t)}enableAll(e){for(const t of this.m_loggers)t.enabled=e}enable(e,t){this.update(e,{enabled:t})}setLogLevelForAll(e){this.m_levelSetForAll=e;for(const t of this.m_loggers)t.level=e}setLogLevel(e,t){this.update(e,{level:t})}setChannel(e){this.channel=e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MultiChannel=class{constructor(...e){this.channels=[],this.channels=e}error(e,...t){for(const r of this.channels)r.error(e,...t)}debug(e,...t){for(const r of this.channels)r.debug(e,...t)}info(e,...t){for(const r of this.channels)r.info(e,...t)}log(e,...t){for(const r of this.channels)r.log(e,...t)}trace(e,...t){for(const r of this.channels)r.trace(e,...t)}warn(e,...t){for(const r of this.channels)r.warn(e,...t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){function t(e,t,r,i){return(e-r)*(e-r)+(t-i)*(t-i)}e.Box=class{constructor(e=0,t=0,r=0,i=0){this.x=e,this.y=t,this.w=r,this.h=i}set(e,t,r,i){this.x=e,this.y=t,this.w=r,this.h=i}contains(e,t){return this.x<=e&&this.x+this.w>=e&&this.y<=t&&this.y+this.h>=t}intersects(e){return this.x<=e.x+e.w&&this.x+this.w>=e.x&&this.y<=e.y+e.h&&this.y+this.h>=e.y}},e.distSquared=t,e.computeSquaredLineLength=function(e){let t=0;const r=e.length-4;for(let i=0;i<r;i+=3){const r=e[i+3]-e[i],n=e[i+4]-e[i+1];t+=r*r+n*n}return t},e.distToSegmentSquared=function(e,r,i,n,o,a){const s=t(i,n,o,a);if(0===s)return t(e,r,i,n);let c=((e-i)*(o-i)+(r-n)*(a-n))/s;return t(e,r,i+(c=Math.max(0,Math.min(1,c)))*(o-i),n+c*(a-n))}}(t.Math2D||(t.Math2D={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){function t(e,t,r){return e<t?t:e>r?r:e}e.clamp=t,e.lerp=function(e,t,r){return e*(1-r)+t*r},e.smoothStep=function(e,r,i){return(i=t((i-e)/(r-e),0,1))*i*(3-2*i)},e.smootherStep=function(e,r,i){return(i=t((i-e)/(r-e),0,1))*i*i*(i*(6*i-15)+10)},e.map=function(e,t,r,i,n){return(e-t)*(n-i)/(r-t)+i},e.min2=function(e,t){let r;return void 0!==e&&(r=e),void 0!==t&&(r=void 0===r?t:Math.min(r,t)),r},e.max2=function(e,t){let r;return void 0!==e&&(r=e),void 0!==t&&(r=void 0===r?t:Math.max(r,t)),r},e.isClamped=function(e,t,r){return!(void 0!==t&&e<t)&&!(void 0!==r&&e>r)},e.easeInOutCubic=function(e,t,r){return e+(t-e)*(r<.5?4*r*r*r:(r-1)*(2*r-2)*(2*r-2)+1)}}(t.MathUtils||(t.MathUtils={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyMixins=function(e,t){t.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(r=>{e.prototype[r]=t.prototype[r]})})},t.applyMixinsWithoutProperties=function(e,t){t.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(r=>{const i=Object.getOwnPropertyDescriptor(t.prototype,r);void 0!==i&&void 0===i.get&&(e.prototype[r]=t.prototype[r])})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=!0;t.assert=function(e,t){if(!i&&!e)throw new Error(void 0!==t?t:"ASSERTION failed")},t.assertExists=function(e,t){if(!i&&null==e)throw new Error(void 0!==t?t:"ASSERTION failed: Element is undefined or null");return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ContextLogger=class{constructor(e,t){this.m_logger=e,this.headerMessage=t,this.context=[],this.m_headerLogged=!1,this.warn=this.createLogMethod("warn"),this.info=this.createLogMethod("info"),this.error=this.createLogMethod("error")}pushAttr(e){this.context.push(`${this.context.length>0?".":""}${e}`)}pushIndex(e){this.context.push(`[${e}]`)}pop(){this.context.pop()}createLogMethod(e){return(t,...r)=>{this.m_headerLogged||(this.m_logger.info(this.headerMessage),this.m_headerLogged=!0),this.m_logger[e](`${this.context.join("")}: ${t}`,...r)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{static now(){return i.nowFunc()}static getNowFunc(){return"undefined"!=typeof performance&&void 0!==performance.now?()=>performance.now():()=>(new Date).getTime()}}t.PerformanceTimer=i,i.instance=new i,i.nowFunc=i.getNowFunc()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cloneDeep=function(e){const t=new Map,r=function e(r){if(null===r)return null;if("object"==typeof r){const i=t.get(r);if(void 0!==i)return i;if(Array.isArray(r)){const i=[];t.set(r,i),i.length=r.length;for(let t=0;t<i.length;++t)i[t]=e(r[t]);return i}if(r instanceof Date){const e=new Date(r.getTime());return t.set(r,e),e}if(r instanceof RegExp){const e=new RegExp(r.source,r.flags);return t.set(r,e),e}if(r.constructor!==Object)throw new Error("cloneDeep doesn't support objects with custom prototypes");{const i={};t.set(r,i);for(const t in r)r.hasOwnProperty(t)&&(i[t]=e(r[t]));return i}}return r}(e);return t.clear(),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOptionValue=function(...e){for(const t of e)if(null!=t)return t},t.mergeWithOptions=function(e,t){const r=Object.assign({},e);if(null==t)return r;for(const i in e)if(e.hasOwnProperty(i)){const e=t[i];null!=e&&(r[i]=e)}return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(80);t.PrefixMapUriResolver=class{constructor(e){this.definitions=e}resolveUri(e){return Object.keys(this.definitions).reduce((e,t)=>{if(t.endsWith("/")&&e.startsWith(t)){return this.definitions[t]+e.substr(t.length)}return e===t?this.definitions[t]:e},e)}};t.RelativeUriResolver=class{constructor(e){this.parentUri=e}resolveUri(e){return i.resolveReferenceUri(this.parentUri,e)}},t.composeUriResolvers=function(...e){return{resolveUri:t=>e.reduce((e,t)=>void 0!==t?t.resolveUri(e):e,t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(80);t.getAppBaseUrl=function(){return i.baseUrl(window.location.href)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chainCallbacks=function(e,t){return function(...r){return e&&e.apply(this,r),t.apply(this,r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);class n extends i.Interpolant{constructor(){super(...arguments),this.exponent=2}interpolate_(e,t,r,i){const n=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=s-a,l=Math.pow((r-t)/(i-t),this.exponent),u=1-l;for(let e=0;e!==a;++e)n[e]=o[c+e]*u+o[s+e]*l;return n}}t.ExponentialInterpolant=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){let t,r;e.WORKER_SERVICE_MANAGER_SERVICE_ID="worker-service-manager",function(e){e.Initialized="initialized",e.Request="request",e.Response="response"}(t=e.ServiceMessageName||(e.ServiceMessageName={})),e.isInitializedMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===t.Initialized},function(e){e.CreateService="create-service",e.DestroyService="destroy-service"}(r=e.Requests||(e.Requests={})),e.isUnknownServiceError=function(e){return/unknown targetServiceType requested: /.test(e.message)},e.isRequestMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===t.Request},e.isResponseMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===t.Response}}(t.WorkerServiceProtocol||(t.WorkerServiceProtocol={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){let t;!function(e){e.RegisterIndex="register-index",e.UpdateIndex="update-index",e.TileRequest="tile-request"}(t=e.Requests||(e.Requests={})),e.isRegisterIndexRequest=function(e){return e&&"string"==typeof e.type&&e.type===t.RegisterIndex},e.isUpdateIndexRequest=function(e){return e&&"string"==typeof e.type&&e.type===t.UpdateIndex},e.isTileRequest=function(e){return e&&"string"==typeof e.type&&e.type===t.TileRequest}}(t.WorkerTilerProtocol||(t.WorkerTilerProtocol={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RequestController=class{constructor(e=0,t=new AbortController){this.priority=e,this.abortController=t}get signal(){return this.abortController.signal}abort(){this.abortController.abort()}},function(e){let t,r;!function(e){e.Configuration="configuration"}(t=e.DecoderMessageName||(e.DecoderMessageName={})),e.isConfigurationMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===t.Configuration},function(e){e.DecodeTileRequest="decode-tile-request",e.TileInfoRequest="tile-info-request"}(r=e.Requests||(e.Requests={})),e.isDecodeTileRequest=function(e){return e&&"string"==typeof e.type&&e.type===r.DecodeTileRequest},e.isTileInfoRequest=function(e){return e&&"string"==typeof e.type&&e.type===r.TileInfoRequest}}(t.WorkerDecoderProtocol||(t.WorkerDecoderProtocol={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGeoCoordinatesLike=function(e){return e&&"number"==typeof e.latitude&&"number"==typeof e.longitude&&("number"==typeof e.altitude||void 0===e.altitude)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGeoPointLike=function(e){if(Array.isArray(e)){const[t,r,i]=e;return"number"==typeof t&&"number"==typeof r&&(void 0===i||"number"==typeof i)}return!1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLatLngLike=function(e){return e&&"number"==typeof e.lat&&"number"==typeof e.lng}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(42),n=r(17),o=r(29),a=r(18),s=r(30),c=r(31),l=r(0);class u extends c.Projection{constructor(){super(...arguments),this.type=c.ProjectionType.Planar}getScaleFactor(e){return 1}worldExtent(e,t,r){return r||(r=a.MathUtils.newEmptyBox3()),r.min.x=-Math.PI,r.min.y=.5*-Math.PI,r.min.z=e,r.max.x=Math.PI,r.max.y=.5*Math.PI,r.max.z=t,r}projectPoint(e,t){return t||(t={x:0,y:0,z:0}),t.x=l.Math.degToRad(e.longitude),t.y=l.Math.degToRad(e.latitude),t.z=e.altitude||0,t}unprojectPoint(e){return n.GeoCoordinates.fromRadians(e.y,e.x,e.z)}unprojectAltitude(e){return e.z}projectBox(e,t){t||(t=a.MathUtils.newEmptyBox3());const r=this.projectPoint(new n.GeoCoordinates(e.south,e.west,e.minAltitude)),i=this.projectPoint(new n.GeoCoordinates(e.north,e.east,e.maxAltitude));return o.isBox3Like(t)?(t.min.x=r.x,t.min.y=r.y,t.min.z=r.z,t.max.x=i.x,t.max.y=i.y,t.max.z=i.z):s.isOrientedBox3Like(t)&&(a.MathUtils.newVector3(1,0,0,t.xAxis),a.MathUtils.newVector3(0,1,0,t.yAxis),a.MathUtils.newVector3(0,0,1,t.zAxis),t.position.x=.5*(r.x+i.x),t.position.y=.5*(r.y+i.y),t.position.z=.5*(r.z+i.z),t.extents.x=.5*(i.x-r.x),t.extents.y=.5*(i.y-r.y),t.extents.z=Math.max(Number.EPSILON,.5*(i.z-r.z))),t}unprojectBox(e){const t=this.unprojectPoint(e.min),r=this.unprojectPoint(e.max);return i.GeoBox.fromCoordinates(t,r)}groundDistance(e){return e.z}scalePointToSurface(e){return e.z=0,e}surfaceNormal(e,t){return void 0===t?t={x:0,y:0,z:1}:(t.x=0,t.y=0,t.z=1),t}}t.identityProjection=new u(1)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(17),n=r(29),o=r(18),a=r(30),s=r(28),c=r(56),l=r(31),u=r(0);function d(e){const t=1/Math.PI,r=Math.floor(2*(e*t+1));return u.Math.clamp(r,0,4)}function h(e){return Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)}function m(e,t,r){const i=.5*(r+(e.maxAltitude||0)),n=u.Math.degToRad(e.west),o=u.Math.degToRad(e.east),a=d(n),s=d(o);let c=Math.cos(n),l=c,h=Math.sin(n),m=h;for(let e=a+1;e<=s;e++){const t=(e+1&1)*((2&e)-1);c=Math.min(t,c),l=Math.max(t,l);const r=(1&e)*((2&e)-1);h=Math.min(r,h),m=Math.max(r,m)}const p=Math.cos(o);c=Math.min(p,c),l=Math.max(p,l);const f=Math.sin(o);h=Math.min(f,h);const g=(l+c)*i,y=(l-c)*i,v=((m=Math.max(f,m))+h)*i,_=(m-h)*i,b=u.Math.degToRad(e.south),S=u.Math.degToRad(e.north),T=Math.sin(S),E=Math.sin(b),w=(T+E)*i,C=(T-E)*i;return t.min.x=g-y,t.min.y=v-_,t.min.z=w-C,t.max.x=g+y,t.max.y=v+_,t.max.z=w+C,t}class p extends l.Projection{constructor(){super(...arguments),this.type=l.ProjectionType.Spherical}worldExtent(e,t,r=o.MathUtils.newEmptyBox3()){const i=this.unitScale+t;return r.min.x=-i,r.min.y=-i,r.min.z=-i,r.max.x=i,r.max.y=i,r.max.z=i,r}projectPoint(e,t=o.MathUtils.newVector3(0,0,0)){return function(e,t,r){const i=r+(e.altitude||0),n=u.Math.degToRad(e.latitude),o=u.Math.degToRad(e.longitude),a=Math.cos(n);return t.x=i*a*Math.cos(o),t.y=i*a*Math.sin(o),t.z=i*Math.sin(n),t}(e,t,this.unitScale)}unprojectPoint(e){const t=e.x*e.x+e.y*e.y,r=Math.sqrt(t),n=e.z/r;if(isNaN(n))return i.GeoCoordinates.fromRadians(0,0,-this.unitScale);const o=Math.sqrt(t+e.z*e.z);return i.GeoCoordinates.fromRadians(Math.atan(n),Math.atan2(e.y,e.x),o-this.unitScale)}unprojectAltitude(e){const t=e.x*e.x+e.y*e.y+e.z*e.z;return Math.sqrt(t)-s.EarthConstants.EQUATORIAL_RADIUS}projectBox(e,t=o.MathUtils.newEmptyBox3()){if(n.isBox3Like(t))return m(e,t,this.unitScale);if(a.isOrientedBox3Like(t)){if(e.longitudeSpan>=90){const r=m(e,o.MathUtils.newEmptyBox3(),this.unitScale);return o.MathUtils.newVector3(1,0,0,t.xAxis),o.MathUtils.newVector3(0,1,0,t.yAxis),o.MathUtils.newVector3(0,0,1,t.zAxis),t.position.x=.5*(r.max.x+r.min.x),t.position.y=.5*(r.max.y+r.min.y),t.position.z=.5*(r.max.z+r.min.z),t.extents.x=.5*(r.max.x-r.min.x),t.extents.y=.5*(r.max.y-r.min.y),t.extents.z=.5*(r.max.z-r.min.z),t}const{south:r,west:i,north:n,east:a,center:s}=e,c=s.longitude,l=s.latitude,d=Math.cos(u.Math.degToRad(r)),h=Math.sin(u.Math.degToRad(r)),p=Math.cos(u.Math.degToRad(i)),f=Math.sin(u.Math.degToRad(i)),g=Math.cos(u.Math.degToRad(n)),y=Math.sin(u.Math.degToRad(n)),v=Math.cos(u.Math.degToRad(a)),_=Math.sin(u.Math.degToRad(a)),b=Math.cos(u.Math.degToRad(c)),S=Math.sin(u.Math.degToRad(c)),T=Math.cos(u.Math.degToRad(l)),E=Math.sin(u.Math.degToRad(l));let w,C,x;o.MathUtils.newVector3(b*T,S*T,E,t.zAxis),o.MathUtils.newVector3(-S,b,0,t.xAxis),o.MathUtils.newVector3(-b*E,-S*E,T,t.yAxis),r>=0?(w=Math.abs(d*(b*(f-_)+S*(v-p))),C=T*h-E*d,x=T*y-E*g*(b*v+S*_)):(n<=0?(w=Math.abs(g*(b*(f-_)+S*(v-p))),x=T*y-E*g):(w=Math.abs(b*(f-_)+S*(v-p)),x=T*y-E*g*(S*_+b*v)),C=T*h-E*d*(b*v+S*_));const O=.5*(this.unitScale+(e.maxAltitude||0)),A=.5*(this.unitScale+(e.minAltitude||0)),P=T*(b*v+S*_),R=Math.min(g*P+y*E,d*P+h*E);return o.MathUtils.newVector3(w*O,(x-C)*O,O-R*A,t.extents),o.MathUtils.newVector3(0,(C+x)*O,O+O,t.position),function(e,t,r,i){const n=e.x*i.x+t.x*i.y+r.x*i.z,o=e.y*i.x+t.y*i.y+r.y*i.z,a=e.z*i.x+t.z*i.y+r.z*i.z;i.x=n,i.y=o,i.z=a}(t.xAxis,t.yAxis,t.zAxis,t.position),t.position.x=t.position.x-t.zAxis.x*t.extents.z,t.position.y=t.position.y-t.zAxis.y*t.extents.z,t.position.z=t.position.z-t.zAxis.z*t.extents.z,t}throw new Error("Invalid bounding box")}unprojectBox(e){throw new Error("Method not implemented.")}getScaleFactor(e){return 1}groundDistance(e){return h(e)-this.unitScale}scalePointToSurface(e){const t=this.unitScale/(h(e)||1);return e.x*=t,e.y*=t,e.z*=t,e}surfaceNormal(e,t){void 0===t&&(t={x:0,y:0,z:0});const r=1/(h(e)||1);return t.x=e.x*r,t.y=e.y*r,t.z=e.z*r,t}reprojectPoint(e,t,r){if(e===c.mercatorProjection||e===c.webMercatorProjection){const{x:i,y:n,z:o}=t,a=this.unitScale,s=i/a-Math.PI,l=n/a-Math.PI,u=Math.exp(l),d=u*u,h=2*u/(d+1),m=(d-1)/(d+1),p=a+o;return void 0===r&&(r={}),r.x=Math.cos(s)*h*p,r.y=Math.sin(s)*h*p,r.z=m*p,e===c.webMercatorProjection&&(r.z=-r.z),r}return super.reprojectPoint(e,t,r)}localTangentSpace(e,t){const r=u.Math.degToRad(e.latitude),i=u.Math.degToRad(e.longitude),n=Math.cos(i),a=Math.sin(i),s=Math.cos(r),c=Math.sin(r);return o.MathUtils.newVector3(n*s,a*s,c,t.zAxis),o.MathUtils.newVector3(-a,n,0,t.xAxis),o.MathUtils.newVector3(-n*c,-a*c,s,t.yAxis),this.projectPoint(e,t.position),t}}t.sphereProjection=new p(s.EarthConstants.EQUATORIAL_RADIUS)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(58);t.QuadTree=class{constructor(e){this.tilingScheme=e}visit(e){this.visitTileKey(i.TileKey.fromRowColumnLevel(0,0,0),e)}visitTileKey(e,t){if(t(e,this.tilingScheme.getGeoBox(e)))for(const r of this.tilingScheme.getSubTileKeys(e))this.visitTileKey(r,t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(131),n=r(134),o=r(43);t.hereTilingScheme=new o.TilingScheme(n.halfQuadTreeSubdivisionScheme,i.normalizedEquirectangularProjection)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(56),n=r(57),o=r(43);t.webMercatorTilingScheme=new o.TilingScheme(n.quadTreeSubdivisionScheme,i.webMercatorProjection)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(56),n=r(57),o=r(43);t.mercatorTilingScheme=new o.TilingScheme(n.quadTreeSubdivisionScheme,i.mercatorProjection)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(132),n=r(57),o=r(43);t.polarTilingScheme=new o.TilingScheme(n.quadTreeSubdivisionScheme,i.transverseMercatorProjection)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVector3Like=function(e){return e&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.z}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTransformLike=function(e){const t=e;return void 0!==t.position&&void 0!==t.xAxis&&void 0!==t.yAxis&&void 0!==t.zAxis}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);class n{constructor(e,t,r){this.position=new i.Vector3,this.xAxis=new i.Vector3(1,0,0),this.yAxis=new i.Vector3(0,1,0),this.zAxis=new i.Vector3(0,0,1),this.extents=new i.Vector3,void 0!==e&&this.position.copy(e),void 0!==t&&t.extractBasis(this.xAxis,this.yAxis,this.zAxis),void 0!==r&&this.extents.copy(r)}clone(){const e=new n;return e.copy(this),e}copy(e){this.position.copy(e.position),this.xAxis.copy(e.xAxis),this.yAxis.copy(e.yAxis),this.zAxis.copy(e.zAxis),this.extents.copy(e.extents)}getCenter(e=new i.Vector3){return e.copy(this.position)}getSize(e=new i.Vector3){return e.copy(this.extents).multiplyScalar(2)}getRotationMatrix(e=new i.Matrix4){return e.makeBasis(this.xAxis,this.yAxis,this.zAxis)}intersects(e){const t=Array.isArray(e)?e:e.planes;for(const e of t){const t=Math.abs(e.normal.dot(this.xAxis)*this.extents.x)+Math.abs(e.normal.dot(this.yAxis)*this.extents.y)+Math.abs(e.normal.dot(this.zAxis)*this.extents.z);if(e.distanceToPoint(this.position)+t<0)return!1}return!0}contains(e){const t=e.x-this.position.x,r=e.y-this.position.y,i=e.z-this.position.z,n=Math.abs(t*this.xAxis.x+r*this.xAxis.y+i*this.xAxis.z),o=Math.abs(t*this.yAxis.x+r*this.yAxis.y+i*this.yAxis.z),a=Math.abs(t*this.zAxis.x+r*this.zAxis.y+i*this.zAxis.z);return!(n>this.extents.x||o>this.extents.y||a>this.extents.z)}distanceToPoint(e){return Math.sqrt(this.distanceToPointSquared(e))}distanceToPointSquared(e){const t=new i.Vector3;t.subVectors(e,this.position);const r=[t.dot(this.xAxis),t.dot(this.yAxis),t.dot(this.zAxis)];let n=0;for(let e=0;e<3;++e){const t=r[e],i=this.extents.getComponent(e);if(t<-i){const e=i+t;n+=e*e}else if(t>i){const e=t-i;n+=e*e}}return n}}t.OrientedBox3=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=r(19),o=r(138),a=r(139),s=r(78);var c;!function(e){e[e.Point=0]="Point",e[e.Line=1]="Line",e[e.Polygon=2]="Polygon"}(c=t.FeatureGroupType||(t.FeatureGroupType={}));const l=100;class u{constructor(e,t=5e3){this.featureIds=new Array,this.numFeatures=0,this.numPositions=0,this.featureIds=new Array(t),this.featureIds.length=t,this.techniqueIndex=new Array(t),this.techniqueIndex.length=t,this.textIndex=new Array(t),this.textIndex.length=t,this.positionIndex=new Array(t),this.positionIndex.length=t,this.positions=new Array(10*t),this.positions.length=10*t,e&&(this.layerIndex=new Array(t),this.layerIndex.length=t,this.classIndex=new Array(t),this.classIndex.length=t,this.typeIndex=new Array(t),this.typeIndex.length=t)}getNumBytes(){return 8*(this.featureIds.length+this.techniqueIndex.length+this.textIndex.length+this.positionIndex.length+this.positions.length+(void 0!==this.layerIndex?this.layerIndex.length:0)+(void 0!==this.classIndex?this.classIndex.length:0)+(void 0!==this.typeIndex?this.typeIndex.length:0))}}t.FeatureGroup=u;class d extends u{constructor(){super(...arguments),this.userData=[]}getNumBytes(){return super.getNumBytes()+8*((void 0!==this.segmentIds?this.segmentIds.length:0)+(void 0!==this.segmentStartOffsets?this.segmentStartOffsets.length:0)+(void 0!==this.segmentEndOffsets?this.segmentEndOffsets.length:0))}}t.LineFeatureGroup=d;class h extends u{constructor(e,t=5e3){super(e,t),this.groupNumRings=0,this.outerRingStartIndex=new Array(t),this.outerRingStartIndex.length=t,this.innerRingIsOuterContour=new Array(t),this.innerRingIsOuterContour.length=t,this.innerRingStartIndex=new Array(t),this.innerRingStartIndex.length=t}getNumBytes(){return super.getNumBytes()+8*((void 0!==this.outerRingStartIndex?this.outerRingStartIndex.length:0)+(void 0!==this.innerRingIsOuterContour?this.innerRingIsOuterContour.length:0)+(void 0!==this.innerRingStartIndex?this.innerRingStartIndex.length:0))}}t.PolygonFeatureGroup=h;class m{constructor(e,t){this.tileKey=e,this.textCatalog=new Array,this.techniqueCatalog=new Array,this.setupTime=0,this.numBytes=0,this.pointGroup=new u(t),this.lineGroup=new d(t),this.polygonGroup=new h(t),t&&(this.layerCatalog=new Array,this.classCatalog=new Array,this.typeCatalog=new Array)}getNumBytes(){let e=l;for(const t of this.textCatalog)e+=2*t.length;if(e+=this.techniqueCatalog.length*l,e+=this.pointGroup.getNumBytes(),e+=this.lineGroup.getNumBytes(),e+=this.polygonGroup.getNumBytes(),void 0!==this.layerCatalog){for(const t of this.layerCatalog)e+=2*t.length;for(const t of this.classCatalog)e+=2*t.length;for(const t of this.typeCatalog)e+=2*t.length}return e}}t.ExtendedTileInfo=m,function(e){function t(e){e.featureIds.length=e.numFeatures,e.techniqueIndex.length=e.numFeatures,e.textIndex.length=e.numFeatures,e.positionIndex.length=e.numFeatures,e.positions.length=e.numPositions,void 0!==e.layerIndex&&(e.layerIndex.length=e.numFeatures),void 0!==e.classIndex&&(e.classIndex.length=e.numFeatures),void 0!==e.typeIndex&&(e.typeIndex.length=e.numFeatures)}function r(e){return e.numPositions===e.positions.length}function i(e,t,r,i){let n;if(t){const t=e.lookup("name:short");if("string"==typeof t&&t.length>0)return t}if(r){const t=e.lookup("iso_code");if("string"==typeof t&&t.length>0)return t}if(void 0!==i)for(const t of i)if("string"==typeof(n=e.lookup(`name:${t}`)||e.lookup(`name_${t}`))&&n.length>0)return n;if("string"==typeof(n=e.lookup("name")))return n}e.finish=function(e){var r,i;t(e.pointGroup),t(r=e.lineGroup),void 0!==r.segmentIds&&(r.segmentIds.length=r.numFeatures,r.segmentStartOffsets.length=r.numFeatures,r.segmentEndOffsets.length=r.numFeatures),t(i=e.polygonGroup),i.outerRingStartIndex.length=i.numFeatures,i.innerRingIsOuterContour.length=i.groupNumRings,i.innerRingStartIndex.length=i.groupNumRings,e.numBytes=e.getNumBytes()},e.featureGroupSize=function(e){return e.numFeatures},e.featureGroupFinished=r,e.tileInfoFinished=function(e){return r(e.pointGroup)&&r(e.lineGroup)&&r(e.polygonGroup)},e.getFeatureName=i,e.getFeatureText=function(e,t,r){let o,c;const l=e instanceof n.Env?e:e.env;if(s.isTextTechnique(t)||s.isPoiTechnique(t)||s.isLineMarkerTechnique(t)){if(void 0!==t.text)return a.evaluateTechniqueAttr(e,t.text);if(void 0!==t.label){const e=l.lookup(t.label);return"string"==typeof e?e:void 0}o=t.useAbbreviation,c=t.useIsoCode}return i(l,o,c,r)}}(m=t.ExtendedTileInfo||(t.ExtendedTileInfo={}));t.ExtendedTileInfoWriter=class{constructor(e,t){this.tileInfo=e,this.storeExtendedTags=t,this.techniqueIndexMap=new Map,this.stringMap=new Map,this.layerMap=new Map,this.classMap=new Map,this.typeMap=new Map}addTechnique(e){let t=this.techniqueIndexMap.get(e._index);if(void 0!==t)return t;const r=o.makeDecodedTechnique(e);return t=this.tileInfo.techniqueCatalog.length,this.techniqueIndexMap.set(r._index,t),this.tileInfo.techniqueCatalog.push(r),t}addFeature(e,t,r,n,o,a){let s=-1;switch(void 0!==n&&n.length>0&&(s=this.addText(n)),e.featureIds[e.numFeatures]=r,e.techniqueIndex[e.numFeatures]=o,e.textIndex[e.numFeatures]=s,e.positionIndex[e.numFeatures]=e.numPositions,a){case c.Polygon:const r=e;i.assert(void 0!==r.outerRingStartIndex),i.assert(void 0!==r.innerRingStartIndex),i.assert(void 0!==r.innerRingIsOuterContour),r.outerRingStartIndex[e.numFeatures]=r.groupNumRings;break;case c.Line:e.userData[e.numFeatures]=t.entries}this.storeExtendedTags&&(e.layerIndex[e.numFeatures]=this.addLayer(t.lookup("$layer")),e.classIndex[e.numFeatures]=this.addClass(t.lookup("class")),e.typeIndex[e.numFeatures]=this.addType(t.lookup("type"))),e.numFeatures++}addFeaturePoint(e,t,r){e.positions[e.numPositions++]=t,e.positions[e.numPositions++]=r}addFeaturePoints(e,t){const r=e.numPositions,i=t.length,n=e.positions;for(let e=0;e<i;e++)n[r+e]=t[e];e.numPositions+=t.length}addRoadSegments(e,t,r,i){void 0===e.segmentIds&&(e.segmentIds=new Array,e.segmentStartOffsets=new Array,e.segmentEndOffsets=new Array),e.segmentIds[e.numFeatures-1]=t,e.segmentStartOffsets[e.numFeatures-1]=r,e.segmentEndOffsets[e.numFeatures-1]=i}addRingPoints(e,t,r){e.innerRingStartIndex[e.groupNumRings]=e.numPositions,e.innerRingIsOuterContour[e.groupNumRings]=r?1:0,e.groupNumRings++;const i=e.numPositions,n=t.length,o=e.positions;for(let e=0;e<n;e++)o[i+e]=t[e];e.numPositions+=t.length}finish(){m.finish(this.tileInfo)}addText(e){return this.addStringValue(e,this.tileInfo.textCatalog,this.stringMap)}addLayer(e){return this.addStringValue(e,this.tileInfo.layerCatalog,this.layerMap)}addClass(e){return this.addStringValue(e,this.tileInfo.classCatalog,this.classMap)}addType(e){return this.addStringValue(e,this.tileInfo.typeCatalog,this.typeMap)}addStringValue(e,t,r){if(null==e)return-1;const i=e.toString();let n=r.get(i);return void 0!==n?n:(n=t.length,t.push(i),r.set(i,n),n)}};class p{constructor(e){this.tileInfo=e}visitAll(e){this.visitAllPointFeatures(e),this.visitAllLineFeatures(e),this.visitAllPolygonFeatures(e)}visitFeature(e,t){let r=0;const i=this.tileInfo.pointGroup.numFeatures,n=this.tileInfo.pointGroup.featureIds;for(let o=0;o<i;o++)n[o]===e&&(r++,this.visitPointFeature(o,t));const o=this.tileInfo.lineGroup.numFeatures,a=this.tileInfo.lineGroup.featureIds;for(let i=0;i<o;i++)a[i]===e&&(r++,this.visitLineFeature(i,t));const s=this.tileInfo.polygonGroup.numFeatures,c=this.tileInfo.polygonGroup.featureIds;for(let i=0;i<s;i++)c[i]===e&&(r++,this.visitPolygonFeature(i,t));return r}visitAllPointFeatures(e){const t=this.tileInfo.pointGroup.numFeatures;for(let r=0;r<t;r++)this.visitPointFeature(r,e)}visitAllLineFeatures(e){const t=this.tileInfo.lineGroup.numFeatures;for(let r=0;r<t;r++)this.visitLineFeature(r,e)}visitAllPolygonFeatures(e){const t=this.tileInfo.polygonGroup.numFeatures;for(let r=0;r<t;r++)this.visitPolygonFeature(r,e)}getTag(e,t){return void 0!==t&&t[e]>=0?t[e]:-1}visitPointFeature(e,t){const r=this.tileInfo.pointGroup,i=r.positionIndex[e],n=r.positions[i],o=r.positions[i+1];t.acceptPoint&&t.acceptPoint(r.featureIds[e],r.techniqueIndex[e],n,o,r.textIndex[e],this.getTag(e,r.layerIndex),this.getTag(e,r.classIndex),this.getTag(e,r.typeIndex))}visitLineFeature(e,t){const r=this.tileInfo,i=r.lineGroup,n=i.numFeatures,o=i.positionIndex[e],a=e===n-1?i.positions.length-o:i.positionIndex[e+1]-o;let s,c,l;void 0!==i.segmentIds&&(s=i.segmentIds[e],c=i.segmentStartOffsets[e],l=i.segmentEndOffsets[e]),t.acceptLine&&t.acceptLine(i.featureIds[e],i.techniqueIndex[e],i.textIndex[e],this.getTag(e,i.layerIndex),this.getTag(e,i.classIndex),this.getTag(e,i.typeIndex),r.lineGroup.positions,o,a,s,c,l)}visitPolygonFeature(e,t){if(void 0===t.acceptPolygon)return;const r=this.tileInfo.polygonGroup,i=r.numFeatures,n=r.outerRingStartIndex[e],o=e===i-1?r.innerRingStartIndex.length-n:r.outerRingStartIndex[e+1]-n;p.polygonAccessor.setup(r,e,n,o),t.acceptPolygon(r.featureIds[e],r.techniqueIndex[e],r.textIndex[e],this.getTag(e,r.layerIndex),this.getTag(e,r.classIndex),this.getTag(e,r.typeIndex),p.polygonAccessor),p.polygonAccessor.reset()}}t.ExtendedTileInfoVisitor=p,p.polygonAccessor=new class{constructor(){this.featureIndex=0,this.ringStart=0,this.numRings=0}setup(e,t,r,i){this.polygons=e,this.featureIndex=t,this.ringStart=r,this.numRings=i}reset(){this.polygons=void 0,this.featureIndex=0,this.ringStart=0,this.numRings=0}isOuterRing(e){if(i.assert(e>=0),i.assert(e<this.numRings),i.assert(void 0!==this.polygons),e<0||e>=this.numRings||void 0===this.polygons)throw new Error("ExtendedTileInfoPolygonAccessor: Invalid ring index");return 0!==this.polygons.innerRingIsOuterContour[this.ringStart+e]}getPoints(e){if(i.assert(e>=0),i.assert(e<this.numRings),i.assert(void 0!==this.polygons),e<0||e>=this.numRings||void 0===this.polygons)throw new Error("ExtendedTileInfoPolygonAccessor: Invalid ring index");const t=this.polygons.innerRingStartIndex[this.ringStart+e];let r;return r=e<this.numRings-1?this.polygons.innerRingStartIndex[this.ringStart+e+1]-t:this.ringStart+e<this.polygons.innerRingStartIndex.length-1?this.polygons.innerRingStartIndex[this.ringStart+e+1]-t:this.polygons.positions.length-t,{points:this.polygons.positions,pointsStart:t,numPointValues:r}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(292),n=r(293),o=r(294),a=r(295),s=r(296),c=r(297),l=r(298),u=r(299),d=r(300),h=r(301),m=r(302),p=r(303),f=new Map;t.ExprEvaluatorContext=class{constructor(e,t,r,i){this.evaluator=e,this.env=t,this.scope=r,this.cache=i}evaluate(e){if(void 0!==e)return e.accept(this.evaluator,this);throw new Error("Failed to evaluate expression")}};class g{static defineOperator(e,t){f.set(e,t)}static defineOperators(e){Object.getOwnPropertyNames(e).forEach(t=>{this.defineOperator(t,e[t])})}visitVarExpr(e,t){const r=t.env.lookup(e.name);return void 0!==r?r:null}visitNullLiteralExpr(e,t){return null}visitBooleanLiteralExpr(e,t){return e.value}visitNumberLiteralExpr(e,t){return e.value}visitStringLiteralExpr(e,t){return e.value}visitObjectLiteralExpr(e,t){return e.value}visitHasAttributeExpr(e,t){return void 0!==t.env.lookup(e.name)}visitContainsExpr(e,t){const r=e.value.accept(this,t),i=e.elements.includes(r);return void 0!==t.cache&&t.cache.set(e,i),i}visitMatchExpr(e,t){const r=t.evaluate(e.value);for(const[i,n]of e.branches){if(Array.isArray(i)&&i.includes(r))return t.evaluate(n);if(i===r)return t.evaluate(n)}return t.evaluate(e.fallback)}visitCaseExpr(e,t){for(const[r,i]of e.branches)if(t.evaluate(r))return t.evaluate(i);return t.evaluate(e.fallback)}visitCallExpr(e,t){switch(e.op){case"all":for(const r of e.args)if(!r.accept(this,t))return!1;return!0;case"any":for(const r of e.args)if(r.accept(this,t))return!0;return!1;case"none":for(const r of e.args)if(r.accept(this,t))return!1;return!0;default:{if(void 0!==t.cache){const r=t.cache.get(e);if(void 0!==r)return r}const r=e.descriptor||f.get(e.op);if(r){e.descriptor=r;const i=r.call(t,e);return t.cache&&t.cache.set(e,i),i}throw new Error(`undefined operator '${e.op}`)}}}}t.ExprEvaluator=g,g.defineOperators(n.CastOperators),g.defineOperators(a.ComparisonOperators),g.defineOperators(u.MathOperators),g.defineOperators(m.StringOperators),g.defineOperators(o.ColorOperators),g.defineOperators(p.TypeOperators),g.defineOperators(d.MiscOperators),g.defineOperators(c.FlowOperators),g.defineOperators(i.ArrayOperators),g.defineOperators(l.InterpolationOperators),g.defineOperators(h.ObjectOperators),g.defineOperators(s.FeatureOperators)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={at:{call:(e,t)=>{const r=t.args,i=e.evaluate(r[0]);if("number"!=typeof i)throw new Error("expected the index of the element to retrieve");const n=e.evaluate(r[1]);if(!Array.isArray(n))throw new Error("expected an array");return i>=0&&i<n.length?n[i]:null}}};t.ArrayOperators=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={"to-boolean":{call:(e,t)=>Boolean(e.evaluate(t.args[0]))},"to-string":{call:(e,t)=>String(e.evaluate(t.args[0]))},"to-number":{call:(e,t)=>{for(const r of t.args){const t=Number(e.evaluate(r));if(!isNaN(t))return t}throw new Error("cannot convert the value to a number")}}};t.CastOperators=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=new i.Color,o={rgb:{call:(e,t)=>{const r=e.evaluate(t.args[0]),o=e.evaluate(t.args[1]),a=e.evaluate(t.args[2]);if("number"==typeof r&&"number"==typeof o&&"number"==typeof a)return"#"+n.setRGB(i.Math.clamp(r,0,255)/255,i.Math.clamp(o,0,255)/255,i.Math.clamp(a,0,255)/255).getHexString();throw new Error(`unknown color 'rgb(${r},${o},${a})'`)}},hsl:{call:(e,t)=>{const r=e.evaluate(t.args[0]),i=e.evaluate(t.args[1]),n=e.evaluate(t.args[2]);if("number"==typeof r&&"number"==typeof i&&"number"==typeof n&&r>=0&&i>=0&&n>=0)return`hsl(${r},${Math.round(i)}%,${Math.round(n)}%)`;throw new Error(`unknown color 'hsl(${r},${i}%,${n}%)'`)}}};t.ColorOperators=o},function(e,t,r){"use strict";function i(e,t,r=!1){const i=e.evaluate(t.args[0]),n=e.evaluate(t.args[1]);if(!("number"==typeof i&&"number"==typeof n||"string"==typeof i&&"string"==typeof n)&&r)throw new Error(`invalid operands '${i}' and '${n}' for operator '${t.op}'`);switch(t.op){case"<":return i<n;case">":return i>n;case"<=":return i<=n;case">=":return i>=n;default:throw new Error(`invalid comparison operator '${t.op}'`)}}Object.defineProperty(t,"__esModule",{value:!0});const n={"!":{call:(e,t)=>!e.evaluate(t.args[0])},"==":{call:(e,t)=>{return e.evaluate(t.args[0])===e.evaluate(t.args[1])}},"!=":{call:(e,t)=>{return e.evaluate(t.args[0])!==e.evaluate(t.args[1])}},"<":{call:(e,t)=>i(e,t)},">":{call:(e,t)=>i(e,t)},"<=":{call:(e,t)=>i(e,t)},">=":{call:(e,t)=>i(e,t)}};t.ComparisonOperators=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FeatureOperators={"geometry-type":{call:(e,t)=>{switch(e.env.lookup("$geometryType")){case"point":return"Point";case"line":return"LineString";case"polygon":return"Polygon";default:return null}}}}},function(e,t,r){"use strict";function i(e,t,r){switch(t){case"boolean":case"number":case"string":for(const i of r){const r=e.evaluate(i);if(typeof r===t)return r}throw new Error(`expected a '${t}'`);default:throw new Error(`invalid type '${t}'`)}}Object.defineProperty(t,"__esModule",{value:!0});const n={boolean:{call:(e,t)=>i(e,"boolean",t.args)},number:{call:(e,t)=>i(e,"number",t.args)},string:{call:(e,t)=>i(e,"string",t.args)}};t.FlowOperators=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(19),n=r(41);const o={zoom:{call:(e,t)=>{if(e.scope===i.ExprScope.Condition){const t=e.env.lookup("$zoom");if(void 0!==t)return t;throw new Error("failed to get the zoom level.")}throw new Error("invalid usage of the 'zoom' operator.")}},interpolate:{call:(e,t)=>{const r=t.args[0],o=t.args[1],a=t.args.slice(2);if(!(r instanceof i.CallExpr))throw new Error("expected an interpolation type");let s,c;if("linear"===r.op)s="Linear";else if("discrete"===r.op)s="Discrete";else if("cubic"===r.op)s="Cubic";else{if("exponential"!==r.op)throw new Error("unrecognized interpolation type");{s="Exponential";const e=r.args[0];if(!(e instanceof i.NumberLiteralExpr))throw new Error("expected the base of the exponential interpolation");c=e.value}}if(!(o instanceof i.CallExpr))throw new Error("expected the input of the interpolation");if("zoom"!==o.op)throw new Error("only 'zoom' is supported");if(0===a.length||a.length%2)throw new Error("invalid number of samples");const l=[],u=[];for(let t=0;t<a.length;t+=2){const r=a[t];if(!(r instanceof i.NumberLiteralExpr))throw new Error("expected a numeric literal");l.push(r.value),u.push(e.evaluate(a[t+1]))}const d=n.createInterpolatedProperty({interpolation:s,zoomLevels:l,values:u,exponent:c});if(void 0===d)throw new Error("failed to create interpolator");return d}},step:{call:(e,t)=>{if(void 0===t.args[0])throw new Error("expected the input of the 'step' operator");const r=t.args[0];if(e.scope===i.ExprScope.Value&&r instanceof i.CallExpr&&"zoom"===r.op){if(t.args.length<3||t.args.length%2)throw new Error("not enough arguments");const r=[],o=[];r.push(Number.MIN_SAFE_INTEGER),o.push(e.evaluate(t.args[1]));for(let n=2;n<t.args.length;n+=2){const a=t.args[n];if(!(a instanceof i.NumberLiteralExpr))throw new Error("expected a numeric literal");r.push(a.value),o.push(e.evaluate(t.args[n+1]))}const a=n.createInterpolatedProperty({interpolation:"Discrete",zoomLevels:r,values:o});if(void 0===a)throw new Error("failed to create interpolator");return a}return function(e,t){if(t.length<3||t.length%2)throw new Error("not enough arguments");const r=e.evaluate(t[0]);if(null===r)return e.evaluate(t[1]);if("number"!=typeof r)throw new Error("the input of a 'step' operator must have type 'number'");let n=1,o=t.length/2-1;for(;n<o;){const e=n+o>>>1,a=t[2*e];if(!(a instanceof i.NumberLiteralExpr))throw new Error("expected a numeric literal");r<a.value?o=e-1:r>a.value?n=e+1:o=e}const a=t[2*n];if(!(a instanceof i.NumberLiteralExpr))throw new Error("expected a numeric literal");const s=a.value<=r?n:n-1;return e.evaluate(t[2*s+1])}(e,t.args)}}};t.InterpolationOperators=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n={"^":{call:(e,t)=>{const r=e.evaluate(t.args[0]),i=e.evaluate(t.args[1]);if("number"!=typeof r||"number"!=typeof i)throw new Error(`invalid operands '${typeof r}' and '${typeof i}' for operator '^'`);return Math.pow(r,i)}},"-":{call:(e,t)=>{const r=e.evaluate(t.args[0]),i=e.evaluate(t.args[1]);if("number"!=typeof r||"number"!=typeof i)throw new Error(`invalid operands '${typeof r}' and '${typeof i}' for operator '-'`);return r-i}},"/":{call:(e,t)=>{const r=e.evaluate(t.args[0]),i=e.evaluate(t.args[1]);if("number"!=typeof r||"number"!=typeof i)throw new Error(`invalid operands '${typeof r}' and '${typeof i}' for operator '/'`);return r/i}},"%":{call:(e,t)=>{const r=e.evaluate(t.args[0]),i=e.evaluate(t.args[1]);if("number"!=typeof r||"number"!=typeof i)throw new Error(`invalid operands '${typeof r}' and '${typeof i}' for operator '%'`);return r%i}},"+":{call:(e,t)=>t.args.reduce((t,r)=>Number(t)+Number(e.evaluate(r)),0)},"*":{call:(e,t)=>t.args.reduce((t,r)=>Number(t)*Number(e.evaluate(r)),1)},abs:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'abs'`);return Math.abs(r)}},acos:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'acos'`);return Math.acos(r)}},asin:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'asin'`);return Math.asin(r)}},atan:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'atan'`);return Math.atan(r)}},ceil:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'ceil'`);return Math.ceil(r)}},cos:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'cos'`);return Math.cos(r)}},e:{call:()=>Math.E},floor:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'floor'`);return Math.floor(r)}},ln:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'ln'`);return Math.log(r)}},ln2:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'ln2'`);return Math.log2(r)}},log10:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'log10'`);return Math.log10(r)}},max:{call:(e,t)=>Math.max(...t.args.map(t=>Number(e.evaluate(t))))},min:{call:(e,t)=>Math.min(...t.args.map(t=>Number(e.evaluate(t))))},clamp:{call:(e,t)=>{const r=e.evaluate(t.args[0]),n=e.evaluate(t.args[1]),o=e.evaluate(t.args[2]);if("number"!=typeof r||"number"!=typeof n||"number"!=typeof o)throw new Error(`invalid operands '${r}', ${n}, ${o} for operator 'clamp'`);return i.Math.clamp(r,n,o)}},pi:{call:()=>Math.PI},round:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'round'`);return Math.round(r)}},sin:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'sin'`);return Math.sin(r)}},sqrt:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'sqrt'`);return Math.sqrt(r)}},tan:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if("number"!=typeof r)throw new Error(`invalid operand '${r}' for operator 'tan'`);return Math.tan(r)}}};t.MathOperators=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={length:{call:(e,t)=>{const r=e.evaluate(t.args[0]);if(Array.isArray(r)||"string"==typeof r)return r.length;throw new Error(`invalid operand '${r}' for operator 'length'`)}},coalesce:{call:(e,t)=>{for(const r of t.args){const t=e.evaluate(r);if(null!==t)return t}return null}}};t.MiscOperators=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=Object.prototype.hasOwnProperty;var n;function o(e,t,r){const o=e.evaluate(t[0]);if("string"!=typeof o)throw new Error("expected the name of an attribute");const a=e.evaluate(t[1]);return a&&"object"==typeof a&&i.call(a,o)?r!==n.get||a[o]:r===n.get&&null}!function(e){e[e.get=0]="get",e[e.has=1]="has"}(n||(n={}));const a={get:{call:(e,t)=>o(e,t.args,n.get)},has:{call:(e,t)=>o(e,t.args,n.has)}};t.ObjectOperators=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={concat:{call:(e,t)=>"".concat(...t.args.map(t=>String(e.evaluate(t))))},downcase:{call:(e,t)=>String(e.evaluate(t.args[0])).toLocaleLowerCase()},upcase:{call:(e,t)=>String(e.evaluate(t.args[0])).toLocaleUpperCase()},"~=":{call:(e,t)=>{const r=e.evaluate(t.args[0]),i=e.evaluate(t.args[1]);return"string"==typeof r&&"string"==typeof i&&-1!==r.indexOf(i)}},"^=":{call:(e,t)=>{const r=e.evaluate(t.args[0]),i=e.evaluate(t.args[1]);return"string"==typeof r&&"string"==typeof i&&r.startsWith(i)}},"$=":{call:(e,t)=>{const r=e.evaluate(t.args[0]),i=e.evaluate(t.args[1]);return"string"==typeof r&&"string"==typeof i&&r.endsWith(i)}}};t.StringOperators=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TypeOperators={typeof:{call:(e,t)=>typeof e.evaluate(t.args[0])}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(19);var n,o;function a(e){switch(e){case n.Tab:case n.Lf:case n.Cr:case n.Space:return!0;default:return!1}}function s(e){return e>=n._0&&e<=n._9}function c(e){return e>=n.a&&e<=n.z||e>=n.A&&e<=n.Z}function l(e){return function(e){return c(e)||s(e)}(e)||e===n._||e===n.Dollar||e===n.Dot||e===n.LBracket||e===n.RBracket}function u(e){switch(e){case o.Eof:return"eof";case o.Error:return"error";case o.Identifier:return"identifier";case o.Number:return"number";case o.String:return"string";case o.Comma:return",";case o.LParen:return"(";case o.RParen:return")";case o.LBracket:return"[";case o.RBracket:return"]";case o.Exclaim:return"!";case o.TildeEqual:return"~=";case o.CaretEqual:return"^=";case o.DollarEqual:return"$=";case o.EqualEqual:return"==";case o.ExclaimEqual:return"!=";case o.Less:return"<";case o.Greater:return">";case o.LessEqual:return"<=";case o.GreaterEqual:return">=";case o.BarBar:return"||";case o.AmpAmp:return"&&";default:throw new Error(`invalid token ${e}`)}}!function(e){e[e.Tab=9]="Tab",e[e.Lf=10]="Lf",e[e.Cr=13]="Cr",e[e.Space=32]="Space",e[e.LParen=40]="LParen",e[e.RParen=41]="RParen",e[e.Comma=44]="Comma",e[e.Dot=46]="Dot",e[e.LBracket=91]="LBracket",e[e.Backslash=92]="Backslash",e[e.RBracket=93]="RBracket",e[e._0=48]="_0",e[e._9=57]="_9",e[e._=95]="_",e[e.A=64]="A",e[e.Z=90]="Z",e[e.a=97]="a",e[e.z=122]="z",e[e.DoubleQuote=34]="DoubleQuote",e[e.SingleQuote=39]="SingleQuote",e[e.Exclaim=33]="Exclaim",e[e.Equal=61]="Equal",e[e.Caret=94]="Caret",e[e.Tilde=126]="Tilde",e[e.Dollar=36]="Dollar",e[e.Less=60]="Less",e[e.Greater=62]="Greater",e[e.Bar=124]="Bar",e[e.Amp=38]="Amp"}(n||(n={})),function(e){e[e.Eof=0]="Eof",e[e.Error=1]="Error",e[e.Identifier=2]="Identifier",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Comma=5]="Comma",e[e.LParen=6]="LParen",e[e.RParen=7]="RParen",e[e.LBracket=8]="LBracket",e[e.RBracket=9]="RBracket",e[e.Exclaim=10]="Exclaim",e[e.TildeEqual=11]="TildeEqual",e[e.CaretEqual=12]="CaretEqual",e[e.DollarEqual=13]="DollarEqual",e[e.EqualEqual=14]="EqualEqual",e[e.ExclaimEqual=15]="ExclaimEqual",e[e.Less=16]="Less",e[e.Greater=17]="Greater",e[e.LessEqual=18]="LessEqual",e[e.GreaterEqual=19]="GreaterEqual",e[e.BarBar=20]="BarBar",e[e.AmpAmp=21]="AmpAmp"}(o||(o={}));class d{constructor(e){this.code=e,this.m_token=o.Error,this.m_index=0,this.m_char=n.Lf}token(){return this.m_token}text(){return this.m_text||""}next(){if(this.m_token=this.yylex(),this.m_token===o.Error)throw new Error(`unexpected character ${this.m_char}`);return this.m_token}yyinp(){this.m_char=this.code.codePointAt(this.m_index++)||0}yylex(){for(this.m_text=void 0;a(this.m_char);)this.yyinp();if(0===this.m_char)return o.Eof;const e=this.m_char;switch(this.yyinp(),e){case n.LParen:return o.LParen;case n.RParen:return o.RParen;case n.LBracket:return o.LBracket;case n.RBracket:return o.RBracket;case n.Comma:return o.Comma;case n.SingleQuote:case n.DoubleQuote:{const t=this.m_index-1;for(;this.m_char&&this.m_char!==e;)this.yyinp();if(this.m_char!==e)throw new Error("Unfinished string literal");return this.yyinp(),this.m_text=this.code.substring(t,this.m_index-2),o.String}case n.Exclaim:return this.m_char===n.Equal?(this.yyinp(),o.ExclaimEqual):o.Exclaim;case n.Caret:return this.m_char===n.Equal?(this.yyinp(),o.CaretEqual):o.Error;case n.Tilde:return this.m_char===n.Equal?(this.yyinp(),o.TildeEqual):o.Error;case n.Equal:return this.m_char===n.Equal?(this.yyinp(),o.EqualEqual):o.Error;case n.Less:return this.m_char===n.Equal?(this.yyinp(),o.LessEqual):o.Less;case n.Greater:return this.m_char===n.Equal?(this.yyinp(),o.GreaterEqual):o.Greater;case n.Bar:return this.m_char===n.Bar?(this.yyinp(),o.BarBar):o.Error;case n.Amp:return this.m_char===n.Amp?(this.yyinp(),o.AmpAmp):o.Error;default:{const t=this.m_index-2;if(c(e)||e===n._||e===n.Dollar&&l(this.m_char)){for(;l(this.m_char);)this.yyinp();return this.m_text=this.code.substring(t,this.m_index-1),o.Identifier}if(s(e)){for(;s(this.m_char);)this.yyinp();if(this.m_char===n.Dot)for(this.yyinp();s(this.m_char);)this.yyinp();return this.m_text=this.code.substring(t,this.m_index-1),o.Number}if(e===n.Dollar)return this.m_char===n.Equal?(this.yyinp(),o.DollarEqual):o.Error}}return o.Error}}function h(e){switch(e){case o.TildeEqual:return"~=";case o.CaretEqual:return"^=";case o.DollarEqual:return"$=";case o.EqualEqual:return"==";case o.ExclaimEqual:return"!=";default:return}}function m(e){switch(e){case o.Less:return"<";case o.Greater:return">";case o.LessEqual:return"<=";case o.GreaterEqual:return">=";default:return}}t.ExprParser=class{constructor(e){this.lex=new d(e),this.lex.next()}parse(){return this.parseLogicalOr()}yyexpect(e){if(this.lex.token()!==e)throw new Error(`Syntax error: Expected token '${u(e)}' but `+`found '${u(this.lex.token())}'`);this.lex.next()}parsePrimary(){switch(this.lex.token()){case o.Identifier:{const e=this.lex.text();switch(e){case"has":this.lex.next(),this.yyexpect(o.LParen);const t=this.lex.text();return this.yyexpect(o.Identifier),this.yyexpect(o.RParen),new i.HasAttributeExpr(t);case"length":this.lex.next(),this.yyexpect(o.LParen);const r=this.parseLogicalOr();return this.yyexpect(o.RParen),new i.CallExpr("length",[r]);default:const n=new i.VarExpr(e);return this.lex.next(),n}}case o.LParen:{this.lex.next();const e=this.parseLogicalOr();return this.yyexpect(o.RParen),e}default:return this.parseLiteral()}}parseLiteral(){switch(this.lex.token()){case o.Number:{const e=new i.NumberLiteralExpr(parseFloat(this.lex.text()));return this.lex.next(),e}case o.String:{const e=new i.StringLiteralExpr(this.lex.text());return this.lex.next(),e}default:throw new Error("Syntax error")}}parseUnary(){return this.lex.token()===o.Exclaim?(this.lex.next(),new i.CallExpr("!",[this.parseUnary()])):this.parsePrimary()}parseRelational(){let e=this.parseUnary();for(;;)if(this.lex.token()===o.Identifier&&"in"===this.lex.text()){this.lex.next(),this.yyexpect(o.LBracket);const t=[this.parseLiteral()];for(;this.lex.token()===o.Comma;)this.lex.next(),t.push(this.parseLiteral());this.yyexpect(o.RBracket),e=new i.ContainsExpr(e,t.map(e=>e.value))}else{const t=m(this.lex.token());if(void 0===t)break;this.lex.next();const r=this.parseUnary();e=new i.CallExpr(t,[e,r])}return e}parseEquality(){let e=this.parseRelational();for(;;){const t=h(this.lex.token());if(void 0===t)break;this.lex.next();const r=this.parseRelational();e=new i.CallExpr(t,[e,r])}return e}parseLogicalAnd(){const e=this.parseEquality();if(this.lex.token()!==o.AmpAmp)return e;const t=[e];do{this.lex.next(),t.push(this.parseEquality())}while(this.lex.token()===o.AmpAmp);return new i.CallExpr("all",t)}parseLogicalOr(){const e=this.parseLogicalAnd();if(this.lex.token()!==o.BarBar)return e;const t=[e];do{this.lex.next(),t.push(this.parseLogicalAnd())}while(this.lex.token()===o.BarBar);return new i.CallExpr("any",t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{lookup(e){}unmap(){return{}}}t.Env=i;t.MapEnv=class extends i{constructor(e,t){super(),this.entries=e,this.parent=t}lookup(e){if(this.entries.hasOwnProperty(e)){const t=this.entries[e];if(void 0!==t)return t}return this.parent?this.parent.lookup(e):void 0}unmap(){const e=this.parent?this.parent.unmap():{};for(const t in this.entries)this.entries.hasOwnProperty(t)&&(e[t]=this.entries[t]);return e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(19);t.ExprPool=class{constructor(){this.m_booleanLiterals=new Map,this.m_numberLiterals=new Map,this.m_stringLiterals=new Map,this.m_objectLiterals=new Map,this.m_varExprs=new Map,this.m_hasAttributeExprs=new Map,this.m_inExprs=new Map,this.m_callExprs=new Map}add(e){return e.accept(this,void 0)}visitNullLiteralExpr(e,t){return i.NullLiteralExpr.instance}visitBooleanLiteralExpr(e,t){const r=this.m_booleanLiterals.get(e.value);return r||(this.m_booleanLiterals.set(e.value,e),e)}visitNumberLiteralExpr(e,t){const r=this.m_numberLiterals.get(e.value);return r||(this.m_numberLiterals.set(e.value,e),e)}visitStringLiteralExpr(e,t){const r=this.m_stringLiterals.get(e.value);return r||(this.m_stringLiterals.set(e.value,e),e)}visitObjectLiteralExpr(e,t){const r=this.m_objectLiterals.get(e.value);return r||(this.m_objectLiterals.set(e.value,e),e)}visitVarExpr(e,t){const r=this.m_varExprs.get(e.name);return r||(this.m_varExprs.set(e.name,e),e)}visitHasAttributeExpr(e,t){const r=this.m_hasAttributeExprs.get(e.name);return r||(this.m_hasAttributeExprs.set(e.name,e),e)}visitContainsExpr(e,t){const r=e.value.accept(this,t);this.m_inExprs.has(r)||this.m_inExprs.set(r,[]);const n=this.m_inExprs.get(r);for(const t of n){if(t.elements.length!==e.elements.length)continue;if(-1===t.elements.findIndex(t=>!e.elements.includes(t)))return t}const o=new i.ContainsExpr(r,e.elements);return this.m_inExprs.set(r,[o]),o}visitMatchExpr(e,t){const r=e.value.accept(this,t),n=e.branches.map(([e,r])=>[e,r.accept(this,t)]),o=e.fallback.accept(this,t);return new i.MatchExpr(r,n,o)}visitCaseExpr(e,t){const r=e.branches.map(([e,r])=>[e.accept(this,t),r.accept(this,t)]),n=e.fallback.accept(this,t);return new i.CaseExpr(r,n)}visitCallExpr(e,t){const r=e.args.map(e=>e.accept(this,t));this.m_callExprs.has(e.op)||this.m_callExprs.set(e.op,[]);const n=this.m_callExprs.get(e.op);for(const e of n){if(e.args.length!==r.length)continue;let t=0;for(;t<e.args.length&&e.args[t]===r[t];++t);if(t===e.args.length)return e}const o=new i.CallExpr(e.op,r);return n.push(o),o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(19);t.ThemeVisitor=class{constructor(e){this.theme=e}visitStyles(e){const t=r=>{if(i.isJsonExpr(r))return!1;if(e(r))return!0;if(void 0!==r.styles)for(const e of r.styles)if(t(e))return!0;return!1};if(void 0!==this.theme.styles)for(const e in this.theme.styles)if(void 0!==this.theme.styles[e])for(const r of this.theme.styles[e])if(t(r))return!0;return!1}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addExtrudedWalls=function(e,t,r,i,n,o){const a=i.length/r;for(let r=0;r<a;++r){const i=t+2*r,s=i+1,c=t+(r+1)%a*2,l=c+1;!1!==o||void 0===n?e.push(i,s,l,l,c,i):n[r]&&e.push(i,s,l,l,c,i)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=new i.Vector2,o=new i.Vector2,a=new i.Vector2,s=new i.Vector2;t.addPolygonEdges=function(e,t,r,i,c,l,u,d){for(let h=0;h<c.length;++h)if(c[h])if(!0===l){const l=t+2*h,m=l+1,p=t+(h+1)%c.length*2,f=p+1;!0===u&&e.push(l,p),e.push(m,f);const g=(0===h?c.length:h)-1;if(c[g])if(void 0!==d){const t=i[h*r],u=i[h*r+1],p=i[(h+1)%c.length*r],f=i[(h+1)%c.length*r+1];n.set(t,u),o.set(p,f),a.set(i[g*r],i[g*r+1]),s.set(n.x,n.y),s.sub(a).normalize().dot(o.sub(n).normalize())<=d&&e.push(l,m)}else e.push(l,m)}else{const r=t+h,i=t+(h+1)%c.length;e.push(r,i)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(130);!function(e){function t(e){if(e instanceof Int8Array)return"int8";if(e instanceof Uint8Array)return"uint8";if(e instanceof Int16Array)return"int16";if(e instanceof Uint16Array)return"uint16";if(e instanceof Int32Array)return"int32";if(e instanceof Uint32Array)return"uint32";if(e instanceof Float32Array)return"float";throw new Error(`Unsupported buffer type ${name}`)}function r(e){const r=e.array;return{name:e.name,buffer:r.buffer,type:t(r),itemCount:e.itemSize,normalized:e.normalized}}e.getBufferElementType=t,e.fromThreeBufferAttribute=r,e.fromThreeInterleavedBufferAttribute=function(e){throw new Error("Not implemented yet")},e.fromThreeBufferGeometry=function(e,t){const n=[],o=Object.getOwnPropertyNames(e.attributes);for(const t of o){const i=r(e.attributes[t]);i.name=t,n.push(i)}const a=r(e.index);return{type:i.GeometryType.Unspecified,vertexAttributes:n,index:a,groups:[{start:0,count:e.index.count,technique:t}]}}}(t.ThreeBufferUtils||(t.ThreeBufferUtils={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(12);t.ThemedTileDecoder=class{constructor(){this.m_storageLevelOffset=0}dispose(){}decodeTile(e,t,r){return void 0===this.m_styleSetEvaluator?Promise.reject(new Error("No style is defined")):this.decodeThemedTile(e,t,this.m_styleSetEvaluator,r)}getTileInfo(e,t,r){return Promise.resolve(void 0)}configure(e,t,r,n){void 0!==e&&(this.m_styleSetEvaluator=new i.StyleSetEvaluator(e,t)),void 0!==r&&(this.languages=r),void 0!==n&&void 0!==n.storageLevelOffset&&(this.m_storageLevelOffset=n.storageLevelOffset)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(4),o=r(1),a=r(59),s=o.LoggerManager.instance.create("TileDecoderService");class c extends a.WorkerService{constructor(e,t){super(e),this.serviceId=e,this.m_decoder=t,this.m_decoder.connect()}static start(e,t){return new c(e,t)}handleRequest(e){return i.WorkerDecoderProtocol.isDecodeTileRequest(e)?this.handleDecodeTileRequest(e):i.WorkerDecoderProtocol.isTileInfoRequest(e)?this.handleTileInfoRequest(e):super.handleRequest(e)}handleMessage(e){i.WorkerDecoderProtocol.isConfigurationMessage(e)?this.handleConfigurationMessage(e):s.error(`[${this.serviceId}]: invalid message ${e.type}`)}handleDecodeTileRequest(e){const t=n.TileKey.fromMortonCode(e.tileKey),r=i.getProjection(e.projection);return this.m_decoder.decodeTile(e.data,t,r).then(e=>{const t=[];return e.geometries.forEach(e=>{e.vertexAttributes.forEach(e=>{e.buffer instanceof ArrayBuffer&&t.push(e.buffer)}),e.index&&e.index.buffer instanceof ArrayBuffer&&t.push(e.index.buffer),void 0!==e.objInfos&&1===e.objInfos.length&&void 0!==e.objInfos[0]&&"displacementMap"in e.objInfos[0]&&t.push(e.objInfos[0].displacementMap.buffer)}),e.techniques.forEach(e=>{i.addBuffersToTransferList(e,t)}),{response:e,transferList:t}})}handleTileInfoRequest(e){const t=n.TileKey.fromMortonCode(e.tileKey),r=i.getProjection(e.projection);return this.m_decoder.getTileInfo(e.data,t,r).then(e=>{return{response:e,transferList:void 0!==e&&void 0!==e.transferList?e.transferList:[]}})}handleConfigurationMessage(e){this.m_decoder.configure(e.styleSet,e.definitions,e.languages,e.options)}}t.TileDecoderService=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(4),o=r(140),a=r(59);class s extends a.WorkerService{constructor(e){super(e),this.serviceId=e,this.tiler=new o.GeoJsonTiler}static start(e){return new s(e)}handleRequest(e){return i.WorkerTilerProtocol.isRegisterIndexRequest(e)?this.handleRegisterIndexRequest(e):i.WorkerTilerProtocol.isUpdateIndexRequest(e)?this.handleUpdateIndexRequest(e):i.WorkerTilerProtocol.isTileRequest(e)?this.handleTileRequest(e):super.handleRequest(e)}async handleTileRequest(e){const t=n.TileKey.fromMortonCode(e.tileKey);return{response:await this.tiler.getTile(e.index,t)||{}}}async handleRegisterIndexRequest(e){const t="string"==typeof e.input?new URL(e.input):e.input;return await this.tiler.registerIndex(e.id,t),{response:{}}}async handleUpdateIndexRequest(e){const t="string"==typeof e.input?new URL(e.input):e.input;return this.tiler.updateIndex(e.id,t),{response:{}}}}t.TilerService=s},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return c}));var i=r(245),n=r(13),o=r(247),a=r(122),s=r(248);function c(e,t){return new l(e,t)}function l(e,t){var r=(t=this.options=function(e,t){for(var r in t)e[r]=t[r];return e}(Object.create(this.options),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=Object(i.a)(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=Object(o.a)(n,t)).length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function u(e,t,r){return 32*((1<<e)*r+t)+e}l.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},l.prototype.splitTile=function(e,t,r,i,o,a,c){for(var l=[e,t,r,i],d=this.options,h=d.debug;l.length;){i=l.pop(),r=l.pop(),t=l.pop(),e=l.pop();var m=1<<t,p=u(t,r,i),f=this.tiles[p];if(!f&&(h>1&&console.time("creation"),f=this.tiles[p]=Object(s.a)(e,t,r,i,d),this.tileCoords.push({z:t,x:r,y:i}),h)){h>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,i,f.numFeatures,f.numPoints,f.numSimplified),console.timeEnd("creation"));var g="z"+t;this.stats[g]=(this.stats[g]||0)+1,this.total++}if(f.source=e,o){if(t===d.maxZoom||t===o)continue;var y=1<<o-t;if(r!==Math.floor(a/y)||i!==Math.floor(c/y))continue}else if(t===d.indexMaxZoom||f.numPoints<=d.indexMaxPoints)continue;if(f.source=null,0!==e.length){h>1&&console.time("clipping");var v,_,b,S,T,E,w=.5*d.buffer/d.extent,C=.5-w,x=.5+w,O=1+w;v=_=b=S=null,T=Object(n.a)(e,m,r-w,r+x,0,f.minX,f.maxX,d),E=Object(n.a)(e,m,r+C,r+O,0,f.minX,f.maxX,d),e=null,T&&(v=Object(n.a)(T,m,i-w,i+x,1,f.minY,f.maxY,d),_=Object(n.a)(T,m,i+C,i+O,1,f.minY,f.maxY,d),T=null),E&&(b=Object(n.a)(E,m,i-w,i+x,1,f.minY,f.maxY,d),S=Object(n.a)(E,m,i+C,i+O,1,f.minY,f.maxY,d),E=null),h>1&&console.timeEnd("clipping"),l.push(v||[],t+1,2*r,2*i),l.push(_||[],t+1,2*r,2*i+1),l.push(b||[],t+1,2*r+1,2*i),l.push(S||[],t+1,2*r+1,2*i+1)}}},l.prototype.getTile=function(e,t,r){var i=this.options,n=i.extent,o=i.debug;if(e<0||e>24)return null;var s=1<<e,c=u(e,t=(t%s+s)%s,r);if(this.tiles[c])return Object(a.a)(this.tiles[c],n);o>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var l,d=e,h=t,m=r;!l&&d>0;)d--,h=Math.floor(h/2),m=Math.floor(m/2),l=this.tiles[u(d,h,m)];return l&&l.source?(o>1&&console.log("found parent tile z%d-%d-%d",d,h,m),o>1&&console.time("drilling down"),this.splitTile(l.source,d,h,m,e,t,r),o>1&&console.timeEnd("drilling down"),this.tiles[c]?Object(a.a)(this.tiles[c],n):null):null}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(59);class o extends n.WorkerService{constructor(e=i.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID){super(e),this.m_factories=new Map,this.m_services=new Map}static getInstance(){return void 0===this.m_service&&(this.m_service=new o(i.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID)),this.m_service}register(e){this.m_factories.set(e.serviceType,e.factory)}handleRequest(e){if(e.type===i.WorkerServiceProtocol.Requests.CreateService){if(void 0!==this.m_services.get(e.targetServiceId))throw Error(`error - service with targetServiceId='${e.targetServiceId}' already running, ignoring CreateService request`);const t=this.m_factories.get(e.targetServiceType);if(void 0===t)throw Error(`unknown targetServiceType requested: '${e.targetServiceType}'`);const r=t(e.targetServiceId);this.m_services.set(e.targetServiceId,r)}if(e.type===i.WorkerServiceProtocol.Requests.DestroyService){const t=this.m_services.get(e.targetServiceId);if(void 0===t)throw Error(`unknown targetServiceId '${e.targetServiceId}'`);t.destroy(),this.m_services.delete(e.targetServiceId)}return Promise.resolve({response:{}})}}t.WorkerServiceManager=o},function(e,t,r){"use strict";function i(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),i(r(317)),i(r(229)),i(r(115))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(12),n=r(4),o=r(44),a=r(145),s=r(21),c=r(229),l=r(115);class u extends a.InteractiveDataSource{constructor(e){super(c.CoverageTile,{dataSourceOptions:{name:e.name||"CoverageDataSource",styleSetName:"coverage",tilingScheme:n.hereTilingScheme,dataProvider:new o.HypeDataProvider(e.dataStore),concurrentDecoderServiceName:"coverage-tile-decoder",concurrentDecoderScriptUrl:e.decoderUrl},levelWithData:e.levelWithData}),this.params=e,this.maxLevelWithData=11,this.m_tileCacheSize=256,this.m_tilesWithData=new Array,this.m_layerIndexVisibilityDistance=3,this.DEFAULT_LEVEL_WITH_DATA=14,e.levelWithData||this.logger.warn("Level with data not specified, by default level "+this.DEFAULT_LEVEL_WITH_DATA+" will be used.");const t=JSON.parse(JSON.stringify(l.coverageTheme));this.m_themeEvaluator=new i.StyleSetEvaluator(t.styles),this.decoder.configure(this.m_themeEvaluator.styleSet),this.m_minLayerIndexLevel=this.levelWithData-this.m_layerIndexVisibilityDistance}static getTileKeysOnLevel(e,t){const r=[],i=n.hereTilingScheme.getSubTileKeys(e);for(const e of i)e.level<t?s.appendToArray(r,u.getTileKeysOnLevel(e,t)):r.push(e);return r}set levelWithData(e){this.m_levelWithData=e}get levelWithData(){return this.m_levelWithData||this.DEFAULT_LEVEL_WITH_DATA}set layer(e){this.params.dataStore.layer=e}get layer(){return this.params.dataStore.layer}get highlightedTile(){return this.m_highlightedTile}set highlightedTile(e){void 0===e||this.isTileWithData(e)||(e=void 0),this.m_highlightedTile=e,this.requestUpdate()}set decodedTile(e){this.m_decodedTileMortonCode=e,this.requestUpdate()}get decodedTileMortonCode(){return this.m_decodedTileMortonCode}get tilesToRender(){return this.m_tilesToRender}get minLayerIndexLevel(){return this.m_minLayerIndexLevel}isTilesGridVisible(e){return e>=this.minLayerIndexLevel}canShowAggregatedCoverage(){return!1}dataProvider(){return super.dataProvider()}isTileWithData(e){return-1!==this.m_tilesWithData.indexOf(e)}getTile(e){let t=this.m_tileCache.get(e.mortonCode());if(void 0===t){const r=this.dataProvider().catalogClient().layers.get(this.params.dataStore.layer);if(void 0===r)return;t=new c.CoverageTile(this,e),this.m_tileCache.set(e.mortonCode(),t),e.level<=this.levelWithData&&e.level===this.m_minLayerIndexLevel&&this.fetchFromLayerIndex(r,e)}return t}addTileToRender(e){this.m_tilesToRender.has(e)||(this.m_tilesToRender.add(e),this.resetComposedTile())}shouldRender(e,t){return t.level===this.m_minLayerIndexLevel&&this.isTilesGridVisible(e)}getTileKeysWithData(e,t,r=!1){let i=[],n=[];i.push(e);for(let e=this.m_layerIndexVisibilityDistance;e>0;e--)n=[],i.forEach(e=>s.appendToArray(n,this.getTilingScheme().getSubTileKeys(e))),i=n;return!0===r?n:n.filter(e=>t.has(e.mortonCode()))}async createGridGeometries(e,t){const r=this.m_tileCache.get(e.mortonCode());if(!r)return void this.logger.error(`Missing tile object ${e.mortonCode()}.`);const i=await this.decodeTile(t,e);i?(this.tileDecoded(e,i),r.decodedTile=i,this.requestUpdate()):this.logger.error(`Missing decoded data for the tile ${e.mortonCode()}.`)}getFeatureObject(){}highlightFeature(){}selectFeature(){}copyObjectFromTileIntoComposedTile(){}getObjectsToRaycast(){return[]}async getProtobufDecoder(){}async fetchFromLayerIndex(e,t){const r=await e.getIndex(t).catch(()=>{this.logger.log(`Error downloading index for tile: ${t.toHereTile()}`)});if(!r)return;const i=this.getTileKeysWithData(t,r).map(e=>e.mortonCode());s.appendToArray(this.m_tilesWithData,i),this.createGridGeometries(t,{tileKeys:i})}}t.CoverageDataSource=u},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(10);t.deleteArtifactUsingDELETE=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/artifact/{artifactHrn}".replace("{artifactHrn}",o.UrlBuilder.toString(t.artifactHrn)),i=new o.UrlBuilder(e.baseUrl+r),a={method:"DELETE",headers:{}},[2,e.request(i,a)]}))}))},t.deleteFileUsingDELETE=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/artifact/{artifactHrn}/{fileName}".replace("{artifactHrn}",o.UrlBuilder.toString(t.artifactHrn)).replace("{fileName}",o.UrlBuilder.toString(t.fileName)),i=new o.UrlBuilder(e.baseUrl+r),a={method:"DELETE",headers:{}},[2,e.request(i,a)]}))}))},t.getArtifactFileUsingGET=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/artifact/{artifactHrn}/{fileName}".replace("{artifactHrn}",o.UrlBuilder.toString(t.artifactHrn)).replace("{fileName}",o.UrlBuilder.toString(t.fileName)),i=new o.UrlBuilder(e.baseUrl+r),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.getArtifactUsingGET=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/artifact/{artifactHrn}".replace("{artifactHrn}",o.UrlBuilder.toString(t.artifactHrn)),i=new o.UrlBuilder(e.baseUrl+r),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.putArtifactFileUsingPUT=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,s;return n(this,(function(n){return r="/artifact/{artifactHrn}/{fileName}".replace("{artifactHrn}",o.UrlBuilder.toString(t.artifactHrn)).replace("{fileName}",o.UrlBuilder.toString(t.fileName)),i=new o.UrlBuilder(e.baseUrl+r),s={method:"PUT",headers:a={}},a["Content-Type"]="application/json",void 0!==t.file&&(s.body=JSON.stringify(t.file)),[2,e.request(i,s)]}))}))},t.registerArtifactUsingPUT=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,s;return n(this,(function(n){return r="/artifact/register/{groupId}/{artifactId}".replace("{groupId}",o.UrlBuilder.toString(t.groupId)).replace("{artifactId}",o.UrlBuilder.toString(t.artifactId)),i=new o.UrlBuilder(e.baseUrl+r),s={method:"PUT",headers:a={}},a["Content-Type"]="application/json",void 0!==t.registerRequest&&(s.body=JSON.stringify(t.registerRequest)),[2,e.request(i,s)]}))}))},t.deleteSchemaUsingDELETE=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/schema/{schemaHrn}".replace("{schemaHrn}",o.UrlBuilder.toString(t.schemaHrn)),i=new o.UrlBuilder(e.baseUrl+r),a={method:"DELETE",headers:{}},[2,e.request(i,a)]}))}))},t.getDocumentUsingGET=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/schema/{schemaHrn}/doc/{file}".replace("{schemaHrn}",o.UrlBuilder.toString(t.schemaHrn)).replace("{file}",o.UrlBuilder.toString(t.file)),i=new o.UrlBuilder(e.baseUrl+r),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.getSchemaUsingGET=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/schema/{schemaHrn}".replace("{schemaHrn}",o.UrlBuilder.toString(t.schemaHrn)),i=new o.UrlBuilder(e.baseUrl+r),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.listUsingGET=function(e,t){return i(this,void 0,void 0,(function(){var r,i;return n(this,(function(n){return"/schema",(r=new o.UrlBuilder(e.baseUrl+"/schema")).appendQuery("sort",t.sort),r.appendQuery("order",t.order),r.appendQuery("from",t.from),r.appendQuery("limit",t.limit),i={method:"GET",headers:{}},[2,e.request(r,i)]}))}))},t.updateSchemaPermissionUsingPOST=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,s;return n(this,(function(n){return r="/schema/{schemaHrn}/permission".replace("{schemaHrn}",o.UrlBuilder.toString(t.schemaHrn)),i=new o.UrlBuilder(e.baseUrl+r),s={method:"POST",headers:a={}},a["Content-Type"]="application/json",void 0!==t.updatePermissionRequest&&(s.body=JSON.stringify(t.updatePermissionRequest)),[2,e.request(i,s)]}))}))}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(10);t.cancelMultipartUpload=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerId}/data/{dataHandle}/multiparts/{multiPartToken}".replace("{layerId}",o.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",o.UrlBuilder.toString(t.dataHandle)).replace("{multiPartToken}",o.UrlBuilder.toString(t.multiPartToken)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),a={method:"DELETE",headers:{}},[2,e.request(i,a)]}))}))},t.checkBlobExists=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerId}/data/{dataHandle}".replace("{layerId}",o.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",o.UrlBuilder.toString(t.dataHandle)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),a={method:"HEAD",headers:{}},[2,e.request(i,a)]}))}))},t.completeMultipartUpload=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,s;return n(this,(function(n){return r="/layers/{layerId}/data/{dataHandle}/multiparts/{multiPartToken}".replace("{layerId}",o.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",o.UrlBuilder.toString(t.dataHandle)).replace("{multiPartToken}",o.UrlBuilder.toString(t.multiPartToken)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),s={method:"PUT",headers:a={}},a["Content-Type"]="application/json",void 0!==t.parts&&(s.body=JSON.stringify(t.parts)),[2,e.request(i,s)]}))}))},t.deleteBlob=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerId}/data/{dataHandle}".replace("{layerId}",o.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",o.UrlBuilder.toString(t.dataHandle)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),a={method:"DELETE",headers:{}},[2,e.request(i,a)]}))}))},t.getBlob=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,s;return n(this,(function(n){return r="/layers/{layerId}/data/{dataHandle}".replace("{layerId}",o.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",o.UrlBuilder.toString(t.dataHandle)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),s={method:"GET",headers:a={}},void 0!==t.range&&(a.Range=t.range),[2,e.request(i,s)]}))}))},t.getMultipartUploadStatus=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerId}/data/{dataHandle}/multiparts/{multiPartToken}".replace("{layerId}",o.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",o.UrlBuilder.toString(t.dataHandle)).replace("{multiPartToken}",o.UrlBuilder.toString(t.multiPartToken)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.putBlob=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,s;return n(this,(function(n){return r="/layers/{layerId}/data/{dataHandle}".replace("{layerId}",o.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",o.UrlBuilder.toString(t.dataHandle)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),s={method:"PUT",headers:a={}},a["Content-Type"]="application/json",void 0!==t.body&&(s.body=JSON.stringify(t.body)),void 0!==t.contentLength&&(a["Content-Length"]=t.contentLength),[2,e.request(i,s)]}))}))},t.startMultipartUpload=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,s;return n(this,(function(n){return r="/layers/{layerId}/data/{dataHandle}/multiparts".replace("{layerId}",o.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",o.UrlBuilder.toString(t.dataHandle)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),s={method:"POST",headers:a={}},a["Content-Type"]="application/json",void 0!==t.body&&(s.body=JSON.stringify(t.body)),[2,e.request(i,s)]}))}))},t.uploadPart=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,s;return n(this,(function(n){return r="/layers/{layerId}/data/{dataHandle}/multiparts/{multiPartToken}/parts".replace("{layerId}",o.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",o.UrlBuilder.toString(t.dataHandle)).replace("{multiPartToken}",o.UrlBuilder.toString(t.multiPartToken)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("partNumber",t.partNumber),i.appendQuery("billingTag",t.billingTag),s={method:"POST",headers:a={}},a["Content-Type"]="application/json",void 0!==t.body&&(s.body=JSON.stringify(t.body)),void 0!==t.contentType&&(a["Content-Type"]=t.contentType),void 0!==t.contentLength&&(a["Content-Length"]=t.contentLength),[2,e.request(i,s)]}))}))}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(10);t.catalogExists=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/catalogs/{catalogHrn}".replace("{catalogHrn}",o.UrlBuilder.toString(t.catalogHrn)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),a={method:"HEAD",headers:{}},[2,e.request(i,a)]}))}))},t.createCatalog=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return"/catalogs",(r=new o.UrlBuilder(e.baseUrl+"/catalogs")).appendQuery("billingTag",t.billingTag),a={method:"POST",headers:i={}},i["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),[2,e.request(r,a)]}))}))},t.deleteCatalog=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/catalogs/{catalogHrn}".replace("{catalogHrn}",o.UrlBuilder.toString(t.catalogHrn)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),a={method:"DELETE",headers:{}},[2,e.request(i,a)]}))}))},t.deleteLayer=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/catalogs/{catalogHrn}/layers/{layerId}".replace("{catalogHrn}",o.UrlBuilder.toString(t.catalogHrn)).replace("{layerId}",o.UrlBuilder.toString(t.layerId)),i=new o.UrlBuilder(e.baseUrl+r),a={method:"DELETE",headers:{}},[2,e.request(i,a)]}))}))},t.getCatalog=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/catalogs/{catalogHrn}".replace("{catalogHrn}",o.UrlBuilder.toString(t.catalogHrn)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.getCatalogStatus=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/status/{token}".replace("{token}",o.UrlBuilder.toString(t.token)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.getCatalogs=function(e,t){return i(this,void 0,void 0,(function(){var r,i;return n(this,(function(n){return"/catalogs",(r=new o.UrlBuilder(e.baseUrl+"/catalogs")).appendQuery("billingTag",t.billingTag),r.appendQuery("verbose",t.verbose),r.appendQuery("q",t.q),r.appendQuery("organisation",t.organisation),r.appendQuery("organisationType",t.organisationType),r.appendQuery("layerType",t.layerType),r.appendQuery("region",t.region),r.appendQuery("schemaHrn",t.schemaHrn),r.appendQuery("resourceType",t.resourceType),r.appendQuery("coverage",t.coverage),r.appendQuery("access",t.access),r.appendQuery("limit",t.limit),r.appendQuery("sortBy",t.sortBy),r.appendQuery("sortOrder",t.sortOrder),i={method:"GET",headers:{}},[2,e.request(r,i)]}))}))},t.patchCatalog=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,s;return n(this,(function(n){return r="/catalogs/{catalogHrn}".replace("{catalogHrn}",o.UrlBuilder.toString(t.catalogHrn)),i=new o.UrlBuilder(e.baseUrl+r),s={method:"PATCH",headers:a={}},a["Content-Type"]="application/json",void 0!==t.body&&(s.body=JSON.stringify(t.body)),[2,e.request(i,s)]}))}))},t.patchLayer=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,s;return n(this,(function(n){return r="/catalogs/{catalogHrn}/layers/{layerId}".replace("{catalogHrn}",o.UrlBuilder.toString(t.catalogHrn)).replace("{layerId}",o.UrlBuilder.toString(t.layerId)),i=new o.UrlBuilder(e.baseUrl+r),s={method:"PATCH",headers:a={}},a["Content-Type"]="application/json",void 0!==t.body&&(s.body=JSON.stringify(t.body)),[2,e.request(i,s)]}))}))},t.updateCatalog=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,s;return n(this,(function(n){return r="/catalogs/{catalogHrn}".replace("{catalogHrn}",o.UrlBuilder.toString(t.catalogHrn)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),s={method:"PUT",headers:a={}},a["Content-Type"]="application/json",void 0!==t.body&&(s.body=JSON.stringify(t.body)),[2,e.request(i,s)]}))}))}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(10);t.getDataCoverageAdminAreas=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerId}/adminareas".replace("{layerId}",o.UrlBuilder.toString(t.layerId)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("datalevel",t.datalevel),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.getDataCoverageSizeMap=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerId}/heatmap/size".replace("{layerId}",o.UrlBuilder.toString(t.layerId)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("datalevel",t.datalevel),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.getDataCoverageSummary=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerId}/summary".replace("{layerId}",o.UrlBuilder.toString(t.layerId)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("version",t.version),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.getDataCoverageTile=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerId}/tilemap".replace("{layerId}",o.UrlBuilder.toString(t.layerId)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("datalevel",t.datalevel),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.getDataCoverageTimeMap=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerId}/heatmap/time".replace("{layerId}",o.UrlBuilder.toString(t.layerId)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("datalevel",t.datalevel),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(10);t.insertIndexes=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,s;return n(this,(function(n){return r="/layers/{layerID}".replace("{layerID}",o.UrlBuilder.toString(t.layerID)),i=new o.UrlBuilder(e.baseUrl+r),s={method:"POST",headers:a={}},a["Content-Type"]="application/json",void 0!==t.indexes&&(s.body=JSON.stringify(t.indexes)),[2,e.request(i,s)]}))}))},t.performQuery=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerID}".replace("{layerID}",o.UrlBuilder.toString(t.layerID)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("huge",t.huge?"true":"false"),i.appendQuery("query",t.query),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.performUpdate=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,s;return n(this,(function(n){return r="/layers/{layerID}".replace("{layerID}",o.UrlBuilder.toString(t.layerID)),i=new o.UrlBuilder(e.baseUrl+r),s={method:"PUT",headers:a={}},a["Content-Type"]="application/json",void 0!==t.request&&(s.body=JSON.stringify(t.request)),[2,e.request(i,s)]}))}))}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(10);t.platformAPI=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/platform/apis/{api}/{version}".replace("{api}",o.UrlBuilder.toString(t.api)).replace("{version}",o.UrlBuilder.toString(t.version)),i=new o.UrlBuilder(e.baseUrl+r),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.platformAPIList=function(e){return i(this,void 0,void 0,(function(){var t,r;return n(this,(function(i){return"/platform/apis",t=new o.UrlBuilder(e.baseUrl+"/platform/apis"),r={method:"GET",headers:{}},[2,e.request(t,r)]}))}))},t.resourceAPI=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/resources/{hrn}/apis/{api}/{version}".replace("{hrn}",o.UrlBuilder.toString(t.hrn)).replace("{api}",o.UrlBuilder.toString(t.api)).replace("{version}",o.UrlBuilder.toString(t.version)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("region",t.region),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.resourceAPIList=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/resources/{hrn}/apis".replace("{hrn}",o.UrlBuilder.toString(t.hrn)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("region",t.region),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(10);t.getChanges=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,s;return n(this,(function(n){return r="/layers/{layerId}/changes".replace("{layerId}",o.UrlBuilder.toString(t.layerId)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("startVersion",t.startVersion),i.appendQuery("endVersion",t.endVersion),i.appendQuery("sinceTime",t.sinceTime),i.appendQuery("additionalFields",t.additionalFields),i.appendQuery("billingTag",t.billingTag),s={method:"GET",headers:a={}},void 0!==t.range&&(a.Range=t.range),[2,e.request(i,s)]}))}))},t.getLayerVersion=function(e,t){return i(this,void 0,void 0,(function(){var r,i;return n(this,(function(n){return"/layerVersions",(r=new o.UrlBuilder(e.baseUrl+"/layerVersions")).appendQuery("version",t.version),r.appendQuery("billingTag",t.billingTag),i={method:"GET",headers:{}},[2,e.request(r,i)]}))}))},t.getPartitions=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,s;return n(this,(function(n){return r="/layers/{layerId}/partitions".replace("{layerId}",o.UrlBuilder.toString(t.layerId)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("version",t.version),i.appendQuery("additionalFields",t.additionalFields),i.appendQuery("billingTag",t.billingTag),s={method:"GET",headers:a={}},void 0!==t.range&&(a.Range=t.range),[2,e.request(i,s)]}))}))},t.latestVersion=function(e,t){return i(this,void 0,void 0,(function(){var r,i;return n(this,(function(n){return"/versions/latest",(r=new o.UrlBuilder(e.baseUrl+"/versions/latest")).appendQuery("startVersion",t.startVersion),r.appendQuery("billingTag",t.billingTag),i={method:"GET",headers:{}},[2,e.request(r,i)]}))}))},t.listVersions=function(e,t){return i(this,void 0,void 0,(function(){var r,i;return n(this,(function(n){return"/versions",(r=new o.UrlBuilder(e.baseUrl+"/versions")).appendQuery("startVersion",t.startVersion),r.appendQuery("endVersion",t.endVersion),r.appendQuery("billingTag",t.billingTag),i={method:"GET",headers:{}},[2,e.request(r,i)]}))}))},t.minimumVersion=function(e,t){return i(this,void 0,void 0,(function(){var r,i;return n(this,(function(n){return"/versions/minimum",(r=new o.UrlBuilder(e.baseUrl+"/versions/minimum")).appendQuery("billingTag",t.billingTag),i={method:"GET",headers:{}},[2,e.request(r,i)]}))}))}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(10);t.getChangesById=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerId}/changes".replace("{layerId}",o.UrlBuilder.toString(t.layerId)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("startVersion",t.startVersion),i.appendQuery("endVersion",t.endVersion),i.appendQuery("sinceTime",t.sinceTime),i.appendQuery("additionalFields",t.additionalFields),i.appendQuery("partition",t.partition),i.appendQuery("billingTag",t.billingTag),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.getPartitionsById=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerId}/partitions".replace("{layerId}",o.UrlBuilder.toString(t.layerId)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("partition",t.partition),i.appendQuery("version",t.version),i.appendQuery("additionalFields",t.additionalFields),i.appendQuery("billingTag",t.billingTag),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.quadTreeIndex=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerId}/versions/{version}/quadkeys/{quadKey}/depths/{depth}".replace("{layerId}",o.UrlBuilder.toString(t.layerId)).replace("{version}",o.UrlBuilder.toString(t.version)).replace("{quadKey}",o.UrlBuilder.toString(t.quadKey)).replace("{depth}",o.UrlBuilder.toString(t.depth)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("additionalFields",t.additionalFields),i.appendQuery("billingTag",t.billingTag),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.quadTreeIndexVolatile=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerId}/quadkeys/{quadKey}/depths/{depth}".replace("{layerId}",o.UrlBuilder.toString(t.layerId)).replace("{quadKey}",o.UrlBuilder.toString(t.quadKey)).replace("{depth}",o.UrlBuilder.toString(t.depth)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("additionalFields",t.additionalFields),i.appendQuery("billingTag",t.billingTag),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(10);t.checkHandleExists=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerId}/data/{dataHandle}".replace("{layerId}",o.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",o.UrlBuilder.toString(t.dataHandle)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),a={method:"HEAD",headers:{}},[2,e.request(i,a)]}))}))},t.deleteVolatileBlob=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerId}/data/{dataHandle}".replace("{layerId}",o.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",o.UrlBuilder.toString(t.dataHandle)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),a={method:"DELETE",headers:{}},[2,e.request(i,a)]}))}))},t.getVolatileBlob=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a;return n(this,(function(n){return r="/layers/{layerId}/data/{dataHandle}".replace("{layerId}",o.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",o.UrlBuilder.toString(t.dataHandle)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),a={method:"GET",headers:{}},[2,e.request(i,a)]}))}))},t.putVolatileBlob=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,s;return n(this,(function(n){return r="/layers/{layerId}/data/{dataHandle}".replace("{layerId}",o.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",o.UrlBuilder.toString(t.dataHandle)),(i=new o.UrlBuilder(e.baseUrl+r)).appendQuery("billingTag",t.billingTag),s={method:"PUT",headers:a={}},a["Content-Type"]="application/json",void 0!==t.body&&(s.body=JSON.stringify(t.body)),[2,e.request(i,s)]}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=!0;function n(e,t){if(!i&&!e)throw new Error(void 0!==t?t:"ASSERTION failed")}var o=function(e,t,r,i,n){this.key=e,this.value=t,this.size=r,this.newer=i,this.older=n};t.Entry=o;var a=function(){function e(e,t){void 0===t&&(t=function(){return 1}),this.m_size=0,this.m_map=new Map,this.m_newest=null,this.m_oldest=null,this.m_capacity=e,this.m_sizeFunction=t}return e.prototype.forEach=function(e,t){for(var r=this.m_newest;null!==r;)e.call(t,r.value,r.key,this),r=r.older},Object.defineProperty(e.prototype,"size",{get:function(){return this.m_size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"capacity",{get:function(){return this.m_capacity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"map",{get:function(){return this.m_map},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"newest",{get:function(){return this.m_newest},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oldest",{get:function(){return this.m_oldest},enumerable:!0,configurable:!0}),e.prototype.setCapacity=function(e){this.m_capacity=e,this.evict()},e.prototype.shrinkToCapacity=function(){for(var e=0,t=this.m_sizeFunction,r=this.m_newest;null!==r;){var i=t(r.value);r.size=i,e+=i,r=r.older}this.m_size=e,this.evict()},e.prototype.set=function(e,t){var r=this.m_sizeFunction(t),i=this.m_map.get(e);if(void 0!==i)this.m_size=this.m_size-i.size+r,i.value=t,i.size=r,this.promote(i),this.evict();else{if(r>this.m_capacity)return;if(i=new o(e,t,r,null,null),0===this.m_map.size)this.m_newest=this.m_oldest=i;else{n(null!==this.m_newest);var a=this.m_newest;i.older=this.m_newest,a.newer=i,this.m_newest=i}this.m_map.set(e,i),this.m_size+=r,this.evict()}},e.prototype.get=function(e){var t=this.m_map.get(e);if(void 0!==t)return this.promote(t),t.value},e.prototype.has=function(e){return this.m_map.has(e)},e.prototype.clear=function(){this.m_newest=this.m_oldest=null,this.m_size=0,this.m_map.clear()},e.prototype.evictAll=function(){var e=this.evictionCallback;void 0!==e&&this.forEach((function(t,r){e(r,t)})),this.clear()},e.prototype.delete=function(e){var t=this.m_map.get(e);return void 0!==t&&(t===this.m_newest?this.m_newest=t.older:t.newer?t.newer.older=t.older:n(!1),t===this.m_oldest?this.m_oldest=t.newer:t.older?t.older.newer=t.newer:n(!1),this.m_size-=t.size,this.m_map.delete(e))},e.prototype.evict=function(){for(;null!==this.m_oldest&&this.m_size>this.m_capacity;){if(void 0===this.evictOldest())return}},e.prototype.evictOldest=function(){n(null!==this.m_oldest);var e=this.m_oldest;n(null===e.older);var t=e;if(void 0!==this.canEvict)for(;!this.canEvict(t.key,t.value);){if(null===t.newer)return;t=t.newer}if(t===e)this.m_oldest=t.newer,null!==t.newer&&(n(t.newer.older===t),t.newer.older=null);else{if(null===t.newer)return;n(t.newer.older===t),t.newer.older=t.older,null!==t.older&&(t.older.newer=t.newer)}var r=this.m_map.delete(t.key);return n(!0===r),r&&void 0!==this.evictionCallback&&this.evictionCallback(t.key,t.value),this.m_size-=t.size,t},e.prototype.promote=function(e){if(e!==this.m_newest){e.newer&&(n(e.newer.older===e),e.newer.older=e.older),e.older&&(n(e.older.newer===e),e.older.newer=e.newer),e===this.m_oldest&&(this.m_oldest=e.newer),e.newer=null,e.older=this.m_newest,n(null!==this.m_newest);var t=this.m_newest;n(null===t.newer),t.newer=e,this.m_newest=e}},e}();t.LRUCache=a},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){var t=this;this.executor=e,this.promise=new Promise((function(e,r){t.resolveFunc=e,t.rejectFunc=r}))}return e.prototype.exec=function(){this.executor().then(this.resolveFunc).catch(this.rejectFunc)},e}(),a=function(){function e(e,t){void 0===e&&(e=fetch),void 0===t&&(t=5),this.fetchFunction=e,this.maxRetries=t,this.activeDownloadCount=0,this.downloadQueue=new Array}return e.fetchRepeatedly=function(t,r,o,a,s){return i(this,void 0,void 0,(function(){var i,c;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,t(a,s)];case 1:return 503!==(i=n.sent()).status||r>=o?[2,i]:[3,3];case 2:if((c=n.sent()).hasOwnProperty("isCancelled")||c.hasOwnProperty("name")&&"AbortError"===c.name||r>o)throw c;return[3,3];case 3:return[2,e.waitFor(e.retryTimeout*r).then((function(){return e.fetchRepeatedly(t,r+1,o,a,s)}))]}}))}))},e.waitFor=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(t){return[2,new Promise((function(t){return setTimeout(t,e)}))]}))}))},e.prototype.download=function(t,r){return i(this,void 0,void 0,(function(){var i,a=this;return n(this,(function(n){return this.activeDownloadCount>=e.maxParallelDownloads?(i=new o((function(){return a.doDownload(t,r)})),this.downloadQueue.push(i),[2,i.promise]):[2,this.doDownload(t,r)]}))}))},e.prototype.doDownload=function(t,r){return i(this,void 0,void 0,(function(){var i=this;return n(this,(function(n){return++this.activeDownloadCount,[2,e.fetchRepeatedly(this.fetchFunction,0,this.maxRetries,t,r).then((function(e){return i.onDownloadDone(),e})).catch((function(e){throw i.onDownloadDone(),e}))]}))}))},e.prototype.onDownloadDone=function(){--this.activeDownloadCount,this.execDeferredDownload()},e.prototype.execDeferredDownload=function(){var e=this.downloadQueue.pop();void 0!==e&&e.exec()},e.retryTimeout=500,e.maxParallelDownloads=16,e}();t.DatastoreDownloadManager=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.data=e}return e.fromString=function(t){if(t.startsWith("http:")||t.startsWith("https:"))return new e({partition:"catalog-url",service:"datastore",region:"",account:"",resource:encodeURIComponent(t)});var r=t.split(":");if(r.length<this.ENTRIES_COUNT||"hrn"!==r[0])throw new Error("Invalid HRN");return new e({partition:r[this.PARTITION_POS],service:r[this.SERVICE_POS],region:r[this.REGION_POS],account:r[this.ACCOUNT_POS],resource:r.slice(this.RESOURCE_POS).join(":")})},e.prototype.toString=function(){return"hrn:"+this.data.partition+":"+this.data.service+":"+(void 0===this.data.region?"":this.data.region)+":"+(void 0===this.data.account?"":this.data.account)+":"+this.data.resource},e.PARTITION_POS=1,e.SERVICE_POS=2,e.REGION_POS=3,e.ACCOUNT_POS=4,e.RESOURCE_POS=5,e.ENTRIES_COUNT=e.RESOURCE_POS+1,e.RESOURCE_ID_POS=1,e.RESOURCE_VERSION_POS=2,e.RESOURCE_TYPE_POS=3,e.RESOURCE_PARAMS_COUNT=3,e}();t.HRN=i},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(141),a=r(144),s=r(82),c=function(){function e(e){this.m_options=e}return e.prototype.ready=function(){return void 0!==this.m_layer},e.prototype.catalogClient=function(){return this.m_catalogClient},e.prototype.connect=function(){return i(this,void 0,void 0,(function(){var e,t,r,i=this;return n(this,(function(n){switch(n.label){case 0:return e=new o.DataStoreClient(this.m_options),t=this,[4,e.getCatalogClient(this.m_options.catalogVersion).catch((function(){throw new Error("Cannot connect to "+i.m_options.hrn.data.partition)}))];case 1:return t.m_catalogClient=n.sent(),r=this.m_catalogClient.getLayer(this.m_options.layer),this.m_layer=r,[2]}}))}))},e.prototype.getTile=function(e,t){return i(this,void 0,void 0,(function(){var r,i;return n(this,(function(n){switch(n.label){case 0:if(void 0===this.m_layer)throw new Error("Hype data provider not connected");return[4,this.m_layer.getTile(e,{signal:t})];case 1:if(!(r=n.sent()).ok)throw i="Error downloading tile "+s.mortonCodeFromQuadKey(e)+" from catalog "+this.m_options.hrn.toString()+": "+r.status+" "+r.statusText,404===r.status?new a.NotFoundError(i):new Error(i);return[2,r.arrayBuffer()]}}))}))},e}();t.HypeDataProvider=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(4),n=r(61),o=r(333),a=r(1),s=r(44),c=r(382),l=r(185),u=r(186),d=r(187),h=r(188),m=r(189);class p extends o.TileDataSource{constructor(e,t){super(new o.TileFactory(e),t.dataSourceOptions),this.interactiveTileType=e,this.params=t,this.addTileBackground=!1,this.cacheable=!1,this.m_tilesToRender=new Set,this.m_tileCacheSize=64,this.m_featureFilters=[],this.m_invalidTiles=new Set,this.m_isInteractiveDataSourceReady=!1,this.logger=a.LoggerManager.instance.create(this.getLoggerName(),{enabled:!0}),this.m_tilesToRefresh=new Set,this.m_enableRefresh=t.enableRefresh,this.m_tileCache=new n.LRUCache(this.m_tileCacheSize),this.m_tileCache.evictionCallback=(e,t)=>{t.dispose()},void 0!==t.intersectionAgent&&this.setUpIntersectionAgent(t.intersectionAgent),void 0!==t.levelWithData&&(this.m_levelWithData=t.levelWithData)}set lastSelectedTile(e){this.m_lastSelectedTile=e}get lastSelectedTile(){return this.m_lastSelectedTile}set levelWithData(e){this.m_levelWithData=e}get levelWithData(){return this.m_levelWithData}get selectedTiles(){return this.m_tilesToRender}get enableRefresh(){return!!this.m_enableRefresh}get i18n(){return this.m_i18next&&!0===this.m_i18next.isInitialized?this.m_i18next:(this.m_i18next=c.createInstance(),this.m_i18next.init({initImmediate:!1,ns:"translation",defaultNS:"translation",fallbackLng:p.DEFAULT_LOCALE,debug:!1,resources:{}}),this.m_i18next)}get locale(){return this.i18n.language}set locale(e){this.i18n.changeLanguage(e)}get featureFilters(){return this.m_featureFilters}selectFeature(e,t){let r;void 0!==t&&(r=this.getIntersectionIndex(t)),this.dispatchEvent({type:p.EVENT_FEATURE_SELECT,featureObject:e,intersectionIndex:r})}deselectFeature(){this.dispatchEvent({type:p.EVENT_FEATURE_DESELECT,featureId:this.m_selectedFeatureId}),this.m_selectedFeatureId=void 0}unhighlightFeature(){this.m_highlightedFeatureId=void 0}async connect(){await super.connect();const e=this.params.schemaProviderOptions;if(void 0===this.params.dataStore&&void 0===e)return void(this.m_isInteractiveDataSourceReady=!0);if(e&&!1===e.enabled)return void(this.m_isInteractiveDataSourceReady=!0);const t=e&&e.schemaProviderFactory?e.schemaProviderFactory:h.commonSchemaProviderFactory,r=e?e.source:void 0;this.m_schemaProvider=await t(r,this.params.dataStore,{loggerName:this.name+" Schema Provider"}),this.m_isInteractiveDataSourceReady=!0}ready(){return this.m_isInteractiveDataSourceReady}async resetDataProvider(e,t=!1){const r=new s.HypeDataProvider(e);await r.connect(),this.params.dataSourceOptions&&(this.params.dataSourceOptions.dataProvider=r),this.params.dataStore=e,t&&(this.m_tileCache.evictAll(),this.resetComposedTile())}schemaProvider(){return this.m_schemaProvider}async setSchemaProvider(e){this.m_schemaProvider=e}translate(e,t){return void 0===t?this.i18n.t(e):this.i18n.t(e,t)}hasTileToRender(e){return this.m_tilesToRender.has(e)}getIntersectionAgent(){return this.m_intersectionAgent}getFeatureObject(e){return e}findFeatures(e,t){return this.m_intersectionAgent?this.m_intersectionAgent.raycastIntersections(e,t).map(e=>e.object):[]}getSelectedFeatureId(){return this.m_selectedFeatureId}getHighlightedFeatureId(){return this.m_highlightedFeatureId}getTile(e){return e.level===this.m_levelWithData?this.getDataLevelTile(e):this.getComposedTile(e)}retrieveTileData(e,t=!0){const r=e.mortonCode();this.dataProvider().getTile(e).then(async i=>{if(t&&!this.m_tileCache.has(r))return;const n=await this.decodeTile(i,e);n&&(n.partitionData=i,(i instanceof ArrayBuffer||i instanceof SharedArrayBuffer)&&(n.dataSize=i.byteLength),this.tileDecoded(e,n))}).catch(async t=>{let i;if(this.logger.error(t),t instanceof s.NotFoundError){const e=await this.getCatalogLayer();e&&"volatile"===e.layerType&&(i=new d.default(r))}void 0===i&&(i=new u.default(r)),this.dispatchEvent({type:p.EVENT_TILE_GET,tileKey:e,error:i})})}async decodeTile(e,t){return this.decoder.decodeTile(e,t,this.projection).catch(e=>{this.logger.error(e.message),this.dispatchEvent({type:p.EVENT_TILE_DECODED,tileKey:t,error:new l.default(`${l.default.DECODING_ERROR}: ${e}`)})})}tileDecoded(e,t){this.dispatchEvent({type:p.EVENT_TILE_DECODED,tileKey:e,decodedTile:t})}copyObjectFromTileIntoComposedTile(e){this.m_composedTile&&this.m_composedTile.copyObjectFromTile(e)}getObjectsToRaycast(e){return e.objects.filter(e=>{const t=e.userData.tooltipRanges;return t&&t.size>0})}canSelectMoreTiles(){return this.selectedTiles.size<this.m_tileCache.capacity}async selectTile(e){return this.isTileValid(e)||(this.markTileValid(e),this.m_tileCache.delete(e)),!this.m_tilesToRender.has(e)&&(this.enableRefresh&&this.m_tileCache.delete(e),this.m_tilesToRender.add(e),this.m_lastSelectedTile=e,this.resetComposedTile(),this.dispatchEvent({type:p.EVENT_TILE_SELECT,tileKey:i.TileKey.fromMortonCode(e)}),!0)}deselectTile(e){this.m_tilesToRender.has(e)&&(this.m_tilesToRender.delete(e),this.resetComposedTile(),this.m_lastSelectedTile=null,this.dispatchEvent({type:p.EVENT_TILE_DESELECT,tileKey:i.TileKey.fromMortonCode(e)}),this.m_selectedFeatureTileKeyCode===e&&this.deselectFeature(),this.requestUpdate())}clearSelectedTiles(){this.resetComposedTile(),this.m_lastSelectedTile=null,this.m_tilesToRender.forEach(e=>{this.m_tilesToRender.delete(e),this.dispatchEvent({type:p.EVENT_TILE_DESELECT,tileKey:i.TileKey.fromMortonCode(e)})}),this.deselectFeature(),this.requestUpdate()}refreshTiles(){this.m_tilesToRefresh=new Set(this.m_tilesToRender),this.m_tileCache.evictAll(),this.resetComposedTile()}addFeatureFilter(e,t){this.removeFeatureFilter(e),this.m_featureFilters.push(e),t&&(this.applyFeatureFilters(),this.requestUpdate())}removeFeatureFilter(e){this.m_featureFilters=this.m_featureFilters.filter(t=>!(t.feature===e.feature&&t.value===e.value))}clearFilters(){this.m_featureFilters=[],this.applyFeatureFilters()}applyFeatureFilters(e){this.m_featureFilters.forEach(t=>{if(void 0===this.mapView.tileGeometryManager)return;this.mapView.tileGeometryManager.hideKind(t.value,t.exclude);const r=[];void 0!==e?r.push(e):void 0!==this.m_composedTile&&(r.push(this.m_composedTile),this.m_composedTile.resetVisibilityCounter()),r.length&&this.mapView.tileGeometryManager.updateTiles(r)})}setUpIntersectionAgent(e){this.m_intersectionAgent=e,this.m_intersectionAgent.addEventListener(m.InteractiveIntersectionAgent.EVENT_OBJECT_SELECT,this.handleFeatureSelect.bind(this)),this.m_intersectionAgent.addEventListener(m.InteractiveIntersectionAgent.EVENT_INTERSECTION_CHANGE,this.handleFeatureHighlight.bind(this))}async getCatalogLayer(){if(void 0===this.params.dataStore)return void this.logger.error("DataSource is not fully initialized - dataStore is not provided.");const e=await this.getCatalogClient(this.params.dataStore);if(void 0!==e)return e.getLayer(this.params.dataStore.layer);this.logger.warn("Cannot get CatalogClient instance.")}async getCatalogClient(e){if(void 0===this.m_catalogClient){const t=new s.DataStoreClient(e);if(2!==t.apiVersion)return void this.logger.warn("Data Service v1 is not supported.");this.m_catalogClient=await t.getCatalogClient(e.catalogVersion)}return this.m_catalogClient}getLoggerName(){return this.name}addTranslation(e,t,r){this.i18n.addResource(e,"translation",t,r)}addTranslations(e,t){this.i18n.addResources(e,"translation",t)}getComposedTile(e){if(void 0!==this.m_composedTile&&this.m_composedTile.objects.length>0)return this.m_composedTile;if(void 0===this.m_composedTile&&(this.m_composedTile=new this.interactiveTileType(this,e)),this.m_tilesToRender.forEach(e=>{const t=this.getDataLevelTile(i.TileKey.fromMortonCode(e));void 0!==t&&this.copyObjectFromTileIntoComposedTile(t)}),void 0!==this.m_intersectionAgent){const e=this.getObjectsToRaycast(this.m_composedTile);this.m_intersectionAgent.attachObjects(e,!1)}return this.m_composedTile}getDataLevelTile(e,t=!0){const r=e.mortonCode();let i,n,o=!1;if(t?(o=!(i=this.m_tileCache.get(r)))&&(i=new this.interactiveTileType(this,e),this.m_tileCache.set(r,i)):i=new this.interactiveTileType(this,e),o)try{this.retrieveTileData(e,t)}catch(e){n=e}return this.dispatchEvent({type:o?p.EVENT_TILE_GET:p.EVENT_TILE_GET_FROM_CACHE,tileKey:e,tile:i,error:n}),i}createGeometries(e,t,r){const i=e.mortonCode();void 0!==(r=r||this.m_tileCache.get(i))&&(r.decodedTile=t,this.m_tilesToRefresh.has(i)&&(this.m_tilesToRefresh.delete(i),0===this.m_tilesToRefresh.size&&this.dispatchEvent({type:p.EVENT_TILES_REFRESHED})),0===this.m_tilesToRefresh.size&&(this.resetComposedTile(),this.requestUpdate()))}resetComposedTile(){void 0!==this.m_composedTile&&(this.m_composedTile.objects.length=0)}getIntersectionIndex(e){if(!e.intersected||!e.intersection)return;let t=e.intersection.faceIndex;return null==t&&(t=e.intersection.index),null!=t?t:void 0}markTileValid(e){this.m_invalidTiles.delete(e)}markTileInvalid(e){this.m_invalidTiles.add(e)}isTileValid(e){return!this.m_invalidTiles.has(e)}handleFeatureHighlight(e){const t=e,r=t.intersected,i=t.intersection?t.intersection.object:void 0,n=t.intersection?t.intersection.index:void 0;r&&void 0!==i?(this.highlightFeature(i,this.getFeatureObject(i),t),this.m_highlightedFeatureIndex=n):this.unhighlightFeature(),this.requestUpdate()}handleFeatureSelect(e){const t=e,r=t.intersection?t.intersection.object:void 0;if(t.intersected&&void 0!==r){const e=this.getFeatureObject(r);if(void 0!==e){this.selectFeature(e,t);const i=r.tileKeyCode;void 0!==i&&(this.m_selectedFeatureTileKeyCode=i)}}else this.deselectFeature();this.requestUpdate()}}t.InteractiveDataSource=p,p.EVENT_TILE_SELECT="tileselect",p.EVENT_TILE_DESELECT="tiledeselect",p.EVENT_TILE_GET="tileget",p.EVENT_TILE_GET_FROM_CACHE="tilegetfromcache",p.EVENT_TILE_DECODED="tiledecode",p.EVENT_BEFORE_TILE_DECODE="beforetiledecode",p.EVENT_BEFORE_TILE_RENDERED="beforetilerendered",p.EVENT_TILE_RENDERED="tilerendered",p.EVENT_TILES_REFRESHED="tilesrefreshed",p.EVENT_FEATURE_SELECT="featureselect",p.EVENT_FEATURE_DESELECT="featuredeselect",p.DEFAULT_LOCALE="en"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1);class n{constructor(e,t,r,i,n){this.key=e,this.value=t,this.size=r,this.newer=i,this.older=n}}t.Entry=n;t.LRUCache=class{constructor(e,t=(()=>1)){this.m_size=0,this.m_map=new Map,this.m_newest=null,this.m_oldest=null,this.m_capacity=e,this.m_sizeFunction=t}forEach(e,t){let r=this.m_newest;for(;null!==r;){const i=r.older;e.call(t,r.value,r.key,this),r=i}}get size(){return this.m_size}get capacity(){return this.m_capacity}get map(){return this.m_map}get newest(){return this.m_newest}get oldest(){return this.m_oldest}setCapacity(e){this.m_capacity=e,this.evict()}setCapacityAndMeasure(e,t=(()=>1)){this.m_capacity=e,this.m_sizeFunction=t,this.shrinkToCapacity()}shrinkToCapacity(){let e=0;const t=this.m_sizeFunction;let r=this.m_newest;for(;null!==r;){const i=t(r.value);r.size=i,e+=i,r=r.older}this.m_size=e,this.evict()}set(e,t){const r=this.m_sizeFunction(t);let o=this.m_map.get(e);if(void 0!==o)this.m_size=this.m_size-o.size+r,o.value=t,o.size=r,this.promoteEntry(o),this.evict();else{if(r>this.m_capacity)return;if(o=new n(e,t,r,null,null),0===this.m_map.size)this.m_newest=this.m_oldest=o;else{i.assert(null!==this.m_newest);const e=this.m_newest;o.older=this.m_newest,e.newer=o,this.m_newest=o}this.m_map.set(e,o),this.m_size+=r,this.evict()}}get(e){const t=this.m_map.get(e);if(void 0!==t)return this.promoteEntry(t),t.value}has(e){return this.m_map.has(e)}clear(){this.m_newest=this.m_oldest=null,this.m_size=0,this.m_map.clear()}evictAll(){const e=this.evictionCallback;void 0!==e&&this.forEach((t,r)=>e(r,t)),this.clear()}evictSelected(e,t){const r=this.evictionCallback;let i=this.m_newest;for(;null!==i;){const n=i.older;e.call(t,i.value,i.key)&&(void 0!==r&&r(i.key,i.value),this.deleteEntry(i),this.m_map.delete(i.key)),i=n}}delete(e){const t=this.m_map.get(e);return void 0!==t&&(this.deleteEntry(t),this.m_map.delete(e))}evict(){for(;null!==this.m_oldest&&this.m_size>this.m_capacity;){if(void 0===this.evictOldest())return}}evictOldest(){i.assert(null!==this.m_oldest);const e=this.m_oldest;i.assert(null===e.older);let t=e;if(void 0!==this.canEvict)for(;!this.canEvict(t.key,t.value);){if(null===t.newer)return;t=t.newer}if(t===e)this.m_oldest=t.newer,null!==t.newer&&(i.assert(t.newer.older===t),t.newer.older=null);else{if(null===t.newer)return;i.assert(t.newer.older===t),t.newer.older=t.older,null!==t.older&&(t.older.newer=t.newer)}const r=this.m_map.delete(t.key);return i.assert(!0===r),r&&void 0!==this.evictionCallback&&this.evictionCallback(t.key,t.value),this.m_size-=t.size,t}deleteEntry(e){e===this.m_newest?this.m_newest=e.older:e.newer?e.newer.older=e.older:i.assert(!1),e===this.m_oldest?this.m_oldest=e.newer:e.older?e.older.newer=e.newer:i.assert(!1),this.m_size-=e.size}promoteEntry(e){if(e===this.m_newest)return;e.newer&&(i.assert(e.newer.older===e),e.newer.older=e.older),e.older&&(i.assert(e.older.newer===e),e.older.newer=e.newer),e===this.m_oldest&&(this.m_oldest=e.newer),e.newer=null,e.older=this.m_newest,i.assert(null!==this.m_newest);const t=this.m_newest;i.assert(null===t.newer),t.newer=e,this.m_newest=e}}},function(e,t,r){"use strict";function i(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),i(r(334)),i(r(184))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(61),n=r(83),o=r(1),a=r(184);t.TileFactory=class{constructor(e){this.m_modelConstructor=e}create(e,t){return new this.m_modelConstructor(e,t)}};const s=3;class c extends n.DataSource{constructor(e,t){if(super(t.name,t.styleSetName,t.minZoomLevel,t.maxZoomLevel,t.storageLevelOffset),this.m_tileFactory=e,this.m_options=t,this.logger=o.LoggerManager.instance.create("TileDataSource"),this.m_isReady=!1,t.decoder)this.m_decoder=t.decoder;else{if(!t.concurrentDecoderServiceName)throw new Error(`TileDataSource[${this.name}]: unable to create, missing decoder or `+"concurrentDecoderServiceName");this.m_decoder=n.ConcurrentDecoderFacade.getTileDecoder(t.concurrentDecoderServiceName,t.concurrentDecoderScriptUrl,t.concurrentDecoderWorkerCount)}this.useGeometryLoader=!0,this.cacheable=!0,this.m_tileLoaderCache=new i.LRUCache(this.getCacheCount()),this.m_tileLoaderCache.evictionCallback=(e,t)=>{t.cancel()}}dispose(){this.decoder.dispose()}ready(){return this.m_isReady&&this.m_options.dataProvider.ready()}get decoder(){return this.m_decoder}async connect(){await Promise.all([this.m_options.dataProvider.connect(),this.m_decoder.connect()]),this.m_isReady=!0,this.m_decoder.configure(void 0,void 0,void 0,{storageLevelOffset:this.m_options.storageLevelOffset})}setStyleSet(e,t,r){this.m_decoder.configure(e,t,r),this.mapView.markTilesDirty(this)}setTheme(e,t){const r=void 0!==this.styleSetName&&e.styles?e.styles[this.styleSetName]:void 0;void 0!==r&&this.setStyleSet(r,e.definitions,t)}clearCache(){this.m_tileLoaderCache.evictAll()}dataProvider(){return this.m_options.dataProvider}getTilingScheme(){return this.m_options.tilingScheme}getTile(e){const t=this.m_tileFactory.create(this,e),r=e.mortonCode(),i=this.m_tileLoaderCache.get(r);if(void 0!==i)t.tileLoader=i;else{const i=new a.TileLoader(this,e,this.m_options.dataProvider,this.decoder,0);t.tileLoader=i,t.copyrightInfo=this.m_options.copyrightInfo,void 0!==this.m_options.copyrightProvider&&this.m_options.copyrightProvider.getCopyrights(t.geoBox,e.level).then(e=>{t.copyrightInfo=void 0===t.copyrightInfo?e:[...t.copyrightInfo,...e],this.requestUpdate()}),e.level<=s&&this.m_tileLoaderCache.set(r,i)}return void 0!==t.tileLoader.decodedTile?t.decodedTile=t.tileLoader.decodedTile:t.load(),t}getTileInfo(e){return new Promise((t,r)=>{const i=new a.TileInfoLoader(this,e,this.m_options.dataProvider,this.decoder,0);i.loadAndDecode().then(e=>{e===n.TileLoaderState.Ready?t(i.tileInfo):r(new Error(`TileDataSource#getInfoTile wrong final state: ${e}`))})})}getCacheCount(){return 2*Math.pow(2,s)}}t.TileDataSource=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SepiaShader={uniforms:{tDiffuse:{value:null},amount:{value:1}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }",fragmentShader:"\n        uniform float amount;\n        uniform sampler2D tDiffuse;\n        varying vec2 vUv;\n        void main() {\n            vec4 color = texture2D( tDiffuse, vUv );\n            vec3 c = color.rgb;\n            color.r = dot( c, vec3( 1.0 - 0.607 * amount, 0.769 * amount, 0.189 * amount ) );\n            color.g = dot( c, vec3( 0.349 * amount, 1.0 - 0.314 * amount, 0.168 * amount ) );\n            color.b = dot( c, vec3( 0.272 * amount, 0.534 * amount, 1.0 - 0.869 * amount ) );\n            gl_FragColor = vec4( min( vec3( 1.0 ), color.rgb ), color.a );\n        }"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VignetteShader={uniforms:{tDiffuse:{value:null},offset:{value:1},darkness:{value:1}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }",fragmentShader:"\n        uniform float offset;\n        uniform float darkness;\n        uniform sampler2D tDiffuse;\n        varying vec2 vUv;\n        void main() {\n            vec4 texel = texture2D( tDiffuse, vUv );\n            vec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );\n            gl_FragColor = vec4( mix( texel.rgb, vec3( 1.0 - darkness ), dot( uv, uv ) ), texel.a );\n        }"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(147);class o extends n.SolidLineMaterial{constructor(e){const t={};void 0!==e&&void 0!==e.color&&(t.color=e.color),void 0!==e&&void 0!==e.outlineColor&&(t.outlineColor=e.outlineColor),void 0!==e&&void 0!==e.lineWidth&&(t.lineWidth=e.lineWidth),void 0!==e&&void 0!==e.outlineWidth&&(t.outlineWidth=e.outlineWidth),void 0!==e&&void 0!==e.opacity&&(t.opacity=e.opacity),void 0!==e&&void 0!==e.fog&&(t.fog=e.fog),super(t),this.name="DashedLineMaterial",Object.assign(this.uniforms,{dashSize:new i.Uniform(o.DEFAULT_DASH_SIZE),gapSize:new i.Uniform(o.DEFAULT_GAP_SIZE)}),void 0!==e&&(void 0!==e.dashSize&&(this.dashSize=e.dashSize),void 0!==e.gapSize&&(this.gapSize=e.gapSize),void 0!==e.fog&&(this.fog=null!==e.fog),void 0===e.dashColor?this.dashTransparency=!0:(this.dashColor.set(e.dashColor),this.dashColor=this.dashColor))}get dashColor(){return this.uniforms.dashColor.value}set dashColor(e){this.uniforms.dashColor.value=e,this.dashTransparency=!1}get dashTransparency(){return!this.defines.USE_DASH_COLOR}set dashTransparency(e){this.defines.USE_DASH_COLOR=e?0:1}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e,this.updateDashedFeature()}updateDashedFeature(){this.defines.DASHED_LINE=this.gapSize>0?1:0}}t.DashedLineMaterial=o,o.DEFAULT_DASH_SIZE=1,o.DEFAULT_GAP_SIZE=1},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertShaderInclude=function(e,t,r,i){const n=!0===i?"\t":"";return e.replace(`#include <${t}>`,`#include <${t}>\n${n}#include <${r}>`)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={extrusion_pars_vertex:"\n// Extrusion axis (xyz: vector, w: factor).\nattribute vec4 extrusionAxis;\nuniform float extrusionRatio;\nvarying vec4 vExtrusionAxis;\n",extrusion_vertex:"\ntransformed = transformed - extrusionAxis.xyz + extrusionAxis.xyz * extrusionRatio;\nvExtrusionAxis = vec4(normalMatrix * extrusionAxis.xyz, extrusionAxis.w);\n",extrusion_normal_fragment_begin:"\n#ifdef FLAT_SHADED\n    // Flattened this divergent path to prevent undefined behaviour in the following derivatives\n    // functions. For more info:\n    // http://www.aclockworkberry.com/shader-derivative-functions/#Derivatives_and_branches\n\n    // Workaround for Adreno/Nexus5 not able able to do dFdx( vViewPosition ) ...\n    vec3 fdx = vec3(dFdx(vViewPosition.x), dFdx(vViewPosition.y), dFdx(vViewPosition.z));\n    vec3 fdy = vec3(dFdy(vViewPosition.x), dFdy(vViewPosition.y), dFdy(vViewPosition.z));\n    vec3 normal = cross( fdx, fdy );\n    if (vExtrusionAxis.w > 0.999999) {\n        normal = vExtrusionAxis.xyz;\n    }\n    normal = normalize(normal);\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * (float(gl_FrontFacing) * 2.0 - 1.0);\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * (float(gl_FrontFacing) * 2.0 - 1.0);\n\t\t\tbitangent = bitangent * (float(gl_FrontFacing) * 2.0 - 1.0);\n\t\t#endif\n\t#endif\n#endif\n// non perturbed normal for clearcoat among others\nvec3 geometryNormal = normal;\n",extrusion_pars_fragment:"\nuniform float extrusionRatio;\nvarying vec4 vExtrusionAxis;\n",extrusion_fragment:"\ngl_FragColor.a *= smoothstep( 0.0, 0.25, extrusionRatio );\n"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={fading_pars_vertex:"\nvarying float fadingDepth;\n",fading_vertex:"\nfadingDepth = -mvPosition.z;\n",fading_pars_fragment:"\nvarying float fadingDepth;\nuniform float fadeNear;\nuniform float fadeFar;\n",fading_fragment:'\n\n// lerp with "hard" edges\n//float fadingFactor = 1.0 - clamp((fadingDepth - fadeNear) / (fadeFar - fadeNear), 0.0, 1.0);\n\n// smooth transitions\nfloat fadingFactor = smoothstep( fadeNear, fadeFar, fadingDepth );\n\ngl_FragColor.a *= 1.0 - fadingFactor;\n\n// debugging color:\n// gl_FragColor = vec4(1., fadingFactor, fadingFactor, 1.0);\n'}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(85),o="\n#define EDGE_DEPTH_OFFSET 0.0001\n\nattribute vec3 position;\nattribute vec4 color;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 edgeColor;\nuniform float edgeColorMix;\n\n#ifdef USE_DISPLACEMENTMAP\nattribute vec3 normal;\nattribute vec2 uv;\nuniform sampler2D displacementMap;\n#endif\n\nvarying vec3 vColor;\n\n#ifdef USE_EXTRUSION\n#include <extrusion_pars_vertex>\n#endif\n\n#ifdef USE_FADING\n#include <fading_pars_vertex>\n#endif\n\nvoid main() {\n\n    #ifdef USE_COLOR\n    vColor = mix(edgeColor.rgb, color.rgb, edgeColorMix);\n    #else\n    vColor = edgeColor.rgb;\n    #endif\n\n    vec3 transformed = vec3( position );\n\n    #ifdef USE_EXTRUSION\n    #include <extrusion_vertex>\n    #endif\n\n    #ifdef USE_DISPLACEMENTMAP\n    transformed += normalize( normal ) * texture2D( displacementMap, uv ).x;\n    #endif\n\n    vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n\n    gl_Position = projectionMatrix * mvPosition;\n    // After projection gl_Position contains clip space coordinates of each vertex\n    // before perspective division (1 / w), thus only vertexes with -w < z < w should\n    // be displayed and offset. We offset only those edges which z coordinate in NDC\n    // space is between: -inf < z < 1\n    float depthOffset = step(-1.0, -gl_Position.z / gl_Position.w) * EDGE_DEPTH_OFFSET;\n    gl_Position.z -= depthOffset;\n\n    #ifdef USE_FADING\n    #include <fading_vertex>\n    #endif\n}",a="\nprecision highp float;\nprecision highp int;\n\nvarying vec3 vColor;\n\n#ifdef USE_EXTRUSION\n#include <extrusion_pars_fragment>\n#endif\n\n#ifdef USE_FADING\n#include <fading_pars_fragment>\n#endif\n\nvoid main() {\n    float alphaValue = 1.0;\n    gl_FragColor = vec4(vColor, alphaValue);\n\n    #ifdef USE_EXTRUSION\n    #include <extrusion_fragment>\n    #endif\n\n    #ifdef USE_FADING\n    #include <fading_fragment>\n    #endif\n}";class s extends i.RawShaderMaterial{constructor(e){const t={},r=void 0!==e&&void 0!==e.displacementMap;r&&(t.USE_DISPLACEMENTMAP=""),super({name:"EdgeMaterial",vertexShader:o,fragmentShader:a,uniforms:{edgeColor:new i.Uniform(new i.Color(s.DEFAULT_COLOR)),edgeColorMix:new i.Uniform(s.DEFAULT_COLOR_MIX),fadeNear:new i.Uniform(n.FadingFeature.DEFAULT_FADE_NEAR),fadeFar:new i.Uniform(n.FadingFeature.DEFAULT_FADE_FAR),extrusionRatio:new i.Uniform(n.ExtrusionFeature.DEFAULT_RATIO_MIN),displacementMap:new i.Uniform(r?e.displacementMap:new i.Texture)},depthWrite:!1,defines:t}),this.transparent=!0,n.FadingFeature.patchGlobalShaderChunks(),n.ExtrusionFeature.patchGlobalShaderChunks(),void 0!==e&&(void 0!==e.color&&this.color.set(e.color),void 0!==e.colorMix&&(this.colorMix=e.colorMix),void 0!==e.fadeNear&&(this.fadeNear=e.fadeNear),void 0!==e.fadeFar&&(this.fadeFar=e.fadeFar),void 0!==e.displacementMap&&(this.displacementMap=e.displacementMap))}get color(){return this.uniforms.edgeColor.value}set color(e){this.uniforms.edgeColor.value=e}get colorMix(){return this.uniforms.edgeColorMix.value}set colorMix(e){this.uniforms.edgeColorMix.value=e,this.updateColorMixFeature()}updateColorMixFeature(){this.defines.USE_COLOR=this.colorMix>0?1:0}get fadeNear(){return this.uniforms.fadeNear.value}set fadeNear(e){this.uniforms.fadeNear.value=e}get fadeFar(){return this.uniforms.fadeFar.value}set fadeFar(e){this.uniforms.fadeFar.value=e,void 0!==e&&e>0?(this.needsUpdate=this.needsUpdate||void 0===this.defines.USE_FADING,this.defines.USE_FADING=""):(this.needsUpdate=this.needsUpdate||void 0!==this.defines.USE_FADING,delete this.defines.USE_FADING)}get extrusionRatio(){return this.uniforms.extrusionRatio.value}set extrusionRatio(e){this.uniforms.extrusionRatio.value=e,void 0!==e&&e>=n.ExtrusionFeature.DEFAULT_RATIO_MIN?(this.needsUpdate=this.needsUpdate||void 0===this.defines.USE_EXTRUSION,this.defines.USE_EXTRUSION=""):(this.needsUpdate=this.needsUpdate||void 0!==this.defines.USE_EXTRUSION,delete this.defines.USE_EXTRUSION)}get displacementMap(){return this.uniforms.displacementMap.value}set displacementMap(e){this.uniforms.displacementMap.value=e,void 0!==e?(this.uniforms.displacementMap.value.needsUpdate=!0,this.defines.USE_DISPLACEMENTMAP="",this.needsUpdate=this.needsUpdate||void 0===this.defines.USE_DISPLACEMENTMAP):(delete this.defines.USE_DISPLACEMENTMAP,this.needsUpdate=this.needsUpdate||void 0!==this.defines.USE_DISPLACEMENTMAP)}}t.EdgeMaterial=s,s.DEFAULT_COLOR=0,s.DEFAULT_COLOR_MIX=0},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(86),o="\n#ifdef USE_COLOR\nattribute vec4 color;\nvarying vec3 vColor;\n#endif\n\n// uniforms to implement double-precision\nuniform mat4 u_mvp;             // combined modelView and projection matrix\nuniform vec3 u_eyepos;          // eye position major\nuniform vec3 u_eyepos_lowpart;  // eye position minor ((double) eyepos - (float) eyepos)\n\n// vertex attributes\nattribute vec3 position;        // high part\nattribute vec3 positionLow;     // low part\n\n#include <high_precision_vert_func>\n\nvoid main() {\n    #ifdef USE_COLOR\n    vColor = color.rgb;\n    #endif\n\n    vec3 pos = subtractDblEyePos(position);\n    gl_Position = u_mvp * vec4(pos, 1.0);\n}",a="\nprecision highp float;\nprecision highp int;\n\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifdef USE_COLOR\nvarying vec3 color;\n#endif\n\nvoid main() {\n    #ifdef USE_COLOR\n    gl_FragColor = vec4( diffuse * vColor, opacity );\n    #else\n    gl_FragColor = vec4( diffuse, opacity );\n    #endif\n}";class s extends i.RawShaderMaterial{constructor(e){Object.assign(i.ShaderChunk,n.default);const t={name:"HighPrecisionLineMaterial",vertexShader:o,fragmentShader:a,uniforms:{diffuse:new i.Uniform(new i.Color(s.DEFAULT_COLOR)),opacity:new i.Uniform(s.DEFAULT_OPACITY),u_mvp:new i.Uniform(new i.Matrix4),u_eyepos:new i.Uniform(new i.Vector3),u_eyepos_lowpart:new i.Uniform(new i.Vector3)}};Object.assign(t,e),super(t),this.type="HighPrecisionLineMaterial",this.isHighPrecisionLineMaterial=!0,void 0!==e&&(void 0!==e.color&&this.color.set(e.color),void 0!==e.opacity&&(this.opacity=e.opacity)),this.updateTransparencyFeature()}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}updateTransparencyFeature(){this.transparent=this.opacity<1}}t.HighPrecisionLineMaterial=s,s.DEFAULT_COLOR=80,s.DEFAULT_OPACITY=1},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(86),o="\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n\nuniform float size;\n\n// uniforms to implement double-precision\nuniform mat4 u_mvp;             // combined modelView and projection matrix\nuniform vec3 u_eyepos;          // eye position major\nuniform vec3 u_eyepos_lowpart;  // eye position minor ((double) eyepos - (float) eyepos)\n\n// vertex attributes\nattribute vec3 positionLow;     // low part\n\n#include <high_precision_vert_func>\n\nvoid main() {\n    #ifdef USE_COLOR\n    vColor = color.rgb;\n    #endif\n\n    vec3 pos = subtractDblEyePos(position);\n    gl_Position = u_mvp * vec4(pos, 1.0);\n\n    // ignore sizeAttenuation for now!\n    gl_PointSize = size;\n}";class a extends i.PointsMaterial{constructor(e){Object.assign(i.ShaderChunk,n.default),super(e),this.type="HighPrecisionPointMaterial",this.vertexShader=o,this.fragmentShader=i.ShaderChunk.points_frag,this.fog=!1,this.uniforms={diffuse:new i.Uniform(new i.Color(a.DEFAULT_COLOR)),opacity:new i.Uniform(a.DEFAULT_OPACITY),size:new i.Uniform(a.DEFAULT_SIZE),scale:new i.Uniform(a.DEFAULT_SCALE),map:new i.Uniform(new i.Texture),uvTransform:new i.Uniform(new i.Matrix3),u_mvp:new i.Uniform(new i.Matrix4),u_eyepos:new i.Uniform(new i.Vector3),u_eyepos_lowpart:new i.Uniform(new i.Vector3)},this.isHighPrecisionPointMaterial=!0,void 0!==e&&(void 0!==e.color&&this.color.set(e.color),void 0!==e.opacity&&(this.opacity=e.opacity),void 0!==e.size&&(this.size=e.size),void 0!==e.scale&&(this.scale=e.scale),void 0!==e.uvTransform&&(this.uvTransform=e.uvTransform),void 0!==e.map&&(this.map=e.map))}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}get uvTransform(){return this.uniforms.uvTransform.value}set uvTransform(e){this.uniforms.uvTransform.value=e}}t.HighPrecisionPointMaterial=a,a.DEFAULT_COLOR=80,a.DEFAULT_OPACITY=1,a.DEFAULT_SIZE=1,a.DEFAULT_SCALE=1,t.isHighPrecisionPointMaterial=function(e){return void 0!==e&&!0===e.isHighPrecisionPointMaterial}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n="\nattribute vec4 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n\nvarying vec4 vColor;\nvarying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n    vColor = color;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xyz, 1.0);\n}",o="\nprecision highp float;\nprecision highp int;\n\nuniform sampler2D map;\n\nvarying vec4 vColor;\nvarying vec2 vUv;\n\nvoid main() {\n\n    vec4 color = texture2D(map, vUv.xy);\n    color *= vColor.a;\n    if (color.a < 0.05) {\n        discard;\n    }\n    gl_FragColor = color;\n}";class a extends i.RawShaderMaterial{constructor(e){super({name:"IconMaterial",vertexShader:n,fragmentShader:o,uniforms:{map:new i.Uniform(e.map)},depthTest:!0,depthWrite:!0,transparent:!0,vertexColors:i.VertexColors,premultipliedAlpha:!0,blending:i.NormalBlending})}get map(){return this.uniforms.map.value}}t.IconMaterial=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n="\nuniform float size;\n\nvoid main() {\n    vec3 transformed = vec3(position);\n    vec4 mvPosition = modelViewMatrix * vec4(transformed, 1.0);\n\n    gl_Position = projectionMatrix * mvPosition;\n    gl_PointSize = size;\n}\n",o="\nuniform vec3 diffuse;\n\nvoid main() {\n    float alpha = 1.0;\n\n    float radius = 0.5;\n    vec2 coords = gl_PointCoord.xy - vec2(0.5);\n    float len = length(coords);\n    float falloff = fwidth(len);\n    float threshold = 1.0 - smoothstep(radius - falloff, radius, len);\n    alpha *= threshold;\n\n    gl_FragColor = vec4(diffuse, alpha);\n}",a=1;class s extends i.ShaderMaterial{constructor(e={}){e.depthTest=!1,super(e),this.isCirclePointsMaterial=!0,this.type="CirclePointsMaterial",this.vertexShader=n,this.fragmentShader=o,this.transparent=!0,this.m_size=e.size||a,this.m_color=new i.Color,this.uniforms={diffuse:new i.Uniform(this.m_color),size:new i.Uniform(this.m_size)},this.extensions.derivatives=!0}get size(){return this.m_size}set size(e){this.m_size=e,this.uniforms.size.value=e,this.needsUpdate=!0}get color(){return"#"+this.m_color.getHexString()}set color(e){this.m_color.set(e),this.uniforms.diffuse.value.set(this.m_color),this.needsUpdate=!0}}t.CirclePointsMaterial=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(146);class o extends i.ShaderMaterial{constructor(e){super({uniforms:e,vertexShader:n.CopyShader.vertexShader,fragmentShader:n.CopyShader.fragmentShader,premultipliedAlpha:!0,transparent:!0,blending:i.AdditiveBlending,depthTest:!1,depthWrite:!1})}}t.MSAAMaterial=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);t.LuminosityHighPassShader={uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new i.Color(0)},defaultOpacity:{value:0}},vertexShader:"\n    varying vec2 vUv;\n    void main() {\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }",fragmentShader:"\n    uniform sampler2D tDiffuse;\n    uniform vec3 defaultColor;\n    uniform float defaultOpacity;\n    uniform float luminosityThreshold;\n    uniform float smoothWidth;\n    varying vec2 vUv;\n    void main() {\n        vec4 texel = texture2D( tDiffuse, vUv );\n        vec3 luma = vec3( 0.299, 0.587, 0.114 );\n        float v = dot( texel.xyz, luma );\n        vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n        float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n        gl_FragColor = mix( outputColor, texel, alpha );\n    }"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(4),n=r(87),o=r(63),a=r(67);class s extends n.DataSource{constructor(){super("background"),this.m_tilingScheme=s.DEFAULT_TILING_SCHEME,this.cacheable=!0}updateStorageLevelOffset(){let e;this.mapView.dataSources.forEach(t=>{if(t===this)return;t.getTilingScheme()===this.m_tilingScheme&&(e=void 0===e?t.storageLevelOffset:Math.max(e,t.storageLevelOffset))}),void 0===e&&(e=0),e!==this.storageLevelOffset&&(this.storageLevelOffset=e,this.mapView.clearTileCache(this.name))}setTheme(e,t){this.mapView.clearTileCache(this.name)}setTilingScheme(e){const t=e||s.DEFAULT_TILING_SCHEME;t!==this.m_tilingScheme&&(this.m_tilingScheme=t,this.updateStorageLevelOffset(),this.mapView.clearTileCache(this.name))}getTilingScheme(){return this.m_tilingScheme}getTile(e){const t=new a.Tile(this,e);return t.forceHasGeometry(!0),t.removeDecodedTile(),o.TileGeometryCreator.instance.addGroundPlane(t,Number.MIN_SAFE_INTEGER),t}}t.BackgroundDataSource=s,s.DEFAULT_TILING_SCHEME=i.webMercatorTilingScheme},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=new i.Vector3,o=new i.Vector3,a=new i.Vector3;t.SubdivisionModifier=class{constructor(){}modify(e){const t=e.getAttribute("position"),r=Array.from(t.array),i=e.getAttribute("uv"),s=void 0!==i?Array.from(i.array):void 0,c=e.getAttribute("edge"),l=void 0!==c?Array.from(c.array):void 0,u=e.getAttribute("wall"),d=void 0!==u?Array.from(u.array):void 0,h=e.getIndex(),m=Array.from(h.array),p=new Map;function f(e,t){const i=`${Math.min(e,t)}_${Math.max(e,t)}`,c=p.get(i);if(void 0!==c)return c;n.set(r[3*e],r[3*e+1],r[3*e+2]),o.set(r[3*t],r[3*t+1],r[3*t+2]),a.lerpVectors(n,o,.5);const u=r.length/3;return r.push(...a.toArray()),p.set(i,u),void 0!==s&&(n.set(s[2*e],s[2*e+1],0),o.set(s[2*t],s[2*t+1],0),a.lerpVectors(n,o,.5),s.push(a.x,a.y)),void 0!==l&&(l[e]===t?(l.push(t),l[e]=u):l[t]===e?(l.push(e),l[t]=u):l.push(-1)),void 0!==d&&(d[e]===t?(d.push(t),d[e]=u):d[t]===e?(d.push(e),d[t]=u):d.push(-1)),u}const g=[];for(;m.length>=3;){const e=m.shift(),t=m.shift(),i=m.shift();switch(n.set(r[3*e],r[3*e+1],r[3*e+2]),o.set(r[3*t],r[3*t+1],r[3*t+2]),a.set(r[3*i],r[3*i+1],r[3*i+2]),this.shouldSplitTriangle(n,o,a)){case 0:{const r=f(e,t);m.push(e,r,i,r,t,i);break}case 1:{const r=f(t,i);m.push(e,t,r,e,r,i);break}case 2:{const r=f(i,e);m.push(e,t,r,r,t,i);break}case void 0:g.push(e,t,i);break;default:throw new Error("failed to subdivide the given geometry")}}return t.array=new Float32Array(r),t.count=r.length/t.itemSize,t.needsUpdate=!0,e.setIndex(g),void 0!==s&&(i.array=new Float32Array(s),i.count=s.length/i.itemSize,i.needsUpdate=!0),void 0!==l&&(c.array=new Float32Array(l),c.count=l.length/c.itemSize,c.needsUpdate=!0),e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(88),o=r(351),a=r(33),s="_Assets/",c="_BoldAssets/",l="_ItalicAssets/",u="_BoldItalicAssets/",d="_Assets/Extra/";class h{constructor(e,t,r,i,n,a,s,c,l,u,d){this.url=e,this.name=t,this.type=r,this.size=i,this.maxWidth=n,this.maxHeight=a,this.distanceRange=s,this.fonts=c,this.unicodeBlocks=l,this.maxCodePointCount=u,this.m_replacementGlyph=d,this.m_glyphTextureCache=new o.GlyphTextureCache(u,this.maxWidth+1,this.maxHeight+1),this.m_loadingJson=new Map,this.m_loadingPages=new Map,this.m_loadingGlyphs=new Map,this.m_loadedJson=new Map,this.m_loadedPages=new Map,this.m_loadedGlyphs=new Map}static async load(e,t){const r=new URL(e,window.location.href),o=await h.loadJSON(r.href),a=new URL(`${o.name}${d}`,r),s=await h.loadJSON(a.href+"Specials.json"),c=await h.loadTexture(a.href+"Specials.png");c.wrapS=i.ClampToEdgeWrapping,c.wrapT=i.ClampToEdgeWrapping,c.minFilter=i.NearestFilter,c.needsUpdate=!0;const l=o.fonts.find(e=>"Extra"===e.name),u=new n.GlyphData(65533,"Specials",s.chars[0].width,s.chars[0].height,s.chars[0].xadvance,s.chars[0].xoffset,s.chars[0].yoffset,0,0,1,1,c,l);return new h(r.href.substr(0,r.href.lastIndexOf("/")),o.name,o.type,o.size,o.maxWidth,o.maxHeight,o.distanceRange,o.fonts,o.supportedBlocks,t,u)}static async loadTexture(e){return new Promise(t=>{(new i.TextureLoader).load(e,t)})}static async loadJSON(e){const t=await fetch(e);if(!t.ok)throw new Error(`${e} Status Text:  ${t.statusText}`);const r=await t.text();return JSON.parse(r)}dispose(){this.fonts.length=0,this.unicodeBlocks.length=0,this.m_glyphTextureCache.dispose(),this.m_loadingJson.clear(),this.m_loadingPages.clear(),this.m_loadingGlyphs.clear(),this.m_loadedJson.clear(),this.m_loadedPages.clear(),this.m_loadedGlyphs.clear()}clear(){this.m_glyphTextureCache.clear(),this.m_loadingJson.clear(),this.m_loadingPages.clear(),this.m_loadingGlyphs.clear(),this.m_loadedJson.clear(),this.m_loadedPages.clear(),this.m_loadedGlyphs.clear()}update(e){this.m_glyphTextureCache.update(e)}get texture(){return this.m_glyphTextureCache.texture}get textureSize(){return this.m_glyphTextureCache.textureSize}get isLoading(){return this.m_loadingJson.size>0||this.m_loadingPages.size>0||this.m_loadingGlyphs.size>0}async loadBlock(e,t,r,i){const n=this.getAssetsPath(r,t),o=`${n}/${e.name.replace(/ /g,"_")}.json`;let a=this.m_loadedJson.get(o);if(void 0===a){let e=this.m_loadingJson.get(o);if(void 0===e)try{e=h.loadJSON(o),this.m_loadingJson.set(o,e),a=await e,this.m_loadingJson.delete(o),this.m_loadedJson.set(o,a)}catch(e){console.error(e),this.m_loadingJson.delete(o)}else a=await e}const s=[];if(!0===i)for(const e of a.pages)s.push(this.loadPage(`${n}/${e}`));return await Promise.all(s),a}removeBlock(e,t,r){const i=this.getAssetsPath(r,t),n=`${i}/${e.name.replace(/ /g,"_")}.json`,o=this.m_loadedJson.get(n);if(void 0!==o){for(const e of o.pages){const t=`${i}/${e}`;this.m_loadingPages.delete(t),this.m_loadedPages.delete(t)}this.m_loadingJson.delete(n),this.m_loadedJson.delete(n)}}async loadCharset(e,t){const r=t.fontName,i=t.fontStyle,n=(t.fontVariant===a.FontVariant.AllCaps||t.fontVariant===a.FontVariant.SmallCaps?e.toUpperCase():e).replace(/[\s\S](?=([\s\S]+))/g,(e,t)=>t.indexOf(e)+1?"":e),o=[];for(const e of n){const t=e.codePointAt(0),n=this.getFont(t,r),a=`${n.name}_${i}`,s=`${a}_${t}`;let c=this.m_loadedGlyphs.get(a);void 0===c&&(c=new Map,this.m_loadedGlyphs.set(a,c));const l=c.get(t);if(void 0===l){let r=this.m_loadingGlyphs.get(s);if(void 0===r){if(-1===n.charset.indexOf(String.fromCodePoint(t))){const r=this.createReplacementGlyph(t,e,n);c.set(t,r),this.m_glyphTextureCache.add(s,r);continue}let o;for(const e of this.unicodeBlocks)if(t>=e.min&&t<=e.max){o=e;break}r=this.loadAssets(t,i,o,n),this.m_loadingGlyphs.set(s,r),r.then(e=>{this.m_loadingGlyphs.delete(s),c.set(t,e),this.m_glyphTextureCache.add(s,e)})}o.push(r)}else this.m_glyphTextureCache.has(s)||(o.push(Promise.resolve(l)),this.m_glyphTextureCache.add(s,l))}return Promise.all(o)}getGlyph(e,t,r){const i=this.m_loadedGlyphs.get(`${t.name}_${r}`);if(void 0!==i)return i.get(e)}getGlyphs(e,t,r){const i=[],n=t.fontName,o=t.fontStyle,s=t.fontVariant,c=s===a.FontVariant.AllCaps||s===a.FontVariant.SmallCaps;for(const t of e){const e=c?t.toUpperCase():t;for(const a of e){const e=a.codePointAt(0),s=this.getFont(e,n),c=this.getGlyph(e,s,o);if(void 0===c)return;i.push(c),void 0!==r&&r.push(a!==t)}}return i}getFont(e,t){let r=this.fonts[0].name;for(const i of this.unicodeBlocks)if(e>=i.min&&e<=i.max){r=void 0!==t&&void 0!==i.fonts.find(e=>e===t)?t:i.fonts[0];break}return this.fonts.find(e=>e.name===r)}updateMemoryUsage(e){let t=0;for(const e of this.unicodeBlocks)t+=2*(e.max-e.min);let r=this.m_glyphTextureCache.textureSize.x*this.m_glyphTextureCache.textureSize.y*4;for(const e in this.m_loadedPages.entries)if(void 0!==this.m_loadedPages.get(e)){const t=this.m_loadedPages.get(e);void 0!==t&&(r+=t.image.width*t.image.height*4)}e.heapSize+=t+r,e.gpuSize+=r}createReplacementGlyph(e,t,r){const i=this.m_replacementGlyph.clone();return i.codePoint=e,i.character=t,i.font=r,i}async loadAssets(e,t,r,i){const o=await this.loadBlock(r,i,t);if(void 0===o)return this.m_replacementGlyph;const a=o.chars.find(t=>t.id===e),s=`${this.getAssetsPath(t,i)}/${o.pages[a.page]}`,c=await this.loadPage(s);return new n.GlyphData(a.id,r.name,a.width,a.height,a.xadvance,a.xoffset,a.yoffset,a.x/c.image.width,1-(a.y+a.height)/c.image.height,(a.x+a.width)/c.image.width,1-a.y/c.image.height,c,i)}async loadPage(e){let t=this.m_loadedPages.get(e);if(void 0===t){let r=this.m_loadingPages.get(e);void 0===r?(r=h.loadTexture(e),this.m_loadingPages.set(e,r),(t=await r).wrapS=i.ClampToEdgeWrapping,t.wrapT=i.ClampToEdgeWrapping,t.minFilter=i.NearestFilter,t.needsUpdate=!0,this.m_loadingPages.delete(e)&&this.m_loadedPages.set(e,t),this.m_loadingPages.delete(e)):t=await r}return t}getAssetsPath(e,t){let r=s;switch(e){case a.FontStyle.Bold:void 0!==t.bold&&(r=c);break;case a.FontStyle.Italic:void 0!==t.italic&&(r=l);break;case a.FontStyle.BoldItalic:void 0!==t.boldItalic?r=u:void 0!==t.italic?r=l:void 0!==t.bold&&(r=c)}return`${this.url}/${this.name}${r}${t.name}`}}t.FontCatalog=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(61),n=r(0),o=r(88),a=r(149),s=8,c=4096;t.GlyphTextureCache=class{constructor(e,t,r){this.capacity=e,this.entryWidth=t,this.entryHeight=r;const o=Math.floor(Math.sqrt(e));this.m_cacheHeight=o*o<e?o+1:o,this.m_cacheWidth=o*this.m_cacheHeight<e?o+1:o,this.m_textureSize=new n.Vector2(this.m_cacheWidth*t,this.m_cacheHeight*r),(this.m_textureSize.y>c||this.m_textureSize.x>c)&&console.warn("GlyphTextureCache texture size ("+this.m_textureSize.x+", "+this.m_textureSize.y+") exceeds WebGL's widely supported MAX_TEXTURE_SIZE ("+c+").\nThis could result in rendering errors on some devices.\nPlease consider reducing its capacity or input assets size."),this.m_entryCache=new i.LRUCache(e),this.initCacheEntries(),this.m_scene=new n.Scene,this.m_camera=new n.OrthographicCamera(0,this.m_textureSize.x,this.m_textureSize.y,0),this.m_camera.position.z=1,this.m_camera.updateMatrixWorld(!1),this.m_rt=new n.WebGLRenderTarget(this.m_textureSize.x,this.m_textureSize.y,{wrapS:n.ClampToEdgeWrapping,wrapT:n.ClampToEdgeWrapping,depthBuffer:!1,stencilBuffer:!1}),this.m_copyTextureSet=new Set,this.m_copyTransform=new n.Matrix3,this.m_copyPositions=[],this.m_copyPositions.push(new n.Vector2,new n.Vector2,new n.Vector2,new n.Vector2),this.m_copyMaterial=new a.GlyphCopyMaterial,this.m_copyVertexBuffer=new n.InterleavedBuffer(new Float32Array(20*e),5),this.m_copyVertexBuffer.setUsage(n.DynamicDrawUsage),this.m_copyPositionAttribute=new n.InterleavedBufferAttribute(this.m_copyVertexBuffer,3,0),this.m_copyUVAttribute=new n.InterleavedBufferAttribute(this.m_copyVertexBuffer,2,3),this.m_copyGeometry=new n.BufferGeometry,this.m_copyGeometry.setAttribute("position",this.m_copyPositionAttribute),this.m_copyGeometry.setAttribute("uv",this.m_copyUVAttribute);const s=new n.BufferAttribute(new Uint32Array(6*e),1);s.setUsage(n.DynamicDrawUsage),this.m_copyGeometry.setIndex(s),this.m_copyMesh=new n.Mesh(this.m_copyGeometry,this.m_copyMaterial),this.m_copyMesh.frustumCulled=!1,this.m_copyGeometryDrawCount=0,this.m_clearMaterial=new a.GlyphClearMaterial,this.m_clearPositionAttribute=new n.BufferAttribute(new Float32Array(8*e),2),this.m_clearPositionAttribute.setUsage(n.DynamicDrawUsage),this.m_clearGeometry=new n.BufferGeometry,this.m_clearGeometry.setAttribute("position",this.m_clearPositionAttribute);const l=new n.BufferAttribute(new Uint32Array(6*e),1);l.setUsage(n.DynamicDrawUsage),this.m_clearGeometry.setIndex(l),this.m_clearMesh=new n.Mesh(this.m_clearGeometry,this.m_clearMaterial),this.m_clearMesh.frustumCulled=!1,this.m_clearGeometryDrawCount=0,this.m_scene.add(this.m_clearMesh,this.m_copyMesh)}dispose(){this.m_entryCache.clear(),this.m_scene.remove(this.m_clearMesh,this.m_copyMesh),this.m_rt.dispose(),this.m_clearMaterial.dispose(),this.m_copyMaterial.dispose(),this.m_copyTextureSet.clear(),this.m_clearGeometry.dispose(),this.m_copyGeometry.dispose()}get texture(){return this.m_rt.texture}get textureSize(){return this.m_textureSize}add(e,t){if(void 0!==this.m_entryCache.get(e))return;const r=this.m_entryCache.oldest;if(null===r)throw new Error("GlyphTextureCache is uninitialized!");this.clearCacheEntry(r.value),this.copyGlyphToCache(e,t,r.value.location)}has(e){return this.m_entryCache.has(e)}get(e){return this.m_entryCache.get(e)}clear(){this.m_copyGeometryDrawCount=0,this.m_clearGeometryDrawCount=0,this.m_entryCache.clear(),this.m_copyTextureSet.clear(),this.initCacheEntries()}update(e){let t=null;const r=this.m_clearGeometryDrawCount>0,i=this.m_copyGeometryDrawCount>0;if((r||i)&&(t=e.getRenderTarget(),e.setRenderTarget(this.m_rt)),r&&(this.m_clearPositionAttribute.needsUpdate=!0,this.m_clearPositionAttribute.updateRange.offset=0,this.m_clearPositionAttribute.updateRange.count=8*this.m_clearGeometryDrawCount,this.m_clearGeometry.index.needsUpdate=!0,this.m_clearGeometry.index.updateRange.offset=0,this.m_clearGeometry.index.updateRange.count=6*this.m_clearGeometryDrawCount,this.m_clearGeometry.setDrawRange(0,6*this.m_clearGeometryDrawCount),this.m_clearMesh.visible=!0,this.m_copyMesh.visible=!1,e.render(this.m_scene,this.m_camera),this.m_clearGeometryDrawCount=0,this.m_clearMesh.visible=!1),i){this.m_copyVertexBuffer.needsUpdate=!0,this.m_copyVertexBuffer.updateRange.offset=0,this.m_copyVertexBuffer.updateRange.count=20*this.m_copyGeometryDrawCount,this.m_copyGeometry.index.needsUpdate=!0,this.m_copyGeometry.index.updateRange.offset=0,this.m_copyGeometry.index.updateRange.count=6*this.m_copyGeometryDrawCount,this.m_copyGeometry.setDrawRange(0,6*this.m_copyGeometryDrawCount),this.m_copyMesh.visible=!0;const t=Array.from(this.m_copyTextureSet),r=Math.ceil(this.m_copyTextureSet.size/s);for(let i=0;i<r;i++){const r=i*s;this.m_copyMaterial.uniforms.pageOffset.value=r;for(let e=0;e<s;e++){const i=r+e;i<this.m_copyTextureSet.size&&(this.m_copyMaterial.uniforms["page"+e].value=t[i])}e.render(this.m_scene,this.m_camera)}this.m_copyTextureSet.clear(),this.m_copyGeometryDrawCount=0}(r||i)&&e.setRenderTarget(t)}initCacheEntries(){const e={name:"",metrics:{size:0,distanceRange:0,base:0,lineHeight:0,lineGap:0,capHeight:0,xHeight:0},charset:""},t=new o.GlyphData(0,"",0,0,0,0,0,0,0,0,0,n.Texture.DEFAULT_IMAGE,e);for(let e=0;e<this.m_cacheHeight;e++)for(let r=0;r<this.m_cacheWidth;r++){const i={glyphData:t,location:new n.Vector2(r,e)};this.m_entryCache.set(`Dummy_${e*this.m_cacheHeight+r}`,i)}}copyGlyphToCache(e,t,r){this.m_copyTextureSet.add(t.texture);let i=0;for(const e of this.m_copyTextureSet.values()){if(e===t.texture)break;i++}t.copyIndex=i,this.m_copyTransform.set(1,0,r.x*this.entryWidth-t.offsetX,0,1,r.y*this.entryHeight-t.positions[0].y,0,0,0);for(let e=0;e<4;++e)this.m_copyPositions[e].set(t.positions[e].x,t.positions[e].y),this.m_copyPositions[e].applyMatrix3(this.m_copyTransform);if(this.m_copyGeometryDrawCount>=this.capacity)return;const n=4*this.m_copyGeometryDrawCount,o=6*this.m_copyGeometryDrawCount;for(let e=0;e<4;++e)this.m_copyPositionAttribute.setXYZ(n+e,this.m_copyPositions[e].x,this.m_copyPositions[e].y,t.copyIndex),this.m_copyUVAttribute.setXY(n+e,t.sourceTextureCoordinates[e].x,t.sourceTextureCoordinates[e].y);this.m_copyGeometry.index.setX(o,n),this.m_copyGeometry.index.setX(o+1,n+1),this.m_copyGeometry.index.setX(o+2,n+2),this.m_copyGeometry.index.setX(o+3,n+2),this.m_copyGeometry.index.setX(o+4,n+1),this.m_copyGeometry.index.setX(o+5,n+3),++this.m_copyGeometryDrawCount;const a=this.m_copyPositions[0].x/this.m_textureSize.x,s=this.m_copyPositions[0].y/this.m_textureSize.y,c=this.m_copyPositions[3].x/this.m_textureSize.x,l=this.m_copyPositions[3].y/this.m_textureSize.y;t.dynamicTextureCoordinates[0].set(a,s),t.dynamicTextureCoordinates[1].set(c,s),t.dynamicTextureCoordinates[2].set(a,l),t.dynamicTextureCoordinates[3].set(c,l),t.isInCache=!0,this.m_entryCache.set(e,{glyphData:t,location:r})}clearCacheEntry(e){if(e.glyphData.isInCache=!1,this.m_copyPositions[0].set(e.location.x*this.entryWidth,e.location.y*this.entryHeight),this.m_copyPositions[1].set((e.location.x+1)*this.entryWidth,e.location.y*this.entryHeight),this.m_copyPositions[2].set(e.location.x*this.entryWidth,(e.location.y+1)*this.entryHeight),this.m_copyPositions[3].set((e.location.x+1)*this.entryWidth,(e.location.y+1)*this.entryHeight),this.m_clearGeometryDrawCount>=this.capacity)return;const t=4*this.m_clearGeometryDrawCount,r=6*this.m_clearGeometryDrawCount;for(let e=0;e<4;++e)this.m_clearPositionAttribute.setXY(t+e,this.m_copyPositions[e].x,this.m_copyPositions[e].y);this.m_clearGeometry.index.setX(r,t),this.m_clearGeometry.index.setX(r+1,t+1),this.m_clearGeometry.index.setX(r+2,t+2),this.m_clearGeometry.index.setX(r+3,t+2),this.m_clearGeometry.index.setX(r+4,t+1),this.m_clearGeometry.index.setX(r+5,t+3),++this.m_clearGeometryDrawCount}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(150),o=r(89),a=r(33),s=r(353),c=r(354),l=r(151),u=new i.Vector3,d={array:[new i.Box2],offset:0};let h=new Float32Array;t.DEFAULT_TEXT_CANVAS_LAYER=0;t.TextCanvas=class{constructor(e){this.m_renderer=e.renderer,this.m_fontCatalog=e.fontCatalog,this.minGlyphCount=e.minGlyphCount,this.maxGlyphCount=e.maxGlyphCount,void 0===e.material?(this.m_ownsMaterial=!0,this.m_material=l.createSdfTextMaterial({fontCatalog:e.fontCatalog})):(this.m_ownsMaterial=!1,this.m_material=e.material),void 0===e.backgroundMaterial?(this.m_ownsBgMaterial=!0,this.m_bgMaterial=l.createSdfTextMaterial({fontCatalog:e.fontCatalog,isBackground:!0})):(this.m_ownsBgMaterial=!1,this.m_bgMaterial=e.backgroundMaterial),this.m_defaultLayer={id:t.DEFAULT_TEXT_CANVAS_LAYER,storage:new o.TextGeometry(new i.Scene,this.m_material,this.m_bgMaterial,this.minGlyphCount,this.maxGlyphCount)},this.m_layers=[this.m_defaultLayer],this.m_defaultTextRenderStyle=new a.TextRenderStyle,this.m_currentTextRenderStyle=this.m_defaultTextRenderStyle,this.m_defaultTextLayoutStyle=new a.TextLayoutStyle,this.m_currentTextLayoutStyle=this.m_defaultTextLayoutStyle,this.m_lineTypesetter=new s.LineTypesetter,this.m_pathTypesetter=new c.PathTypesetter}get fontCatalog(){return this.m_fontCatalog}set fontCatalog(e){this.m_fontCatalog=e;const t=this.m_material;t.uniforms.sdfTexture.value=this.m_fontCatalog.texture,t.uniforms.sdfParams.value=new i.Vector4(this.m_fontCatalog.textureSize.x,this.m_fontCatalog.textureSize.y,this.m_fontCatalog.size,this.m_fontCatalog.distanceRange),t.defines.MSDF="msdf"===this.m_fontCatalog.type?1:0;const r=this.m_bgMaterial;r.uniforms.sdfTexture.value=this.m_fontCatalog.texture,r.uniforms.sdfParams.value=new i.Vector4(this.m_fontCatalog.textureSize.x,this.m_fontCatalog.textureSize.y,this.m_fontCatalog.size,this.m_fontCatalog.distanceRange),r.defines.MSDF="msdf"===this.m_fontCatalog.type?1:0}get material(){return this.m_material}set material(e){this.m_ownsMaterial&&(this.m_material.dispose(),this.m_ownsMaterial=!1),this.m_material=e;for(const e of this.m_layers)e.storage.mesh.material=this.m_material}get backgroundMaterial(){return this.m_bgMaterial}set backgroundMaterial(e){this.m_ownsBgMaterial&&(this.m_bgMaterial.dispose(),this.m_ownsBgMaterial=!1),this.m_bgMaterial=e;for(const e of this.m_layers)e.storage.backgroundMesh.material=this.m_bgMaterial}get textRenderStyle(){return this.m_currentTextRenderStyle}set textRenderStyle(e){this.m_currentTextRenderStyle=e}get textLayoutStyle(){return this.m_currentTextLayoutStyle}set textLayoutStyle(e){this.m_currentTextLayoutStyle=e}clear(){for(const e of this.m_layers)e.storage.clear();this.m_currentTextRenderStyle=this.m_defaultTextRenderStyle}render(e,t,r){this.m_fontCatalog.update(this.m_renderer);let i=null;void 0!==t&&(i=this.m_renderer.getRenderTarget(),this.m_renderer.setRenderTarget(t)),!0===r&&this.m_renderer.clear(!0);for(const t of this.m_layers)t.storage.update(),this.m_renderer.clear(!1,!0),this.m_renderer.render(t.storage.scene,e);void 0!==t&&this.m_renderer.setRenderTarget(i)}addLayer(e){let t=this.getLayer(e);return void 0===t&&(t={id:e,storage:new o.TextGeometry(new i.Scene,this.m_material,this.m_bgMaterial,this.minGlyphCount,this.maxGlyphCount)},this.m_layers.push(t),this.m_layers.sort((e,t)=>e.id-t.id)),t}getLayer(e){return this.m_layers.find(t=>t.id===e)}getAllLayers(){return this.m_layers}measureText(e,t,r){let i,n,o,a;if(u.set(0,0,0),void 0!==r){if(i=r.path,n=r.pathOverflow,a=r.outputCharacterBounds,void 0!==r.path){const e=r.path.getPoint(0);if(null===e)return!1;u.set(e.x,e.y,0)}r.letterCaseArray&&(o=r.letterCaseArray)}return this.placeText({input:e,layer:this.m_defaultLayer,textPath:i,textPathOverflow:n,bounds:t,individualBounds:a,letterCaseArray:o})}addText(e,t,r){let i,n,o;u.copy(t);let a=this.m_defaultLayer;if(void 0!==r){if(i=r.path,n=r.pathOverflow,void 0!==r.layer){let e=this.getLayer(r.layer);void 0===e&&(e=this.addLayer(r.layer)),a=e}void 0!==r.path&&u.set(0,0,u.z),r.letterCaseArray&&(o=r.letterCaseArray)}const s=a.storage.drawCount,c=this.placeText({input:e,textPath:i,textPathOverflow:n,layer:a,letterCaseArray:o});return c&&void 0!==r?(!0===r.updatePosition&&t.copy(u),void 0!==r.pickingData&&a.storage.addPickingData(s,a.storage.drawCount,r.pickingData)):c||(a.storage.m_drawCount=s),c}createTextBufferObject(e,t){let r,o;u.set(0,0,0);const s=this.m_currentTextRenderStyle.fontVariant===a.FontVariant.SmallCaps;if("string"!=typeof e)r=e,void 0!==t&&t.letterCaseArray&&(o=t.letterCaseArray);else if(o=[],void 0===(r=this.m_fontCatalog.getGlyphs(e,this.m_currentTextRenderStyle,s?o:void 0)))return;let c,l,d,m,p,f;return void 0!==t&&(c=t.path,l=t.pathOverflow,!0===t.outputBounds&&(d=new i.Box2),!0===t.outputCharacterBounds&&(m=[]),!0===t.storeStyles&&(p=this.m_currentTextRenderStyle,f=this.m_currentTextLayoutStyle)),this.placeText({input:e,layer:this.m_defaultLayer,computeTextBuffer:!0,textPath:c,textPathOverflow:l,bounds:d,individualBounds:m,letterCaseArray:o}),new n.TextBufferObject(r,new Float32Array(h),d,m,p,f)}addTextBufferObject(e,t){let r,i,n,o,a,s,c,l=this.m_defaultLayer;if(void 0!==t){if(void 0!==t.layer){let e=this.getLayer(t.layer);void 0===e&&(e=this.addLayer(t.layer)),l=e}r=t.position,i=t.scale,n=t.rotation,o=t.color,a=t.opacity,s=t.backgroundColor,c=t.backgroundOpacity}const u=l.storage.drawCount,d=l.storage.addTextBufferObject(e,r,i,n,o,a,s,c);return d&&void 0!==t?void 0!==t.pickingData&&l.storage.addPickingData(u,l.storage.drawCount,t.pickingData):d||(l.storage.m_drawCount=u),d}pickText(e,t){for(const r of this.m_layers)r.storage.pick(e,t)}getMemoryUsage(e){this.m_fontCatalog.updateMemoryUsage(e);for(const t of this.m_layers)t.storage.updateMemoryUsage(e)}placeText(e){if(0===e.input.length||0===this.m_currentTextLayoutStyle.maxLines)return void 0!==e.bounds&&(e.bounds.min.set(0,0),e.bounds.max.set(0,0)),void 0!==e.individualBounds&&(e.individualBounds.length=0),!0;let t,r;const i=this.m_currentTextRenderStyle.fontVariant===a.FontVariant.SmallCaps;if("string"!=typeof e.input)t=e.input,e.letterCaseArray&&(r=e.letterCaseArray);else if(r=[],void 0===(t=this.m_fontCatalog.getGlyphs(e.input,this.m_currentTextRenderStyle,i?r:void 0)))return!1;let n;void 0!==e.individualBounds&&(d.array=e.individualBounds,d.offset=0,n=d),void 0!==e.bounds&&(e.bounds.min.set(1/0,1/0),e.bounds.max.set(-1/0,-1/0)),!0===e.computeTextBuffer&&(h=new Float32Array(t.length*o.QUAD_VERTEX_MEMORY_FOOTPRINT));const s=void 0!==e.textPath,c={glyphs:t,fontCatalog:this.m_fontCatalog,textRenderStyle:this.m_currentTextRenderStyle,textLayoutStyle:this.m_currentTextLayoutStyle,position:u,geometry:e.layer.storage,smallCapsArray:i?r:void 0,globalBounds:e.bounds,individualBounds:n,vertexBuffer:!0===e.computeTextBuffer?h:void 0};let l=!0;return s?(Object.assign(c,{path:e.textPath,pathOverflow:!0===e.textPathOverflow}),l=this.m_pathTypesetter.arrangeGlyphs(c)):l=this.m_lineTypesetter.arrangeGlyphs(c),void 0!==n&&(n.array.length=n.offset),l}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(89),o=r(33),a=r(90),s=r(46);t.LineTypesetter=class{constructor(){this.m_tempTransform=new i.Matrix3,this.m_tempCorners=[new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3],this.m_tempLineDirection=s.UnicodeUtils.Direction.LTR,this.m_tempRunDirection=s.UnicodeUtils.Direction.LTR,this.m_tempPixelSize=1,this.m_tempPixelBgSize=1,this.m_tempScale=1,this.m_tempSmallCaps=!1}arrangeGlyphs(e){this.m_currentParams=e,this.m_tempLineDirection=a.TypesettingUtils.getDirection(this.m_currentParams.glyphs,0),this.m_tempRunDirection=this.m_tempLineDirection,this.m_tempPixelSize=a.TypesettingUtils.getPixelSize(this.m_currentParams.textRenderStyle.fontSize.size,this.m_currentParams.textRenderStyle.fontSize.unit,this.m_currentParams.fontCatalog.size),this.m_tempScale=this.m_tempPixelSize/this.m_currentParams.fontCatalog.size,this.m_tempPixelBgSize=Math.min(a.TypesettingUtils.getPixelSize(this.m_currentParams.textRenderStyle.fontSize.backgroundSize,this.m_currentParams.textRenderStyle.fontSize.unit,this.m_currentParams.fontCatalog.size),this.m_currentParams.fontCatalog.distanceRange*this.m_tempScale),this.m_tempSmallCaps=void 0!==this.m_currentParams.smallCapsArray,this.m_currentParams.position.y+=this.m_currentParams.textLayoutStyle.verticalAlignment*this.m_currentParams.glyphs[0].font.metrics.capHeight*this.m_tempScale;const t=void 0!==this.m_currentParams.globalBounds&&void 0===this.m_currentParams.vertexBuffer,r=this.m_currentParams.position.x,i=this.m_currentParams.glyphs[0].font.metrics.lineHeight+this.m_currentParams.textLayoutStyle.leading;let n=0,c=0,l=0,u=0,d=0,h=0,m=0,p=0,f=!1;for(let e=0;e<this.m_currentParams.glyphs.length&&!(p>this.m_currentParams.textLayoutStyle.maxLines-1);++e){const g=this.m_currentParams.glyphs[e];if(!g.isInCache&&!t)return!1;const y=s.UnicodeUtils.isNewLine(g.codePoint),v=s.UnicodeUtils.isWhiteSpace(g.codePoint);if(f||g.direction!==-this.m_tempLineDirection||(f=!0),s.UnicodeUtils.isPrintable(g.codePoint)&&(d+=(g.advanceX+this.m_currentParams.textLayoutStyle.tracking)*this.m_tempScale*(this.m_tempSmallCaps?a.TypesettingUtils.getSmallCapsScale(this.m_currentParams.glyphs,this.m_currentParams.smallCapsArray,e,this.m_currentParams.textRenderStyle.fontVariant):1)),e===n&&(u=d,h=d,m=d),y||this.m_currentParams.textLayoutStyle.wrappingMode===o.WrappingMode.Character&&d>this.m_currentParams.textLayoutStyle.lineWidth||this.m_currentParams.textLayoutStyle.wrappingMode===o.WrappingMode.Word&&d>this.m_currentParams.textLayoutStyle.lineWidth&&m!==u){if(this.m_currentParams.textLayoutStyle.wrappingMode!==o.WrappingMode.None){let t=c,r=h;this.m_currentParams.textLayoutStyle.wrappingMode===o.WrappingMode.Word&&m!==u&&(t=l,r=m),d=r,e=Math.min(y?n===e?t:e:t,this.m_currentParams.glyphs.length-1)}const t=this.m_tempLineDirection===s.UnicodeUtils.Direction.RTL&&f?1+this.m_currentParams.textLayoutStyle.horizontalAlignment:this.m_currentParams.textLayoutStyle.horizontalAlignment;if(this.m_currentParams.position.x=this.m_currentParams.position.x+d*t,!this.placeLine(n,e,this.m_tempLineDirection,f))return!1;for(this.m_currentParams.position.y-=i*this.m_tempScale,this.m_currentParams.position.x=r;e!==n&&e+1<this.m_currentParams.glyphs.length&&s.UnicodeUtils.isWhiteSpace(this.m_currentParams.glyphs[e+1].codePoint);)++e;if((n=e+1)===this.m_currentParams.glyphs.length)break;y&&(this.m_tempLineDirection=a.TypesettingUtils.getDirection(this.m_currentParams.glyphs,n),this.m_tempRunDirection=this.m_tempLineDirection),u=0,d=0,c=n,h=0,l=n,m=0,f=!1,p++}else this.m_currentParams.textLayoutStyle.wrappingMode===o.WrappingMode.None||v||(c=e,h=d,this.m_currentParams.textLayoutStyle.wrappingMode===o.WrappingMode.Word&&e+1<this.m_currentParams.glyphs.length&&(s.UnicodeUtils.isWhiteSpace(this.m_currentParams.glyphs[e+1].codePoint)||s.UnicodeUtils.isNewLine(this.m_currentParams.glyphs[e+1].codePoint))&&(l=e,m=d))}if(p<=this.m_currentParams.textLayoutStyle.maxLines-1&&n<=this.m_currentParams.glyphs.length-1){const e=this.m_tempLineDirection===s.UnicodeUtils.Direction.RTL&&f?1+this.m_currentParams.textLayoutStyle.horizontalAlignment:this.m_currentParams.textLayoutStyle.horizontalAlignment;if(this.m_currentParams.position.setX(this.m_currentParams.position.x+d*e),!this.placeLine(n,this.m_currentParams.glyphs.length-1,this.m_tempLineDirection,f))return!1}return!0}placeLine(e,t,r,i){if(!i)return this.placeRun(e,t,r);const n=this.m_currentParams.glyphs,o=this.m_currentParams.smallCapsArray,c=this.m_currentParams.textRenderStyle,l=this.m_currentParams.textLayoutStyle,u=this.m_currentParams.position,d=r===s.UnicodeUtils.Direction.RTL,h=u.x;let m=0,p=e;for(let i=e;i<=t;++i){const e=n[i];if(e.direction===-this.m_tempRunDirection){if(d&&(u.x=h+m),!this.placeRun(p,i-1,this.m_tempRunDirection))return!1;d||(u.x=h+m),p=i,this.m_tempRunDirection*=-1}else if(e.direction===s.UnicodeUtils.Direction.Neutral&&this.m_tempRunDirection===-r){let e=i;for(;e+1<n.length&&1!==Math.abs(n[e].direction);)++e;if(n[e].direction!==this.m_tempRunDirection){if(d&&(u.x=h+m),!this.placeRun(p,i-1,this.m_tempRunDirection))return!1;d||(u.x=h+m),p=i,this.m_tempRunDirection*=-1}}m+=(e.advanceX+l.tracking)*this.m_tempScale*(this.m_tempSmallCaps?a.TypesettingUtils.getSmallCapsScale(n,o,i,c.fontVariant):1)*r}if(p<=t){if(d&&(u.x=h+m),!this.placeRun(p,t,this.m_tempRunDirection))return!1;d||(u.x=h+m)}return!0}placeRun(e,t,r){const i=this.m_currentParams.glyphs,c=this.m_currentParams.smallCapsArray,l=this.m_currentParams.fontCatalog,u=this.m_currentParams.textRenderStyle,d=this.m_currentParams.textLayoutStyle,h=this.m_currentParams.position,m=this.m_currentParams.geometry,p=this.m_currentParams.globalBounds,f=this.m_currentParams.individualBounds,g=this.m_currentParams.vertexBuffer,y=r===s.UnicodeUtils.Direction.LTR?e:t,v=r===s.UnicodeUtils.Direction.LTR?t:e;for(let _=y;r===s.UnicodeUtils.Direction.RTL?_>=v:_<=v;_+=r){const y=i[_];if(!s.UnicodeUtils.isPrintable(y.codePoint))continue;if(e!==t&&0!==_&&r===s.UnicodeUtils.Direction.RTL&&y.direction===s.UnicodeUtils.Direction.Weak){let t=_,r=i[t-1];for(;t!==e&&(r.direction===s.UnicodeUtils.Direction.Weak||r.direction===s.UnicodeUtils.Direction.Neutral&&!s.UnicodeUtils.isWhiteSpace(r.codePoint));)r=i[--t-1];this.placeRun(Math.max(t,e),_,s.UnicodeUtils.Direction.LTR),_=t;continue}const v=y.font,b=v.metrics,S=u.fontStyle,T=S===o.FontStyle.Bold&&void 0===v.bold||S===o.FontStyle.BoldItalic&&void 0===v.bold&&void 0===v.boldItalic,E=S===o.FontStyle.Italic&&void 0===v.italic||S===o.FontStyle.BoldItalic&&void 0===v.italic&&void 0===v.boldItalic,w=!!this.m_tempSmallCaps&&(c[_]&&u.fontVariant===o.FontVariant.SmallCaps),C=w?b.xHeight/b.capHeight:1,x=this.m_tempScale*C,O=((T?.02:0)+(w?.01:0))*(l.size/l.distanceRange),A=.5*this.m_tempPixelBgSize/(l.distanceRange*Math.max(x,1)),P=s.UnicodeUtils.isRtlMirrored(y.codePoint)&&r===s.UnicodeUtils.Direction.RTL,R=b.lineHeight-b.base-.5*b.distanceRange;a.TypesettingUtils.computeGlyphTransform(this.m_tempTransform,h,x,d.canvasRotation,u.rotation);for(let e=0;e<4;++e){const t=y.positions[e],r=E&&e>1?a.TypesettingUtils.OBLIQUE_OFFSET*b.size:0;this.m_tempCorners[e].set(t.x+r,t.y-R,t.z),this.m_tempCorners[e].applyMatrix3(this.m_tempTransform)}if(void 0===p&&void 0===g){if(!m.add(y,this.m_tempCorners,O,O+A,P,u))return!1}else void 0!==p&&a.TypesettingUtils.updateBounds(this.m_tempCorners,p,f),void 0!==g&&m.addToBuffer(g,_*n.QUAD_VERTEX_MEMORY_FOOTPRINT,y,this.m_tempCorners,O,O+A,P,u);h.set(h.x+(y.advanceX+d.tracking)*x*Math.cos(d.lineRotation),h.y+(y.advanceX+d.tracking)*x*Math.sin(d.lineRotation),h.z)}return!0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(89),o=r(33),a=r(90),s=r(46);t.PathTypesetter=class{constructor(){this.m_tempTransform=new i.Matrix3,this.m_tempCorners=[new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3],this.m_tempLineDirection=s.UnicodeUtils.Direction.LTR,this.m_tempRunDirection=s.UnicodeUtils.Direction.LTR,this.m_tempPixelSize=1,this.m_tempPixelBgSize=1,this.m_tempScale=1,this.m_tempSmallCaps=!1,this.m_tempPathPosition=new i.Vector3,this.m_tempPathLength=0,this.m_tempPathOffset=0}arrangeGlyphs(e){this.m_currentParams=e,this.m_tempLineDirection=a.TypesettingUtils.getDirection(this.m_currentParams.glyphs,0),this.m_tempRunDirection=this.m_tempLineDirection,this.m_tempPixelSize=a.TypesettingUtils.getPixelSize(this.m_currentParams.textRenderStyle.fontSize.size,this.m_currentParams.textRenderStyle.fontSize.unit,this.m_currentParams.fontCatalog.size),this.m_tempScale=this.m_tempPixelSize/this.m_currentParams.fontCatalog.size,this.m_tempPixelBgSize=Math.min(a.TypesettingUtils.getPixelSize(this.m_currentParams.textRenderStyle.fontSize.backgroundSize,this.m_currentParams.textRenderStyle.fontSize.unit,this.m_currentParams.fontCatalog.size),this.m_currentParams.fontCatalog.distanceRange*this.m_tempScale),this.m_tempSmallCaps=void 0!==this.m_currentParams.smallCapsArray,this.m_tempPathLength=this.m_currentParams.path.getLength(),this.m_tempPathOffset=0;const t=void 0!==this.m_currentParams.globalBounds&&void 0===this.m_currentParams.vertexBuffer;let r=!1,i=0;for(let e=0;e<this.m_currentParams.glyphs.length;++e){const n=this.m_currentParams.glyphs[e];if(!n.isInCache&&!t)return!1;s.UnicodeUtils.isPrintable(n.codePoint)&&(r||n.direction!==-this.m_tempLineDirection||(r=!0),i+=(n.advanceX+this.m_currentParams.textLayoutStyle.tracking)*this.m_tempScale*(this.m_tempSmallCaps?a.TypesettingUtils.getSmallCapsScale(this.m_currentParams.glyphs,this.m_currentParams.smallCapsArray,e,this.m_currentParams.textRenderStyle.fontVariant):1))}return this.m_tempPathOffset=Math.min(Math.max(-this.m_currentParams.textLayoutStyle.horizontalAlignment+this.m_currentParams.textLayoutStyle.horizontalAlignment*i/this.m_tempPathLength,0),1),this.placeLine(this.m_tempLineDirection,r)}placeLine(e,t){if(!t)return this.placeRun(0,this.m_currentParams.glyphs.length-1,e);const r=this.m_currentParams.glyphs;let i=0;for(let t=i;t<r.length;++t){const n=r[t];if(n.direction===-this.m_tempRunDirection){if(!this.placeRun(i,t-1,this.m_tempRunDirection))return!1;i=t,this.m_tempRunDirection*=-1}else if(n.direction===s.UnicodeUtils.Direction.Neutral&&this.m_tempRunDirection===-e){let e=t;for(;e+1<r.length&&1!==Math.abs(r[e].direction);)++e;if(r[e].direction!==this.m_tempRunDirection){if(!this.placeRun(i,t-1,this.m_tempRunDirection))return!1;i=t,this.m_tempRunDirection*=-1}}}return!(i<r.length&&!this.placeRun(i,r.length-1,this.m_tempRunDirection))}placeRun(e,t,r){const c=this.m_currentParams.glyphs,l=this.m_currentParams.smallCapsArray,u=this.m_currentParams.fontCatalog,d=this.m_currentParams.textRenderStyle,h=this.m_currentParams.textLayoutStyle,m=this.m_currentParams.position,p=this.m_currentParams.geometry,f=this.m_currentParams.globalBounds,g=this.m_currentParams.individualBounds,y=this.m_currentParams.vertexBuffer,v=this.m_currentParams.path,_=d.rotation,b=h.verticalAlignment*c[0].font.metrics.capHeight*this.m_tempScale,S=r===s.UnicodeUtils.Direction.LTR?e:t,T=r===s.UnicodeUtils.Direction.LTR?t:e;for(let E=S;r===s.UnicodeUtils.Direction.RTL?E>=T:E<=T;E+=r){const S=c[E];if(!s.UnicodeUtils.isPrintable(S.codePoint))continue;if(e!==t&&0!==E&&r===s.UnicodeUtils.Direction.RTL&&S.direction===s.UnicodeUtils.Direction.Weak){let t=E,r=c[t-1];for(;t!==e&&(r.direction===s.UnicodeUtils.Direction.Weak||r.direction===s.UnicodeUtils.Direction.Neutral&&!s.UnicodeUtils.isWhiteSpace(r.codePoint));)r=c[--t-1];this.placeRun(Math.max(t,e),E,s.UnicodeUtils.Direction.LTR),E=t;continue}const T=S.font,w=T.metrics,C=d.fontStyle,x=C===o.FontStyle.Bold&&void 0===T.bold||C===o.FontStyle.BoldItalic&&void 0===T.bold&&void 0===T.boldItalic,O=C===o.FontStyle.Italic&&void 0===T.italic||C===o.FontStyle.BoldItalic&&void 0===T.italic&&void 0===T.boldItalic,A=!!this.m_tempSmallCaps&&(l[E]&&d.fontVariant===o.FontVariant.SmallCaps),P=A?w.xHeight/w.capHeight:1,R=this.m_tempScale*P,I=((x?.02:0)+(A?.01:0))*(u.size/u.distanceRange),D=.5*this.m_tempPixelBgSize/(u.distanceRange*Math.max(R,1)),L=s.UnicodeUtils.isRtlMirrored(S.codePoint)&&r===s.UnicodeUtils.Direction.RTL,M=w.lineHeight-w.base-.5*w.distanceRange,k=v.getPoint(this.m_tempPathOffset);if(null===k)return this.m_currentParams.pathOverflow;const N=v.getTangent(this.m_tempPathOffset),F=new i.Vector2(-N.y,N.x).multiplyScalar(b),U=Math.atan2(N.y,N.x);this.m_tempPathPosition.set(F.x+k.x,F.y+k.y,m.z),d.rotation=_+U,a.TypesettingUtils.computeGlyphTransform(this.m_tempTransform,this.m_tempPathPosition,R,0,d.rotation);for(let e=0;e<4;++e){const t=S.positions[e],r=O&&e>1?a.TypesettingUtils.OBLIQUE_OFFSET*w.size:0;this.m_tempCorners[e].set(t.x+r,t.y-M,t.z),this.m_tempCorners[e].applyMatrix3(this.m_tempTransform),this.m_tempCorners[e].x-=m.x,this.m_tempCorners[e].y-=m.y}if(void 0===f&&void 0===y){if(!p.add(S,this.m_tempCorners,I,I+D,L,d))return!1}else void 0!==f&&a.TypesettingUtils.updateBounds(this.m_tempCorners,f,g),void 0!==y&&p.addToBuffer(y,E*n.QUAD_VERTEX_MEMORY_FOOTPRINT,S,this.m_tempCorners,I,I+D,L,d);d.rotation=_,this.m_tempPathOffset+=(S.advanceX+h.tracking)*R/this.m_tempPathLength}return!0}}},function(e,t,r){"use strict";var i,n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Initial=0]="Initial",e[e.Medial=1]="Medial",e[e.Final=2]="Final"}(i||(i={})),function(e){e[e.Isolated=0]="Isolated",e[e.Connected=1]="Connected"}(n||(n={}));class o{constructor(){this.m_singleCharactersMap=new Map,this.m_combinedCharactersMap=new Map,this.m_singleCharactersMap.set(1569,[void 0,void 0,void 0]),this.m_singleCharactersMap.set(1570,[void 0,void 0,65154]),this.m_singleCharactersMap.set(1571,[void 0,void 0,65156]),this.m_singleCharactersMap.set(1572,[void 0,void 0,65158]),this.m_singleCharactersMap.set(1573,[void 0,void 0,65160]),this.m_singleCharactersMap.set(1574,[65163,65164,65162]),this.m_singleCharactersMap.set(1575,[void 0,void 0,65166]),this.m_singleCharactersMap.set(1576,[65169,65170,65168]),this.m_singleCharactersMap.set(1577,[void 0,void 0,65172]),this.m_singleCharactersMap.set(1578,[65175,65176,65174]),this.m_singleCharactersMap.set(1579,[65179,65180,65178]),this.m_singleCharactersMap.set(1580,[65183,65184,65182]),this.m_singleCharactersMap.set(1581,[65187,65188,65186]),this.m_singleCharactersMap.set(1582,[65191,65192,65190]),this.m_singleCharactersMap.set(1583,[void 0,void 0,65194]),this.m_singleCharactersMap.set(1584,[void 0,void 0,65196]),this.m_singleCharactersMap.set(1585,[void 0,void 0,65198]),this.m_singleCharactersMap.set(1586,[void 0,void 0,65200]),this.m_singleCharactersMap.set(1587,[65203,65204,65202]),this.m_singleCharactersMap.set(1588,[65207,65208,65206]),this.m_singleCharactersMap.set(1589,[65211,65212,65210]),this.m_singleCharactersMap.set(1590,[65215,65216,65214]),this.m_singleCharactersMap.set(1591,[65219,65220,65218]),this.m_singleCharactersMap.set(1592,[65223,65224,65222]),this.m_singleCharactersMap.set(1593,[65227,65228,65226]),this.m_singleCharactersMap.set(1594,[65231,65232,65230]),this.m_singleCharactersMap.set(1600,[1600,1600,1600]),this.m_singleCharactersMap.set(1601,[65235,65236,65234]),this.m_singleCharactersMap.set(1602,[65239,65240,65238]),this.m_singleCharactersMap.set(1603,[65243,65244,65242]),this.m_singleCharactersMap.set(1604,[65247,65248,65246]),this.m_singleCharactersMap.set(1605,[65251,65252,65250]),this.m_singleCharactersMap.set(1606,[65255,65256,65254]),this.m_singleCharactersMap.set(1607,[65259,65260,65258]),this.m_singleCharactersMap.set(1608,[void 0,void 0,65262]),this.m_singleCharactersMap.set(1609,[void 0,void 0,65264]),this.m_singleCharactersMap.set(1610,[65267,65268,65266]),this.m_singleCharactersMap.set(1662,[64344,64345,64343]),this.m_singleCharactersMap.set(1740,[64510,64511,64509]),this.m_singleCharactersMap.set(1670,[64380,64381,64379]),this.m_singleCharactersMap.set(1705,[64400,64401,64399]),this.m_singleCharactersMap.set(1711,[64404,64405,64403]),this.m_singleCharactersMap.set(1688,[void 0,void 0,64395]),this.m_combinedCharactersMap.set(1604,new Map),this.m_combinedCharactersMap.get(1604).set(1570,[65269,65270]),this.m_combinedCharactersMap.get(1604).set(1571,[65271,65272]),this.m_combinedCharactersMap.get(1604).set(1573,[65273,65274]),this.m_combinedCharactersMap.get(1604).set(1575,[65275,65276]),this.m_neutralCharacters=[1552,1554,1555,1556,1557,1611,1612,1613,1614,1615,1616,1617,1618,1619,1620,1621,1622,1623,1624,1648,1750,1751,1752,1753,1754,1755,1756,1759,1760,1761,1762,1763,1764,1767,1768,1770,1771,1772,1773]}static get instance(){return void 0===this.m_instance&&(this.m_instance=new o),this.m_instance}convert(e){let t="";for(let r=0;r<e.length;++r){const o=e.charCodeAt(r);if(this.isArabicCharacter(o)){let a=r-1;for(;a>=0&&this.isNeutral(e.charCodeAt(a));--a);let s=a>=0?e.charCodeAt(a):void 0;if(void 0!==s){const e=this.getCharacterMap(s);(void 0===e||void 0===e[i.Initial]&&void 0===e[i.Medial])&&(s=void 0)}let c=r+1;for(;c<e.length&&this.isNeutral(e.charCodeAt(c));++c);let l=c<e.length?e.charCodeAt(c):void 0;if(void 0!==l){const e=this.getCharacterMap(l);(void 0===e||void 0===e[i.Medial]&&void 0===e[i.Final])&&(l=void 0)}if(1604===o&&void 0!==l&&(1570===l||1571===l||1573===l||1575===l)){const e=this.getCombinedCharacterMap(o,l);t+=void 0!==s?String.fromCharCode(e[n.Connected]):String.fromCharCode(e[n.Isolated]),++r;continue}const u=this.getCharacterMap(o);void 0!==s&&void 0!==l&&void 0!==u[i.Medial]?t+=String.fromCharCode(u[i.Medial]):void 0!==s&&void 0!==u[i.Final]?t+=String.fromCharCode(u[i.Final]):void 0!==l&&void 0!==u[i.Initial]?t+=String.fromCharCode(u[i.Initial]):t+=String.fromCharCode(o)}else t+=String.fromCharCode(o)}return t}isArabicCharacter(e){return this.m_singleCharactersMap.has(e)}getCharacterMap(e){return this.m_singleCharactersMap.get(e)}getCombinedCharacterMap(e,t){const r=this.m_combinedCharactersMap.get(e);if(void 0!==r)return r.get(t)}isNeutral(e){for(const t of this.m_neutralCharacters)if(t===e)return!0;return!1}}t.ContextualArabicConverter=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);t.PathBlockingElement=class{constructor(e){this.points=e,this.screenSpaceLines=new Array(e.length>=2?e.length-1:0);for(let e=0;e<this.screenSpaceLines.length;e++)this.screenSpaceLines[e]=new i.Line3(new i.Vector3,new i.Vector3)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(154),n=r(93);t.TextElementState=class{initialize(e,t,r=1){const o=!0===t?0:i.DEFAULT_FADE_TIME;if(e!==n.TextElementType.LineMarker)this.m_textRenderState=new i.RenderState,this.m_textRenderState.fadingTime=o,e===n.TextElementType.PoiLabel&&(this.m_iconRenderStates=new i.RenderState,this.m_iconRenderStates.fadingTime=o);else{this.m_iconRenderStates=new Array;for(let e=0;e<r;++e){const e=this.m_iconRenderStates,t=new i.RenderState;t.state=i.FadingState.FadingIn,t.fadingTime=o,e.push(t)}}}get initialized(){return void 0!==this.m_textRenderState||void 0!==this.m_iconRenderStates}clear(){this.m_iconRenderStates=void 0,this.m_textRenderState=void 0}get viewDistance(){return this.m_viewDistance}set viewDistance(e){this.m_viewDistance=e}get textRenderState(){return this.m_textRenderState}get iconRenderState(){if(void 0!==this.m_iconRenderStates)return this.m_iconRenderStates instanceof i.RenderState?this.m_iconRenderStates:void 0}get iconRenderStates(){if(void 0!==this.m_iconRenderStates)return this.m_iconRenderStates instanceof i.RenderState?void 0:this.m_iconRenderStates}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(9),o=r(1),a=r(0),s=r(34),c=r(359),l=r(157),u=o.LoggerManager.instance.create("PoiRenderer"),d=-1,h=new a.Vector3(0);class m{constructor(e,t,r,i){this.mapView=e,this.scene=t,this.imageItem=r,this.renderOrder=i,this.color=s.ColorCache.instance.getColor("#000000")}init(){void 0===this.boxBuffer&&this.setup()}reset(){void 0===this.boxBuffer&&this.init(),this.boxBuffer.reset()}update(){void 0===this.boxBuffer&&this.init(),this.boxBuffer.updateBufferGeometry()}updateMemoryUsage(e){void 0!==this.boxBuffer&&this.boxBuffer.updateMemoryUsage(e)}setup(){const e=new l.IconTexture(this.imageItem),t=new a.Texture(e.image.imageData,a.UVMapping,void 0,void 0,a.LinearFilter,a.LinearFilter,a.RGBAFormat);t.needsUpdate=!0,t.premultiplyAlpha=!0,t.generateMipmaps=!1,this.m_material=new n.IconMaterial({map:t}),this.boxBuffer=new c.BoxBuffer(this.m_material,this.renderOrder);const r=this.boxBuffer.mesh;r.frustumCulled=!1,this.scene.add(r),this.mapView.update()}}class p{constructor(e,t){this.mapView=e,this.textCanvas=t,this.batches=[],this.m_batchMap=new Map}registerPoi(e){const{imageItem:t,imageTexture:r,imageTextureName:i}=e;if(void 0===t||void 0===i||void 0===r)return d;const n=e.renderOrder,o=r.image;let a,s,c=this.m_batchMap.get(o);if(void 0===c&&(c=new Map,this.m_batchMap.set(o,c)),void 0!==(a=c.get(n)))return a;a=this.batches.length;let l=this.textCanvas.getLayer(n);return void 0===l&&(this.textCanvas.addText("",h,{layer:n}),l=this.textCanvas.getLayer(n)),(s=new m(this.mapView,l.storage.scene,t,n)).init(),c.set(n,a),this.batches.push(s),a}addPoi(e,t,r){const i=this.registerPoi(e);return o.assert(i>=0),i<0?d:(o.assert(void 0!==e.uvBox),void 0===this.batches[i].boxBuffer&&this.batches[i].init(),this.batches[i].boxBuffer.addBox(t,e.uvBox,this.batches[i].color,r,e.textElement.renderDistance,e.textElement),i)}getBatch(e){if(e>=0)return o.assert(e<this.batches.length),this.batches[e]}reset(){for(const e of this.batches)e.reset()}update(){for(const e of this.batches)e.update()}pickTextElements(e,t){for(const r of this.batches)void 0===r.boxBuffer&&r.init(),r.boxBuffer.pickBoxes(e,t,r.imageItem.imageData)}updateMemoryUsage(e){for(const t of this.batches){if(void 0!==t.imageItem.imageData){const r=t.imageItem.imageData.width*t.imageItem.imageData.height*4;e.heapSize+=r,e.gpuSize+=r}void 0!==t.boxBuffer&&t.boxBuffer.updateMemoryUsage(e)}}}class f{constructor(e,t){this.mapView=e,this.textCanvas=t,this.m_tempScreenBox=new o.Math2D.Box,this.m_renderBuffer=new p(e,t)}prepareRender(e,t){const r=e.poiInfo;return void 0!==r&&(void 0===r.poiRenderBatch&&this.preparePoi(e,t),void 0!==r.poiRenderBatch)}computeScreenBox(e,t,r,i,n,o){return!!this.computeIconScreenBox(e,t,r,n,o)&&i.isVisible(o)}isSpaceAvailable(e,t){return!e.isAllocated(t)}reset(){this.m_renderBuffer.reset()}renderPoi(e,t,r,i,n,a,s){o.assert(void 0!==e.poiRenderBatch),this.computeIconScreenBox(e,t,i,s,this.m_tempScreenBox)&&(n&&r.allocate(this.m_tempScreenBox),this.m_renderBuffer.addPoi(e,this.m_tempScreenBox,a))}poiIsRenderable(e){return void 0!==e.poiRenderBatch}update(){this.m_renderBuffer.update()}pickTextElements(e,t){this.m_renderBuffer.pickTextElements(e,t)}getMemoryUsage(e){this.m_renderBuffer.updateMemoryUsage(e)}computeIconScreenBox(e,t,r,n,a){if(o.assert(void 0!==e.poiRenderBatch),void 0===this.m_renderBuffer.getBatch(e.poiRenderBatch))return!1;const s=e.computedWidth*r,c=e.computedHeight*r,l=e.technique,u=i.getPropertyValue(l.iconXOffset,n),d=i.getPropertyValue(l.iconYOffset,n),h=t.x+("number"==typeof u?u:0),m=t.y+("number"==typeof d?d:0);return a.x=h-s/2,a.y=m-c/2,a.w=s,a.h=c,!0}preparePoi(e,t){const r=e.poiInfo;if(void 0===r||!e.visible)return;if(void 0!==r.poiRenderBatch||!1===r.isValid)return;if(void 0!==r.poiTableName){if(!this.mapView.poiManager.updatePoiFromPoiTable(e))return;if(r.poiTableName=void 0,!e.visible)return}const i=r.imageTextureName,n=this.mapView.poiManager.getImageTexture(i);if(void 0===n)return void 0===f.m_missingTextureName.get(i)&&(f.m_missingTextureName.set(i,!0),u.error(`preparePoi: No imageTexture with name '${i}' found`)),void(r.isValid=!1);const o=n.image;let a=this.mapView.imageCache.findImageByName(o);if(void 0===a)return u.error(`init: No imageItem found with name '${o}'`),void(r.isValid=!1);if(!a.loaded){if(void 0!==a.loadingPromise)return;const e=a.url,i=this.mapView.imageCache.loadImage(a);if(i instanceof Promise)return void i.then(i=>{void 0!==i?this.setupPoiInfo(r,n,i,t):u.error(`preparePoi: Failed to load imageItem: '${e}`)}).catch(t=>{u.error(`preparePoi: Failed to load imageItem: '${e}`,t),r.isValid=!1});a=i}this.setupPoiInfo(r,n,a,t)}setupPoiInfo(e,t,r,n){if(o.assert(void 0===e.uvBox),void 0===r||void 0===r.imageData)return u.error("setupPoiInfo: No imageItem/imageData found"),e.poiRenderBatch=d,void(e.isValid=!1);const a=e.technique,s=r.imageData.width,c=r.imageData.height,l=void 0!==t.width?t.width:s,h=void 0!==t.height?t.height:c;let m=0,p=1,f=0,g=1,y=void 0!==a.iconScale?a.iconScale:1,v=void 0!==a.iconScale?a.iconScale:1;const _=void 0!==t.width?t.width:s,b=void 0!==t.height?t.height:c,S=void 0!==t.xOffset?t.xOffset:0,T=void 0!==t.yOffset?t.yOffset:0;m=S/s,p=(S+_)/s;f=(c-T)/c,g=(c-T-b)/c;const E=i.getPropertyValue(a.screenWidth,n);void 0!==E&&(v=y=E/l);const w=i.getPropertyValue(a.screenHeight,n);void 0!==w&&(v=w/h,void 0!==E&&(y=v)),e.computedWidth=l*y,e.computedHeight=h*v,e.uvBox={s0:m,t0:g,s1:p,t1:f},e.imageItem=r,e.imageTexture=t,e.poiRenderBatch=this.m_renderBuffer.registerPoi(e),e.isValid=!0,o.assert(void 0!==e.poiRenderBatch)}}t.PoiRenderer=f,f.m_missingTextureName=new Map},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=r(0),o=r(360),a=0,s=32768,c=4,l=6,u=3,d=4,h=4,m=1,p=4,f=4;class g extends n.Mesh{constructor(e,t){super(e,t),this.type="BoxBufferMesh"}get isEmpty(){return void 0===this.geometry||0===this.geometry.index.count}}t.BoxBufferMesh=g;class y{constructor(e,t=0,r=a,i=s){this.material=e,this.renderOrder=t,this.startElementCount=r,this.maxElementCount=i,this.m_size=0,this.resizeBuffer(r),this.pickInfos=new Array}clone(){return new y(this.material,this.renderOrder)}dispose(){void 0!==this.geometry&&(this.geometry.dispose(),this.geometry=void 0),this.internalMesh=void 0}get size(){return this.m_size}reset(){void 0!==this.positionAttribute&&(this.positionAttribute.count=0,this.colorAttribute.count=0,this.uvAttribute.count=0,this.indexAttribute.count=0,this.pickInfos.length=0)}canAddElements(e=1){const t=this.indexAttribute;if(t.count+e*l>=t.array.length){if(t.array.length>=this.maxElementCount*l)return!1;const e=Math.min(this.maxElementCount,0===this.size?256:2*this.size);this.resize(e)}return!0}saveState(){return{positionAttributeCount:this.positionAttribute.count,colorAttributeCount:this.colorAttribute.count,uvAttributeCount:this.uvAttribute.count,indexAttributeCount:this.indexAttribute.count,pickInfoCount:this.pickInfos.length}}restoreState(e){this.positionAttribute.count=e.positionAttributeCount,this.colorAttribute.count=e.colorAttributeCount,this.uvAttribute.count=e.uvAttributeCount,this.indexAttribute.count=e.indexAttributeCount,this.pickInfos.length=e.pickInfoCount}addBox(e,t,r,i,n,o){if(!this.canAddElements())return!1;const{s0:a,t0:s,s1:u,t1:d}=t,{x:h,y:m,w:p,h:f}=e,g=Math.round(255*r.r),y=Math.round(255*r.g),v=Math.round(255*r.b),_=Math.round(255*i),b=this.positionAttribute,S=this.colorAttribute,T=this.uvAttribute,E=this.indexAttribute,w=b.count,C=E.count;return b.setXYZ(w,h,m,n),b.setXYZ(w+1,h+p,m,n),b.setXYZ(w+2,h,m+f,n),b.setXYZ(w+3,h+p,m+f,n),S.setXYZW(w,g,y,v,_),S.setXYZW(w+1,g,y,v,_),S.setXYZW(w+2,g,y,v,_),S.setXYZW(w+3,g,y,v,_),T.setXY(w,a,s),T.setXY(w+1,u,s),T.setXY(w+2,a,d),T.setXY(w+3,u,d),E.setX(C,w),E.setX(C+1,w+1),E.setX(C+2,w+2),E.setX(C+3,w+2),E.setX(C+4,w+1),E.setX(C+5,w+3),b.count+=c,S.count+=c,T.count+=c,E.count+=l,this.pickInfos.push(o),!0}updateBufferGeometry(){const e=this.positionAttribute,t=this.colorAttribute,r=this.uvAttribute,i=this.indexAttribute;e.count>0&&(e.needsUpdate=!0,e.updateRange.offset=0,e.updateRange.count=e.count*c),t.count>0&&(t.needsUpdate=!0,t.updateRange.offset=0,t.updateRange.count=t.count*c),r.count>0&&(r.needsUpdate=!0,r.updateRange.offset=0,r.updateRange.count=r.count*c),i.count>0&&(i.needsUpdate=!0,i.updateRange.offset=0,i.updateRange.count=i.count),void 0!==this.geometry&&(this.geometry.clearGroups(),this.geometry.addGroup(0,this.indexAttribute.count))}cleanUp(){0===this.indexAttribute.count&&this.size>a&&this.clearAttributes()}get isEmpty(){return this.internalMesh.isEmpty}get mesh(){return void 0===this.internalMesh&&this.resize(),this.internalMesh}pickBoxes(e,t,r){const n=this.pickInfos.length,o=this.pickInfos,a=this.positionAttribute,s=e.x,l=e.y,u=document.createElement("canvas");for(let e=0;e<n;e++){const n=e*c,d=a.getX(n);if(s<d)continue;const h=a.getX(n+1);if(s>h)continue;const m=a.getY(n);if(l<m)continue;const p=a.getY(n+2);if(l>p)continue;const f=new i.Math2D.Box(d,m,h-d,p-m);void 0!==r&&void 0!==o[e].poiInfo&&void 0!==o[e].poiInfo.uvBox&&this.isPixelTransparent(r,s,l,f,o[e].poiInfo.uvBox,u)||void 0!==o[e]&&t(o[e])}}resize(e,t){return void 0!==this.geometry&&this.geometry.dispose(),this.geometry=new n.BufferGeometry,void 0!==e&&(!0===t||e>this.size)&&this.resizeBuffer(e),this.geometry.setAttribute("position",this.positionAttribute),this.geometry.setAttribute("color",this.colorAttribute),this.geometry.setAttribute("uv",this.uvAttribute),this.geometry.setIndex(this.indexAttribute),this.geometry.addGroup(0,this.indexAttribute.count),void 0===this.internalMesh?(this.internalMesh=new g(this.geometry,this.material),this.internalMesh.renderOrder=this.renderOrder):this.internalMesh.geometry=this.geometry,this.internalMesh}updateMemoryUsage(e){const t=this.positionAttribute.count*u*p+this.colorAttribute.count*d+this.uvAttribute.count*h*p+this.indexAttribute.count*f;e.heapSize+=t,e.gpuSize+=t}isPixelTransparent(e,t,r,i,n,a){let s=!1;const{u:c,v:l}=o.screenToUvCoordinates(t,r,i,n),u=e.width*c,d=e.height*l,h=o.getPixelFromImage(u,d,e,a);return void 0!==h&&0===h[3]&&(s=!0),s}clearAttributes(){this.positionAttribute=void 0,this.colorAttribute=void 0,this.uvAttribute=void 0,this.indexAttribute=void 0,this.resize(a,!0)}resizeBuffer(e){const t=new Float32Array(e*c*u);if(void 0!==this.positionAttribute&&this.positionAttribute.array.length>0){const e=this.positionAttribute.count;t.set(this.positionAttribute.array),this.positionAttribute.array=t,this.positionAttribute.count=e}else this.positionAttribute=new n.BufferAttribute(t,u),this.positionAttribute.count=0,this.positionAttribute.setUsage(n.DynamicDrawUsage);const r=new Uint8Array(e*c*d);if(void 0!==this.colorAttribute){const e=this.colorAttribute.count;r.set(this.colorAttribute.array),this.colorAttribute.array=r,this.colorAttribute.count=e}else this.colorAttribute=new n.BufferAttribute(r,d,!0),this.colorAttribute.count=0,this.colorAttribute.setUsage(n.DynamicDrawUsage);const i=new Float32Array(e*c*h);if(void 0!==this.uvAttribute){const e=this.uvAttribute.count;i.set(this.uvAttribute.array),this.uvAttribute.array=i,this.uvAttribute.count=e}else this.uvAttribute=new n.BufferAttribute(i,h),this.uvAttribute.count=0,this.uvAttribute.setUsage(n.DynamicDrawUsage);const o=e*l*m,a=o>65535?new Uint32Array(o):new Uint16Array(o);if(void 0!==this.indexAttribute){const e=this.indexAttribute.count;a.set(this.indexAttribute.array),this.indexAttribute.array=a,this.indexAttribute.count=e}else this.indexAttribute=new n.BufferAttribute(a,m),this.indexAttribute.count=0,this.indexAttribute.setUsage(n.DynamicDrawUsage);this.m_size=e}}t.BoxBuffer=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1);function n(e,t,r,i){if(t>e.width||t<0||r>e.height||r<0)return;let n;i.width=e.width,i.height=e.height;const o=i.getContext("2d");return null!==o&&(o.drawImage(e,0,0,e.width,e.height,0,0,i.width,i.height),n=o.getImageData(t,r,1,1).data),n}function o(e,t,r,i){if(!(t>e.width||t<0||r>e.height||r<0))return((e,t,r)=>{const i=t*r,n=e.data,o=new Uint8ClampedArray(r);for(let e=0;e<r;e++)o[0]=n[i+e];return o})(e,r*e.width+t,i)}t.getPixelFromImage=function(e,t,r,i){let a;if((e=>void 0!==e.close)(r))void 0===i&&(i=document.createElement("canvas")),a=n(r,e,t,i);else{const i=r;a=o(i,e,t,i.data.length/(i.height*i.width))}return a},t.screenToUvCoordinates=function(e,t,r,n){const o=r.x,a=r.x+r.w,s=r.y,c=r.y+r.h;return{u:i.MathUtils.map(e,o,a,n.s0,n.s1),v:i.MathUtils.map(t,s,c,n.t0,n.t1)}},t.getPixelFromImageBitmap=n,t.getPixelFromImageData=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);class n extends i.LineCurve{constructor(e,t){super(e,t)}getLengths(){return void 0===this.m_lengths&&(this.m_lengths=[0,this.v2.distanceTo(this.v1)]),this.m_lengths}}t.SimpleLineCurve=n;class o{constructor(e,t,r){this.path=e,this.index=t,this.t=r}get curve(){return this.path.curves[this.index]}get point(){return void 0===this.m_point&&(this.m_point=this.curve.getPoint(this.t)),this.m_point}}t.PathParam=o;class a extends i.Path{constructor(){super()}getLengths(){if(this.m_cache)return this.m_cache;let e=0;const t=new Array;return t.push(0),this.curves.forEach(r=>{const i=r;e+=i.v1.distanceTo(i.v2),t.push(e)}),this.m_cache=t,t}getParamAt(e){const t=e*this.getLength(),r=this.getCurveLengths();for(let e=0;e<r.length;++e){if(r[e]<t)continue;const i=r[e]-t,n=this.curves[e].getLength();return new o(this,e,0===n?0:1-i/n)}return null}}t.SimplePath=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(9),o=r(363),a=r(161),s=r(364),c=r(49),l=r(365),u=a.MSAASampling.Level_1,d=a.MSAASampling.Level_4;t.MapRenderingManager=class{constructor(e,t,r,s={msaaEnabled:!1}){this.bloom={enabled:!1,strength:1.5,radius:.4,threshold:.85},this.outline={enabled:!1,thickness:.005,color:"#000000",ghostExtrudedPolygons:!1,needsUpdate:!1},this.vignette={enabled:!1,offset:1,darkness:1},this.sepia={enabled:!1,amount:.5},this.m_width=1,this.m_height=1,this.m_renderPass=new c.RenderPass,this.m_target1=new i.WebGLRenderTarget(1,1),this.m_target2=new i.WebGLRenderTarget(1,1),this.m_sepiaPass=new c.ShaderPass(n.SepiaShader),this.m_vignettePass=new c.ShaderPass(n.VignetteShader),this.m_readBuffer=new i.WebGLRenderTarget(e,t),this.m_msaaPass=new a.MSAARenderPass,this.m_msaaPass.enabled=void 0!==s&&!0===s.msaaEnabled,this.m_dynamicMsaaSamplingLevel=void 0===s.dynamicMsaaSamplingLevel?u:s.dynamicMsaaSamplingLevel,this.m_staticMsaaSamplingLevel=void 0===s.staticMsaaSamplingLevel?d:s.staticMsaaSamplingLevel,this.m_lowResPass=new o.LowResRenderPass(r),this.m_lowResPass.enabled=void 0!==r}updateOutline(e){this.outline.color=e.color,this.outline.thickness=e.thickness,this.outline.ghostExtrudedPolygons=e.ghostExtrudedPolygons,this.outline.needsUpdate=!0}render(e,t,r,n){if(!n&&void 0!==this.m_lowResPass.pixelRatio)return this.m_lowResPass.renderToScreen=!0,void this.m_lowResPass.render(e,t,r,null,this.m_readBuffer);const o=this.bloom.enabled||this.outline.enabled||this.vignette.enabled||this.sepia.enabled;let a=null;if((this.bloom.enabled||this.vignette.enabled||this.sepia.enabled)&&(e.setRenderTarget(this.m_target1),e.clearDepth()),this.m_msaaPass.enabled?(this.m_msaaPass.samplingLevel=n?this.m_staticMsaaSamplingLevel:this.m_dynamicMsaaSamplingLevel,this.m_msaaPass.renderToScreen=!o,this.m_msaaPass.render(e,t,r,null,this.m_readBuffer)):this.bloom.enabled||this.vignette.enabled||this.sepia.enabled?(a=this.m_target1,this.m_renderPass.render(e,t,r,this.m_target1,null)):(!this.outline.enabled||this.outline.enabled&&!this.bloom.enabled)&&e.render(t,r),this.outline.enabled){void 0===this.m_outlineEffect&&(this.m_outlineEffect=new s.OutlineEffect(e)),this.outline.needsUpdate&&(this.m_outlineEffect.color=this.outline.color,this.m_outlineEffect.thickness=this.outline.thickness,this.m_outlineEffect.ghostExtrudedPolygons=this.outline.ghostExtrudedPolygons,this.outline.needsUpdate=!1);const i=this.bloom.enabled||this.vignette.enabled||this.sepia.enabled;i&&(a=this.m_target1),e.setRenderTarget(i?a:null),this.m_outlineEffect.render(t,r)}if(this.bloom.enabled){void 0===this.m_bloomPass&&(this.m_bloomPass=new l.BloomPass(new i.Vector2(this.m_width,this.m_height),this.bloom.strength,this.bloom.radius,this.bloom.threshold));const n=this.vignette.enabled||this.sepia.enabled;this.m_bloomPass.renderToScreen=!n,this.m_bloomPass.radius=this.bloom.radius,this.m_bloomPass.strength=this.bloom.strength,this.m_bloomPass.threshold=this.bloom.threshold,this.m_bloomPass.render(e,t,r,null,a)}else void 0!==this.m_bloomPass&&(this.m_bloomPass.dispose(),this.m_bloomPass=void 0);if(this.vignette.enabled){const i=a,n=this.sepia.enabled;this.m_vignettePass.uniforms.offset.value=this.vignette.offset,this.m_vignettePass.uniforms.darkness.value=this.vignette.darkness,this.m_vignettePass.renderToScreen=!n,n&&(a=a===this.m_target1?this.m_target2:this.m_target1),this.m_vignettePass.render(e,t,r,a,i)}this.sepia.enabled&&(this.m_sepiaPass.renderToScreen=!0,this.m_sepiaPass.uniforms.amount.value=this.sepia.amount,this.m_sepiaPass.render(e,t,r,null,a))}setSize(e,t){this.m_readBuffer.setSize(e,t),this.m_msaaPass.setSize(e,t),void 0!==this.m_bloomPass&&this.m_bloomPass.setSize(e,t),this.m_lowResPass.setSize(e,t),this.m_target1.setSize(e,t),this.m_target2.setSize(e,t),this.m_width=e,this.m_height=t}get lowResPixelRatio(){return this.m_lowResPass.pixelRatio}set lowResPixelRatio(e){this.m_lowResPass.pixelRatio=e,this.m_lowResPass.enabled=void 0!==e}set dynamicMsaaSamplingLevel(e){this.m_dynamicMsaaSamplingLevel=e}get dynamicMsaaSamplingLevel(){return this.m_dynamicMsaaSamplingLevel}set msaaEnabled(e){this.m_msaaPass.enabled=e}get msaaEnabled(){return this.m_msaaPass.enabled}set staticMsaaSamplingLevel(e){this.m_staticMsaaSamplingLevel=e}get staticMsaaSamplingLevel(){return this.m_staticMsaaSamplingLevel}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(9),n=r(0),o=r(49);class a extends o.Pass{constructor(e){super(),this.lowResPixelRatio=e,this.m_renderTarget=null,this.m_localCamera=new n.OrthographicCamera(-1,1,1,-1,0,1),this.m_quadScene=new n.Scene,this.m_quadUniforms=i.CopyShader.uniforms,this.m_quadMaterial=new i.CopyMaterial(this.m_quadUniforms),this.m_quad=new n.Mesh(new n.PlaneBufferGeometry(2,2),this.m_quadMaterial),this.m_savedWidth=0,this.m_savedHeight=0,this.m_quad.frustumCulled=!1,this.m_quadScene.add(this.m_quad),this.m_pixelRatio=e}dispose(){this.m_quadMaterial.dispose(),this.m_quad.geometry.dispose(),null!==this.m_renderTarget&&(this.m_renderTarget.dispose(),this.m_renderTarget=null)}set pixelRatio(e){this.m_pixelRatio=e,this.m_renderTarget&&void 0!==this.pixelRatio&&this.m_renderTarget.setSize(Math.floor(this.m_savedWidth*this.pixelRatio),Math.floor(this.m_savedHeight*this.pixelRatio))}get pixelRatio(){return this.m_pixelRatio}render(e,t,r,i,o){if(!this.enabled||void 0===this.pixelRatio)return;null===this.m_renderTarget&&(this.m_savedWidth=o.width,this.m_savedHeight=o.height,this.m_renderTarget=new n.WebGLRenderTarget(Math.floor(this.m_savedWidth*this.pixelRatio),Math.floor(this.m_savedHeight*this.pixelRatio),{minFilter:n.LinearFilter,magFilter:n.LinearFilter,format:n.RGBAFormat,depthBuffer:!0,stencilBuffer:!0}),this.m_renderTarget.texture.name="LowResRenderPass.sample"),this.m_quadUniforms.tDiffuse.value=this.m_renderTarget.texture,this.m_quadUniforms.opacity.value=1;const a=e.getRenderTarget();e.setRenderTarget(this.m_renderTarget),e.clear(),e.render(t,r),e.setRenderTarget(this.renderToScreen?null:i),e.clear(),e.render(this.m_quadScene,this.m_localCamera),e.setRenderTarget(a)}setSize(e,t){this.m_savedWidth=e,this.m_savedHeight=t,this.m_renderTarget&&void 0!==this.pixelRatio&&this.m_renderTarget.setSize(Math.floor(e*this.pixelRatio),Math.floor(t*this.pixelRatio))}}t.LowResRenderPass=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=r(0),o="\n    uniform float outlineThickness;\n\n    vec4 calculateOutline( vec4 pos, vec3 objectNormal, vec4 skinned ) {\n\n        float thickness = outlineThickness;\n        const float ratio = 1.0;\n        vec4 pos2 = projectionMatrix * modelViewMatrix * vec4( skinned.xyz + objectNormal, 1.0 );\n        vec4 norm = normalize( pos - pos2 );\n        return pos + norm * thickness * pos.w * ratio;\n\n    }",a="\n    #if ! defined( LAMBERT ) && ! defined( PHONG ) && ! defined( TOON ) && ! defined( STANDARD )\n        #ifndef USE_ENVMAP\n            vec3 objectNormal = normalize( normal );\n        #endif\n    #endif\n\n    #ifdef FLIP_SIDED\n        objectNormal = -objectNormal;\n    #endif\n\n    #ifdef DECLARE_TRANSFORMED\n        vec3 transformed = vec3( position );\n    #endif\n\n    gl_Position = calculateOutline( gl_Position, objectNormal, vec4( transformed, 1.0 ) );\n\n    #include <fog_vertex>",s="\n    #include <common>\n    #include <fog_pars_fragment>\n\n    uniform vec3 outlineColor;\n    uniform float outlineAlpha;\n\n    void main() {\n\n        gl_FragColor = vec4( outlineColor, outlineAlpha );\n\n        #include <fog_fragment>\n\n    }";t.OutlineEffect=class{constructor(e){this.m_renderer=e,this.enabled=!0,this.m_defaultThickness=.02,this.m_defaultColor=new n.Color(0,0,0),this.m_defaultAlpha=1,this.m_defaultKeepAlive=!1,this.m_ghostExtrudedPolygons=!1,this.m_cache={},this.m_removeThresholdCount=60,this.m_originalMaterials={},this.m_originalOnBeforeRenders={},this.m_shaderIDs={MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical"},this.m_uniformsChunk={outlineThickness:{value:this.m_defaultThickness},outlineColor:{value:this.m_defaultColor},outlineAlpha:{value:this.m_defaultAlpha}},this.autoClear=e.autoClear,this.domElement=e.domElement,this.shadowMap=e.shadowMap}set thickness(e){this.m_defaultThickness=e,this.m_uniformsChunk.outlineThickness.value=e,this.m_cache={}}set color(e){this.m_defaultColor.set(e),this.m_cache={}}set ghostExtrudedPolygons(e){this.m_ghostExtrudedPolygons=e}clear(e,t,r){this.m_renderer.clear(e,t,r)}getPixelRatio(){return this.m_renderer.getPixelRatio()}setPixelRatio(e){this.m_renderer.setPixelRatio(e)}getSize(e){return this.m_renderer.getSize(e)}setSize(e,t,r){this.m_renderer.setSize(e,t,r)}setViewport(e,t,r,i){this.m_renderer.setViewport(e,t,r,i)}setScissor(e,t,r,i){this.m_renderer.setScissor(e,t,r,i)}setScissorTest(e){this.m_renderer.setScissorTest(e)}setRenderTarget(e){this.m_renderer.setRenderTarget(e)}render(e,t){if(this.m_ghostExtrudedPolygons){if(!this.enabled)return void this.m_renderer.render(e,t);const r=this.m_renderer.autoClear;this.m_renderer.autoClear=this.autoClear,this.m_renderer.render(e,t),this.m_renderer.autoClear=r}this.renderOutline(e,t)}renderOutline(e,t){const r=this.m_renderer.autoClear,i=e.autoUpdate,n=e.background,o=this.m_renderer.shadowMap.enabled;e.autoUpdate=!1,e.background=null,this.m_renderer.autoClear=!1,this.m_renderer.shadowMap.enabled=!1,e.traverse(this.setOutlineMaterial.bind(this)),this.m_renderer.render(e,t),e.traverse(this.restoreOriginalMaterial.bind(this)),this.cleanupCache(),e.autoUpdate=i,e.background=n,this.m_renderer.autoClear=r,this.m_renderer.shadowMap.enabled=o}createInvisibleMaterial(){return new n.ShaderMaterial({name:"invisible",visible:!1})}createMaterial(e){const t=this.m_shaderIDs[e.type];let r,i;if(void 0!==t){const e=n.ShaderLib[t];r=e.uniforms,i=e.vertexShader}else if(!0===e.isRawShaderMaterial){if(r=e.uniforms,i=e.vertexShader,!/attribute\s+vec3\s+position\s*;/.test(i)||!/attribute\s+vec3\s+normal\s*;/.test(i))return this.createInvisibleMaterial()}else{if(!0!==e.isShaderMaterial)return this.createInvisibleMaterial();r=e.uniforms,i=e.vertexShader}const c=Object.assign(Object.assign({},r),this.m_uniformsChunk),l=i.replace(/void\s+main\s*\(\s*\)/,o+"\nvoid main()").replace(/\}\s*$/,a+"\n}").replace(/#include\s+<[\w_]*light[\w_]*>/g,""),u={};return/vec3\s+transformed\s*=/.test(i)||/#include\s+<begin_vertex>/.test(i)||(u.DECLARE_TRANSFORMED=!0),new n.ShaderMaterial({defines:u,uniforms:c,vertexShader:l,fragmentShader:s,side:n.BackSide,skinning:!1,morphTargets:!1,morphNormals:!1,fog:!1})}getOutlineMaterialFromCache(e){let t=this.m_cache[e.uuid];return void 0===t&&(t={material:this.createMaterial(e),used:!0,keepAlive:this.m_defaultKeepAlive,count:0},this.m_cache[e.uuid]=t),t.used=!0,t.material}getOutlineMaterial(e){const t=this.getOutlineMaterialFromCache(e);return this.m_originalMaterials[t.uuid]=e,this.updateOutlineMaterial(t,e),t}setOutlineMaterial(e){if(void 0!==e.material){if(Array.isArray(e.material))for(let t=0,r=e.material.length;t<r;t++)e.material[t]=this.getOutlineMaterial(e.material[t]);else e.material=this.getOutlineMaterial(e.material);this.m_originalOnBeforeRenders[e.uuid]=e.onBeforeRender,e.onBeforeRender=i.chainCallbacks(e.onBeforeRender,this.onBeforeRender.bind(this))}}restoreOriginalMaterial(e){if(void 0!==e.material){if(Array.isArray(e.material))for(let t=0,r=e.material.length;t<r;t++)e.material[t]=this.m_originalMaterials[e.material[t].uuid];else e.material=this.m_originalMaterials[e.material.uuid];e.onBeforeRender=this.m_originalOnBeforeRenders[e.uuid]}}onBeforeRender(e,t,r,i,n,o){const a=this.m_originalMaterials[n.uuid];void 0!==a&&this.updateUniforms(n,a)}updateUniforms(e,t){const r=t.userData.outlineParameters;e.uniforms.outlineAlpha.value=t.opacity,void 0!==r&&(void 0!==r.thickness&&(e.uniforms.outlineThickness.value=r.thickness),void 0!==r.color&&e.uniforms.outlineColor.value.fromArray(r.color),void 0!==r.alpha&&(e.uniforms.outlineAlpha.value=r.alpha))}updateOutlineMaterial(e,t){if("invisible"===e.name)return;const r=t.userData.outlineParameters;e.skinning=t.skinning,e.morphTargets=t.morphTargets,e.morphNormals=t.morphNormals,e.fog=t.fog,void 0!==r?(e.visible=!1!==t.visible&&(void 0===r.visible||r.visible),e.transparent=void 0!==r.alpha&&r.alpha<1||t.transparent,void 0!==r.keepAlive&&(this.m_cache[t.uuid].keepAlive=r.keepAlive)):(e.transparent=t.transparent,e.visible=t.visible),!0!==t.wireframe&&!1!==t.depthTest||(e.visible=!1)}cleanupCache(){let e;for(let t=0,r=(e=Object.keys(this.m_originalMaterials)).length;t<r;t++)this.m_originalMaterials[e[t]]=void 0;for(let t=0,r=(e=Object.keys(this.m_originalOnBeforeRenders)).length;t<r;t++)this.m_originalOnBeforeRenders[e[t]]=void 0;e=Object.keys(this.m_cache);for(const t of e)!1===this.m_cache[t].used?(this.m_cache[t].count++,!1===this.m_cache[t].keepAlive&&this.m_cache[t].count>this.m_removeThresholdCount&&delete this.m_cache[t]):(this.m_cache[t].used=!1,this.m_cache[t].count=0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(9),n=r(0),o=r(49),a=new n.Vector2(1,0),s=new n.Vector2(0,1);class c extends o.Pass{constructor(e,t,r,o){super(),this.resolution=new n.Vector2(256,256),this.m_renderTargetsHorizontal=[],this.m_renderTargetsVertical=[],this.m_nMips=5,this.m_separableBlurMaterials=[],this.m_camera=new n.OrthographicCamera(-1,1,1,-1,0,1),this.m_scene=new n.Scene,this.m_basic=new n.MeshBasicMaterial,this.m_quad=new n.Mesh(new n.PlaneBufferGeometry(2,2)),this.m_bloomTintColors=[new n.Vector3(1,1,1),new n.Vector3(1,1,1),new n.Vector3(1,1,1),new n.Vector3(1,1,1),new n.Vector3(1,1,1)],this.strength=t,this.radius=r,this.threshold=o,this.resolution=e,this.m_quad.frustumCulled=!1,this.m_scene.add(this.m_quad);const a={minFilter:n.LinearFilter,magFilter:n.LinearFilter,format:n.RGBAFormat};let s=Math.round(this.resolution.x/2),c=Math.round(this.resolution.y/2);this.m_renderTargetBright=new n.WebGLRenderTarget(s,c,a),this.m_renderTargetBright.texture.name="UnrealBloomPass.bright",this.m_renderTargetBright.texture.generateMipmaps=!1;for(let e=0;e<this.m_nMips;e++){const t=new n.WebGLRenderTarget(s,c,a);t.texture.name="UnrealBloomPass.h"+e,t.texture.generateMipmaps=!1,this.m_renderTargetsHorizontal.push(t);const r=new n.WebGLRenderTarget(s,c,a);r.texture.name="UnrealBloomPass.v"+e,r.texture.generateMipmaps=!1,this.m_renderTargetsVertical.push(r),s=Math.round(s/2),c=Math.round(c/2)}this.m_highPassUniforms=n.UniformsUtils.clone(i.LuminosityHighPassShader.uniforms),this.m_highPassUniforms.luminosityThreshold.value=o,this.m_highPassUniforms.smoothWidth.value=.01,this.m_materialHighPassFilter=new n.ShaderMaterial({uniforms:this.m_highPassUniforms,vertexShader:i.LuminosityHighPassShader.vertexShader,fragmentShader:i.LuminosityHighPassShader.fragmentShader,defines:{}});const l=[3,5,7,9,11];s=Math.round(this.resolution.x/2),c=Math.round(this.resolution.y/2);for(let e=0;e<this.m_nMips;e++)this.m_separableBlurMaterials.push(this.getSeperableBlurMaterial(l[e])),this.m_separableBlurMaterials[e].uniforms.texSize.value=new n.Vector2(s,c),s=Math.round(s/2),c=Math.round(c/2);this.m_compositeMaterial=this.getCompositeMaterial(this.m_nMips),this.m_compositeMaterial.uniforms.blurTexture1.value=this.m_renderTargetsVertical[0].texture,this.m_compositeMaterial.uniforms.blurTexture2.value=this.m_renderTargetsVertical[1].texture,this.m_compositeMaterial.uniforms.blurTexture3.value=this.m_renderTargetsVertical[2].texture,this.m_compositeMaterial.uniforms.blurTexture4.value=this.m_renderTargetsVertical[3].texture,this.m_compositeMaterial.uniforms.blurTexture5.value=this.m_renderTargetsVertical[4].texture,this.m_compositeMaterial.uniforms.bloomStrength.value=t,this.m_compositeMaterial.uniforms.bloomRadius.value=.1,this.m_compositeMaterial.needsUpdate=!0;this.m_compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.m_compositeMaterial.uniforms.bloomTintColors.value=this.m_bloomTintColors,this.m_copyUniforms=n.UniformsUtils.clone(i.CopyShader.uniforms),this.m_copyUniforms.opacity.value=1,this.m_materialCopy=new n.ShaderMaterial({uniforms:this.m_copyUniforms,vertexShader:i.CopyShader.vertexShader,fragmentShader:i.CopyShader.fragmentShader,blending:n.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0})}dispose(){for(const e of this.m_renderTargetsHorizontal)e.dispose();for(const e of this.m_renderTargetsVertical)e.dispose();this.m_renderTargetBright.dispose()}setSize(e,t){let r=Math.round(e/2),i=Math.round(t/2);this.m_renderTargetBright.setSize(r,i);for(let e=0;e<this.m_nMips;e++)this.m_renderTargetsHorizontal[e].setSize(r,i),this.m_renderTargetsVertical[e].setSize(r,i),this.m_separableBlurMaterials[e].uniforms.texSize.value=new n.Vector2(r,i),r=Math.round(r/2),i=Math.round(i/2)}render(e,t,r,i,n){this.renderToScreen&&(this.m_quad.material=this.m_basic,this.m_basic.map=n.texture,e.setRenderTarget(null),e.clear(),e.render(this.m_scene,this.m_camera)),this.m_highPassUniforms.tDiffuse.value=n.texture,this.m_highPassUniforms.luminosityThreshold.value=this.threshold,this.m_quad.material=this.m_materialHighPassFilter,e.setRenderTarget(this.m_renderTargetBright),e.clear(),e.render(this.m_scene,this.m_camera);let o=this.m_renderTargetBright;for(let t=0;t<this.m_nMips;t++)this.m_quad.material=this.m_separableBlurMaterials[t],this.m_separableBlurMaterials[t].uniforms.colorTexture.value=o.texture,this.m_separableBlurMaterials[t].uniforms.direction.value=a,e.setRenderTarget(this.m_renderTargetsHorizontal[t]),e.clear(),e.render(this.m_scene,this.m_camera),this.m_separableBlurMaterials[t].uniforms.colorTexture.value=this.m_renderTargetsHorizontal[t].texture,this.m_separableBlurMaterials[t].uniforms.direction.value=s,e.setRenderTarget(this.m_renderTargetsVertical[t]),e.clear(),e.render(this.m_scene,this.m_camera),o=this.m_renderTargetsVertical[t];this.m_quad.material=this.m_compositeMaterial,this.m_compositeMaterial.uniforms.bloomStrength.value=this.strength,this.m_compositeMaterial.uniforms.bloomRadius.value=this.radius,this.m_compositeMaterial.uniforms.bloomTintColors.value=this.m_bloomTintColors,e.setRenderTarget(this.m_renderTargetsHorizontal[0]),e.clear(),e.render(this.m_scene,this.m_camera),this.m_quad.material=this.m_materialCopy,this.m_copyUniforms.tDiffuse.value=this.m_renderTargetsHorizontal[0].texture,this.renderToScreen?(e.setRenderTarget(null),e.render(this.m_scene,this.m_camera)):(e.setRenderTarget(n),e.render(this.m_scene,this.m_camera))}getSeperableBlurMaterial(e){return new n.ShaderMaterial({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new n.Vector2(.5,.5)},direction:{value:new n.Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;\n            void main() {\n                vUv = uv;\n                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n            }",fragmentShader:"#include <common>\n            varying vec2 vUv;\n            uniform sampler2D colorTexture;\n            uniform vec2 texSize;\n            uniform vec2 direction;\n\n            float gaussianPdf(in float x, in float sigma) {\n                return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n            }\n            void main() {\n                vec2 invSize = 1.0 / texSize;\n                float fSigma = float(SIGMA);\n                float weightSum = gaussianPdf(0.0, fSigma);\n                vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\n                for( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n                    float x = float(i);\n                    float w = gaussianPdf(x, fSigma);\n                    vec2 uvOffset = direction * invSize * x;\n                    vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\n                    vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\n                    diffuseSum += (sample1 + sample2) * w;\n                    weightSum += 2.0 * w;\n                }\n                gl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n            }"})}getCompositeMaterial(e){return new n.ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n                void main() {\n                    vUv = uv;\n                    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n                }",fragmentShader:"varying vec2 vUv;\n                uniform sampler2D blurTexture1;\n                uniform sampler2D blurTexture2;\n                uniform sampler2D blurTexture3;\n                uniform sampler2D blurTexture4;\n                uniform sampler2D blurTexture5;\n                uniform sampler2D dirtTexture;\n                uniform float bloomStrength;\n                uniform float bloomRadius;\n                uniform float bloomFactors[NUM_MIPS];\n                uniform vec3 bloomTintColors[NUM_MIPS];\n\n                float lerpBloomFactor(const in float factor) {\n                    float mirrorFactor = 1.2 - factor;\n                    return mix(factor, mirrorFactor, bloomRadius);\n                }\n\n                void main() {\n                    gl_FragColor = bloomStrength * (\nlerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\nlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\nlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\nlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\nlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n                }"})}}t.BloomPass=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerBootstrapRequest=function(e){return e&&"worker-bootstrap-request"===e.type&&Array.isArray(e.dependencies)},t.isWorkerBootstrapResponse=function(e){return e&&"worker-bootstrap-response"===e.type&&Array.isArray(e.resolvedDependencies)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(4),n=r(1),o=r(0),a=r(165),s=r(368),c=r(20);class l{constructor(e,t,r=0,i=0,n=0){this.tileKey=e,this.area=t,this.offset=r,this.minElevation=i,this.maxElevation=n}}function u(e,t,r){const i=e.getGeoBox(t),n=360*r;return i.northEast.longitude+=n,i.southWest.longitude+=n,i}t.TileKeyEntry=l;t.FrustumIntersection=class{constructor(e,t,r,i){this.m_camera=e,this.mapView=t,this.m_extendedFrustumCulling=r,this.m_tileWrappingEnabled=i,this.m_frustum=new o.Frustum,this.m_viewProjectionMatrix=new o.Matrix4,this.m_rootTileKeys=[],this.m_tileKeyEntries=new Map,this.m_mapTileCuller=new s.MapTileCuller(e)}get camera(){return this.m_camera}get projection(){return this.mapView.projection}updateFrustum(e){this.m_viewProjectionMatrix.multiplyMatrices(void 0!==e?e:this.m_camera.projectionMatrix,this.m_camera.matrixWorldInverse),this.m_frustum.setFromMatrix(this.m_viewProjectionMatrix),this.m_extendedFrustumCulling&&this.m_mapTileCuller.setup(),this.computeRequiredInitialRootTileKeys(this.m_camera.position)}compute(e,t,r,s,d){this.m_tileKeyEntries.clear();let h=!0;for(const e of this.m_rootTileKeys)this.m_tileKeyEntries.set(c.TileOffsetUtils.getKeyForTileKeyAndOffset(e.tileKey,e.offset),new l(e.tileKey,1/0,e.offset,e.minElevation,e.maxElevation));const m=void 0!==r&&r.getTilingScheme()===e,p=new o.Box3,f=[...this.m_rootTileKeys];for(;f.length>0;){const o=f.pop();if(void 0===o)continue;const g=o.tileKey;if(g.level>t)continue;if(!1===d.some((e,t)=>e.shouldSubdivide(s[t],g)))continue;const y=c.TileOffsetUtils.getKeyForTileKeyAndOffset(g,o.offset),v=this.m_tileKeyEntries.get(y);n.assert(void 0!==v),n.assert(v.area>0);for(const t of e.getSubTileKeys(g)){const s=o.offset,d=c.TileOffsetUtils.getKeyForTileKeyAndOffset(t,s);n.assert(void 0===this.m_tileKeyEntries.get(d));const g=u(e,t,s);if(m){const e=r.getElevationRange(t);g.southWest.altitude=e.minElevation,g.northEast.altitude=e.maxElevation,h=h&&e.calculationStatus===a.CalculationStatus.FinalPrecise}let y=0;if(this.mapView.projection.type===i.ProjectionType.Spherical){const e=new i.OrientedBox3;this.mapView.projection.projectBox(g,e),e.intersects(this.m_frustum)&&(y=1)}else this.mapView.projection.projectBox(g,p),y=this.computeSubTileArea(p);if(y>0){const e=new l(t,y,s,g.southWest.altitude,g.northEast.altitude);this.m_tileKeyEntries.set(d,e),f.push(e)}}}return{tileKeyEntries:this.m_tileKeyEntries,calculationFinal:h}}computeSubTileArea(e){if((!this.m_extendedFrustumCulling||this.m_mapTileCuller.frustumIntersectsTileBox(e))&&this.m_frustum.intersectsBox(e)){const t=[new o.Vector3(e.min.x,e.min.y,0).applyMatrix4(this.m_viewProjectionMatrix),new o.Vector3(e.max.x,e.min.y,0).applyMatrix4(this.m_viewProjectionMatrix),new o.Vector3(e.max.x,e.max.y,0).applyMatrix4(this.m_viewProjectionMatrix),new o.Vector3(e.min.x,e.max.y,0).applyMatrix4(this.m_viewProjectionMatrix)];t.push(t[0]);const r=t.length;let i=0;for(let e=r-1,n=0;n<r;e=n++)i+=t[e].x*t[n].y-t[n].x*t[e].y;return Math.abs(.5*i)}return 0}computeRequiredInitialRootTileKeys(e){this.m_rootTileKeys=[];const t=i.TileKey.fromRowColumnLevel(0,0,0);if(!(this.mapView.projection.type===i.ProjectionType.Planar)||!this.m_tileWrappingEnabled)return void this.m_rootTileKeys.push(new l(t,0,0,0));const r=this.mapView.projection.unprojectPoint(e),n=Math.round(r.longitude/360),a=this.m_camera,s=c.MapViewUtils.extractAttitude(this.mapView,a).pitch,u=a.aspect>1?a.aspect:1/a.aspect,d=o.Math.degToRad(a.fov*u/2)+s,h=Math.tan(d)*a.position.z-Math.tan(s)*a.position.z,m=new o.Vector3(e.x-h,e.y,e.z),p=this.mapView.projection.unprojectPoint(m),f=o.Math.clamp(Math.ceil(Math.abs((r.longitude-p.longitude)/360)*Math.SQRT2),0,7);for(let e=-f+n;e<=f+n;e++)this.m_rootTileKeys.push(new l(t,0,e,0,0))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);t.MapTileCuller=class{constructor(e){this.m_camera=e,this.m_globalFrustumMin=new i.Vector3,this.m_globalFrustumMax=new i.Vector3,this.m_frustumCorners=[new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3]}setup(){const e=this.getFrustumCorners(),t=this.m_camera.matrixWorld;this.m_globalFrustumMin.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this.m_globalFrustumMax.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(const r of e)r.applyMatrix4(t),this.m_globalFrustumMin.x=Math.min(this.m_globalFrustumMin.x,r.x),this.m_globalFrustumMin.y=Math.min(this.m_globalFrustumMin.y,r.y),this.m_globalFrustumMin.z=Math.min(this.m_globalFrustumMin.z,r.z),this.m_globalFrustumMax.x=Math.max(this.m_globalFrustumMax.x,r.x),this.m_globalFrustumMax.y=Math.max(this.m_globalFrustumMax.y,r.y),this.m_globalFrustumMax.z=Math.max(this.m_globalFrustumMax.z,r.z)}frustumIntersectsTileBox(e){const t=this.m_globalFrustumMin,r=this.m_globalFrustumMax;return!(r.x<e.min.x||r.y<e.min.y||r.z<e.min.z||t.x>e.max.x||t.y>e.max.y||t.z>e.max.z)}getFrustumCorners(){const e=this.m_frustumCorners,t=this.m_camera.projectionMatrixInverse;let r=0;function i(i,n,o){e[r++].set(i,n,o).applyMatrix4(t)}return i(-1,-1,-1),i(1,-1,-1),i(-1,1,-1),i(1,1,-1),i(-1,-1,1),i(1,-1,1),i(-1,1,1),i(1,1,1),e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2);function n(e,t){if(!("material"in e))return;const r=e.material;"displacementMap"in r&&(r.displacementMap=t)}const o=new(r(0).Vector3);function a(e,t,r){o.copy(e).add(r.center);const i=r.mapView.projection.unprojectPoint(o),n=t.getHeight(i);void 0!==n&&(i.altitude=n,r.mapView.projection.projectPoint(i,o),e.copy(o).sub(r.center))}function s(e,t,r){if(void 0!==e.path)for(const i of e.path)a(i,t,r);else a(e.position,t,r)}const c=60;t.overlayOnElevation=function(e){const t=e.mapView.elevationProvider;if(void 0===t||0===e.objects.length)return;const r=t.getDisplacementMap(e.tileKey);if(void 0===r||0===e.objects.length)return;const o=e.objects[0];if(!o.userData||!o.userData.kind||!o.userData.kind.find(e=>e!==i.GeometryKind.All&&e!==i.GeometryKind.Terrain))return;for(const t of e.objects)n(t,r.texture);if(!e.allGeometryLoaded)return;if(e.allTextElementsOverlaid)return;const a=Math.ceil(e.textElementGroups.count()/c),l=e.textElementGroups.sortedGroups;let{groupIndex:u,elementIndex:d}=e.nextTextElementToOverlay,h=0;for(;u<l.length;){const r=l[u];for(;h<a&&d<r.elements.length;)s(r.elements[d],t,e),d++,h++;if(!(d>=r.elements.length))break;++u,d=0}e.nextTextElementToOverlay={groupIndex:u,elementIndex:d},e.textElementsChanged=!0,e.mapView.update()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(371),o=r(166),a=[[i.GeometryKind.Background,i.GeometryKind.Terrain,i.GeometryKind.Area,i.GeometryKind.Border],[i.GeometryKind.Line],[i.GeometryKind.Building],[i.GeometryKind.Label],[i.GeometryKind.All]],s=new i.GeometryKindSet(a[0]);class c extends o.TileGeometryManagerBase{constructor(e){super(e),this.m_maxUpdatedTilePerFrame=5,this.m_loadPhaseDefinitions=a,this.m_basicGeometryKinds=s}initTile(e){e.dataSource.useGeometryLoader&&(e.tileGeometryLoader=new n.PhasedTileGeometryLoader(e,this.m_loadPhaseDefinitions,this.m_basicGeometryKinds))}updateTiles(e){let t=this.mapView.isDynamicFrame?this.updateSomeTiles(e):this.updateAllTilesTogether(e);if(this.m_tileUpdateCallback)for(const t of e)this.m_tileUpdateCallback(t);!(t=this.updateTileObjectVisibility(e)||t)&&this.checkTilesFinished(e)||this.mapView.update()}checkTilesFinished(e){for(const t of e){const e=t.tileGeometryLoader;if(void 0!==e&&!e.allGeometryLoaded)return!1}return!0}updateSomeTiles(e){let t=0;for(const r of e){const e=r.tileGeometryLoader;if(void 0!==e&&e.update(this.enableFilterByKind?this.enabledGeometryKinds:void 0,this.enableFilterByKind?this.disabledGeometryKinds:void 0)&&(t++,this.m_maxUpdatedTilePerFrame>0&&t>=this.m_maxUpdatedTilePerFrame))break}return t>0}updateAllTilesTogether(e){let t,r=!1;for(const r of e){const e=r.tileGeometryLoader;void 0!==e&&(void 0===t||e.currentPhase<t)&&(t=e.currentPhase)}if(void 0!==t&&t<this.m_loadPhaseDefinitions.length){const i=t+1;r=this.updateTilesIfNeeded(e,i)}return r}updateTilesIfNeeded(e,t){let r=!1;for(const i of e){const e=i.tileGeometryLoader;void 0!==e&&e.updateToPhase(t,this.enableFilterByKind?this.enabledGeometryKinds:void 0,this.enableFilterByKind?this.disabledGeometryKinds:void 0)&&(r=!0)}return r}}t.PhasedTileGeometryManager=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(1),o=r(48),a=r(63),s=r(94);t.PhasedTileGeometryLoader=class{constructor(e,t,r){this.m_tile=e,this.m_loadPhaseDefinitions=t,this.m_basicGeometryKinds=r,this.m_isFinished=!1,this.m_geometryKindsLoaded=new i.GeometryKindSet,this.m_currentPhaseIndex=0}get tile(){return this.m_tile}get currentPhase(){return this.m_currentPhaseIndex}get numberOfPhases(){return this.m_loadPhaseDefinitions.length}get geometryKindsCreated(){return this.m_geometryKindsLoaded}get availableGeometryKinds(){return this.m_availableGeometryKinds}get basicGeometryLoaded(){for(const e of this.m_basicGeometryKinds)if(!this.m_geometryKindsLoaded.has(e))return!1;return!0}get allGeometryLoaded(){return this.currentPhase>=this.m_loadPhaseDefinitions.length}setDecodedTile(e){return this.m_decodedTile=e,this.m_currentPhaseIndex=0,this.m_geometryKindsLoaded.clear(),void 0!==this.m_decodedTile&&(this.m_availableGeometryKinds=s.TileGeometryLoader.prepareDecodedTile(this.m_decodedTile)),this.m_decodedTile}updateCompletely(e,t){return this.update(e,t,!0)}updateToPhase(e,t,r){let i=!1;for(e=Math.min(e,this.numberOfPhases);this.currentPhase<e&&this.update(t,r);)i=!0;return i}update(e,t,r=!1){const i=this.tile,s=this.m_loadPhaseDefinitions;if(!i.dataSource.cacheable)return this.m_currentPhaseIndex=s.length,!1;let c=this.m_decodedTile;const l=this.currentPhase;if(void 0===c&&void 0!==i.decodedTile&&(c=this.setDecodedTile(i.decodedTile),a.TileGeometryCreator.instance.processTechniques(c,e,t),i.clear()),void 0===c||l>=this.numberOfPhases)return!1;const u=a.TileGeometryCreator.instance,d=o.PerformanceStatistics.instance;let h=0;if(d.enabled&&(h=n.PerformanceTimer.now()),r)u.createAllGeometries(i,c),this.m_currentPhaseIndex=s.length;else{const e=s[l];for(const t of e)this.createKind(u,t)}if(d.enabled&&d.currentFrame.addValue("geometry.geometryCreationTime",n.PerformanceTimer.now()-h),void 0===this.nextPhase()){if(d.enabled){const e=d.currentFrame;e.addValue("geometryCount.numGeometries",c.geometries.length),e.addValue("geometryCount.numTechniques",c.techniques.length),e.addValue("geometryCount.numPoiGeometries",void 0!==c.poiGeometries?c.poiGeometries.length:0),e.addValue("geometryCount.numTextGeometries",void 0!==c.textGeometries?c.textGeometries.length:0),e.addValue("geometryCount.numTextPathGeometries",void 0!==c.textPathGeometries?c.textPathGeometries.length:0),e.addValue("geometryCount.numPathGeometries",void 0!==c.pathGeometries?c.pathGeometries.length:0),e.addMessage(`Decoded tile: ${i.dataSource.name} # lvl=${i.tileKey.level} `+`col=${i.tileKey.column} row=${i.tileKey.row}`)}this.finish()}return!0}get isFinished(){return this.m_isFinished}dispose(){this.m_decodedTile=void 0}reset(){this.m_decodedTile=void 0,this.m_isFinished=!1,this.m_availableGeometryKinds=void 0,this.m_geometryKindsLoaded.clear(),this.m_currentPhaseIndex=0}nextPhase(){return this.m_currentPhaseIndex<this.m_loadPhaseDefinitions.length&&this.m_currentPhaseIndex++,this.m_currentPhaseIndex<this.m_loadPhaseDefinitions.length?this.m_currentPhaseIndex:void 0}createKind(e,t){if(this.m_geometryKindsLoaded.has(t))return;this.m_geometryKindsLoaded.add(t);const r=this.tile,n=this.m_decodedTile;if(void 0!==n){const o=e=>{if(!1===e.enabled)return!1;const r=e.kind;if(t===i.GeometryKind.All)return!0;if(r instanceof Set){return r.has(t)}return r===t};e.createObjects(r,n,o);const a=e=>!!(i.isPoiTechnique(e)||i.isLineMarkerTechnique(e)||i.isTextTechnique(e))&&o(e);e.createTextElements(r,n,a),e.preparePois(r,n)}}finish(){this.m_decodedTile=void 0,this.m_tile.loadingFinished(),this.m_tile.removeDecodedTile(),this.m_isFinished=!0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=r(155),o=r(173),a=i.LoggerManager.instance.create("ScreenCollissions");class s{constructor(){this.screenBounds=new i.Math2D.Box,this.rtree=new o}static toBox2D(e,t){t.x=e.min.x,t.y=e.min.y,t.w=e.max.x-e.min.x,t.h=e.max.y-e.min.y}reset(){this.rtree.clear()}update(e,t){this.screenBounds.set(e/-2,t/-2,e,t),this.reset()}allocate(e){const t={minX:e.x,minY:e.y,maxX:e.x+e.w,maxY:e.y+e.h,type:"box"};this.rtree.insert(t)}allocateIBoxes(e){this.rtree.load(e)}isAllocated(e){const t=e instanceof i.Math2D.Box?this.toCollisionBox(e):e,r=this.rtree.search(t);for(const e of r)switch(e.type){case"box":return!0;case"line":{const r=e;if(this.intersectsLine(t,r))return!0}}return!1}isVisible(e){return this.screenBounds.intersects(e)}intersectsLine(e,t){const r=t.line,i=r.end.x-r.start.x;let n,o,a,s;if(0!==i){const t=r.end.y-r.start.y,c=t,l=-i,u=r.start.y-t/i*r.start.x;n=Math.sign(e.minX*c+(e.minY-u)*l),o=Math.sign(e.maxX*c+(e.minY-u)*l),a=Math.sign(e.minX*c+(e.maxY-u)*l),s=Math.sign(e.maxX*c+(e.maxY-u)*l)}else n=Math.sign(e.minX-r.start.x),o=Math.sign(e.maxX-r.start.x),a=Math.sign(e.minX-r.start.x),s=Math.sign(e.maxX-r.start.x);return n!==o||n!==a||n!==s}toCollisionBox(e){return{minX:e.x,minY:e.y,maxX:e.x+e.w,maxY:e.y+e.h,type:"box"}}}t.ScreenCollisions=s;t.ScreenCollisionsDebug=class extends s{constructor(e){super(),this.m_renderContext=null,this.m_renderingEnabled=!1,this.m_numAllocations=0,this.m_numSuccessfulTests=0,this.m_numFailedTests=0,this.m_numSuccessfulVisibilityTests=0,this.m_numFailedVisibilityTests=0,null!=e&&(this.m_renderContext=e.getContext("2d"))}reset(){super.reset(),this.m_numAllocations=0,this.m_numSuccessfulTests=0,this.m_numFailedTests=0,this.m_numSuccessfulVisibilityTests=0,this.m_numFailedVisibilityTests=0}update(e,t){this.m_renderingEnabled&&a.log(`Allocations: ${this.m_numAllocations} Successful Tests: ${this.m_numSuccessfulTests} Failed Tests: ${this.m_numFailedTests}  Successful Visibility Tests: ${this.m_numSuccessfulVisibilityTests}  Failed Visibility Tests: ${this.m_numFailedVisibilityTests} `),super.update(e,t),null!==this.m_renderContext&&(this.m_renderContext.canvas.width=e,this.m_renderContext.canvas.height=t),this.m_renderingEnabled=n.debugContext.getValue("DEBUG_SCREEN_COLLISIONS")}allocate(e){super.allocate(e),this.m_numAllocations++,this.m_renderingEnabled&&null!==this.m_renderContext&&(this.m_renderContext.strokeStyle="#6666ff",this.m_renderContext.strokeRect(e.x-this.screenBounds.x,this.screenBounds.y+this.screenBounds.h-e.y-1,e.w,-e.h))}allocateIBoxes(e){for(const t of e)this.m_numAllocations++,this.m_renderingEnabled&&null!==this.m_renderContext&&(this.m_renderContext.strokeStyle="#aa2222",this.m_renderContext.strokeRect(t.minX-this.screenBounds.x,this.screenBounds.y+this.screenBounds.h-t.minY-1,t.maxX-t.minX,-(t.maxY-t.minY)));super.allocateIBoxes(e)}isAllocated(e){const t=super.isAllocated(e);if(this.m_renderingEnabled&&null!==this.m_renderContext){const r=t?2:0;this.m_renderContext.strokeStyle=t?"#FF0000":"#00ff00",this.m_renderContext.strokeRect(e.x-this.screenBounds.x-r,this.screenBounds.y+this.screenBounds.h-e.y-1+r,e.w+2*r,-e.h-2*r)}return t?this.m_numFailedTests++:this.m_numSuccessfulTests++,t}isVisible(e){const t=super.isVisible(e);return t?this.m_numSuccessfulVisibilityTests++:this.m_numFailedVisibilityTests++,t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);class n{constructor(e){this.m_camera=e,this.m_width=0,this.m_height=0}get width(){return this.m_width}get height(){return this.m_height}project(e,t=new i.Vector2){const r=this.projectVector(e,n.tempV3);if(r.z>-1&&r.z<1)return t.set(r.x*this.m_width/2,r.y*this.m_height/2),t}project3(e,t=new i.Vector3){const r=this.projectVector(e,n.tempV3);if(r.z>-1&&r.z<1)return t.set(r.x*this.m_width/2,r.y*this.m_height/2,r.z),t}projectVector(e,t){return t.set(e.x,e.y,e.z).project(this.m_camera),t}onScreen(e){const t=this.projectVector(e,n.tempV3);return t.z>-1&&t.z<1&&(t.x>=-1&&t.x<=1&&t.y>=-1&&t.y<=1)}update(e,t,r){this.m_camera=e,this.m_width=t,this.m_height=r}}t.ScreenProjector=n,n.tempV2=new i.Vector2,n.tempV3=new i.Vector3},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(174),n=r(375);t.SkyBackground=class{constructor(e,t,r){switch(this.m_sky=e,this.m_projectionType=t,this.m_sky.type){case"gradient":this.m_skyTexture=new n.SkyGradientTexture(this.m_sky,this.m_projectionType),this.updateCamera(r);break;case"cubemap":this.m_skyTexture=new i.SkyCubemapTexture(this.m_sky)}}dispose(){this.m_skyTexture.dispose()}get texture(){return this.m_skyTexture.texture}updateCamera(e){"gradient"===this.m_sky.type&&this.m_skyTexture.update(e)}updateTexture(e,t){const r=this.m_sky.type===e.type&&this.m_projectionType===t;switch(e.type){case"gradient":r?this.m_skyTexture.updateTexture(e):this.m_skyTexture=new n.SkyGradientTexture(e,t);break;case"cubemap":r?this.m_skyTexture.updateTexture(e):this.m_skyTexture=new i.SkyCubemapTexture(e)}this.m_projectionType=t,this.m_sky=e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(4),n=r(1),o=r(0);t.DEFAULT_TEXTURE_SIZE=512,t.DEFAULT_MONOMIAL_POWER=1;const a=[new o.Vector3(1,0,0),new o.Vector3(-1,0,0),new o.Vector3(0,-1,0),new o.Vector3(0,1,0),new o.Vector3(0,0,1),new o.Vector3(0,0,-1)],s=[new o.Vector3(0,0,-1),new o.Vector3(0,0,1),new o.Vector3(1,0,0),new o.Vector3(1,0,0),new o.Vector3(1,0,0),new o.Vector3(-1,0,0)],c=[new o.Vector3(0,1,0),new o.Vector3(0,1,0),new o.Vector3(0,0,1),new o.Vector3(0,0,-1),new o.Vector3(0,1,0),new o.Vector3(0,1,0)];t.SkyGradientTexture=class{constructor(e,r,n=t.DEFAULT_TEXTURE_SIZE){this.m_projectionType=r,this.m_height=n;const a=new o.Color(e.topColor),s=new o.Color(e.bottomColor),c=new o.Color(e.groundColor);this.m_width=this.m_projectionType===i.ProjectionType.Planar?1:this.m_height,this.m_faceCount=this.m_projectionType===i.ProjectionType.Planar?1:6,this.m_faces=[];for(let t=0;t<this.m_faceCount;++t){const r=new Uint8Array(3*this.m_width*this.m_height);this.fillTextureData(r,t,a,s,c,e.monomialPower);const i=new o.DataTexture(r,this.m_width,this.m_height,o.RGBFormat);i.needsUpdate=!0,i.unpackAlignment=1,this.m_faces.push(i)}this.m_projectionType===i.ProjectionType.Spherical?(this.m_skybox=new o.CubeTexture(this.m_faces),this.m_skybox.needsUpdate=!0):(this.m_farClipPlaneDividedVertically=new o.Line3,this.m_groundPlane=new o.Plane(new o.Vector3(0,0,1)),this.m_bottomMidFarPoint=new o.Vector3,this.m_topMidFarPoint=new o.Vector3,this.m_horizonPosition=new o.Vector3,this.m_farClipPlaneCorners=[new o.Vector3,new o.Vector3,new o.Vector3,new o.Vector3])}dispose(){for(let e=0;e<this.m_faceCount;++e)this.m_faces[e].dispose();this.m_projectionType===i.ProjectionType.Spherical&&this.m_skybox.dispose()}get texture(){return this.m_projectionType===i.ProjectionType.Planar?this.m_faces[0]:this.m_skybox}update(e){this.m_projectionType===i.ProjectionType.Planar&&(this.setHorizonPosition(e),this.updateTexturePosition())}updateTexture(e){for(let t=0;t<this.m_faceCount;++t)this.fillTextureData(this.m_faces[t].image.data,t,new o.Color(e.topColor),new o.Color(e.bottomColor),new o.Color(e.groundColor),e.monomialPower),this.m_faces[t].needsUpdate=!0;this.m_projectionType===i.ProjectionType.Spherical&&(this.m_skybox.needsUpdate=!0)}fillTextureData(e,r,l,u,d,h){const m=new o.Color,p=new o.Vector3,f=new o.Vector3,g=new o.Vector3,y=new o.Vector3(0,0,1);for(let o=0;o<this.m_height;++o)for(let v=0;v<this.m_width;++v){if(this.m_projectionType===i.ProjectionType.Spherical){const e=f.copy(s[r]).multiplyScalar((v+.5)/this.m_width*2-1),i=g.copy(c[r]).multiplyScalar((o+.5)/this.m_height*2-1);p.copy(a[r]).add(e).add(i).normalize();const _=Math.max(y.dot(p),0);m.copy(d).lerp(u,Math.min(100*_,1)).lerp(l,_**n.getOptionValue(h,t.DEFAULT_MONOMIAL_POWER)).multiplyScalar(255)}else{const e=o/this.m_height;0===o?m.copy(d).multiplyScalar(255):m.copy(u).lerp(l,e**n.getOptionValue(h,t.DEFAULT_MONOMIAL_POWER)).multiplyScalar(255)}e[o*this.m_width*3+3*v]=m.r,e[o*this.m_width*3+3*v+1]=m.g,e[o*this.m_width*3+3*v+2]=m.b}}setHorizonPosition(e){this.m_farClipPlaneCorners[0].set(-1,-1,1).unproject(e),this.m_farClipPlaneCorners[1].set(1,-1,1).unproject(e),this.m_farClipPlaneCorners[2].set(-1,1,1).unproject(e),this.m_farClipPlaneCorners[3].set(1,1,1).unproject(e),this.m_bottomMidFarPoint.copy(this.m_farClipPlaneCorners[0]).add(this.m_farClipPlaneCorners[1]).multiplyScalar(.5),this.m_topMidFarPoint.copy(this.m_farClipPlaneCorners[2]).add(this.m_farClipPlaneCorners[3]).multiplyScalar(.5),this.m_farClipPlaneDividedVertically.set(this.m_bottomMidFarPoint,this.m_topMidFarPoint),this.m_groundPlane.intersectLine(this.m_farClipPlaneDividedVertically,this.m_horizonPosition)||this.m_horizonPosition.set(0,0,0)}updateTexturePosition(){const e=this.m_bottomMidFarPoint.distanceTo(this.m_horizonPosition)/this.m_farClipPlaneDividedVertically.distance(),t=0===this.m_horizonPosition.length()?1:e-2/this.m_height;this.m_faces[0].offset.set(0,this.m_bottomMidFarPoint.z<=0?-t:e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=r(62),o=r(96);class a{constructor(e,t){if(this.m_defaults=new Map,this.m_mapViews=[],this.update=()=>{const e=this.m_mapViews.map(e=>e.copyrightInfo).reduce(o.CopyrightInfo.mergeArrays,this.staticInfo||[]);if(0===e.length)return void(this.m_element.style.display="none");if(this.m_element.style.display="block",0!==this.m_defaults.size)for(const t of e){const e=this.m_defaults.get(t.id);void 0!==e&&(t.year=i.getOptionValue(t.year,e.year),t.label=i.getOptionValue(t.label,e.label),t.link=i.getOptionValue(t.link,e.link))}const t=o.CopyrightInfo.mergeArrays(e);this.m_element.innerHTML=o.CopyrightInfo.formatAsHtml(t)},"string"==typeof e){const t=document.getElementById(e);if(!t)throw new Error(`CopyrightElementHandler: unable to find DOM element #${e}`);this.m_element=t}else this.m_element=e;void 0!==t&&this.attach(t)}static install(e,t){return new a(e,t)}destroy(){for(const e of this.m_mapViews)e.removeEventListener(n.MapViewEventNames.CopyrightChanged,this.update)}attach(e){return this.m_mapViews.push(e),e.addEventListener(n.MapViewEventNames.CopyrightChanged,this.update),this.update(),this}detach(e){return e.removeEventListener(n.MapViewEventNames.CopyrightChanged,this.update),this.m_mapViews=this.m_mapViews.filter(t=>t!==e),this.update(),this}setDefaults(e){if(this.m_defaults.clear(),void 0!==e)for(const t of e)this.m_defaults.set(t.id,t);return this}setStaticCopyightInfo(e){return this.staticInfo=e,this}}t.CopyrightElementHandler=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(180),n=r(179);class o extends n.CopyrightCoverageProvider{constructor(e,t){super(),this.m_fetchURL=e,this.m_baseScheme=t}getCopyrightCoverageData(){return void 0!==this.m_cachedCopyrightResponse?this.m_cachedCopyrightResponse:(this.m_cachedCopyrightResponse=(new i.TransferManager).downloadJson(this.m_fetchURL).then(e=>e[this.m_baseScheme]).catch(e=>(this.logger.error(e),[])),this.m_cachedCopyrightResponse)}}t.UrlCopyrightProvider=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(68);class i{constructor(e){this.executor=e,this.doExec=!1,this.promise=new Promise((e,t)=>{this.resolveFunc=e,this.rejectFunc=t,this.doExec&&this.execInnerPromise(this.resolveFunc,this.rejectFunc)})}exec(){void 0!==this.resolveFunc&&void 0!==this.rejectFunc?this.execInnerPromise(this.resolveFunc,this.rejectFunc):this.doExec=!0}execInnerPromise(e,t){this.executor().then(t=>e(t)).catch(e=>t(e))}}class n{constructor(e=fetch,t=5){this.fetchFunction=e,this.maxRetries=t,this.activeDownloadCount=0,this.downloadQueue=new Array,this.activeDownloads=new Map}static instance(){return n.defaultInstance}static async fetchRepeatedly(e,t,r,i,o){try{const n=await e(i,o);if(503!==n.status||t>r)return n}catch(e){if(e.hasOwnProperty("isCancelled")||e.hasOwnProperty("name")&&"AbortError"===e.name||t>r)throw e}return n.waitFor(n.retryTimeout*t).then(()=>n.fetchRepeatedly(e,r,t+1,i,o))}static waitFor(e){return new Promise(t=>setTimeout(t,e))}downloadJson(e,t){return this.downloadAs(e=>e.json(),e,t)}downloadArrayBuffer(e,t){return this.download(e,t).then(e=>e.arrayBuffer())}download(e,t){if(this.activeDownloadCount>=n.maxParallelDownloads){const r=new i(()=>this.doDownload(e,t));return this.downloadQueue.push(r),r.promise}return this.doDownload(e,t)}doDownload(e,t){return++this.activeDownloadCount,n.fetchRepeatedly(this.fetchFunction,0,this.maxRetries,e,t).then(e=>(this.onDownloadDone(),e)).catch(e=>{throw this.onDownloadDone(),e})}onDownloadDone(){--this.activeDownloadCount,this.execDeferredDownload()}execDeferredDownload(){const e=this.downloadQueue.pop();void 0!==e&&e.exec()}downloadAs(e,t,r){const i=t,n=this.activeDownloads.get(i);if(void 0!==n)return Promise.resolve(n);const o=this.download(t,r).then(t=>{if(this.activeDownloads.delete(i),t.ok)return e(t);throw new Error(JSON.stringify(t))}).catch(e=>{throw this.activeDownloads.delete(i),e});return this.activeDownloads.set(i,o),o}}t.TransferManager=n,n.retryTimeout=500,n.maxParallelDownloads=16,n.defaultInstance=new n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.isLoading=function(e){return void 0!==e.loadingPromise}}(t.ImageItem||(t.ImageItem={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(1),o=r(181),a=n.LoggerManager.instance.create("TileDataAccessor");t.TileDataAccessor=class{constructor(e,t,r){this.tile=e,this.visitor=t,this.m_wantsPoints=!0,this.m_wantsLines=!0,this.m_wantsAreas=!0,this.m_wantsObject3D=!0;const i=!0===r.wantsAll;this.m_wantsPoints=i||!(!1===r.wantsPoints),this.m_wantsLines=i||!(!1===r.wantsLines),this.m_wantsAreas=i||!(!1===r.wantsAreas),this.m_wantsObject3D=i||!(!1===r.wantsObject3D)}visitAll(){const e=this.tile.objects;for(const t of e)this.visitObject(t)}visitObject(e){const t=void 0!==e.userData?e.userData.feature:void 0;if(void 0===t||void 0!==t.ids&&1===t.ids.length&&!this.visitor.wantsFeature(t.ids[0]))return;const r=t.geometryType;if(void 0===r)return void a.warn("#visitObject: visiting object failed, no geometryType",e);switch(n.assert(void 0!==t.ids,"featureData.ids missing"),n.assert(Array.isArray(t.ids),"featureData.ids is not an array"),n.assert(void 0!==t.starts,"featureData.starts missing"),n.assert(Array.isArray(t.starts),"featureData.starts is not an array"),void 0!==t.ids&&void 0!==t.starts&&n.assert(t.ids.length===t.starts.length,"featureData.ids and featureData.starts have unequal length"),r){case i.GeometryType.Point:case i.GeometryType.Text:if(!this.m_wantsPoints)return;break;case i.GeometryType.SolidLine:case i.GeometryType.ExtrudedLine:case i.GeometryType.TextPath:if(!this.m_wantsLines)return;break;case i.GeometryType.Polygon:case i.GeometryType.ExtrudedPolygon:if(!this.m_wantsAreas)return;break;case i.GeometryType.Object3D:if(!this.m_wantsObject3D)return;break;default:a.warn("#visitObject: invalid geometryType")}if("Mesh"!==e.type)return void a.warn("#visitObject: visiting object failed, not of type 'Mesh'",e);const o=e;this.visitMesh(o,t)}getBufferGeometry(e){const t=e.geometry;if("BufferGeometry"!==t.type)return void a.warn("#visitObject: object does not have BufferGeometry");const r=t;if(r.getAttribute("position"))return r;a.warn("#visitLines: BufferGeometry has no position attribute")}getGeometryAccessor(e,t,r){switch(e){case i.GeometryType.Point:case i.GeometryType.Text:return;case i.GeometryType.SolidLine:case i.GeometryType.ExtrudedLine:case i.GeometryType.TextPath:return new o.BufferedGeometryLineAccessor(t,e,r);case i.GeometryType.Polygon:case i.GeometryType.ExtrudedPolygon:return;case i.GeometryType.Object3D:return new o.BufferedGeometryObject3dAccessor(t,e,r);default:a.warn("#getGeometryAccessor: invalid geometryType")}}getIndexedGeometryAccessor(e,t,r){switch(e){case i.GeometryType.Point:case i.GeometryType.Text:return;case i.GeometryType.SolidLine:case i.GeometryType.ExtrudedLine:case i.GeometryType.TextPath:return new o.IndexedBufferedGeometryLineAccessor(t,e,r);case i.GeometryType.Polygon:case i.GeometryType.ExtrudedPolygon:case i.GeometryType.Object3D:return;default:a.warn("#getIndexedGeometryAccessor: invalid geometryType")}}visitMesh(e,t){const{ids:r,starts:s}=t,c=t.geometryType;if(void 0===r||void 0===s||void 0===c)return;let l;for(let t=0;t<r.length;t++){const u=r[t];if(!this.visitor.wantsFeature(u))continue;const d=s[t];let h=-1;if(void 0===l){const t=this.getBufferGeometry(e);if(void 0===t)continue;if(void 0===(l=null!==t.index?this.getIndexedGeometryAccessor(c,e,t):this.getGeometryAccessor(c,e,t))){a.warn("#visitObject: no accessor geometryType",c);continue}}switch(h=t<s.length-1?s[t+1]:l.getCount(),l.setRange(d,h),c){case i.GeometryType.Point:case i.GeometryType.Text:this.visitor.visitPoint(u);break;case i.GeometryType.SolidLine:case i.GeometryType.ExtrudedLine:case i.GeometryType.TextPath:n.assert(o.isLineAccessor(l)),this.visitor.visitLine(u,l);break;case i.GeometryType.Polygon:case i.GeometryType.ExtrudedPolygon:this.visitor.visitArea(u);break;case i.GeometryType.Object3D:n.assert(o.isObject3dAccessor(l)),this.visitor.visitObject3D(u,l);break;default:a.warn("#visitObject: invalid geometryType")}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(9),o=r(99);class a extends i.Points{constructor(e,t,r,o,a){void 0===t&&(t=new n.HighPrecisionPointMaterial({color:o||n.HighPrecisionPointMaterial.DEFAULT_COLOR,opacity:void 0!==a?a:1})),super(void 0===e?new i.BufferGeometry:e,t),this.matrixWorldInverse=new i.Matrix4,r&&this.setPositions(r)}get bufferGeometry(){return this.geometry}clearGeometry(){return this.geometry=new i.BufferGeometry}get shaderMaterial(){return this.material}setPositions(e){o.HighPrecisionUtils.setPositions(this,e)}setupForRendering(){this.material.isHighPrecisionPointsMaterial&&void 0!==this.dimensionality&&this.material.setDimensionality(this.dimensionality),this.onBeforeRender=(e,t,r,i,n,a)=>{o.HighPrecisionUtils.updateHpUniforms(this,r,this.shaderMaterial)}}updateMatrixWorld(e){const t=this.matrixWorldNeedsUpdate||e;super.updateMatrixWorld(e),t&&this.matrixWorldInverse.getInverse(this.matrixWorld)}}t.HighPrecisionPoints=a},function(e,t,r){"use strict";r.r(t),r.d(t,"changeLanguage",(function(){return n})),r.d(t,"cloneInstance",(function(){return o})),r.d(t,"createInstance",(function(){return a})),r.d(t,"dir",(function(){return s})),r.d(t,"exists",(function(){return c})),r.d(t,"getFixedT",(function(){return l})),r.d(t,"init",(function(){return u})),r.d(t,"loadLanguages",(function(){return d})),r.d(t,"loadNamespaces",(function(){return h})),r.d(t,"loadResources",(function(){return m})),r.d(t,"off",(function(){return p})),r.d(t,"on",(function(){return f})),r.d(t,"setDefaultNamespace",(function(){return g})),r.d(t,"t",(function(){return y})),r.d(t,"use",(function(){return v}));var i=r(3);t.default=i.a;var n=i.a.changeLanguage.bind(i.a),o=i.a.cloneInstance.bind(i.a),a=i.a.createInstance.bind(i.a),s=i.a.dir.bind(i.a),c=i.a.exists.bind(i.a),l=i.a.getFixedT.bind(i.a),u=i.a.init.bind(i.a),d=i.a.loadLanguages.bind(i.a),h=i.a.loadNamespaces.bind(i.a),m=i.a.loadResources.bind(i.a),p=i.a.off.bind(i.a),f=i.a.on.bind(i.a),g=i.a.setDefaultNamespace.bind(i.a),y=i.a.t.bind(i.a),v=i.a.use.bind(i.a)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(t.UserMessageType||(t.UserMessageType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLayersWithSchema=async function(e,t){const r=await e.getCatalogsBySchema(t);return void 0===r.results||void 0===r.results.items?[]:r.results.items.map(e=>(e.layers=e.layers.filter(e=>e.schema&&e.schema.hrn===t),e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(60),n=r(10),o=r(180),a=r(44),s=r(143);t.PartitionInfoStore=class{constructor(e){if(this.m_config=e,this.m_downloadManager=new o.TransferManager,void 0===this.m_config.serviceUrls.metadata)throw new Error("Metadata URL is not defined");this.m_metadataUrl=this.m_config.serviceUrls.metadata,this.m_requestBuilder=new s.DataStoreRequestBuilder(this.m_downloadManager,this.m_metadataUrl,this.m_config.getBearerToken),this.m_partitionStore=new Map}async getPartitionsData(e,t,r=!0){let i=[];const o=[],a=await this.getLayer();if("versioned"===a.layerType&&void 0===t&&(t=await this.getCatalogLatestVersion()),r?e.forEach(e=>{const r=this.m_partitionStore.get(`${e}:${t}`);void 0===r?i.push(e):o.push(r)}):i=e,!i.length)return o;const s=`/query/v1/catalogs/${this.m_config.hrn.data.resource}/layers/${this.m_config.layer}/partitions`,c=new n.UrlBuilder(this.m_metadataUrl+s);"versioned"===a.layerType&&c.appendQuery("version",t),i.forEach(e=>c.appendQuery("partition",e)),c.appendQuery("additionalFields",["dataSize","compressedDataSize","partitionType"]);return(await this.m_requestBuilder.request(c,{method:"GET",headers:{}})).partitions.forEach(e=>{this.m_partitionStore.set(`${e.partition}:${t}`,e),o.push(e)}),o}async getPartitionSize(e,t,r=!0){let i;const n=await this.getPartitionsData([e],t,r);return void 0!==n&&n.length?i=n.pop().dataSize:i}async getCatalogLatestVersion(){if(void 0!==this.m_catalogLatestVersion)return this.m_catalogLatestVersion;const e=new s.DataStoreRequestBuilder(this.m_downloadManager,this.m_metadataUrl+`/metadata/v1/catalogs/${this.m_config.hrn.data.resource}`,this.m_config.getBearerToken),t=await i.MetadataApi.latestVersion(e,{startVersion:0});return this.m_catalogLatestVersion=t.version,this.m_catalogLatestVersion}async getLayerVersions(){if(void 0!==this.m_layerVersions)return this.m_layerVersions;const e=new s.DataStoreRequestBuilder(this.m_downloadManager,this.m_metadataUrl+`/metadata/v1/catalogs/${this.m_config.hrn.data.resource}`,this.m_config.getBearerToken),t=await i.MetadataApi.getLayerVersion(e,{version:await this.getCatalogLatestVersion()});return this.m_layerVersions=t.layerVersions,this.m_layerVersions}async getLayerLatestVersion(){if(void 0!==this.m_layerLatestVersion)return this.m_layerLatestVersion;const e=await this.getLayerVersions();return this.m_layerLatestVersion=e.reduce((e,t)=>t.layer===this.m_config.layer&&t.version>e?t.version:e,0),this.m_layerLatestVersion}async getLayer(){if(void 0===this.m_layer){const e=new a.DataStoreClient(this.m_config),t=await e.getCatalogClient();this.m_layer=t.getLayer(this.m_config.layer)}return this.m_layer}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=r(44),o=r(191);t.PartitionDecoder=class{constructor(e,t,r,o,a){this.m_catalogHrn=e,this.m_layerName=t,this.m_ready=!1,this.m_logger=i.LoggerManager.instance.create("Partition Decoder"),this.m_dataProvider=new n.HypeDataProvider({hrn:this.m_catalogHrn,layer:this.m_layerName,catalogVersion:o,getBearerToken:r,serviceUrls:a})}get catalogClient(){if(void 0===this.m_catalogClient)throw new Error("Catalog client is not defined.");return this.m_catalogClient}get layer(){if(void 0===this.m_layer)throw new Error("Catalog layer is not defined.");return this.m_layer}async connect(){this.m_ready||(await this.m_dataProvider.connect(),this.m_catalogClient=this.m_dataProvider.catalogClient(),this.m_layer=this.m_catalogClient.getLayer(this.m_layerName)),this.m_ready=!0}async decode(e){if(await this.connect(),"application/x-protobuf"===this.layer.contentType)return this.getDecodedResult(e);if(void 0===this.layer.contentType||!this.layer.contentType.startsWith("text/")&&"application/vnd.geo+json"!==this.layer.contentType&&"application/json"!==this.layer.contentType){const t=await this.getRawResult(e);return t.errorMessage=`Content type ${this.layer.contentType} is not supported.`,t}return this.getPlainResult(e,this.layer.contentType)}async getRawResult(e){await this.connect();const t=await this.m_dataProvider.getTile(e);return{dataSize:t.byteLength,rawData:t}}setErrorMessage(e){this.m_connectionErrorMessage=e,this.m_logger.error(this.m_connectionErrorMessage)}async getDecodedResult(e){const t=await this.m_dataProvider.getTile(e),r=await this.getProtoDecoder();if(null===r){const e=this.m_connectionErrorMessage||"Missing protobuf decoder in the catalog schema.";throw new Error(e)}const i=new Uint8Array(t),n=r.decode(i),o=n.$type.toObject(n,{defaults:!0,longs:String,enums:String,bytes:String,json:!0});return{dataSize:i.byteLength,rawData:t,decodedData:o}}async getPlainResult(e,t){const r=await this.catalogClient.getPartition(this.layer,e.toHereTile());if(404===r.status)throw new Error(`There is no data in partition ${e.toHereTile()}`);let i;if("versioned"===this.layer.layerType)i=t.startsWith("text/")?await r.text():await r.json();else{const e=await r.arrayBuffer(),n=this.arrayBufferToString(e);i=t.startsWith("text/")?n:JSON.parse(n)}return{dataSize:JSON.stringify(i).length,rawData:i,decodedData:i}}async getProtoDecoder(){if(void 0!==this.m_protoDecoder)return this.m_protoDecoder;const e=new o.CatalogSchemaProvider(this.layer,{loggerName:"PartitionDecoder Schema Provider"});try{await e.connect(),this.m_protoDecoder=e.getProtobufDecoder()||null}catch(e){this.setErrorMessage(e.message),this.m_protoDecoder=null}return this.m_protoDecoder}arrayBufferToString(e){const t=new Uint8Array(e),r=t.length;let i="",n=Math.pow(2,8)-1;for(let e=0;e<r;e+=n)e+n>r&&(n=r-e),i+=String.fromCharCode.apply(null,Array.from(t.subarray(e,e+n)));return i}}},function(e,t,r){"use strict";function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var e=new i;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}i.prototype=r(388),i.prototype.loadAsync=r(422),i.support=r(22),i.defaults=r(202),i.version="3.2.0",i.loadAsync=function(e,t){return(new i).loadAsync(e,t)},i.external=r(51),e.exports=i},function(e,t,r){"use strict";var i=r(35),n=r(6),o=r(11),a=r(201),s=r(202),c=r(104),l=r(408),u=r(409),d=r(73),h=r(421),m=function(e,t,r){var i,a=n.getTypeOf(t),u=n.extend(r||{},s);u.date=u.date||new Date,null!==u.compression&&(u.compression=u.compression.toUpperCase()),"string"==typeof u.unixPermissions&&(u.unixPermissions=parseInt(u.unixPermissions,8)),u.unixPermissions&&16384&u.unixPermissions&&(u.dir=!0),u.dosPermissions&&16&u.dosPermissions&&(u.dir=!0),u.dir&&(e=f(e)),u.createFolders&&(i=p(e))&&g.call(this,i,!0);var m="string"===a&&!1===u.binary&&!1===u.base64;r&&void 0!==r.binary||(u.binary=!m),(t instanceof c&&0===t.uncompressedSize||u.dir||!t||0===t.length)&&(u.base64=!1,u.binary=!0,t="",u.compression="STORE",a="string");var y=null;y=t instanceof c||t instanceof o?t:d.isNode&&d.isStream(t)?new h(e,t):n.prepareContent(e,t,u.binary,u.optimizedBinaryString,u.base64);var v=new l(e,y,u);this.files[e]=v},p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},f=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:s.createFolders,e=f(e),this.files[e]||m.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function y(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var v={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,i;for(t in this.files)this.files.hasOwnProperty(t)&&(i=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,i))},filter:function(e){var t=[];return this.forEach((function(r,i){e(r,i)&&t.push(i)})),t},file:function(e,t,r){if(1===arguments.length){if(y(e)){var i=e;return this.filter((function(e,t){return!t.dir&&i.test(e)}))}var n=this.files[this.root+e];return n&&!n.dir?n:null}return(e=this.root+e,m.call(this,e,t,r),this)},folder:function(e){if(!e)return this;if(y(e))return this.filter((function(t,r){return r.dir&&e.test(t)}));var t=this.root+e,r=g.call(this,t),i=this.clone();return i.root=r.name,i},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter((function(t,r){return r.name.slice(0,e.length)===e})),i=0;i<r.length;i++)delete this.files[r[i].name];return this},generate:function(e){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r={};try{if((r=n.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");n.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var s=r.comment||this.comment||"";t=u.generateWorker(this,r,s)}catch(e){(t=new o("error")).error(e)}return new a(t,r.type||"string",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};e.exports=v},function(e,t,r){"use strict";t.byteLength=function(e){var t=l(e),r=t[0],i=t[1];return 3*(r+i)/4-i},t.toByteArray=function(e){var t,r,i=l(e),a=i[0],s=i[1],c=new o(function(e,t,r){return 3*(t+r)/4-r}(0,a,s)),u=0,d=s>0?a-4:a;for(r=0;r<d;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;2===s&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,c[u++]=255&t);1===s&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t);return c},t.fromByteArray=function(e){for(var t,r=e.length,n=r%3,o=[],a=0,s=r-n;a<s;a+=16383)o.push(u(e,a,a+16383>s?s:a+16383));1===n?(t=e[r-1],o.push(i[t>>2]+i[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],o.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return o.join("")};for(var i=[],n=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)i[s]=a[s],n[a.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function u(e,t,r){for(var n,o,a=[],s=t;s<r;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(i[(o=n)>>18&63]+i[o>>12&63]+i[o>>6&63]+i[63&o]);return a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,r,i,n){var o,a,s=8*n-i-1,c=(1<<s)-1,l=c>>1,u=-7,d=r?n-1:0,h=r?-1:1,m=e[t+d];for(d+=h,o=m&(1<<-u)-1,m>>=-u,u+=s;u>0;o=256*o+e[t+d],d+=h,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=i;u>0;a=256*a+e[t+d],d+=h,u-=8);if(0===o)o=1-l;else{if(o===c)return a?NaN:1/0*(m?-1:1);a+=Math.pow(2,i),o-=l}return(m?-1:1)*a*Math.pow(2,o-i)},t.write=function(e,t,r,i,n,o){var a,s,c,l=8*o-n-1,u=(1<<l)-1,d=u>>1,h=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,m=i?0:o-1,p=i?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+d>=1?h/c:h*Math.pow(2,1-d))*c>=2&&(a++,c/=2),a+d>=u?(s=0,a=u):a+d>=1?(s=(t*c-1)*Math.pow(2,n),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,n),a=0));n>=8;e[r+m]=255&s,m+=p,s/=256,n-=8);for(a=a<<n|s,l+=n;l>0;e[r+m]=255&a,m+=p,a/=256,l-=8);e[r+m-p]|=128*f}},function(e,t,r){e.exports=n;var i=r(100).EventEmitter;function n(){i.call(this)}r(37)(n,i),n.Readable=r(101),n.Writable=r(399),n.Duplex=r(400),n.Transform=r(401),n.PassThrough=r(402),n.Stream=n,n.prototype.pipe=function(e,t){var r=this;function n(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function o(){r.readable&&r.resume&&r.resume()}r.on("data",n),e.on("drain",o),e._isStdio||t&&!1===t.end||(r.on("end",s),r.on("close",c));var a=!1;function s(){a||(a=!0,e.end())}function c(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){if(u(),0===i.listenerCount(this,"error"))throw e}function u(){r.removeListener("data",n),e.removeListener("drain",o),r.removeListener("end",s),r.removeListener("close",c),r.removeListener("error",l),e.removeListener("error",l),r.removeListener("end",u),r.removeListener("close",u),e.removeListener("close",u)}return r.on("error",l),e.on("error",l),r.on("end",u),r.on("close",u),e.on("close",u),e.emit("pipe",r),e}},function(e,t){},function(e,t,r){"use strict";var i=r(102).Buffer,n=r(394);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return i.alloc(0);if(1===this.length)return this.head.data;for(var t,r,n,o=i.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,r=o,n=s,t.copy(r,n),s+=a.data.length,a=a.next;return o},e}(),n&&n.inspect&&n.inspect.custom&&(e.exports.prototype[n.inspect.custom]=function(){var e=n.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t){},function(e,t,r){(function(e,t){!function(e,r){"use strict";if(!e.setImmediate){var i,n,o,a,s,c=1,l={},u=!1,d=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){p(e.data)},i=function(e){o.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(n=d.documentElement,i=function(e){var t=d.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):i=function(e){setTimeout(p,0,e)}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),i=function(t){e.postMessage(a+t,"*")}),h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var n={callback:e,args:t};return l[c]=n,i(c),c++},h.clearImmediate=m}function m(e){delete l[e]}function p(e){if(u)setTimeout(p,0,e);else{var t=l[e];if(t){u=!0;try{!function(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(r,i)}}(t)}finally{m(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,r(23),r(71))},function(e,t,r){(function(t){function r(e){try{if(!t.localStorage)return!1}catch(e){return!1}var r=t.localStorage[e];return null!=r&&"true"===String(r).toLowerCase()}e.exports=function(e,t){if(r("noDeprecation"))return e;var i=!1;return function(){if(!i){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}}}).call(this,r(23))},function(e,t,r){var i=r(36),n=i.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=i:(o(i,t),t.Buffer=a),a.prototype=Object.create(n.prototype),o(n,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},function(e,t,r){"use strict";e.exports=o;var i=r(199),n=r(50);function o(e){if(!(this instanceof o))return new o(e);i.call(this,e)}n.inherits=r(37),n.inherits(o,i),o.prototype._transform=function(e,t,r){r(null,e)}},function(e,t,r){e.exports=r(103)},function(e,t,r){e.exports=r(26)},function(e,t,r){e.exports=r(101).Transform},function(e,t,r){e.exports=r(101).PassThrough},function(e,t,r){"use strict";(function(t){e.exports="function"==typeof t?t:function(){var e=[].slice.apply(arguments);e.splice(1,0,0),setTimeout.apply(null,e)}}).call(this,r(197).setImmediate)},function(e,t,r){"use strict";var i=r(405);function n(){}var o={},a=["REJECTED"],s=["FULFILLED"],c=["PENDING"];function l(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==n&&m(this,e)}function u(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function d(e,t,r){i((function(){var i;try{i=t(r)}catch(t){return o.reject(e,t)}i===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,i)}))}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function m(e,t){var r=!1;function i(t){r||(r=!0,o.reject(e,t))}function n(t){r||(r=!0,o.resolve(e,t))}var a=p((function(){t(n,i)}));"error"===a.status&&i(a.value)}function p(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}e.exports=l,l.prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){throw r}))}))},l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===a)return this;var r=new this.constructor(n);this.state!==c?d(r,this.state===s?e:t,this.outcome):this.queue.push(new u(r,e,t));return r},u.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){o.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},o.resolve=function(e,t){var r=p(h,t);if("error"===r.status)return o.reject(e,r.value);var i=r.value;if(i)m(e,i);else{e.state=s,e.outcome=t;for(var n=-1,a=e.queue.length;++n<a;)e.queue[n].callFulfilled(t)}return e},o.reject=function(e,t){e.state=a,e.outcome=t;for(var r=-1,i=e.queue.length;++r<i;)e.queue[r].callRejected(t);return e},l.resolve=function(e){if(e instanceof this)return e;return o.resolve(new this(n),e)},l.reject=function(e){var t=new this(n);return o.reject(t,e)},l.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,i=!1;if(!r)return this.resolve([]);var a=new Array(r),s=0,c=-1,l=new this(n);for(;++c<r;)u(e[c],c);return l;function u(e,n){t.resolve(e).then((function(e){a[n]=e,++s!==r||i||(i=!0,o.resolve(l,a))}),(function(e){i||(i=!0,o.reject(l,e))}))}},l.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,i=!1;if(!r)return this.resolve([]);var a=-1,s=new this(n);for(;++a<r;)c=e[a],t.resolve(c).then((function(e){i||(i=!0,o.resolve(s,e))}),(function(e){i||(i=!0,o.reject(s,e))}));var c;return s}},function(e,t,r){"use strict";(function(t){var r,i,n=t.MutationObserver||t.WebKitMutationObserver;if(n){var o=0,a=new n(u),s=t.document.createTextNode("");a.observe(s,{characterData:!0}),r=function(){s.data=o=++o%2}}else if(t.setImmediate||void 0===t.MessageChannel)r="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){u(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(u,0)};else{var c=new t.MessageChannel;c.port1.onmessage=u,r=function(){c.port2.postMessage(0)}}var l=[];function u(){var e,t;i=!0;for(var r=l.length;r;){for(t=l,l=[],e=-1;++e<r;)t[e]();r=l.length}i=!1}e.exports=function(e){1!==l.push(e)||i||r()}}).call(this,r(23))},function(e,t,r){"use strict";var i=r(11),n=r(6);function o(e){i.call(this,"ConvertWorker to "+e),this.destType=e}n.inherits(o,i),o.prototype.processChunk=function(e){this.push({data:n.transformTo(this.destType,e.data),meta:e.meta})},e.exports=o},function(e,t,r){"use strict";var i=r(193).Readable;function n(e,t,r){i.call(this,t),this._helper=e;var n=this;e.on("data",(function(e,t){n.push(e)||n._helper.pause(),r&&r(t)})).on("error",(function(e){n.emit("error",e)})).on("end",(function(){n.push(null)}))}r(6).inherits(n,i),n.prototype._read=function(){this._helper.resume()},e.exports=n},function(e,t,r){"use strict";var i=r(201),n=r(203),o=r(35),a=r(104),s=r(11),c=function(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}};c.prototype={internalStream:function(e){var t=null,r="string";try{if(!e)throw new Error("No output type specified.");var n="string"===(r=e.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),t=this._decompressWorker();var a=!this._dataBinary;a&&!n&&(t=t.pipe(new o.Utf8EncodeWorker)),!a&&n&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(e){(t=new s("error")).error(e)}return new i(t,r,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof a&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new o.Utf8EncodeWorker)),a.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof s?this._data:new n(this._data)}};for(var l=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<l.length;d++)c.prototype[l[d]]=u;e.exports=c},function(e,t,r){"use strict";var i=r(206),n=r(420);t.generateWorker=function(e,t,r){var o=new n(t.streamFiles,r,t.platform,t.encodeFileName),a=0;try{e.forEach((function(e,r){a++;var n=function(e,t){var r=e||t,n=i[r];if(!n)throw new Error(r+" is not a valid compression method !");return n}(r.options.compression,t.compression),s=r.options.compressionOptions||t.compressionOptions||{},c=r.dir,l=r.date;r._compressWorker(n,s).withStreamInfo("file",{name:e,dir:c,date:l,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(o)})),o.entriesCount=a}catch(e){o.error(e)}return o}},function(e,t,r){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,n=r(411),o=r(6),a=r(11),s=i?"uint8array":"array";function c(e,t){a.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}t.magic="\b\0",o.inherits(c,a),c.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(s,e.data),!1)},c.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},t.compressWorker=function(e){return new c("Deflate",e)},t.uncompressWorker=function(){return new c("Inflate",{})}},function(e,t,r){"use strict";var i={};(0,r(24).assign)(i,r(412),r(415),r(211)),e.exports=i},function(e,t,r){"use strict";var i=r(413),n=r(24),o=r(209),a=r(106),s=r(210),c=Object.prototype.toString,l=0,u=-1,d=0,h=8;function m(e){if(!(this instanceof m))return new m(e);this.options=n.assign({level:u,method:h,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var r=i.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==l)throw new Error(a[r]);if(t.header&&i.deflateSetHeader(this.strm,t.header),t.dictionary){var p;if(p="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=i.deflateSetDictionary(this.strm,p))!==l)throw new Error(a[r]);this._dict_set=!0}}function p(e,t){var r=new m(t);if(r.push(e,!0),r.err)throw r.msg||a[r.err];return r.result}m.prototype.push=function(e,t){var r,a,s=this.strm,u=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=o.string2buf(e):"[object ArrayBuffer]"===c.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new n.Buf8(u),s.next_out=0,s.avail_out=u),1!==(r=i.deflate(s,a))&&r!==l)return this.onEnd(r),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(n.shrinkBuf(s.output,s.next_out))):this.onData(n.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==r);return 4===a?(r=i.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===l):2!==a||(this.onEnd(l),s.avail_out=0,!0)},m.prototype.onData=function(e){this.chunks.push(e)},m.prototype.onEnd=function(e){e===l&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=m,t.deflate=p,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,p(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,p(e,t)}},function(e,t,r){"use strict";var i,n=r(24),o=r(414),a=r(207),s=r(208),c=r(106),l=0,u=1,d=3,h=4,m=5,p=0,f=1,g=-2,y=-3,v=-5,_=-1,b=1,S=2,T=3,E=4,w=0,C=2,x=8,O=9,A=15,P=8,R=286,I=30,D=19,L=2*R+1,M=15,k=3,N=258,F=N+k+1,U=32,j=42,V=69,B=73,G=91,z=103,q=113,H=666,W=1,K=2,Y=3,$=4,Z=3;function J(e,t){return e.msg=c[t],t}function X(e){return(e<<1)-(e>4?9:0)}function Q(e){for(var t=e.length;--t>=0;)e[t]=0}function ee(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(n.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function te(e,t){o._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ee(e.strm)}function re(e,t){e.pending_buf[e.pending++]=t}function ie(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function ne(e,t){var r,i,n=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-F?e.strstart-(e.w_size-F):0,l=e.window,u=e.w_mask,d=e.prev,h=e.strstart+N,m=l[o+a-1],p=l[o+a];e.prev_length>=e.good_match&&(n>>=2),s>e.lookahead&&(s=e.lookahead);do{if(l[(r=t)+a]===p&&l[r+a-1]===m&&l[r]===l[o]&&l[++r]===l[o+1]){o+=2,r++;do{}while(l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&o<h);if(i=N-(h-o),o=h-N,i>a){if(e.match_start=t,a=i,i>=s)break;m=l[o+a-1],p=l[o+a]}}}while((t=d[t&u])>c&&0!=--n);return a<=e.lookahead?a:e.lookahead}function oe(e){var t,r,i,o,c,l,u,d,h,m,p=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=p+(p-F)){n.arraySet(e.window,e.window,p,p,0),e.match_start-=p,e.strstart-=p,e.block_start-=p,t=r=e.hash_size;do{i=e.head[--t],e.head[t]=i>=p?i-p:0}while(--r);t=r=p;do{i=e.prev[--t],e.prev[t]=i>=p?i-p:0}while(--r);o+=p}if(0===e.strm.avail_in)break;if(l=e.strm,u=e.window,d=e.strstart+e.lookahead,h=o,m=void 0,(m=l.avail_in)>h&&(m=h),r=0===m?0:(l.avail_in-=m,n.arraySet(u,l.input,l.next_in,m,d),1===l.state.wrap?l.adler=a(l.adler,u,m,d):2===l.state.wrap&&(l.adler=s(l.adler,u,m,d)),l.next_in+=m,l.total_in+=m,m),e.lookahead+=r,e.lookahead+e.insert>=k)for(c=e.strstart-e.insert,e.ins_h=e.window[c],e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+k-1])&e.hash_mask,e.prev[c&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=c,c++,e.insert--,!(e.lookahead+e.insert<k)););}while(e.lookahead<F&&0!==e.strm.avail_in)}function ae(e,t){for(var r,i;;){if(e.lookahead<F){if(oe(e),e.lookahead<F&&t===l)return W;if(0===e.lookahead)break}if(r=0,e.lookahead>=k&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-F&&(e.match_length=ne(e,r)),e.match_length>=k)if(i=o._tr_tally(e,e.strstart-e.match_start,e.match_length-k),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=k){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(te(e,!1),0===e.strm.avail_out))return W}return e.insert=e.strstart<k-1?e.strstart:k-1,t===h?(te(e,!0),0===e.strm.avail_out?Y:$):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?W:K}function se(e,t){for(var r,i,n;;){if(e.lookahead<F){if(oe(e),e.lookahead<F&&t===l)return W;if(0===e.lookahead)break}if(r=0,e.lookahead>=k&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=k-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-F&&(e.match_length=ne(e,r),e.match_length<=5&&(e.strategy===b||e.match_length===k&&e.strstart-e.match_start>4096)&&(e.match_length=k-1)),e.prev_length>=k&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-k,i=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-k),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=k-1,e.strstart++,i&&(te(e,!1),0===e.strm.avail_out))return W}else if(e.match_available){if((i=o._tr_tally(e,0,e.window[e.strstart-1]))&&te(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return W}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<k-1?e.strstart:k-1,t===h?(te(e,!0),0===e.strm.avail_out?Y:$):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?W:K}function ce(e,t,r,i,n){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=i,this.func=n}function le(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*L),this.dyn_dtree=new n.Buf16(2*(2*I+1)),this.bl_tree=new n.Buf16(2*(2*D+1)),Q(this.dyn_ltree),Q(this.dyn_dtree),Q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(M+1),this.heap=new n.Buf16(2*R+1),Q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*R+1),Q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ue(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=C,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?j:q,e.adler=2===t.wrap?0:1,t.last_flush=l,o._tr_init(t),p):J(e,g)}function de(e){var t,r=ue(e);return r===p&&((t=e.state).window_size=2*t.w_size,Q(t.head),t.max_lazy_match=i[t.level].max_lazy,t.good_match=i[t.level].good_length,t.nice_match=i[t.level].nice_length,t.max_chain_length=i[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=k-1,t.match_available=0,t.ins_h=0),r}function he(e,t,r,i,o,a){if(!e)return g;var s=1;if(t===_&&(t=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),o<1||o>O||r!==x||i<8||i>15||t<0||t>9||a<0||a>E)return J(e,g);8===i&&(i=9);var c=new le;return e.state=c,c.strm=e,c.wrap=s,c.gzhead=null,c.w_bits=i,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=o+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+k-1)/k),c.window=new n.Buf8(2*c.w_size),c.head=new n.Buf16(c.hash_size),c.prev=new n.Buf16(c.w_size),c.lit_bufsize=1<<o+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new n.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=a,c.method=r,de(e)}i=[new ce(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(oe(e),0===e.lookahead&&t===l)return W;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+r;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,te(e,!1),0===e.strm.avail_out))return W;if(e.strstart-e.block_start>=e.w_size-F&&(te(e,!1),0===e.strm.avail_out))return W}return e.insert=0,t===h?(te(e,!0),0===e.strm.avail_out?Y:$):(e.strstart>e.block_start&&(te(e,!1),e.strm.avail_out),W)})),new ce(4,4,8,4,ae),new ce(4,5,16,8,ae),new ce(4,6,32,32,ae),new ce(4,4,16,16,se),new ce(8,16,32,32,se),new ce(8,16,128,128,se),new ce(8,32,128,256,se),new ce(32,128,258,1024,se),new ce(32,258,258,4096,se)],t.deflateInit=function(e,t){return he(e,t,x,A,P,w)},t.deflateInit2=he,t.deflateReset=de,t.deflateResetKeep=ue,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?g:(e.state.gzhead=t,p):g},t.deflate=function(e,t){var r,n,a,c;if(!e||!e.state||t>m||t<0)return e?J(e,g):g;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||n.status===H&&t!==h)return J(e,0===e.avail_out?v:g);if(n.strm=e,r=n.last_flush,n.last_flush=t,n.status===j)if(2===n.wrap)e.adler=0,re(n,31),re(n,139),re(n,8),n.gzhead?(re(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),re(n,255&n.gzhead.time),re(n,n.gzhead.time>>8&255),re(n,n.gzhead.time>>16&255),re(n,n.gzhead.time>>24&255),re(n,9===n.level?2:n.strategy>=S||n.level<2?4:0),re(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(re(n,255&n.gzhead.extra.length),re(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=s(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=V):(re(n,0),re(n,0),re(n,0),re(n,0),re(n,0),re(n,9===n.level?2:n.strategy>=S||n.level<2?4:0),re(n,Z),n.status=q);else{var y=x+(n.w_bits-8<<4)<<8;y|=(n.strategy>=S||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(y|=U),y+=31-y%31,n.status=q,ie(n,y),0!==n.strstart&&(ie(n,e.adler>>>16),ie(n,65535&e.adler)),e.adler=1}if(n.status===V)if(n.gzhead.extra){for(a=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>a&&(e.adler=s(e.adler,n.pending_buf,n.pending-a,a)),ee(e),a=n.pending,n.pending!==n.pending_buf_size));)re(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>a&&(e.adler=s(e.adler,n.pending_buf,n.pending-a,a)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=B)}else n.status=B;if(n.status===B)if(n.gzhead.name){a=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(e.adler=s(e.adler,n.pending_buf,n.pending-a,a)),ee(e),a=n.pending,n.pending===n.pending_buf_size)){c=1;break}c=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,re(n,c)}while(0!==c);n.gzhead.hcrc&&n.pending>a&&(e.adler=s(e.adler,n.pending_buf,n.pending-a,a)),0===c&&(n.gzindex=0,n.status=G)}else n.status=G;if(n.status===G)if(n.gzhead.comment){a=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(e.adler=s(e.adler,n.pending_buf,n.pending-a,a)),ee(e),a=n.pending,n.pending===n.pending_buf_size)){c=1;break}c=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,re(n,c)}while(0!==c);n.gzhead.hcrc&&n.pending>a&&(e.adler=s(e.adler,n.pending_buf,n.pending-a,a)),0===c&&(n.status=z)}else n.status=z;if(n.status===z&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&ee(e),n.pending+2<=n.pending_buf_size&&(re(n,255&e.adler),re(n,e.adler>>8&255),e.adler=0,n.status=q)):n.status=q),0!==n.pending){if(ee(e),0===e.avail_out)return n.last_flush=-1,p}else if(0===e.avail_in&&X(t)<=X(r)&&t!==h)return J(e,v);if(n.status===H&&0!==e.avail_in)return J(e,v);if(0!==e.avail_in||0!==n.lookahead||t!==l&&n.status!==H){var _=n.strategy===S?function(e,t){for(var r;;){if(0===e.lookahead&&(oe(e),0===e.lookahead)){if(t===l)return W;break}if(e.match_length=0,r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(te(e,!1),0===e.strm.avail_out))return W}return e.insert=0,t===h?(te(e,!0),0===e.strm.avail_out?Y:$):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?W:K}(n,t):n.strategy===T?function(e,t){for(var r,i,n,a,s=e.window;;){if(e.lookahead<=N){if(oe(e),e.lookahead<=N&&t===l)return W;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=k&&e.strstart>0&&(i=s[n=e.strstart-1])===s[++n]&&i===s[++n]&&i===s[++n]){a=e.strstart+N;do{}while(i===s[++n]&&i===s[++n]&&i===s[++n]&&i===s[++n]&&i===s[++n]&&i===s[++n]&&i===s[++n]&&i===s[++n]&&n<a);e.match_length=N-(a-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=k?(r=o._tr_tally(e,1,e.match_length-k),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(te(e,!1),0===e.strm.avail_out))return W}return e.insert=0,t===h?(te(e,!0),0===e.strm.avail_out?Y:$):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?W:K}(n,t):i[n.level].func(n,t);if(_!==Y&&_!==$||(n.status=H),_===W||_===Y)return 0===e.avail_out&&(n.last_flush=-1),p;if(_===K&&(t===u?o._tr_align(n):t!==m&&(o._tr_stored_block(n,0,0,!1),t===d&&(Q(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),ee(e),0===e.avail_out))return n.last_flush=-1,p}return t!==h?p:n.wrap<=0?f:(2===n.wrap?(re(n,255&e.adler),re(n,e.adler>>8&255),re(n,e.adler>>16&255),re(n,e.adler>>24&255),re(n,255&e.total_in),re(n,e.total_in>>8&255),re(n,e.total_in>>16&255),re(n,e.total_in>>24&255)):(ie(n,e.adler>>>16),ie(n,65535&e.adler)),ee(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?p:f)},t.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==j&&t!==V&&t!==B&&t!==G&&t!==z&&t!==q&&t!==H?J(e,g):(e.state=null,t===q?J(e,y):p):g},t.deflateSetDictionary=function(e,t){var r,i,o,s,c,l,u,d,h=t.length;if(!e||!e.state)return g;if(2===(s=(r=e.state).wrap)||1===s&&r.status!==j||r.lookahead)return g;for(1===s&&(e.adler=a(e.adler,t,h,0)),r.wrap=0,h>=r.w_size&&(0===s&&(Q(r.head),r.strstart=0,r.block_start=0,r.insert=0),d=new n.Buf8(r.w_size),n.arraySet(d,t,h-r.w_size,r.w_size,0),t=d,h=r.w_size),c=e.avail_in,l=e.next_in,u=e.input,e.avail_in=h,e.next_in=0,e.input=t,oe(r);r.lookahead>=k;){i=r.strstart,o=r.lookahead-(k-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[i+k-1])&r.hash_mask,r.prev[i&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=i,i++}while(--o);r.strstart=i,r.lookahead=k-1,oe(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=k-1,r.match_available=0,e.next_in=l,e.input=u,e.avail_in=c,r.wrap=s,p},t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,r){"use strict";var i=r(24),n=4,o=0,a=1,s=2;function c(e){for(var t=e.length;--t>=0;)e[t]=0}var l=0,u=1,d=2,h=29,m=256,p=m+1+h,f=30,g=19,y=2*p+1,v=15,_=16,b=7,S=256,T=16,E=17,w=18,C=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],x=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=new Array(2*(p+2));c(P);var R=new Array(2*f);c(R);var I=new Array(512);c(I);var D=new Array(256);c(D);var L=new Array(h);c(L);var M,k,N,F=new Array(f);function U(e,t,r,i,n){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=e&&e.length}function j(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function V(e){return e<256?I[e]:I[256+(e>>>7)]}function B(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function G(e,t,r){e.bi_valid>_-r?(e.bi_buf|=t<<e.bi_valid&65535,B(e,e.bi_buf),e.bi_buf=t>>_-e.bi_valid,e.bi_valid+=r-_):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function z(e,t,r){G(e,r[2*t],r[2*t+1])}function q(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function H(e,t,r){var i,n,o=new Array(v+1),a=0;for(i=1;i<=v;i++)o[i]=a=a+r[i-1]<<1;for(n=0;n<=t;n++){var s=e[2*n+1];0!==s&&(e[2*n]=q(o[s]++,s))}}function W(e){var t;for(t=0;t<p;t++)e.dyn_ltree[2*t]=0;for(t=0;t<f;t++)e.dyn_dtree[2*t]=0;for(t=0;t<g;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*S]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function K(e){e.bi_valid>8?B(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Y(e,t,r,i){var n=2*t,o=2*r;return e[n]<e[o]||e[n]===e[o]&&i[t]<=i[r]}function $(e,t,r){for(var i=e.heap[r],n=r<<1;n<=e.heap_len&&(n<e.heap_len&&Y(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!Y(t,i,e.heap[n],e.depth));)e.heap[r]=e.heap[n],r=n,n<<=1;e.heap[r]=i}function Z(e,t,r){var i,n,o,a,s=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],n=e.pending_buf[e.l_buf+s],s++,0===i?z(e,n,t):(z(e,(o=D[n])+m+1,t),0!==(a=C[o])&&G(e,n-=L[o],a),z(e,o=V(--i),r),0!==(a=x[o])&&G(e,i-=F[o],a))}while(s<e.last_lit);z(e,S,t)}function J(e,t){var r,i,n,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,c=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=y,r=0;r<c;r++)0!==o[2*r]?(e.heap[++e.heap_len]=l=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)o[2*(n=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[n]=0,e.opt_len--,s&&(e.static_len-=a[2*n+1]);for(t.max_code=l,r=e.heap_len>>1;r>=1;r--)$(e,o,r);n=c;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],$(e,o,1),i=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=i,o[2*n]=o[2*r]+o[2*i],e.depth[n]=(e.depth[r]>=e.depth[i]?e.depth[r]:e.depth[i])+1,o[2*r+1]=o[2*i+1]=n,e.heap[1]=n++,$(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,i,n,o,a,s,c=t.dyn_tree,l=t.max_code,u=t.stat_desc.static_tree,d=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,m=t.stat_desc.extra_base,p=t.stat_desc.max_length,f=0;for(o=0;o<=v;o++)e.bl_count[o]=0;for(c[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<y;r++)(o=c[2*c[2*(i=e.heap[r])+1]+1]+1)>p&&(o=p,f++),c[2*i+1]=o,i>l||(e.bl_count[o]++,a=0,i>=m&&(a=h[i-m]),s=c[2*i],e.opt_len+=s*(o+a),d&&(e.static_len+=s*(u[2*i+1]+a)));if(0!==f){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,f-=2}while(f>0);for(o=p;0!==o;o--)for(i=e.bl_count[o];0!==i;)(n=e.heap[--r])>l||(c[2*n+1]!==o&&(e.opt_len+=(o-c[2*n+1])*c[2*n],c[2*n+1]=o),i--)}}(e,t),H(o,l,e.bl_count)}function X(e,t,r){var i,n,o=-1,a=t[1],s=0,c=7,l=4;for(0===a&&(c=138,l=3),t[2*(r+1)+1]=65535,i=0;i<=r;i++)n=a,a=t[2*(i+1)+1],++s<c&&n===a||(s<l?e.bl_tree[2*n]+=s:0!==n?(n!==o&&e.bl_tree[2*n]++,e.bl_tree[2*T]++):s<=10?e.bl_tree[2*E]++:e.bl_tree[2*w]++,s=0,o=n,0===a?(c=138,l=3):n===a?(c=6,l=3):(c=7,l=4))}function Q(e,t,r){var i,n,o=-1,a=t[1],s=0,c=7,l=4;for(0===a&&(c=138,l=3),i=0;i<=r;i++)if(n=a,a=t[2*(i+1)+1],!(++s<c&&n===a)){if(s<l)do{z(e,n,e.bl_tree)}while(0!=--s);else 0!==n?(n!==o&&(z(e,n,e.bl_tree),s--),z(e,T,e.bl_tree),G(e,s-3,2)):s<=10?(z(e,E,e.bl_tree),G(e,s-3,3)):(z(e,w,e.bl_tree),G(e,s-11,7));s=0,o=n,0===a?(c=138,l=3):n===a?(c=6,l=3):(c=7,l=4)}}c(F);var ee=!1;function te(e,t,r,n){G(e,(l<<1)+(n?1:0),3),function(e,t,r,n){K(e),n&&(B(e,r),B(e,~r)),i.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r,!0)}t._tr_init=function(e){ee||(!function(){var e,t,r,i,n,o=new Array(v+1);for(r=0,i=0;i<h-1;i++)for(L[i]=r,e=0;e<1<<C[i];e++)D[r++]=i;for(D[r-1]=i,n=0,i=0;i<16;i++)for(F[i]=n,e=0;e<1<<x[i];e++)I[n++]=i;for(n>>=7;i<f;i++)for(F[i]=n<<7,e=0;e<1<<x[i]-7;e++)I[256+n++]=i;for(t=0;t<=v;t++)o[t]=0;for(e=0;e<=143;)P[2*e+1]=8,e++,o[8]++;for(;e<=255;)P[2*e+1]=9,e++,o[9]++;for(;e<=279;)P[2*e+1]=7,e++,o[7]++;for(;e<=287;)P[2*e+1]=8,e++,o[8]++;for(H(P,p+1,o),e=0;e<f;e++)R[2*e+1]=5,R[2*e]=q(e,5);M=new U(P,C,m+1,p,v),k=new U(R,x,0,f,v),N=new U(new Array(0),O,0,g,b)}(),ee=!0),e.l_desc=new j(e.dyn_ltree,M),e.d_desc=new j(e.dyn_dtree,k),e.bl_desc=new j(e.bl_tree,N),e.bi_buf=0,e.bi_valid=0,W(e)},t._tr_stored_block=te,t._tr_flush_block=function(e,t,r,i){var c,l,h=0;e.level>0?(e.strm.data_type===s&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return o;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return a;for(t=32;t<m;t++)if(0!==e.dyn_ltree[2*t])return a;return o}(e)),J(e,e.l_desc),J(e,e.d_desc),h=function(e){var t;for(X(e,e.dyn_ltree,e.l_desc.max_code),X(e,e.dyn_dtree,e.d_desc.max_code),J(e,e.bl_desc),t=g-1;t>=3&&0===e.bl_tree[2*A[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),c=e.opt_len+3+7>>>3,(l=e.static_len+3+7>>>3)<=c&&(c=l)):c=l=r+5,r+4<=c&&-1!==t?te(e,t,r,i):e.strategy===n||l===c?(G(e,(u<<1)+(i?1:0),3),Z(e,P,R)):(G(e,(d<<1)+(i?1:0),3),function(e,t,r,i){var n;for(G(e,t-257,5),G(e,r-1,5),G(e,i-4,4),n=0;n<i;n++)G(e,e.bl_tree[2*A[n]+1],3);Q(e,e.dyn_ltree,t-1),Q(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,h+1),Z(e,e.dyn_ltree,e.dyn_dtree)),W(e),i&&K(e)},t._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(D[r]+m+1)]++,e.dyn_dtree[2*V(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){G(e,u<<1,3),z(e,S,P),function(e){16===e.bi_valid?(B(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},function(e,t,r){"use strict";var i=r(416),n=r(24),o=r(209),a=r(211),s=r(106),c=r(210),l=r(419),u=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var r=i.inflateInit2(this.strm,t.windowBits);if(r!==a.Z_OK)throw new Error(s[r]);if(this.header=new l,i.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=o.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=i.inflateSetDictionary(this.strm,t.dictionary))!==a.Z_OK))throw new Error(s[r])}function h(e,t){var r=new d(t);if(r.push(e,!0),r.err)throw r.msg||s[r.err];return r.result}d.prototype.push=function(e,t){var r,s,c,l,d,h=this.strm,m=this.options.chunkSize,p=this.options.dictionary,f=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?h.input=o.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?h.input=new Uint8Array(e):h.input=e,h.next_in=0,h.avail_in=h.input.length;do{if(0===h.avail_out&&(h.output=new n.Buf8(m),h.next_out=0,h.avail_out=m),(r=i.inflate(h,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&p&&(r=i.inflateSetDictionary(this.strm,p)),r===a.Z_BUF_ERROR&&!0===f&&(r=a.Z_OK,f=!1),r!==a.Z_STREAM_END&&r!==a.Z_OK)return this.onEnd(r),this.ended=!0,!1;h.next_out&&(0!==h.avail_out&&r!==a.Z_STREAM_END&&(0!==h.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(c=o.utf8border(h.output,h.next_out),l=h.next_out-c,d=o.buf2string(h.output,c),h.next_out=l,h.avail_out=m-l,l&&n.arraySet(h.output,h.output,c,l,0),this.onData(d)):this.onData(n.shrinkBuf(h.output,h.next_out)))),0===h.avail_in&&0===h.avail_out&&(f=!0)}while((h.avail_in>0||0===h.avail_out)&&r!==a.Z_STREAM_END);return r===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(r=i.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),h.avail_out=0,!0)},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=d,t.inflate=h,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},t.ungzip=h},function(e,t,r){"use strict";var i=r(24),n=r(207),o=r(208),a=r(417),s=r(418),c=0,l=1,u=2,d=4,h=5,m=6,p=0,f=1,g=2,y=-2,v=-3,_=-4,b=-5,S=8,T=1,E=2,w=3,C=4,x=5,O=6,A=7,P=8,R=9,I=10,D=11,L=12,M=13,k=14,N=15,F=16,U=17,j=18,V=19,B=20,G=21,z=22,q=23,H=24,W=25,K=26,Y=27,$=28,Z=29,J=30,X=31,Q=32,ee=852,te=592,re=15;function ie(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function ne(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function oe(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=T,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(ee),t.distcode=t.distdyn=new i.Buf32(te),t.sane=1,t.back=-1,p):y}function ae(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,oe(e)):y}function se(e,t){var r,i;return e&&e.state?(i=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?y:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=r,i.wbits=t,ae(e))):y}function ce(e,t){var r,i;return e?(i=new ne,e.state=i,i.window=null,(r=se(e,t))!==p&&(e.state=null),r):y}var le,ue,de=!0;function he(e){if(de){var t;for(le=new i.Buf32(512),ue=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(l,e.lens,0,288,le,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(u,e.lens,0,32,ue,0,e.work,{bits:5}),de=!1}e.lencode=le,e.lenbits=9,e.distcode=ue,e.distbits=5}function me(e,t,r,n){var o,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new i.Buf8(a.wsize)),n>=a.wsize?(i.arraySet(a.window,t,r-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>n&&(o=n),i.arraySet(a.window,t,r-n,o,a.wnext),(n-=o)?(i.arraySet(a.window,t,r-n,n,0),a.wnext=n,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}t.inflateReset=ae,t.inflateReset2=se,t.inflateResetKeep=oe,t.inflateInit=function(e){return ce(e,re)},t.inflateInit2=ce,t.inflate=function(e,t){var r,ee,te,re,ne,oe,ae,se,ce,le,ue,de,pe,fe,ge,ye,ve,_e,be,Se,Te,Ee,we,Ce,xe=0,Oe=new i.Buf8(4),Ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return y;(r=e.state).mode===L&&(r.mode=M),ne=e.next_out,te=e.output,ae=e.avail_out,re=e.next_in,ee=e.input,oe=e.avail_in,se=r.hold,ce=r.bits,le=oe,ue=ae,Ee=p;e:for(;;)switch(r.mode){case T:if(0===r.wrap){r.mode=M;break}for(;ce<16;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}if(2&r.wrap&&35615===se){r.check=0,Oe[0]=255&se,Oe[1]=se>>>8&255,r.check=o(r.check,Oe,2,0),se=0,ce=0,r.mode=E;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&se)<<8)+(se>>8))%31){e.msg="incorrect header check",r.mode=J;break}if((15&se)!==S){e.msg="unknown compression method",r.mode=J;break}if(ce-=4,Te=8+(15&(se>>>=4)),0===r.wbits)r.wbits=Te;else if(Te>r.wbits){e.msg="invalid window size",r.mode=J;break}r.dmax=1<<Te,e.adler=r.check=1,r.mode=512&se?I:L,se=0,ce=0;break;case E:for(;ce<16;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}if(r.flags=se,(255&r.flags)!==S){e.msg="unknown compression method",r.mode=J;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=J;break}r.head&&(r.head.text=se>>8&1),512&r.flags&&(Oe[0]=255&se,Oe[1]=se>>>8&255,r.check=o(r.check,Oe,2,0)),se=0,ce=0,r.mode=w;case w:for(;ce<32;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}r.head&&(r.head.time=se),512&r.flags&&(Oe[0]=255&se,Oe[1]=se>>>8&255,Oe[2]=se>>>16&255,Oe[3]=se>>>24&255,r.check=o(r.check,Oe,4,0)),se=0,ce=0,r.mode=C;case C:for(;ce<16;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}r.head&&(r.head.xflags=255&se,r.head.os=se>>8),512&r.flags&&(Oe[0]=255&se,Oe[1]=se>>>8&255,r.check=o(r.check,Oe,2,0)),se=0,ce=0,r.mode=x;case x:if(1024&r.flags){for(;ce<16;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}r.length=se,r.head&&(r.head.extra_len=se),512&r.flags&&(Oe[0]=255&se,Oe[1]=se>>>8&255,r.check=o(r.check,Oe,2,0)),se=0,ce=0}else r.head&&(r.head.extra=null);r.mode=O;case O:if(1024&r.flags&&((de=r.length)>oe&&(de=oe),de&&(r.head&&(Te=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),i.arraySet(r.head.extra,ee,re,de,Te)),512&r.flags&&(r.check=o(r.check,ee,de,re)),oe-=de,re+=de,r.length-=de),r.length))break e;r.length=0,r.mode=A;case A:if(2048&r.flags){if(0===oe)break e;de=0;do{Te=ee[re+de++],r.head&&Te&&r.length<65536&&(r.head.name+=String.fromCharCode(Te))}while(Te&&de<oe);if(512&r.flags&&(r.check=o(r.check,ee,de,re)),oe-=de,re+=de,Te)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=P;case P:if(4096&r.flags){if(0===oe)break e;de=0;do{Te=ee[re+de++],r.head&&Te&&r.length<65536&&(r.head.comment+=String.fromCharCode(Te))}while(Te&&de<oe);if(512&r.flags&&(r.check=o(r.check,ee,de,re)),oe-=de,re+=de,Te)break e}else r.head&&(r.head.comment=null);r.mode=R;case R:if(512&r.flags){for(;ce<16;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}if(se!==(65535&r.check)){e.msg="header crc mismatch",r.mode=J;break}se=0,ce=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=L;break;case I:for(;ce<32;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}e.adler=r.check=ie(se),se=0,ce=0,r.mode=D;case D:if(0===r.havedict)return e.next_out=ne,e.avail_out=ae,e.next_in=re,e.avail_in=oe,r.hold=se,r.bits=ce,g;e.adler=r.check=1,r.mode=L;case L:if(t===h||t===m)break e;case M:if(r.last){se>>>=7&ce,ce-=7&ce,r.mode=Y;break}for(;ce<3;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}switch(r.last=1&se,ce-=1,3&(se>>>=1)){case 0:r.mode=k;break;case 1:if(he(r),r.mode=B,t===m){se>>>=2,ce-=2;break e}break;case 2:r.mode=U;break;case 3:e.msg="invalid block type",r.mode=J}se>>>=2,ce-=2;break;case k:for(se>>>=7&ce,ce-=7&ce;ce<32;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}if((65535&se)!=(se>>>16^65535)){e.msg="invalid stored block lengths",r.mode=J;break}if(r.length=65535&se,se=0,ce=0,r.mode=N,t===m)break e;case N:r.mode=F;case F:if(de=r.length){if(de>oe&&(de=oe),de>ae&&(de=ae),0===de)break e;i.arraySet(te,ee,re,de,ne),oe-=de,re+=de,ae-=de,ne+=de,r.length-=de;break}r.mode=L;break;case U:for(;ce<14;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}if(r.nlen=257+(31&se),se>>>=5,ce-=5,r.ndist=1+(31&se),se>>>=5,ce-=5,r.ncode=4+(15&se),se>>>=4,ce-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=J;break}r.have=0,r.mode=j;case j:for(;r.have<r.ncode;){for(;ce<3;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}r.lens[Ae[r.have++]]=7&se,se>>>=3,ce-=3}for(;r.have<19;)r.lens[Ae[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,we={bits:r.lenbits},Ee=s(c,r.lens,0,19,r.lencode,0,r.work,we),r.lenbits=we.bits,Ee){e.msg="invalid code lengths set",r.mode=J;break}r.have=0,r.mode=V;case V:for(;r.have<r.nlen+r.ndist;){for(;ye=(xe=r.lencode[se&(1<<r.lenbits)-1])>>>16&255,ve=65535&xe,!((ge=xe>>>24)<=ce);){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}if(ve<16)se>>>=ge,ce-=ge,r.lens[r.have++]=ve;else{if(16===ve){for(Ce=ge+2;ce<Ce;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}if(se>>>=ge,ce-=ge,0===r.have){e.msg="invalid bit length repeat",r.mode=J;break}Te=r.lens[r.have-1],de=3+(3&se),se>>>=2,ce-=2}else if(17===ve){for(Ce=ge+3;ce<Ce;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}ce-=ge,Te=0,de=3+(7&(se>>>=ge)),se>>>=3,ce-=3}else{for(Ce=ge+7;ce<Ce;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}ce-=ge,Te=0,de=11+(127&(se>>>=ge)),se>>>=7,ce-=7}if(r.have+de>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=J;break}for(;de--;)r.lens[r.have++]=Te}}if(r.mode===J)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=J;break}if(r.lenbits=9,we={bits:r.lenbits},Ee=s(l,r.lens,0,r.nlen,r.lencode,0,r.work,we),r.lenbits=we.bits,Ee){e.msg="invalid literal/lengths set",r.mode=J;break}if(r.distbits=6,r.distcode=r.distdyn,we={bits:r.distbits},Ee=s(u,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,we),r.distbits=we.bits,Ee){e.msg="invalid distances set",r.mode=J;break}if(r.mode=B,t===m)break e;case B:r.mode=G;case G:if(oe>=6&&ae>=258){e.next_out=ne,e.avail_out=ae,e.next_in=re,e.avail_in=oe,r.hold=se,r.bits=ce,a(e,ue),ne=e.next_out,te=e.output,ae=e.avail_out,re=e.next_in,ee=e.input,oe=e.avail_in,se=r.hold,ce=r.bits,r.mode===L&&(r.back=-1);break}for(r.back=0;ye=(xe=r.lencode[se&(1<<r.lenbits)-1])>>>16&255,ve=65535&xe,!((ge=xe>>>24)<=ce);){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}if(ye&&0==(240&ye)){for(_e=ge,be=ye,Se=ve;ye=(xe=r.lencode[Se+((se&(1<<_e+be)-1)>>_e)])>>>16&255,ve=65535&xe,!(_e+(ge=xe>>>24)<=ce);){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}se>>>=_e,ce-=_e,r.back+=_e}if(se>>>=ge,ce-=ge,r.back+=ge,r.length=ve,0===ye){r.mode=K;break}if(32&ye){r.back=-1,r.mode=L;break}if(64&ye){e.msg="invalid literal/length code",r.mode=J;break}r.extra=15&ye,r.mode=z;case z:if(r.extra){for(Ce=r.extra;ce<Ce;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}r.length+=se&(1<<r.extra)-1,se>>>=r.extra,ce-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=q;case q:for(;ye=(xe=r.distcode[se&(1<<r.distbits)-1])>>>16&255,ve=65535&xe,!((ge=xe>>>24)<=ce);){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}if(0==(240&ye)){for(_e=ge,be=ye,Se=ve;ye=(xe=r.distcode[Se+((se&(1<<_e+be)-1)>>_e)])>>>16&255,ve=65535&xe,!(_e+(ge=xe>>>24)<=ce);){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}se>>>=_e,ce-=_e,r.back+=_e}if(se>>>=ge,ce-=ge,r.back+=ge,64&ye){e.msg="invalid distance code",r.mode=J;break}r.offset=ve,r.extra=15&ye,r.mode=H;case H:if(r.extra){for(Ce=r.extra;ce<Ce;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}r.offset+=se&(1<<r.extra)-1,se>>>=r.extra,ce-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=J;break}r.mode=W;case W:if(0===ae)break e;if(de=ue-ae,r.offset>de){if((de=r.offset-de)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=J;break}de>r.wnext?(de-=r.wnext,pe=r.wsize-de):pe=r.wnext-de,de>r.length&&(de=r.length),fe=r.window}else fe=te,pe=ne-r.offset,de=r.length;de>ae&&(de=ae),ae-=de,r.length-=de;do{te[ne++]=fe[pe++]}while(--de);0===r.length&&(r.mode=G);break;case K:if(0===ae)break e;te[ne++]=r.length,ae--,r.mode=G;break;case Y:if(r.wrap){for(;ce<32;){if(0===oe)break e;oe--,se|=ee[re++]<<ce,ce+=8}if(ue-=ae,e.total_out+=ue,r.total+=ue,ue&&(e.adler=r.check=r.flags?o(r.check,te,ue,ne-ue):n(r.check,te,ue,ne-ue)),ue=ae,(r.flags?se:ie(se))!==r.check){e.msg="incorrect data check",r.mode=J;break}se=0,ce=0}r.mode=$;case $:if(r.wrap&&r.flags){for(;ce<32;){if(0===oe)break e;oe--,se+=ee[re++]<<ce,ce+=8}if(se!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=J;break}se=0,ce=0}r.mode=Z;case Z:Ee=f;break e;case J:Ee=v;break e;case X:return _;case Q:default:return y}return e.next_out=ne,e.avail_out=ae,e.next_in=re,e.avail_in=oe,r.hold=se,r.bits=ce,(r.wsize||ue!==e.avail_out&&r.mode<J&&(r.mode<Y||t!==d))&&me(e,e.output,e.next_out,ue-e.avail_out)?(r.mode=X,_):(le-=e.avail_in,ue-=e.avail_out,e.total_in+=le,e.total_out+=ue,r.total+=ue,r.wrap&&ue&&(e.adler=r.check=r.flags?o(r.check,te,ue,e.next_out-ue):n(r.check,te,ue,e.next_out-ue)),e.data_type=r.bits+(r.last?64:0)+(r.mode===L?128:0)+(r.mode===B||r.mode===N?256:0),(0===le&&0===ue||t===d)&&Ee===p&&(Ee=b),Ee)},t.inflateEnd=function(e){if(!e||!e.state)return y;var t=e.state;return t.window&&(t.window=null),e.state=null,p},t.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?y:(r.head=t,t.done=!1,p):y},t.inflateSetDictionary=function(e,t){var r,i=t.length;return e&&e.state?0!==(r=e.state).wrap&&r.mode!==D?y:r.mode===D&&n(1,t,i,0)!==r.check?v:me(e,t,i,i)?(r.mode=X,_):(r.havedict=1,p):y},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,r){"use strict";e.exports=function(e,t){var r,i,n,o,a,s,c,l,u,d,h,m,p,f,g,y,v,_,b,S,T,E,w,C,x;r=e.state,i=e.next_in,C=e.input,n=i+(e.avail_in-5),o=e.next_out,x=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),c=r.dmax,l=r.wsize,u=r.whave,d=r.wnext,h=r.window,m=r.hold,p=r.bits,f=r.lencode,g=r.distcode,y=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;e:do{p<15&&(m+=C[i++]<<p,p+=8,m+=C[i++]<<p,p+=8),_=f[m&y];t:for(;;){if(m>>>=b=_>>>24,p-=b,0===(b=_>>>16&255))x[o++]=65535&_;else{if(!(16&b)){if(0==(64&b)){_=f[(65535&_)+(m&(1<<b)-1)];continue t}if(32&b){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}S=65535&_,(b&=15)&&(p<b&&(m+=C[i++]<<p,p+=8),S+=m&(1<<b)-1,m>>>=b,p-=b),p<15&&(m+=C[i++]<<p,p+=8,m+=C[i++]<<p,p+=8),_=g[m&v];r:for(;;){if(m>>>=b=_>>>24,p-=b,!(16&(b=_>>>16&255))){if(0==(64&b)){_=g[(65535&_)+(m&(1<<b)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(T=65535&_,p<(b&=15)&&(m+=C[i++]<<p,(p+=8)<b&&(m+=C[i++]<<p,p+=8)),(T+=m&(1<<b)-1)>c){e.msg="invalid distance too far back",r.mode=30;break e}if(m>>>=b,p-=b,T>(b=o-a)){if((b=T-b)>u&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(E=0,w=h,0===d){if(E+=l-b,b<S){S-=b;do{x[o++]=h[E++]}while(--b);E=o-T,w=x}}else if(d<b){if(E+=l+d-b,(b-=d)<S){S-=b;do{x[o++]=h[E++]}while(--b);if(E=0,d<S){S-=b=d;do{x[o++]=h[E++]}while(--b);E=o-T,w=x}}}else if(E+=d-b,b<S){S-=b;do{x[o++]=h[E++]}while(--b);E=o-T,w=x}for(;S>2;)x[o++]=w[E++],x[o++]=w[E++],x[o++]=w[E++],S-=3;S&&(x[o++]=w[E++],S>1&&(x[o++]=w[E++]))}else{E=o-T;do{x[o++]=x[E++],x[o++]=x[E++],x[o++]=x[E++],S-=3}while(S>2);S&&(x[o++]=x[E++],S>1&&(x[o++]=x[E++]))}break}}break}}while(i<n&&o<s);i-=S=p>>3,m&=(1<<(p-=S<<3))-1,e.next_in=i,e.next_out=o,e.avail_in=i<n?n-i+5:5-(i-n),e.avail_out=o<s?s-o+257:257-(o-s),r.hold=m,r.bits=p}},function(e,t,r){"use strict";var i=r(24),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,r,c,l,u,d,h){var m,p,f,g,y,v,_,b,S,T=h.bits,E=0,w=0,C=0,x=0,O=0,A=0,P=0,R=0,I=0,D=0,L=null,M=0,k=new i.Buf16(16),N=new i.Buf16(16),F=null,U=0;for(E=0;E<=15;E++)k[E]=0;for(w=0;w<c;w++)k[t[r+w]]++;for(O=T,x=15;x>=1&&0===k[x];x--);if(O>x&&(O=x),0===x)return l[u++]=20971520,l[u++]=20971520,h.bits=1,0;for(C=1;C<x&&0===k[C];C++);for(O<C&&(O=C),R=1,E=1;E<=15;E++)if(R<<=1,(R-=k[E])<0)return-1;if(R>0&&(0===e||1!==x))return-1;for(N[1]=0,E=1;E<15;E++)N[E+1]=N[E]+k[E];for(w=0;w<c;w++)0!==t[r+w]&&(d[N[t[r+w]]++]=w);if(0===e?(L=F=d,v=19):1===e?(L=n,M-=257,F=o,U-=257,v=256):(L=a,F=s,v=-1),D=0,w=0,E=C,y=u,A=O,P=0,f=-1,g=(I=1<<O)-1,1===e&&I>852||2===e&&I>592)return 1;for(;;){_=E-P,d[w]<v?(b=0,S=d[w]):d[w]>v?(b=F[U+d[w]],S=L[M+d[w]]):(b=96,S=0),m=1<<E-P,C=p=1<<A;do{l[y+(D>>P)+(p-=m)]=_<<24|b<<16|S|0}while(0!==p);for(m=1<<E-1;D&m;)m>>=1;if(0!==m?(D&=m-1,D+=m):D=0,w++,0==--k[E]){if(E===x)break;E=t[r+d[w]]}if(E>O&&(D&g)!==f){for(0===P&&(P=O),y+=C,R=1<<(A=E-P);A+P<x&&!((R-=k[A+P])<=0);)A++,R<<=1;if(I+=1<<A,1===e&&I>852||2===e&&I>592)return 1;l[f=D&g]=O<<24|A<<16|y-u|0}}return 0!==D&&(l[y+D]=E-P<<24|64<<16|0),h.bits=O,0}},function(e,t,r){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(e,t,r){"use strict";var i=r(6),n=r(11),o=r(35),a=r(105),s=r(212),c=function(e,t){var r,i="";for(r=0;r<t;r++)i+=String.fromCharCode(255&e),e>>>=8;return i},l=function(e,t,r,n,l,u){var d,h,m=e.file,p=e.compression,f=u!==o.utf8encode,g=i.transformTo("string",u(m.name)),y=i.transformTo("string",o.utf8encode(m.name)),v=m.comment,_=i.transformTo("string",u(v)),b=i.transformTo("string",o.utf8encode(v)),S=y.length!==m.name.length,T=b.length!==v.length,E="",w="",C="",x=m.dir,O=m.date,A={crc32:0,compressedSize:0,uncompressedSize:0};t&&!r||(A.crc32=e.crc32,A.compressedSize=e.compressedSize,A.uncompressedSize=e.uncompressedSize);var P=0;t&&(P|=8),f||!S&&!T||(P|=2048);var R,I,D,L=0,M=0;x&&(L|=16),"UNIX"===l?(M=798,L|=(R=m.unixPermissions,I=x,D=R,R||(D=I?16893:33204),(65535&D)<<16)):(M=20,L|=63&(m.dosPermissions||0)),d=O.getUTCHours(),d<<=6,d|=O.getUTCMinutes(),d<<=5,d|=O.getUTCSeconds()/2,h=O.getUTCFullYear()-1980,h<<=4,h|=O.getUTCMonth()+1,h<<=5,h|=O.getUTCDate(),S&&(w=c(1,1)+c(a(g),4)+y,E+="up"+c(w.length,2)+w),T&&(C=c(1,1)+c(a(_),4)+b,E+="uc"+c(C.length,2)+C);var k="";return k+="\n\0",k+=c(P,2),k+=p.magic,k+=c(d,2),k+=c(h,2),k+=c(A.crc32,4),k+=c(A.compressedSize,4),k+=c(A.uncompressedSize,4),k+=c(g.length,2),k+=c(E.length,2),{fileRecord:s.LOCAL_FILE_HEADER+k+g+E,dirRecord:s.CENTRAL_FILE_HEADER+c(M,2)+k+c(_.length,2)+"\0\0\0\0"+c(L,4)+c(n,4)+g+E+_}},u=function(e){return s.DATA_DESCRIPTOR+c(e.crc32,4)+c(e.compressedSize,4)+c(e.uncompressedSize,4)};function d(e,t,r,i){n.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=i,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}i.inherits(d,n),d.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,n.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-i-1))/r:100}}))},d.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=l(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,r=l(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),t)this.push({data:u(e),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var r=this.bytesWritten-e,n=function(e,t,r,n,o){var a=i.transformTo("string",o(n));return s.CENTRAL_DIRECTORY_END+"\0\0\0\0"+c(e,2)+c(e,2)+c(t,4)+c(r,4)+c(a.length,2)+a}(this.dirRecords.length,r,e,this.zipComment,this.encodeFileName);this.push({data:n,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},d.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(e){var t=this._sources;if(!n.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(e){}return!0},d.prototype.lock=function(){n.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},e.exports=d},function(e,t,r){"use strict";var i=r(6),n=r(11);function o(e,t){n.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}i.inherits(o,n),o.prototype._bindStream=function(e){var t=this;this._stream=e,e.pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},o.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=o},function(e,t,r){"use strict";var i=r(6),n=r(51),o=r(35),a=(i=r(6),r(423)),s=r(205),c=r(73);function l(e){return new n.Promise((function(t,r){var i=e.decompressed.getContentWorker().pipe(new s);i.on("error",(function(e){r(e)})).on("end",(function(){i.streamInfo.crc32!==e.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}e.exports=function(e,t){var r=this;return t=i.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),c.isNode&&c.isStream(e)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var r=new a(t);return r.load(e),r})).then((function(e){var r=[n.Promise.resolve(e)],i=e.files;if(t.checkCRC32)for(var o=0;o<i.length;o++)r.push(l(i[o]));return n.Promise.all(r)})).then((function(e){for(var i=e.shift(),n=i.files,o=0;o<n.length;o++){var a=n[o];r.file(a.fileNameStr,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:t.createFolders})}return i.zipComment.length&&(r.comment=i.zipComment),r}))}},function(e,t,r){"use strict";var i=r(213),n=r(6),o=r(212),a=r(426),s=(r(35),r(22));function c(e){this.files=[],this.loadOptions=e}c.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(t)+", expected "+n.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var i=this.reader.readString(4)===t;return this.reader.setIndex(r),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",r=n.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,i=this.zip64EndOfCentralSize-44;0<i;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(e<0)throw!this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory");this.reader.setIndex(e);var t=e;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var i=t-r;if(i>0)this.isSignature(t,o.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(e){this.reader=i(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=c},function(e,t,r){"use strict";var i=r(215);function n(e){i.call(this,e)}r(6).inherits(n,i),n.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},n.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},n.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=n},function(e,t,r){"use strict";var i=r(216);function n(e){i.call(this,e)}r(6).inherits(n,i),n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},e.exports=n},function(e,t,r){"use strict";var i=r(213),n=r(6),o=r(104),a=r(105),s=r(35),c=r(206),l=r(22);function u(e,t){this.options=e,this.loadOptions=t}u.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in c)if(c.hasOwnProperty(t)&&c[t].magic===e)return c[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===e&&(this.dosPermissions=63&this.externalFileAttributes),3===e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=i(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,r,i,n=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index<n;)t=e.readInt(2),r=e.readInt(2),i=e.readData(r),this.extraFields[t]={id:t,length:r,value:i}},handleUTF8:function(){var e=l.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=n.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var o=n.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=i(e.value);return 1!==t.readInt(1)?null:a(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=i(e.value);return 1!==t.readInt(1)?null:a(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},e.exports=u},function(e,t,r){"use strict";e.exports=r(428)},function(e,t,r){"use strict";var i=e.exports=r(429);i.build="full",i.tokenize=r(227),i.parse=r(442),i.common=r(443),i.Root._configure(i.Type,i.parse,i.common)},function(e,t,r){"use strict";var i=e.exports=r(217);i.build="light",i.load=function(e,t,r){return"function"==typeof t?(r=t,t=new i.Root):t||(t=new i.Root),t.load(e,r)},i.loadSync=function(e,t){return t||(t=new i.Root),t.loadSync(e)},i.encoder=r(222),i.decoder=r(223),i.verifier=r(224),i.converter=r(225),i.ReflectionObject=r(38),i.Namespace=r(52),i.Root=r(114),i.Enum=r(14),i.Type=r(109),i.Field=r(27),i.OneOf=r(74),i.MapField=r(110),i.Service=r(111),i.Method=r(112),i.Message=r(113),i.wrappers=r(226),i.types=r(39),i.util=r(7),i.ReflectionObject._configure(i.Root),i.Namespace._configure(i.Type,i.Service,i.Enum),i.Root._configure(i.Type),i.Field._configure(i.Type)},function(e,t,r){"use strict";var i=t;i.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var n=new Array(64),o=new Array(123),a=0;a<64;)o[n[a]=a<26?a+65:a<52?a+71:a<62?a-4:a-59|43]=a++;i.encode=function(e,t,r){for(var i,o=null,a=[],s=0,c=0;t<r;){var l=e[t++];switch(c){case 0:a[s++]=n[l>>2],i=(3&l)<<4,c=1;break;case 1:a[s++]=n[i|l>>4],i=(15&l)<<2,c=2;break;case 2:a[s++]=n[i|l>>6],a[s++]=n[63&l],c=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return c&&(a[s++]=n[i],a[s++]=61,1===c&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))};i.decode=function(e,t,r){for(var i,n=r,a=0,s=0;s<e.length;){var c=e.charCodeAt(s++);if(61===c&&a>1)break;if(void 0===(c=o[c]))throw Error("invalid encoding");switch(a){case 0:i=c,a=1;break;case 1:t[r++]=i<<2|(48&c)>>4,i=c,a=2;break;case 2:t[r++]=(15&i)<<4|(60&c)>>2,i=c,a=3;break;case 3:t[r++]=(3&i)<<6|c,a=0}}if(1===a)throw Error("invalid encoding");return r-n},i.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},function(e,t,r){"use strict";function i(){this._listeners={}}e.exports=i,i.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},i.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],i=0;i<r.length;)r[i].fn===t?r.splice(i,1):++i;return this},i.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],i=1;i<arguments.length;)r.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,r)}return this}},function(e,t,r){"use strict";function i(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),i=128===r[3];function n(e,i,n){t[0]=e,i[n]=r[0],i[n+1]=r[1],i[n+2]=r[2],i[n+3]=r[3]}function o(e,i,n){t[0]=e,i[n]=r[3],i[n+1]=r[2],i[n+2]=r[1],i[n+3]=r[0]}function a(e,i){return r[0]=e[i],r[1]=e[i+1],r[2]=e[i+2],r[3]=e[i+3],t[0]}function s(e,i){return r[3]=e[i],r[2]=e[i+1],r[1]=e[i+2],r[0]=e[i+3],t[0]}e.writeFloatLE=i?n:o,e.writeFloatBE=i?o:n,e.readFloatLE=i?a:s,e.readFloatBE=i?s:a}():function(){function t(e,t,r,i){var n=t<0?1:0;if(n&&(t=-t),0===t)e(1/t>0?0:2147483648,r,i);else if(isNaN(t))e(2143289344,r,i);else if(t>34028234663852886e22)e((n<<31|2139095040)>>>0,r,i);else if(t<11754943508222875e-54)e((n<<31|Math.round(t/1401298464324817e-60))>>>0,r,i);else{var o=Math.floor(Math.log(t)/Math.LN2);e((n<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,r,i)}}function r(e,t,r){var i=e(t,r),n=2*(i>>31)+1,o=i>>>23&255,a=8388607&i;return 255===o?a?NaN:n*(1/0):0===o?1401298464324817e-60*n*a:n*Math.pow(2,o-150)*(a+8388608)}e.writeFloatLE=t.bind(null,n),e.writeFloatBE=t.bind(null,o),e.readFloatLE=r.bind(null,a),e.readFloatBE=r.bind(null,s)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),i=128===r[7];function n(e,i,n){t[0]=e,i[n]=r[0],i[n+1]=r[1],i[n+2]=r[2],i[n+3]=r[3],i[n+4]=r[4],i[n+5]=r[5],i[n+6]=r[6],i[n+7]=r[7]}function o(e,i,n){t[0]=e,i[n]=r[7],i[n+1]=r[6],i[n+2]=r[5],i[n+3]=r[4],i[n+4]=r[3],i[n+5]=r[2],i[n+6]=r[1],i[n+7]=r[0]}function a(e,i){return r[0]=e[i],r[1]=e[i+1],r[2]=e[i+2],r[3]=e[i+3],r[4]=e[i+4],r[5]=e[i+5],r[6]=e[i+6],r[7]=e[i+7],t[0]}function s(e,i){return r[7]=e[i],r[6]=e[i+1],r[5]=e[i+2],r[4]=e[i+3],r[3]=e[i+4],r[2]=e[i+5],r[1]=e[i+6],r[0]=e[i+7],t[0]}e.writeDoubleLE=i?n:o,e.writeDoubleBE=i?o:n,e.readDoubleLE=i?a:s,e.readDoubleBE=i?s:a}():function(){function t(e,t,r,i,n,o){var a=i<0?1:0;if(a&&(i=-i),0===i)e(0,n,o+t),e(1/i>0?0:2147483648,n,o+r);else if(isNaN(i))e(0,n,o+t),e(2146959360,n,o+r);else if(i>17976931348623157e292)e(0,n,o+t),e((a<<31|2146435072)>>>0,n,o+r);else{var s;if(i<22250738585072014e-324)e((s=i/5e-324)>>>0,n,o+t),e((a<<31|s/4294967296)>>>0,n,o+r);else{var c=Math.floor(Math.log(i)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(s=i*Math.pow(2,-c))>>>0,n,o+t),e((a<<31|c+1023<<20|1048576*s&1048575)>>>0,n,o+r)}}}function r(e,t,r,i,n){var o=e(i,n+t),a=e(i,n+r),s=2*(a>>31)+1,c=a>>>20&2047,l=4294967296*(1048575&a)+o;return 2047===c?l?NaN:s*(1/0):0===c?5e-324*s*l:s*Math.pow(2,c-1075)*(l+4503599627370496)}e.writeDoubleLE=t.bind(null,n,0,4),e.writeDoubleBE=t.bind(null,o,4,0),e.readDoubleLE=r.bind(null,a,0,4),e.readDoubleBE=r.bind(null,s,4,0)}(),e}function n(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function o(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function a(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=i(i)},function(e,t,r){"use strict";var i=t;i.length=function(e){for(var t=0,r=0,i=0;i<e.length;++i)(r=e.charCodeAt(i))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t},i.read=function(e,t,r){if(r-t<1)return"";for(var i,n=null,o=[],a=0;t<r;)(i=e[t++])<128?o[a++]=i:i>191&&i<224?o[a++]=(31&i)<<6|63&e[t++]:i>239&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(i>>10),o[a++]=56320+(1023&i)):o[a++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,o)),a=0);return n?(a&&n.push(String.fromCharCode.apply(String,o.slice(0,a))),n.join("")):String.fromCharCode.apply(String,o.slice(0,a))},i.write=function(e,t,r){for(var i,n,o=r,a=0;a<e.length;++a)(i=e.charCodeAt(a))<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=63&i|128):55296==(64512&i)&&56320==(64512&(n=e.charCodeAt(a+1)))?(i=65536+((1023&i)<<10)+(1023&n),++a,t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=63&i|128);return r-o}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=r||8192,n=i>>>1,o=null,a=i;return function(r){if(r<1||r>n)return e(r);a+r>i&&(o=e(i),a=0);var s=t.call(o,a,a+=r);return 7&a&&(a=1+(7|a)),s}}},function(e,t,r){"use strict";e.exports=n;var i=r(16);function n(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=n.zero=new n(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var a=n.zeroHash="\0\0\0\0\0\0\0\0";n.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var r=e>>>0,i=(e-r)/4294967296>>>0;return t&&(i=~i>>>0,r=~r>>>0,++r>4294967295&&(r=0,++i>4294967295&&(i=0))),new n(r,i)},n.from=function(e){if("number"==typeof e)return n.fromNumber(e);if(i.isString(e)){if(!i.Long)return n.fromNumber(parseInt(e,10));e=i.Long.fromString(e)}return e.low||e.high?new n(e.low>>>0,e.high>>>0):o},n.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},n.prototype.toLong=function(e){return i.Long?new i.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;n.fromHash=function(e){return e===a?o:new n((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},n.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},n.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},n.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},n.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},function(e,t,r){"use strict";e.exports=a;var i=r(107);(a.prototype=Object.create(i.prototype)).constructor=a;var n=r(16),o=n.Buffer;function a(){i.call(this)}a.alloc=function(e){return(a.alloc=n._Buffer_allocUnsafe)(e)};var s=o&&o.prototype instanceof Uint8Array&&"set"===o.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var i=0;i<e.length;)t[r++]=e[i++]};function c(e,t,r){e.length<40?n.utf8.write(e,t,r):t.utf8Write(e,r)}a.prototype.bytes=function(e){n.isString(e)&&(e=n._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(s,t,e),this},a.prototype.string=function(e){var t=o.byteLength(e);return this.uint32(t),t&&this._push(c,t,e),this}},function(e,t,r){"use strict";e.exports=o;var i=r(108);(o.prototype=Object.create(i.prototype)).constructor=o;var n=r(16);function o(e){i.call(this,e)}n.Buffer&&(o.prototype._slice=n.Buffer.prototype.slice),o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len))}},function(e,t,r){"use strict";e.exports=n;var i=r(16);function n(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(n.prototype=Object.create(i.EventEmitter.prototype)).constructor=n,n.prototype.rpcCall=function e(t,r,n,o,a){if(!o)throw TypeError("request must be specified");var s=this;if(!a)return i.asPromise(e,s,t,r,n,o);if(s.rpcImpl)try{return s.rpcImpl(t,r[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,r){if(e)return s.emit("error",e,t),a(e);if(null!==r){if(!(r instanceof n))try{r=n[s.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return s.emit("error",e,t),a(e)}return s.emit("data",r,t),a(null,r)}s.end(!0)}))}catch(e){return s.emit("error",e,t),void setTimeout((function(){a(e)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},n.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(e,t,r){"use strict";function i(e,t){"string"==typeof e&&(t=e,e=void 0);var r=[];function n(e){if("string"!=typeof e){var t=o();if(i.verbose&&console.log("codegen: "+t),t="return "+t,e){for(var a=Object.keys(e),s=new Array(a.length+1),c=new Array(a.length),l=0;l<a.length;)s[l]=a[l],c[l]=e[a[l++]];return s[l]=t,Function.apply(null,s).apply(null,c)}return Function(t)()}for(var u=new Array(arguments.length-1),d=0;d<u.length;)u[d]=arguments[++d];if(d=0,e=e.replace(/%([%dfijs])/g,(function(e,t){var r=u[d++];switch(t){case"d":case"f":return String(Number(r));case"i":return String(Math.floor(r));case"j":return JSON.stringify(r);case"s":return String(r)}return"%"})),d!==u.length)throw Error("parameter count mismatch");return r.push(e),n}function o(i){return"function "+(i||t||"")+"("+(e&&e.join(",")||"")+"){\n  "+r.join("\n  ")+"\n}"}return n.toString=o,n}e.exports=i,i.verbose=!1},function(e,t,r){"use strict";e.exports=o;var i=r(218),n=r(219)("fs");function o(e,t,r){return"function"==typeof t?(r=t,t={}):t||(t={}),r?!t.xhr&&n&&n.readFile?n.readFile(e,(function(i,n){return i&&"undefined"!=typeof XMLHttpRequest?o.xhr(e,t,r):i?r(i):r(null,t.binary?n:n.toString("utf8"))})):o.xhr(e,t,r):i(o,this,e,t)}o.xhr=function(e,t,r){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4===i.readyState){if(0!==i.status&&200!==i.status)return r(Error("status "+i.status));if(t.binary){var e=i.response;if(!e){e=[];for(var n=0;n<i.responseText.length;++n)e.push(255&i.responseText.charCodeAt(n))}return r(null,"undefined"!=typeof Uint8Array?new Uint8Array(e):e)}return r(null,i.responseText)}},t.binary&&("overrideMimeType"in i&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer"),i.open("GET",e),i.send()}},function(e,t,r){"use strict";var i=t,n=i.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},o=i.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),r=n(e),i="";r&&(i=t.shift()+"/");for(var o=0;o<t.length;)".."===t[o]?o>0&&".."!==t[o-1]?t.splice(--o,2):r?t.splice(o,1):++o:"."===t[o]?t.splice(o,1):++o;return i+t.join("/")};i.resolve=function(e,t,r){return r||(t=o(t)),n(t)?t:(r||(e=o(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?o(e+"/"+t):t)}},function(e,t,r){"use strict";e.exports=w,w.filename=null,w.defaults={keepCase:!1};var i=r(227),n=r(114),o=r(109),a=r(27),s=r(110),c=r(74),l=r(14),u=r(111),d=r(112),h=r(39),m=r(7),p=/^[1-9][0-9]*$/,f=/^-?[1-9][0-9]*$/,g=/^0[x][0-9a-fA-F]+$/,y=/^-?0[x][0-9a-fA-F]+$/,v=/^0[0-7]+$/,_=/^-?0[0-7]+$/,b=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,S=/^[a-zA-Z_][a-zA-Z_0-9]*$/,T=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,E=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function w(e,t,r){t instanceof n||(r=t,t=new n),r||(r=w.defaults);var C,x,O,A,P,R=i(e,r.alternateCommentMode||!1),I=R.next,D=R.push,L=R.peek,M=R.skip,k=R.cmnt,N=!0,F=!1,U=t,j=r.keepCase?function(e){return e}:m.camelCase;function V(e,t,r){var i=w.filename;return r||(w.filename=null),Error("illegal "+(t||"token")+" '"+e+"' ("+(i?i+", ":"")+"line "+R.line+")")}function B(){var e,t=[];do{if('"'!==(e=I())&&"'"!==e)throw V(e);t.push(I()),M(e),e=L()}while('"'===e||"'"===e);return t.join("")}function G(e){var t=I();switch(t){case"'":case'"':return D(t),B();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return function(e,t){var r=1;"-"===e.charAt(0)&&(r=-1,e=e.substring(1));switch(e){case"inf":case"INF":case"Inf":return r*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(p.test(e))return r*parseInt(e,10);if(g.test(e))return r*parseInt(e,16);if(v.test(e))return r*parseInt(e,8);if(b.test(e))return r*parseFloat(e);throw V(e,"number",t)}(t,!0)}catch(r){if(e&&T.test(t))return t;throw V(t,"value")}}function z(e,t){var r,i;do{!t||'"'!==(r=L())&&"'"!==r?e.push([i=q(I()),M("to",!0)?q(I()):i]):e.push(B())}while(M(",",!0));M(";")}function q(e,t){switch(e){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!t&&"-"===e.charAt(0))throw V(e,"id");if(f.test(e))return parseInt(e,10);if(y.test(e))return parseInt(e,16);if(_.test(e))return parseInt(e,8);throw V(e,"id")}function H(){if(void 0!==C)throw V("package");if(C=I(),!T.test(C))throw V(C,"name");U=U.define(C),M(";")}function W(){var e,t=L();switch(t){case"weak":e=O||(O=[]),I();break;case"public":I();default:e=x||(x=[])}t=B(),M(";"),e.push(t)}function K(){if(M("="),A=B(),!(F="proto3"===A)&&"proto2"!==A)throw V(A,"syntax");M(";")}function Y(e,t){switch(t){case"option":return J(e,t),M(";"),!0;case"message":return function(e,t){if(!S.test(t=I()))throw V(t,"type name");var r=new o(t);$(r,(function(e){if(!Y(r,e))switch(e){case"map":!function(e){M("<");var t=I();if(void 0===h.mapKey[t])throw V(t,"type");M(",");var r=I();if(!T.test(r))throw V(r,"type");M(">");var i=I();if(!S.test(i))throw V(i,"name");M("=");var n=new s(j(i),q(I()),t,r);$(n,(function(e){if("option"!==e)throw V(e);J(n,e),M(";")}),(function(){ee(n)})),e.add(n)}(r);break;case"required":case"optional":case"repeated":Z(r,e);break;case"oneof":!function(e,t){if(!S.test(t=I()))throw V(t,"name");var r=new c(j(t));$(r,(function(e){"option"===e?(J(r,e),M(";")):(D(e),Z(r,"optional"))})),e.add(r)}(r,e);break;case"extensions":z(r.extensions||(r.extensions=[]));break;case"reserved":z(r.reserved||(r.reserved=[]),!0);break;default:if(!F||!T.test(e))throw V(e);D(e),Z(r,"optional")}})),e.add(r)}(e,t),!0;case"enum":return function(e,t){if(!S.test(t=I()))throw V(t,"name");var r=new l(t);$(r,(function(e){switch(e){case"option":J(r,e),M(";");break;case"reserved":z(r.reserved||(r.reserved=[]),!0);break;default:!function(e,t){if(!S.test(t))throw V(t,"name");M("=");var r=q(I(),!0),i={};$(i,(function(e){if("option"!==e)throw V(e);J(i,e),M(";")}),(function(){ee(i)})),e.add(t,r,i.comment)}(r,e)}})),e.add(r)}(e,t),!0;case"service":return function(e,t){if(!S.test(t=I()))throw V(t,"service name");var r=new u(t);$(r,(function(e){if(!Y(r,e)){if("rpc"!==e)throw V(e);!function(e,t){var r=t;if(!S.test(t=I()))throw V(t,"name");var i,n,o,a,s=t;M("("),M("stream",!0)&&(n=!0);if(!T.test(t=I()))throw V(t);i=t,M(")"),M("returns"),M("("),M("stream",!0)&&(a=!0);if(!T.test(t=I()))throw V(t);o=t,M(")");var c=new d(s,r,i,o,n,a);$(c,(function(e){if("option"!==e)throw V(e);J(c,e),M(";")})),e.add(c)}(r,e)}})),e.add(r)}(e,t),!0;case"extend":return function(e,t){if(!T.test(t=I()))throw V(t,"reference");var r=t;$(null,(function(t){switch(t){case"required":case"repeated":case"optional":Z(e,t,r);break;default:if(!F||!T.test(t))throw V(t);D(t),Z(e,"optional",r)}}))}(e,t),!0}return!1}function $(e,t,r){var i=R.line;if(e&&(e.comment=k(),e.filename=w.filename),M("{",!0)){for(var n;"}"!==(n=I());)t(n);M(";",!0)}else r&&r(),M(";"),e&&"string"!=typeof e.comment&&(e.comment=k(i))}function Z(e,t,r){var i=I();if("group"!==i){if(!T.test(i))throw V(i,"type");var n=I();if(!S.test(n))throw V(n,"name");n=j(n),M("=");var s=new a(n,q(I()),i,t,r);$(s,(function(e){if("option"!==e)throw V(e);J(s,e),M(";")}),(function(){ee(s)})),e.add(s),F||!s.repeated||void 0===h.packed[i]&&void 0!==h.basic[i]||s.setOption("packed",!1,!0)}else!function(e,t){var r=I();if(!S.test(r))throw V(r,"name");var i=m.lcFirst(r);r===i&&(r=m.ucFirst(r));M("=");var n=q(I()),s=new o(r);s.group=!0;var c=new a(i,n,r,t);c.filename=w.filename,$(s,(function(e){switch(e){case"option":J(s,e),M(";");break;case"required":case"optional":case"repeated":Z(s,e);break;default:throw V(e)}})),e.add(s).add(c)}(e,t)}function J(e,t){var r=M("(",!0);if(!T.test(t=I()))throw V(t,"name");var i=t;r&&(M(")"),i="("+i+")",t=L(),E.test(t)&&(i+=t,I())),M("="),X(e,i)}function X(e,t){if(M("{",!0))do{if(!S.test(P=I()))throw V(P,"name");"{"===L()?X(e,t+"."+P):(M(":"),"{"===L()?X(e,t+"."+P):Q(e,t+"."+P,G(!0))),M(",",!0)}while(!M("}",!0));else Q(e,t,G(!0))}function Q(e,t,r){e.setOption&&e.setOption(t,r)}function ee(e){if(M("[",!0)){do{J(e,"option")}while(M(",",!0));M("]")}return e}for(;null!==(P=I());)switch(P){case"package":if(!N)throw V(P);H();break;case"import":if(!N)throw V(P);W();break;case"syntax":if(!N)throw V(P);K();break;case"option":if(!N)throw V(P);J(U,P),M(";");break;default:if(Y(U,P)){N=!1;continue}throw V(P)}return w.filename=null,{package:C,imports:x,weakImports:O,syntax:A,root:t}}},function(e,t,r){"use strict";e.exports=o;var i,n=/\/|\./;function o(e,t){n.test(e)||(e="google/protobuf/"+e+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),o[e]=t}o("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),o("duration",{Duration:i={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),o("timestamp",{Timestamp:i}),o("empty",{Empty:{fields:{}}}),o("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),o("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),o("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),o.get=function(e){return o[e]||null}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e){super(e),Object.setPrototypeOf(this,i.prototype)}}t.default=i,i.LOAD_RENDERER_PLUGIN_FAILURE="Unable to load renderer plugin",i.RENDERER_PLUGIN_ERROR="Error processing renderer plugin",i.RENDERER_PLUGIN_MISSING="No rendering plugin bundled with the schema",i.RENDERER_PLUGIN_ERROR_BOTH_METHODS="Renderer plugin must implement either getGeoJSON or getGeoJSONAsync function (but not both of them).",i.INVALID_RESULT="Renderer plugin returned invalid result.",i.RUNTIME_ERROR="Runtime error in renderer plugin. Open browser's developer tools for more details.",i.SYNTAX_ERROR="Syntax error in renderer plugin. Open browser's developer tools for more details."},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(70);class n extends i.SchemaProviderAbstract{constructor(e,t){super(t),this.m_schemaArchive=e,this.m_params=t}async fetchSchemaDetails(){return this.m_params&&this.m_params.schemaDetails?this.m_params.schemaDetails:void 0}async getSchemaArchive(){return this.m_schemaArchive}}t.FileSchemaProvider=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(70);class n extends i.SchemaProviderAbstract{constructor(e,t,r){super(r),this.m_dataStoreClient=e,this.m_schemaHRN=t,this.m_params=r}async fetchSchemaDetails(){const e=await this.m_dataStoreClient.getSchemaDetails(this.m_schemaHRN).catch(e=>{this.m_logger.info(e.message)});return e?e.schema:void 0}async getSchemaArchive(){return await this.m_dataStoreClient.getSchema(this.m_schemaHRN).catch(e=>{this.m_logger.info(e.message)})||void 0}}t.HRNSchemaProvider=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);t.getCoverageFillShader=function(e){return{transparent:!0,depthTest:!0,vertexShader:"attribute vec3 tileKeyData;\n\n        uniform vec3 uColor;\n        uniform vec3 uHoverColor;\n        uniform vec3 uSelectedColor;\n        uniform vec3 uSelectedHoverColor;\n        uniform vec3 uDecodedColor;\n        uniform vec3 uDecodedHoverColor;\n\n        uniform float uOpacity;\n        uniform float uSelectedOpacity;\n        uniform float uDecodedOpacity;\n\n        uniform vec3 uHighlightedTile;\n        uniform vec3 uSelectedTiles[256];\n        uniform vec3 uDecodedTile;\n\n        varying vec3 vColor;\n        varying float vOpacity;\n\n        bool isTileSelected(in vec3 tileData) {\n            for (int i = 0; i < 256; ++i) {\n                if (uSelectedTiles[i] == tileData) {\n                    return(true);\n                }\n            }\n\n            return(false);\n        }\n\n        void main() {\n            vColor = uColor;\n            vOpacity = uOpacity;\n\n            if (tileKeyData == uHighlightedTile) {\n                if (tileKeyData == uDecodedTile) {\n                    vColor = uDecodedHoverColor;\n                    vOpacity = uDecodedOpacity;\n                } else if (isTileSelected(tileKeyData)) {\n                    vColor = uSelectedHoverColor;\n                    vOpacity = uSelectedOpacity;\n                } else {\n                    vColor = uHoverColor;\n                }\n            } else if (tileKeyData == uDecodedTile) {\n                vColor = uDecodedColor;\n                vOpacity = uDecodedOpacity;\n            } else if (isTileSelected(tileKeyData)) {\n                vColor = uSelectedColor;\n                vOpacity = uSelectedOpacity;\n            }\n\n            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n            gl_Position = projectionMatrix * mvPosition;\n        }",fragmentShader:"varying float vOpacity;\n            varying vec3 vColor;\n\n            void main() {\n                gl_FragColor = vec4(vColor, vOpacity);\n            }",uniforms:{uColor:{type:"vec3",value:new i.Color(e.color).toArray()},uHoverColor:{type:"vec3",value:new i.Color(e.hoverColor).toArray()},uOpacity:{type:"f",value:e.opacity},uSelectedColor:{type:"vec3",value:new i.Color(e.selectedColor).toArray()},uSelectedHoverColor:{type:"vec3",value:new i.Color(e.selectedHoverColor).toArray()},uSelectedOpacity:{type:"f",value:e.selectedOpacity},uDecodedColor:{type:"vec3",value:new i.Color(e.decodedColor).toArray()},uDecodedHoverColor:{type:"vec3",value:new i.Color(e.decodedHoverColor).toArray()},uDecodedOpacity:{type:"f",value:e.decodedOpacity},uHighlightedTile:{type:"vec3",value:new i.Vector3(0,0,0)},uSelectedTiles:{type:"fv",value:new Array(768).fill(0)},uDecodedTile:{type:"vec3",value:[]}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);t.getCoverageGridShader=function(e){return{transparent:!0,depthTest:!0,vertexShader:"attribute vec3 tileKeyData;\n        attribute float vertexData;\n\n        uniform vec3 uColor;\n        uniform vec3 uHighlightColor;\n        uniform vec3 uSelectedColor;\n        uniform vec3 uSelectedHoverColor;\n        uniform vec3 uDecodedColor;\n\n        uniform vec3 uHighlightedTile;\n        uniform vec3 uLastSelectedTile;\n        uniform vec3 uDecodedTile;\n\n        varying vec3 vColor;\n\n        bool vertexTouchesTile(vec3 vertex, vec3 tile) {\n            if (vertex.z != tile.z) {\n                return(false);\n            }\n\n            if (vertex.x == tile.x) {\n                // same row\n\n                if (vertex.y == tile.y - 1.0) {\n                    // tile to the left\n                    if (vertexData == 1.0) {\n                        return(true);\n                    }\n                }\n\n                if (vertex.y == tile.y + 1.0) {\n                    // tile to the right\n                    if (vertexData == 3.0) {\n                        return(true);\n                    }\n                }\n            }\n\n            if (vertex.y == tile.y) {\n                // same column\n\n                if (vertex.x == tile.x - 1.0) {\n                    // tile below\n                    if (vertexData == 2.0) {\n                        return(true);\n                    }\n                }\n\n                if (vertex.x == tile.x + 1.0) {\n                    // tile above\n                    if (vertexData == 0.0) {\n                        return(true);\n                    }\n                }\n            }\n\n            return(false);\n        }\n\n        bool isLastSelectedTile(in vec3 tileData) {\n            if (tileData == uLastSelectedTile) {\n                return(true);\n            }\n\n            return(false);\n        }\n\n        bool isTileHighlighted(in vec3 tileData) {\n            if (tileData == uHighlightedTile || vertexTouchesTile(tileData, uHighlightedTile)) {\n                return(true);\n            }\n\n            return(false);\n        }\n\n        void main() {\n            vColor = uColor;\n\n            if (tileKeyData == uDecodedTile || vertexTouchesTile(tileKeyData, uDecodedTile)) {\n                vColor = uDecodedColor;\n            }\n\n            bool isLastSelected = isLastSelectedTile(tileKeyData);\n            bool isHighlighted = isTileHighlighted(tileKeyData);\n\n            if (isHighlighted) {\n                vColor = uHighlightColor;\n            }\n\n            if (isLastSelected || vertexTouchesTile(tileKeyData, uLastSelectedTile)) {\n                vColor = uSelectedHoverColor;\n            }\n\n            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n            gl_Position = projectionMatrix * mvPosition;\n        }",fragmentShader:"uniform float uOpacity;\n\n            varying vec3 vColor;\n\n            void main() {\n                gl_FragColor = vec4(vColor, uOpacity);\n            }",uniforms:{uColor:{type:"vec3",value:new i.Color(e.borderColor).toArray()},uOpacity:{type:"f",value:e.borderOpacity},uHighlightColor:{type:"vec3",value:new i.Color(e.highlightColor).toArray()},uSelectedColor:{type:"vec3",value:new i.Color(e.selectedColor).toArray()},uSelectedHoverColor:{type:"vec3",value:new i.Color(e.selectedHoverColor).toArray()},uDecodedColor:{type:"vec3",value:new i.Color(e.decodedColor).toArray()},uHighlightedTile:{type:"vec3",value:new i.Vector3(0,0,0)},uLastSelectedTile:{type:"vec3",value:new i.Vector3(0,0,0)},uDecodedTile:{type:"vec3",value:[]}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0);t.getHeatmapShader=function(e){return{transparent:!0,depthTest:!0,vertexShader:"attribute float sizeData;\n        attribute float timeData;\n\n        uniform vec3 uCoverageColor;\n        uniform float uOpacity;\n        uniform float uSizeMapOpacity;\n        uniform float uTimeMapOpacity;\n        uniform float uMaxSize;\n        uniform int uShowSizeMap;\n        uniform int uShowTimeMap;\n\n        varying vec3 vColor;\n        varying float vOpacity;\n\n        void main() {\n            vOpacity = uOpacity;\n            vColor = uCoverageColor;\n\n            float heatmapData = -1.0;\n\n            if (uShowSizeMap == 1) {\n                heatmapData = sizeData;\n                vOpacity = uSizeMapOpacity;\n            }\n\n            if (uShowTimeMap == 1) {\n                heatmapData = timeData;\n                vOpacity = uTimeMapOpacity;\n            }\n\n            if (heatmapData > -1.0) {\n                float red = 1.0;\n                float green = 1.0;\n                float blue = 0.0;\n\n                float scale = uMaxSize / 4.0;\n                if (heatmapData > scale) {\n                    green = 1.0 - (heatmapData - scale) / scale / 3.0;\n                } else {\n                    blue = 1.0 - heatmapData / scale;\n                }\n\n                vColor = vec3(red, green, blue);\n            }\n\n            vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n            gl_Position = projectionMatrix * mvPosition;\n        }",fragmentShader:"uniform int uIsHidden;\n            varying vec3 vColor;\n            varying float vOpacity;\n\n            void main() {\n                if (uIsHidden == 1) {\n                    discard;\n                } else {\n                    gl_FragColor = vec4(vColor, vOpacity);\n                }\n            }",uniforms:{uCoverageColor:{type:"vec3",value:new i.Color(e.fillColor).toArray()},uMaxSize:{type:"f",value:255},uOpacity:{type:"f",value:e.opacity},uSizeMapOpacity:{type:"f",value:e.opacity},uTimeMapOpacity:{type:"f",value:e.opacity},uShowSizeMap:{type:"i",value:0},uShowTimeMap:{type:"i",value:0},uIsHidden:{type:"i",value:1}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(12),n=r(69),o=r(0),a=r(117),s=r(75),c=r(451);var l;function u(e){return e.kind===l.MoveTo}function d(e){return e.kind===l.LineTo}function h(e){return e.kind===l.ClosePath}function m(e,t){if(e.layers)for(const r of e.layers)t.visitLayer&&!t.visitLayer(r)||p(r,t),t.endVisitLayer&&t.endVisitLayer(r)}function p(e,t){if((!t.visitLayer||t.visitLayer(e))&&e.features)for(const r of e.features)switch(r.type){case c.com.mapbox.pb.Tile.GeomType.UNKNOWN:break;case c.com.mapbox.pb.Tile.GeomType.POINT:t.visitPointFeature&&t.visitPointFeature(r);break;case c.com.mapbox.pb.Tile.GeomType.LINESTRING:t.visitLineFeature&&t.visitLineFeature(r);break;case c.com.mapbox.pb.Tile.GeomType.POLYGON:t.visitPolygonFeature&&t.visitPolygonFeature(r)}t.endVisitLayer&&t.endVisitLayer(e)}!function(e){e[e.MoveTo=1]="MoveTo",e[e.LineTo=2]="LineTo",e[e.ClosePath=7]="ClosePath"}(l=t.CommandKind||(t.CommandKind={})),t.isMoveToCommand=u,t.isLineToCommand=d,t.isClosePathCommand=h,t.visitOmv=m,t.visitOmvLayer=p;class f{accept(e,t,r){const{keys:i,values:n}=e,o=t.tags;if(o&&i&&n)for(let e=0;e<o.length;e+=2){const t=i[o[e]],a=n[o[e+1]];if(!r.visitAttribute(t,a))break}}}t.FeatureAttributes=f;class g{accept(e,t){const r=e.length;let i=0,n=0;const a=[],s=[],c=[];for(let u=0;u<r;){const r=7&e[u],d=e[u]>>3;if(++u,r===l.MoveTo||r===l.LineTo)for(let l=0;l<d;++l){const l=e[u++],d=e[u++];i+=l>>1^-(1&l),n+=d>>1^-(1&d),"Polygon"===t.type&&(a.push(i),s.push(n));const h=new o.Vector2(i,n);c.push({kind:r,position:h})}else{for(const e of c)t.visitCommand(e);t.visitCommand({kind:r}),a.length=0,s.length=0,c.length=0}}if(c.length>0)for(const e of c)t.visitCommand(e)}}t.GeometryCommands=g;const y=["stringValue","floatValue","doubleValue","intValue","uintValue","sintValue","boolValue"];function v(e,t,r={}){const i=new f,o=r||{};return i.accept(e,t,{visitAttribute:(e,t)=>(o[function(e){switch(e){case"id":return"$id";default:return e}}(e)]=function(e){const t=Object.prototype.hasOwnProperty;for(const r of y)if(t.call(e,r)){const t=e[r];if(void 0===t)throw new Error("unpexted undefined value");return n.isLong(t)?t.toNumber():t}throw new Error("not happening")}(t),!0)}),o}function _(e,t,r,o,a,s,c){const l={$layer:e.name,$level:o,$zoom:Math.max(0,o-(a||0)),$geometryType:r};if(void 0!==t.id){const e=function(e,t){if(void 0!==e.id){if("number"==typeof e.id)return e.id;if(n.isLong(e.id))return e.id.greaterThan(Number.MAX_SAFE_INTEGER)&&void 0!==t&&t.error("Invalid ID: Larger than largest available Number in feature: ",e),e.id.toNumber()}}(t,s);void 0!==e&&(l.$id=e)}return v(e,t,l),new i.MapEnv(l,c)}function b(e){if(void 0===e)return a.OmvGeometryType.UNKNOWN;switch(e.type){case c.com.mapbox.pb.Tile.GeomType.UNKNOWN:return a.OmvGeometryType.UNKNOWN;case c.com.mapbox.pb.Tile.GeomType.POINT:return a.OmvGeometryType.POINT;case c.com.mapbox.pb.Tile.GeomType.LINESTRING:return a.OmvGeometryType.LINESTRING;case c.com.mapbox.pb.Tile.GeomType.POLYGON:return a.OmvGeometryType.POLYGON;default:return a.OmvGeometryType.UNKNOWN}}t.OmvProtobufDataAdapter=class{constructor(e,t,r){this.id="omv-protobuf",this.m_geometryCommands=new g,this.m_processor=e,this.m_dataFilter=t,this.m_logger=r}get dataFilter(){return this.m_dataFilter}set dataFilter(e){this.m_dataFilter=e}canProcess(e){return s.isArrayBufferLike(e)}process(e,t){const r=new Uint8Array(e),i=c.com.mapbox.pb.Tile.decode(r);this.m_tileKey=t,m(i,this)}visitLayer(e){this.m_layer=e;const t=this.m_tileKey.level,r=e.name;return!(void 0!==this.m_dataFilter&&!this.m_dataFilter.wantsLayer(r,t))}visitPointFeature(e){if(void 0===e.geometry)return;const t=this.m_tileKey.level,r=this.m_layer.name,i=this.m_layer.extent||4096;if(void 0!==this.m_dataFilter&&!this.m_dataFilter.wantsPointFeature(r,b(e),t))return;const n=[];if(this.m_geometryCommands.accept(e.geometry,{type:"Point",visitCommand:e=>{u(e)&&n.push(e.position)}}),0===n.length)return;const o=_(this.m_layer,e,"point",t,this.m_processor.storageLevelOffset,this.m_logger);this.m_processor.processPointFeature(r,i,n,o,t)}visitLineFeature(e){if(void 0===e.geometry)return;const t=this.m_tileKey.level,r=this.m_layer.name,i=this.m_layer.extent||4096;if(void 0!==this.m_dataFilter&&!this.m_dataFilter.wantsLineFeature(r,b(e),t))return;const n=[];let o;if(this.m_geometryCommands.accept(e.geometry,{type:"Line",visitCommand:e=>{u(e)?(o=[e.position],n.push({positions:o})):d(e)&&o.push(e.position)}}),0===n.length)return;const a=_(this.m_layer,e,"line",t,this.m_processor.storageLevelOffset,this.m_logger);this.m_processor.processLineFeature(r,i,n,a,t)}visitPolygonFeature(e){if(void 0===e.geometry)return;const t=this.m_tileKey.level,r=this.m_layer.name,i=this.m_layer.extent||4096;if(void 0!==this.m_dataFilter&&!this.m_dataFilter.wantsPolygonFeature(r,b(e),t))return;const n=[],o={rings:[]};let a;if(this.m_geometryCommands.accept(e.geometry,{type:"Polygon",visitCommand:e=>{u(e)?a=[e.position]:d(e)?a.push(e.position):h(e)&&o.rings.push(a)}}),o.rings.length>0&&n.push(o),0===n.length)return;const s=_(this.m_layer,e,"polygon",t,this.m_processor.storageLevelOffset,this.m_logger);this.m_processor.processPolygonFeature(r,i,n,s,t)}}},function(e,t,r){"use strict";var i,n,o,a=r(231),s=a.Reader,c=a.util,l=a.roots.default||(a.roots.default={});l.com=((o={}).mapbox=((n={}).pb=((i={}).Tile=function(){function e(e){if(this.layers=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.prototype.layers=c.emptyArray,e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new l.com.mapbox.pb.Tile;e.pos<r;){var n=e.uint32();switch(n>>>3){case 3:i.layers&&i.layers.length||(i.layers=[]),i.layers.push(l.com.mapbox.pb.Tile.Layer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof s||(e=new s(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof l.com.mapbox.pb.Tile)return e;var t=new l.com.mapbox.pb.Tile;if(e.layers){if(!Array.isArray(e.layers))throw TypeError(".com.mapbox.pb.Tile.layers: array expected");t.layers=[];for(var r=0;r<e.layers.length;++r){if("object"!=typeof e.layers[r])throw TypeError(".com.mapbox.pb.Tile.layers: object expected");t.layers[r]=l.com.mapbox.pb.Tile.Layer.fromObject(e.layers[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.layers=[]),e.layers&&e.layers.length){r.layers=[];for(var i=0;i<e.layers.length;++i)r.layers[i]=l.com.mapbox.pb.Tile.Layer.toObject(e.layers[i],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},e.GeomType=(t={},(r=Object.create(t))[t[0]="UNKNOWN"]=0,r[t[1]="POINT"]=1,r[t[2]="LINESTRING"]=2,r[t[3]="POLYGON"]=3,r),e.Value=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.stringValue="",e.prototype.floatValue=0,e.prototype.doubleValue=0,e.prototype.intValue=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.uintValue=c.Long?c.Long.fromBits(0,0,!0):0,e.prototype.sintValue=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.boolValue=!1,e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new l.com.mapbox.pb.Tile.Value;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.stringValue=e.string();break;case 2:i.floatValue=e.float();break;case 3:i.doubleValue=e.double();break;case 4:i.intValue=e.int64();break;case 5:i.uintValue=e.uint64();break;case 6:i.sintValue=e.sint64();break;case 7:i.boolValue=e.bool();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof s||(e=new s(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof l.com.mapbox.pb.Tile.Value)return e;var t=new l.com.mapbox.pb.Tile.Value;return null!=e.stringValue&&(t.stringValue=String(e.stringValue)),null!=e.floatValue&&(t.floatValue=Number(e.floatValue)),null!=e.doubleValue&&(t.doubleValue=Number(e.doubleValue)),null!=e.intValue&&(c.Long?(t.intValue=c.Long.fromValue(e.intValue)).unsigned=!1:"string"==typeof e.intValue?t.intValue=parseInt(e.intValue,10):"number"==typeof e.intValue?t.intValue=e.intValue:"object"==typeof e.intValue&&(t.intValue=new c.LongBits(e.intValue.low>>>0,e.intValue.high>>>0).toNumber())),null!=e.uintValue&&(c.Long?(t.uintValue=c.Long.fromValue(e.uintValue)).unsigned=!0:"string"==typeof e.uintValue?t.uintValue=parseInt(e.uintValue,10):"number"==typeof e.uintValue?t.uintValue=e.uintValue:"object"==typeof e.uintValue&&(t.uintValue=new c.LongBits(e.uintValue.low>>>0,e.uintValue.high>>>0).toNumber(!0))),null!=e.sintValue&&(c.Long?(t.sintValue=c.Long.fromValue(e.sintValue)).unsigned=!1:"string"==typeof e.sintValue?t.sintValue=parseInt(e.sintValue,10):"number"==typeof e.sintValue?t.sintValue=e.sintValue:"object"==typeof e.sintValue&&(t.sintValue=new c.LongBits(e.sintValue.low>>>0,e.sintValue.high>>>0).toNumber())),null!=e.boolValue&&(t.boolValue=Boolean(e.boolValue)),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(r.stringValue="",r.floatValue=0,r.doubleValue=0,c.Long){var i=new c.Long(0,0,!1);r.intValue=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.intValue=t.longs===String?"0":0;c.Long?(i=new c.Long(0,0,!0),r.uintValue=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.uintValue=t.longs===String?"0":0,c.Long?(i=new c.Long(0,0,!1),r.sintValue=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.sintValue=t.longs===String?"0":0,r.boolValue=!1}return null!=e.stringValue&&e.hasOwnProperty("stringValue")&&(r.stringValue=e.stringValue),null!=e.floatValue&&e.hasOwnProperty("floatValue")&&(r.floatValue=t.json&&!isFinite(e.floatValue)?String(e.floatValue):e.floatValue),null!=e.doubleValue&&e.hasOwnProperty("doubleValue")&&(r.doubleValue=t.json&&!isFinite(e.doubleValue)?String(e.doubleValue):e.doubleValue),null!=e.intValue&&e.hasOwnProperty("intValue")&&("number"==typeof e.intValue?r.intValue=t.longs===String?String(e.intValue):e.intValue:r.intValue=t.longs===String?c.Long.prototype.toString.call(e.intValue):t.longs===Number?new c.LongBits(e.intValue.low>>>0,e.intValue.high>>>0).toNumber():e.intValue),null!=e.uintValue&&e.hasOwnProperty("uintValue")&&("number"==typeof e.uintValue?r.uintValue=t.longs===String?String(e.uintValue):e.uintValue:r.uintValue=t.longs===String?c.Long.prototype.toString.call(e.uintValue):t.longs===Number?new c.LongBits(e.uintValue.low>>>0,e.uintValue.high>>>0).toNumber(!0):e.uintValue),null!=e.sintValue&&e.hasOwnProperty("sintValue")&&("number"==typeof e.sintValue?r.sintValue=t.longs===String?String(e.sintValue):e.sintValue:r.sintValue=t.longs===String?c.Long.prototype.toString.call(e.sintValue):t.longs===Number?new c.LongBits(e.sintValue.low>>>0,e.sintValue.high>>>0).toNumber():e.sintValue),null!=e.boolValue&&e.hasOwnProperty("boolValue")&&(r.boolValue=e.boolValue),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},e}(),e.Feature=function(){function e(e){if(this.tags=[],this.geometry=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.id=c.Long?c.Long.fromBits(0,0,!0):0,e.prototype.tags=c.emptyArray,e.prototype.type=0,e.prototype.geometry=c.emptyArray,e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new l.com.mapbox.pb.Tile.Feature;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.id=e.uint64();break;case 2:if(i.tags&&i.tags.length||(i.tags=[]),2==(7&n))for(var o=e.uint32()+e.pos;e.pos<o;)i.tags.push(e.uint32());else i.tags.push(e.uint32());break;case 3:i.type=e.int32();break;case 4:if(i.geometry&&i.geometry.length||(i.geometry=[]),2==(7&n))for(o=e.uint32()+e.pos;e.pos<o;)i.geometry.push(e.uint32());else i.geometry.push(e.uint32());break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof s||(e=new s(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof l.com.mapbox.pb.Tile.Feature)return e;var t=new l.com.mapbox.pb.Tile.Feature;if(null!=e.id&&(c.Long?(t.id=c.Long.fromValue(e.id)).unsigned=!0:"string"==typeof e.id?t.id=parseInt(e.id,10):"number"==typeof e.id?t.id=e.id:"object"==typeof e.id&&(t.id=new c.LongBits(e.id.low>>>0,e.id.high>>>0).toNumber(!0))),e.tags){if(!Array.isArray(e.tags))throw TypeError(".com.mapbox.pb.Tile.Feature.tags: array expected");t.tags=[];for(var r=0;r<e.tags.length;++r)t.tags[r]=e.tags[r]>>>0}switch(e.type){case"UNKNOWN":case 0:t.type=0;break;case"POINT":case 1:t.type=1;break;case"LINESTRING":case 2:t.type=2;break;case"POLYGON":case 3:t.type=3}if(e.geometry){if(!Array.isArray(e.geometry))throw TypeError(".com.mapbox.pb.Tile.Feature.geometry: array expected");for(t.geometry=[],r=0;r<e.geometry.length;++r)t.geometry[r]=e.geometry[r]>>>0}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.tags=[],r.geometry=[]),t.defaults){if(c.Long){var i=new c.Long(0,0,!0);r.id=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.id=t.longs===String?"0":0;r.type=t.enums===String?"UNKNOWN":0}if(null!=e.id&&e.hasOwnProperty("id")&&("number"==typeof e.id?r.id=t.longs===String?String(e.id):e.id:r.id=t.longs===String?c.Long.prototype.toString.call(e.id):t.longs===Number?new c.LongBits(e.id.low>>>0,e.id.high>>>0).toNumber(!0):e.id),e.tags&&e.tags.length){r.tags=[];for(var n=0;n<e.tags.length;++n)r.tags[n]=e.tags[n]}if(null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?l.com.mapbox.pb.Tile.GeomType[e.type]:e.type),e.geometry&&e.geometry.length)for(r.geometry=[],n=0;n<e.geometry.length;++n)r.geometry[n]=e.geometry[n];return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},e}(),e.Layer=function(){function e(e){if(this.features=[],this.keys=[],this.values=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.version=1,e.prototype.name="",e.prototype.features=c.emptyArray,e.prototype.keys=c.emptyArray,e.prototype.values=c.emptyArray,e.prototype.extent=4096,e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new l.com.mapbox.pb.Tile.Layer;e.pos<r;){var n=e.uint32();switch(n>>>3){case 15:i.version=e.uint32();break;case 1:i.name=e.string();break;case 2:i.features&&i.features.length||(i.features=[]),i.features.push(l.com.mapbox.pb.Tile.Feature.decode(e,e.uint32()));break;case 3:i.keys&&i.keys.length||(i.keys=[]),i.keys.push(e.string());break;case 4:i.values&&i.values.length||(i.values=[]),i.values.push(l.com.mapbox.pb.Tile.Value.decode(e,e.uint32()));break;case 5:i.extent=e.uint32();break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("version"))throw c.ProtocolError("missing required 'version'",{instance:i});if(!i.hasOwnProperty("name"))throw c.ProtocolError("missing required 'name'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof s||(e=new s(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof l.com.mapbox.pb.Tile.Layer)return e;var t=new l.com.mapbox.pb.Tile.Layer;if(null!=e.version&&(t.version=e.version>>>0),null!=e.name&&(t.name=String(e.name)),e.features){if(!Array.isArray(e.features))throw TypeError(".com.mapbox.pb.Tile.Layer.features: array expected");t.features=[];for(var r=0;r<e.features.length;++r){if("object"!=typeof e.features[r])throw TypeError(".com.mapbox.pb.Tile.Layer.features: object expected");t.features[r]=l.com.mapbox.pb.Tile.Feature.fromObject(e.features[r])}}if(e.keys){if(!Array.isArray(e.keys))throw TypeError(".com.mapbox.pb.Tile.Layer.keys: array expected");for(t.keys=[],r=0;r<e.keys.length;++r)t.keys[r]=String(e.keys[r])}if(e.values){if(!Array.isArray(e.values))throw TypeError(".com.mapbox.pb.Tile.Layer.values: array expected");for(t.values=[],r=0;r<e.values.length;++r){if("object"!=typeof e.values[r])throw TypeError(".com.mapbox.pb.Tile.Layer.values: object expected");t.values[r]=l.com.mapbox.pb.Tile.Value.fromObject(e.values[r])}}return null!=e.extent&&(t.extent=e.extent>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.features=[],r.keys=[],r.values=[]),t.defaults&&(r.name="",r.extent=4096,r.version=1),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),e.features&&e.features.length){r.features=[];for(var i=0;i<e.features.length;++i)r.features[i]=l.com.mapbox.pb.Tile.Feature.toObject(e.features[i],t)}if(e.keys&&e.keys.length)for(r.keys=[],i=0;i<e.keys.length;++i)r.keys[i]=e.keys[i];if(e.values&&e.values.length)for(r.values=[],i=0;i<e.values.length;++i)r.values[i]=l.com.mapbox.pb.Tile.Value.toObject(e.values[i],t);return null!=e.extent&&e.hasOwnProperty("extent")&&(r.extent=e.extent),null!=e.version&&e.hasOwnProperty("version")&&(r.version=e.version),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},e}(),e}(),i),n),o),e.exports=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(182),o=r(98),a=r(1),s=r(233),c=r(0),l=r(4),u=r(116),d=r(75),h=r(139),m=r(148),p=a.LoggerManager.instance.create("OmvDecodedTileEmitter"),f=new c.Vector3,g=new c.Vector3,y=new c.Vector3,v=new c.Vector3,_=new c.Vector3,b=new c.Vector2,S=new c.Vector2,T=new c.Vector3,E=new c.Vector2,w=new c.Vector2,C=new c.Vector2,x=1e-18,O=5,A=.5,P=Math.PI/8,R=-1;class I{constructor(e){this.type=e,this.positions=[],this.normals=[],this.textureCoordinates=[],this.colors=[],this.extrusionAxis=[],this.indices=[],this.edgeIndices=[],this.groups=[],this.texts=[],this.pathLengths=[],this.stringCatalog=[],this.imageTextures=[],this.featureIds=[],this.featureStarts=[],this.objInfos=[]}addText(e){let t=this.stringCatalog.indexOf(e);return t<0&&(t=this.stringCatalog.length,this.stringCatalog.push(e)),t}}var D;!function(e){e[e.Simple=0]="Simple",e[e.Complex=1]="Complex"}(D=t.LineType||(t.LineType={}));const L=new c.Color;t.OmvDecodedTileEmitter=class{constructor(e,t,r,i,n,o){this.m_decodeInfo=e,this.m_styleSetEvaluator=t,this.m_gatherFeatureIds=r,this.m_skipShortLabels=i,this.m_enableElevationOverlay=n,this.m_languages=o,this.m_meshBuffers=new Map,this.m_geometries=[],this.m_textGeometries=[],this.m_textPathGeometries=[],this.m_pathGeometries=[],this.m_poiGeometries=[],this.m_simpleLines=[],this.m_solidLines=[],this.m_dashedLines=[],this.m_sources=[],this.m_maxGeometryHeight=0}get projection(){return this.m_decodeInfo.targetProjection}get center(){return this.m_decodeInfo.center}processPointFeature(e,t,r,n,o,a){const s=n.env;this.processFeatureCommon(s);for(const e of o){if(void 0===e)continue;const o=e._index,c=this.findOrCreateMeshBuffers(o,i.GeometryType.Point);if(void 0===c)continue;const{positions:l,texts:u,featureIds:m,imageTextures:p,objInfos:f}=c,g=i.isTextTechnique(e)||i.isPoiTechnique(e);let y;const v=i.isPoiTechnique(e);if(v){const t=e;if(y=h.evaluateTechniqueAttr(n,t.imageTexture),void 0!==t.poiName)y=h.evaluateTechniqueAttr(n,t.poiName);else if("string"==typeof t.poiNameField){y=s.lookup(t.poiNameField)}else if("string"==typeof t.imageTextureField){const e=s.lookup(t.imageTextureField);y=i.composeTechniqueTextureName(e,t)}}for(const o of r){if(g){const t=e,r=i.ExtendedTileInfo.getFeatureText(n,t,this.m_languages);void 0!==r&&r.length>0?u.push(c.addText(r)):u.push(R)}d.webMercatorTile2TargetWorld(t,this.m_decodeInfo,o,T),l.push(T.x,T.y,T.z),this.m_gatherFeatureIds&&(m.push(a),f.push(s.entries)),v&&(void 0===y?p.push(R):p.push(c.addText(y)))}}}processLineFeature(e,t,r,n,s,l){const u=n.env;this.processFeatureCommon(u);const m=[],f=[],{projectedTileBounds:g}=this.m_decodeInfo,y=g.max.x-g.min.x,v=g.max.y-g.min.y,_=Math.max(y,v);let b,S;for(const e of s)if(void 0!==e)if(b){const t=this.getTextureCoordinateType(e);a.assert(void 0===t||S===t)}else b=this.getComputeTexCoordsFunc(e),S=this.getTextureCoordinateType(e);for(const e of r){const r=[],i=[];e.positions.forEach(e=>{if(d.webMercatorTile2TargetWorld(t,this.m_decodeInfo,e,T),r.push(T.x,T.y,T.z),b){const{u:r,v:n}=b(e,t);i.push(r,n)}}),m.push(r),f.push(i)}const E=this.m_decodeInfo.tileKey.level>=11;for(const e of s){if(void 0===e)continue;const t=e._index,r=e.name;if(i.isLineTechnique(e)||i.isSolidLineTechnique(e)||i.isDashedLineTechnique(e)){const r=i.isLineTechnique(e)?this.m_simpleLines:i.isSolidLineTechnique(e)?this.m_solidLines:this.m_dashedLines,o=i.isLineTechnique(e)?D.Simple:D.Complex;this.applyLineTechnique(r,e,t,this.m_gatherFeatureIds,o,l,m,n,this.getTextureCoordinateType(e)?f:void 0)}else if(i.isTextTechnique(e)||i.isPoiTechnique(e)||i.isLineMarkerTechnique(e)){const r=e,o=i.ExtendedTileInfo.getFeatureText(n,r,this.m_languages);if(void 0===o||0===o.length)continue;let s=[];if(this.m_skipShortLabels){const e=_/this.m_decodeInfo.tileSizeOnScreen,t=O*o.length*e*A,r=t*t;s=this.splitJaggyLines(m,r,P)}else s=m;if(0===s.length)continue;if(i.isTextTechnique(e)){if(void 0===o)continue;for(const e of s){const r=a.Math2D.computeSquaredLineLength(e);this.m_textPathGeometries.push({technique:t,path:e,pathLengthSqr:r,text:String(o),featureId:l,objInfos:this.m_gatherFeatureIds?u.entries:void 0})}}else{const r=e;let i=h.evaluateTechniqueAttr(n,r.imageTexture);if("string"==typeof r.imageTextureField){i=u.lookup(r.imageTextureField),"string"==typeof r.imageTexturePrefix&&(i=r.imageTexturePrefix+i),"string"==typeof r.imageTexturePostfix&&(i+=r.imageTexturePostfix)}for(const e of s)this.m_poiGeometries.push({technique:t,positions:{name:"position",type:"float",buffer:new Float32Array(e).buffer,itemCount:3},texts:[0],stringCatalog:[o,i],imageTextures:[1],featureId:l,objInfos:this.m_gatherFeatureIds?[u.entries]:void 0})}}else if(i.isLabelRejectionLineTechnique(e)){const e=new c.Vector3;for(const t of m){const r=[];for(let i=0;i<t.length;i+=3)e.set(t[i],t[i+1],t[i+2]),e.add(this.m_decodeInfo.center),r.push(e.clone());this.m_pathGeometries.push({path:r})}}else if(i.isExtrudedLineTechnique(e)){const r=this.findOrCreateMeshBuffers(t,i.GeometryType.ExtrudedLine);if(void 0===r)continue;const{positions:a,indices:s,groups:c,featureIds:d,featureStarts:p,objInfos:f}=r,g=s.length,y=h.evaluateTechniqueAttr(n,e.lineWidth);if(void 0===y)continue;const v=h.evaluateTechniqueAttr(n,e.caps,"Circle"),_=E&&"Circle"===v;m.forEach(e=>{o.triangulateLine(e,y,a,s,_),this.m_gatherFeatureIds&&(d.push(l),p.push(g),f.push(u.entries))});const b=s.length-g;c.push({start:g,count:b,technique:t,featureId:l})}else p.warn(`OmvDecodedTileEmitter#processLineFeature: Invalid line technique\n                     ${r} for layer: ${u.entries.$layer} `)}}processPolygonFeature(e,t,r,n,o,a){const s=n.env;this.processFeatureCommon(s),o.forEach(e=>{if(void 0===e)return;const o=e._index;if(void 0===o)throw new Error("OmvDecodedTileEmitter#processPolygonFeature: Internal error - No technique index");const s=[],c=i.isExtrudedPolygonTechnique(e),l=i.isFillTechnique(e),h=c||l||i.isStandardTechnique(e),m=this.getComputeTexCoordsFunc(e),p=void 0!==m?4:2;for(const e of r){const r=[];for(const i of e.rings){const e=[];for(const r of i)if(e.push(r.x,r.y),void 0!==m){const{u:i,v:n}=m(r,t);e.push(i,n)}r.push(new u.Ring(t,p,e))}s.push(r)}const f=i.isSolidLineTechnique(e)||i.isDashedLineTechnique(e)||i.isLineTechnique(e);if(h)this.applyPolygonTechnique(s,e,o,a,n,t);else if(f){const r="line"===e.name?this.m_simpleLines:"solid-line"===e.name?this.m_solidLines:this.m_dashedLines,i="line"===e.name?D.Simple:D.Complex;s.forEach(s=>{const c=[];s.forEach(e=>{const r=e.contour.length/e.vertexStride;let i=[];for(let n=0;n<r;++n){const o=(n+1)%r,a=e.contour[n*e.vertexStride],s=e.contour[n*e.vertexStride+1],l=e.contour[o*e.vertexStride],u=e.contour[o*e.vertexStride+1],h=!(a<=0&&l<=0||a>=e.extents&&l>=e.extents||s<=0&&u<=0||s>=e.extents&&u>=e.extents);h||0===i.length?h&&0===i.length&&(d.webMercatorTile2TargetWorld(t,this.m_decodeInfo,b.set(a,s),T),i.push(T.x,T.y,T.z)):(c.push(i),i=[]),h&&(d.webMercatorTile2TargetWorld(t,this.m_decodeInfo,b.set(l,u),T),i.push(T.x,T.y,T.z))}i.length&&c.push(i)}),0!==c.length&&this.applyLineTechnique(r,e,o,this.m_gatherFeatureIds,i,a,c,n)})}})}getDecodedTile(){this.createGeometries(),this.processSimpleLines(this.m_simpleLines),this.processLines(this.m_solidLines),this.processLines(this.m_dashedLines);const e={techniques:this.m_styleSetEvaluator.decodedTechniques,geometries:this.m_geometries,decodeTime:void 0};return this.m_textGeometries.length>0&&(e.textGeometries=this.m_textGeometries),this.m_poiGeometries.length>0&&(e.poiGeometries=this.m_poiGeometries),this.m_textPathGeometries.length>0&&(e.textPathGeometries=this.m_textPathGeometries),this.m_pathGeometries.length>0&&(e.pathGeometries=this.m_pathGeometries),0!==this.m_sources.length&&(e.copyrightHolderIds=this.m_sources),e.maxGeometryHeight=this.m_maxGeometryHeight,e}splitJaggyLines(e,t,r){const i=[],n=(e,t,r)=>{let i=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(let s=t;s<r;s+=3){const t=e[s],r=e[s+1];t<i&&(i=t),t>n&&(n=t),r<o&&(o=r),r>a&&(a=r)}return(n-i)*(n-i)+(a-o)*(a-o)},o=e.slice();for(;o.length>0;){const e=o.pop();if(void 0===e||e.length<6)continue;let a=-1;for(let t=0;t<e.length-3;t+=3){E.set(e[t],e[t+1]),w.set(e[t+3],e[t+4]);const i=w.sub(E).normalize();if(t>0){const e=Math.atan2(C.x*i.y-i.x*C.y,i.dot(C));if(Math.abs(e)>r){a=t;break}}C.set(i.x,i.y)}if(a>0){const r=n(e,0,a+3),s=n(e,a,e.length);r>t&&i.push(e.slice(0,a+3)),s>t&&o.push(e.slice(a))}else{n(e,0,e.length)>t&&i.push(e)}}return i}getTextureCoordinateType(e){return(i.isFillTechnique(e)||i.isSolidLineTechnique(e)||i.isDashedLineTechnique(e)||i.isExtrudedPolygonTechnique(e))&&this.m_enableElevationOverlay?i.TextureCoordinateType.TileSpace:i.textureCoordinateType(e)}getComputeTexCoordsFunc(e){const t=this.getTextureCoordinateType(e);return t===i.TextureCoordinateType.TileSpace?(e,t)=>{const{x:r,y:i}=(new c.Vector2).copy(e).divideScalar(t);return{u:r,v:1-i}}:t===i.TextureCoordinateType.EquirectangularSpace?(e,t)=>{const r=d.tile2world(t,this.m_decodeInfo,e,!1,S),{x:i,y:n}=l.normalizedEquirectangularProjection.reprojectPoint(l.webMercatorProjection,new c.Vector3(r.x,r.y,0));return{u:i,v:n}}:void 0}applyLineTechnique(e,t,r,o,a=D.Complex,s,c,l,u){const d=h.evaluateTechniqueAttr(l,t.renderOrderOffset,0);let m;const p=e.find(e=>e.technique===r&&e.renderOrderOffset===d),f=void 0!==u;if(void 0===p){m=new n.LineGroup(f,void 0,a===D.Simple);const c={type:a===D.Complex?i.GeometryType.SolidLine:i.GeometryType.Line,technique:r,renderOrderOffset:void 0!==d?Number(d):void 0,lines:m};!h.evaluateTechniqueAttr(l,t.transient,!1)&&o&&(c.featureIds=[s],c.featureStarts=[0]),e.push(c)}else m=p.lines,o&&p.featureIds&&p.featureStarts&&(p.featureIds.push(s),p.featureStarts.push(m.indices.length));let g=0;c.forEach(e=>{m.add(this.m_decodeInfo.center,e,u?u[g++]:void 0)})}applyPolygonTechnique(e,t,r,n,o,u){const E=i.isExtrudedPolygonTechnique(t),w=E?i.GeometryType.ExtrudedPolygon:i.GeometryType.Polygon,C=this.findOrCreateMeshBuffers(r,w);if(void 0===C)return;const O=t,A=t,P=!1!==O.boundaryWalls,R=i.isFillTechnique(t),I=this.getTextureCoordinateType(t);let D=h.evaluateTechniqueAttr(o,O.height),M=h.evaluateTechniqueAttr(o,O.floorHeight);if(void 0===D){const e=o.env.lookup("height"),t=h.evaluateTechniqueAttr(o,O.defaultHeight);D=void 0!==e?e:void 0!==t?t:0}if(void 0===M){const e=o.env.lookup("min_height");M=void 0===e||R?0:e}D===M&&(D+=x);const k=a.getOptionValue(O.constantHeight,!1);this.m_decodeInfo.tileBounds.getCenter(f);const{positions:N,normals:F,textureCoordinates:U,colors:j,extrusionAxis:V,indices:B,edgeIndices:G,groups:z}=C,q=void 0!==I?4:2,H=q+2,W=this.m_decodeInfo.targetProjection.type===l.ProjectionType.Spherical,K=(E?O.lineWidth||0:R&&A.lineWidth||0)>0;let Y;if(i.isExtrudedPolygonTechnique(t)&&a.getOptionValue(t.vertexColors,!1)){let e=h.evaluateTechniqueAttr(o,t.color);if(void 0===e){const t=o.env.lookup("color");this.isColorStringValid(t)&&(e=String(t))}void 0===e&&(e=h.evaluateTechniqueAttr(o,t.defaultColor,0)),void 0===e&&(e=0),L.set(e),Y=L}for(const t of e){const e=B.length;for(let e=0;e<t.length;){const r=[],i=N.length/3,{contour:n,winding:o}=t[e++];for(let e=0;e<n.length/q;++e){for(let t=0;t<q;++t)r.push((1===t?-1:1)*n[e*q+t]);const t=(e+1)%(n.length/q),i=n[e*q],o=n[e*q+1],a=n[t*q],s=n[t*q+1],c=!(i<=0&&a<=0||i>=u&&a>=u||o<=0&&s<=0||o>=u&&s>=u);r.push(c?t:-1,P||c?t:-1)}const a=[];for(;e<t.length&&t[e].winding!==o;){const i=r.length/H;a.push(i);const n=t[e++].contour;for(let e=0;e<n.length/q;++e){for(let t=0;t<q;++t)r.push((1===t?-1:1)*n[e*q+t]);const t=(e+1)%(n.length/q),o=n[e*q],a=n[e*q+1],s=n[t*q],c=n[t*q+1],l=!(o<=0&&s<=0||o>=u&&s>=u||a<=0&&c<=0||a>=u&&c>=u);r.push(l?i+t:-1,P||l?i+t:-1)}}try{const e=s.default(r,a,H),t=r.length/H;if(W){const t=new c.BufferGeometry,i=[],n=[],o=[],a=[];for(let e=0;e<r.length;e+=H){const t=d.tile2world(u,this.m_decodeInfo,b.set(r[e],r[e+1]),!0,S);i.push(t.x,t.y,0),void 0!==I&&n.push(r[e+2],r[e+3]),o.push(r[e+q]),a.push(r[e+q+1])}const s=new c.BufferAttribute(new Float32Array(i),3);let h;t.setAttribute("position",s),void 0!==I&&(h=new c.BufferAttribute(new Float32Array(n),2),t.setAttribute("uv",h));const p=new c.BufferAttribute(new Float32Array(o),1);t.setAttribute("edge",p);const f=new c.BufferAttribute(new Float32Array(a),1);t.setAttribute("wall",p);const g=new c.BufferAttribute(new Uint32Array(e),1);t.setIndex(g),new m.SphericalGeometrySubdivisionModifier(c.Math.degToRad(10),l.webMercatorProjection).modify(t),r.length=0,e.length=0;for(let e=0;e<s.array.length;e+=3){const t=d.world2tile(u,this.m_decodeInfo,b.set(s.array[e],s.array[e+1]),!0,S);r.push(t.x,t.y),void 0!==I&&(r.push(h.array[e/3*2]),r.push(h.array[e/3*2+1])),r.push(p.array[e/3]),r.push(f.array[e/3])}e.push(...t.getIndex().array)}y.set(0,0,1);for(let e=0;e<r.length;e+=H){d.webMercatorTile2TargetWorld(u,this.m_decodeInfo,b.set(r[e],r[e+1]),T,!0);let t=1;E&&!0!==k&&(g.set(f.x+T.x,f.y+T.y,f.z+T.z),t=this.m_decodeInfo.targetProjection.getScaleFactor(g)),this.m_maxGeometryHeight=Math.max(this.m_maxGeometryHeight,t*D),W&&y.set(T.x,T.y,T.z).add(this.center).normalize(),v.copy(y).multiplyScalar(M*t),_.copy(y).multiplyScalar(D*t),N.push(T.x+v.x,T.y+v.y,T.z+v.z),void 0!==I&&U.push(r[e+2],r[e+3]),this.m_enableElevationOverlay&&F.push(...y.toArray()),E&&(N.push(T.x+_.x,T.y+_.y,T.z+_.z),V.push(_.x-v.x,_.y-v.y,_.z-v.z,0,_.x-v.x,_.y-v.y,_.z-v.z,1),void 0!==I&&U.push(r[e+2],r[e+3]),this.m_enableElevationOverlay&&F.push(...y.toArray()),void 0!==Y&&j.push(Y.r,Y.g,Y.b,Y.r,Y.g,Y.b))}for(let t=0;t<e.length;t+=3)if(E){const r=i+2*e[t+0]+1,n=i+2*e[t+1]+1,o=i+2*e[t+2]+1;B.push(r,n,o)}else{const r=i+e[t+0],n=i+e[t+1],o=i+e[t+2];B.push(r,n,o)}K&&this.addEdges(i,t,H,q,N,r,G,E,O.footprint,O.maxSlope),E&&this.addWalls(i,t,H,q,r,B)}catch(e){p.error("cannot triangulate geometry",e)}}this.m_gatherFeatureIds&&(C.objInfos.push(o.env.entries),C.featureIds.push(n),C.featureStarts.push(e));const i=B.length-e;i>0&&z.push({start:e,count:i,technique:r,featureId:n})}}createGeometries(){this.m_meshBuffers.forEach((e,t)=>{if(0===e.positions.length)return;if(!this.m_styleSetEvaluator.techniques||this.m_styleSetEvaluator.techniques.length<=t)throw new Error("Invalid technique index");const r=this.m_styleSetEvaluator.techniques[t];if(void 0===r)return;const n=new Float32Array(e.positions);if(e.texts.length>0&&i.isTextTechnique(r))return void this.m_textGeometries.push({positions:{name:"position",type:"float",buffer:n.buffer,itemCount:3},texts:e.texts,technique:t,featureId:e.featureIds?e.featureIds[0]:void 0,stringCatalog:e.stringCatalog,objInfos:this.m_gatherFeatureIds?e.objInfos:void 0});if(e.texts.length>0&&i.isPoiTechnique(r))return void this.m_poiGeometries.push({positions:{name:"position",type:"float",buffer:n.buffer,itemCount:3},texts:e.texts,technique:t,featureId:e.featureIds?e.featureIds[0]:void 0,stringCatalog:e.stringCatalog,imageTextures:e.imageTextures,objInfos:e.objInfos});0===e.groups.length&&e.groups.push({start:0,count:n.length/3,technique:t});const o={type:e.type,vertexAttributes:[{name:"position",buffer:n.buffer,itemCount:3,type:"float"}],groups:e.groups};if(e.normals.length>0){const t=new Float32Array(e.normals);a.assert(t.length===n.length,"length of normals buffer is different than the length of the position buffer"),o.vertexAttributes.push({name:"normal",buffer:t.buffer,itemCount:3,type:"float"})}if(e.colors.length>0){const t=new Float32Array(e.colors);a.assert(t.length===n.length,"length of colors buffer is different than the length of the position buffer"),o.vertexAttributes.push({name:"color",buffer:t.buffer,itemCount:3,type:"float"})}if(e.textureCoordinates.length>0){const t=e.positions.length/3,r=e.textureCoordinates.length/2;a.assert(r===t,"length of textureCoordinates buffer is different than the length of theposition buffer");const i=new Float32Array(e.textureCoordinates);o.vertexAttributes.push({name:"uv",buffer:i.buffer,itemCount:2,type:"float"})}if(e.extrusionAxis.length>0){const t=new Float32Array(e.extrusionAxis);a.assert(t.length/4==n.length/3,"length of extrusionAxis buffer is different than the length of the position buffer"),o.vertexAttributes.push({name:"extrusionAxis",buffer:t.buffer,itemCount:4,type:"float"})}e.indices.length>0&&(o.index={name:"index",buffer:new Uint32Array(e.indices).buffer,itemCount:1,type:"uint32"}),e.edgeIndices.length>0&&(o.edgeIndex={name:"edgeIndex",buffer:new Uint32Array(e.edgeIndices).buffer,itemCount:1,type:"uint32"}),this.m_gatherFeatureIds&&(o.featureIds=e.featureIds,o.featureStarts=e.featureStarts,o.objInfos=e.objInfos),this.m_geometries.push(o)})}processLines(e){e.forEach(e=>{const{vertices:t,indices:r}=e.lines,n=e.renderOrderOffset,o=e.technique,a=new Float32Array(t).buffer,s=new Uint32Array(r).buffer,c={type:"float",stride:e.lines.stride,buffer:a,attributes:e.lines.vertexAttributes},l={type:i.GeometryType.SolidLine,index:{buffer:s,itemCount:1,type:"uint32",name:"index"},interleavedVertexAttributes:[c],groups:[{start:0,count:r.length,technique:o,renderOrderOffset:n}],vertexAttributes:[]};this.m_gatherFeatureIds&&(l.featureIds=e.featureIds,l.featureStarts=e.featureStarts),this.m_geometries.push(l)})}processSimpleLines(e){e.forEach(e=>{const{vertices:t,indices:r}=e.lines,n=e.renderOrderOffset,o=e.technique,a=new Float32Array(t).buffer,s=new Uint32Array(r).buffer,c={buffer:a,itemCount:3,type:"float",name:"position"},l={type:i.GeometryType.Line,index:{buffer:s,itemCount:1,type:"uint32",name:"index"},vertexAttributes:[c],groups:[{start:0,count:r.length,technique:o,renderOrderOffset:n}]};this.m_gatherFeatureIds&&(l.featureIds=e.featureIds,l.featureStarts=e.featureStarts),this.m_geometries.push(l)})}findOrCreateMeshBuffers(e,t){let r=this.m_meshBuffers.get(e);return void 0!==r?r.type!==t?void p.error(`MeshBuffer has been created with wrong type "${i.GeometryType[t]}"\n                instead of "${i.GeometryType[r.type]}"`):r:(r=new I(t),this.m_meshBuffers.set(e,r),r)}processFeatureCommon(e){const t=e.lookup("source");"string"==typeof t&&""!==t&&(this.m_sources.includes(t)||this.m_sources.push(t))}isColorStringValid(e){return"string"==typeof e&&e.length>0}addEdges(e,t,r,i,n,o,a,s,l,u){const d=new c.Vector3,h=new c.Vector3;let m,p,f=0,g=0;for(;f<t;){for(;f!==m;){void 0===m&&(m=f),f<t&&(g=Math.max(g,f));const c=o[f*r+i];if(c<0)break;if(s)if(!0===l&&a.push(e+2*f,e+2*c),a.push(e+2*f+1,e+2*c+1),void 0!==u){if(void 0!==p){const t=3*(e+2*p),r=3*(e+2*f),i=3*(e+2*c);d.set(n[r]-n[t],n[r+1]-n[t+1],n[r+2]-n[t+2]).normalize(),h.set(n[i]-n[r],n[i+1]-n[r+1],n[i+2]-n[r+2]).normalize(),d.dot(h)<=u&&a.push(e+2*f,e+2*f+1)}}else a.push(e+2*f,e+2*f+1);else a.push(e+f,e+c);p=f,f=c}f=g+1,m=void 0,p=void 0}}addWalls(e,t,r,i,n,o){let a,s=0,c=0;for(;s<t;){for(;s!==a;){void 0===a&&(a=s),s<t&&(c=Math.max(c,s));const l=n[s*r+i+1];if(l<0)break;o.push(e+2*s,e+2*s+1,e+2*l+1,e+2*l+1,e+2*l,e+2*s),s=l}s=c+1,a=void 0}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(0),o=r(116),a=r(75);t.OmvTileInfoEmitter=class{constructor(e,t,r,n,o){this.m_decodeInfo=e,this.m_styleSetEvaluator=t,this.m_storeExtendedTags=r,this.m_gatherRoadSegments=n,this.m_languages=o,this.m_tileInfo=new i.ExtendedTileInfo(e.tileKey,this.m_storeExtendedTags),this.m_tileInfoWriter=new i.ExtendedTileInfoWriter(this.m_tileInfo,this.m_storeExtendedTags)}processPointFeature(e,t,r,o,s,c){const l=this.m_tileInfoWriter,u=new n.Vector3;for(const e of s){if(void 0===e)continue;const n=l.addTechnique(e),s=i.ExtendedTileInfo.getFeatureText(o,e,this.m_languages);for(const e of r)a.webMercatorTile2TargetWorld(t,this.m_decodeInfo,e,u),l.addFeature(this.m_tileInfo.pointGroup,o.env,c,s,n,i.FeatureGroupType.Point),l.addFeaturePoint(this.m_tileInfo.pointGroup,u.x,u.y)}}processLineFeature(e,t,r,o,s,c){const l=this.m_tileInfoWriter,u=o.env,d=new n.Vector3,h=[];for(const e of r){const r=[];for(const i of e.positions)a.webMercatorTile2TargetWorld(t,this.m_decodeInfo,i,d),r.push(d.x,d.y);h.push(r)}for(const e of s){if(void 0===e)continue;const t=l.addTechnique(e),r=i.ExtendedTileInfo.getFeatureText(o,e,this.m_languages);for(const e of h)l.addFeature(this.m_tileInfo.lineGroup,u,c,r,t,i.FeatureGroupType.Line),l.addFeaturePoints(this.m_tileInfo.lineGroup,e)}if(this.m_gatherRoadSegments){const e=u.lookup("segmentId");if(void 0!==e){const t=u.lookup("startOffset"),r=u.lookup("endOffset");l.addRoadSegments(this.m_tileInfo.lineGroup,e,void 0!==t?t:0,void 0!==r?r:1)}}}processPolygonFeature(e,t,r,s,c,l){if(0===c.length)throw new Error("OmvTileInfoEmitter#processPolygonFeature: Internal error - No technique index");const u=this.m_tileInfoWriter,d=new n.Vector3,h=[];for(const e of r){const r=[];for(const i of e.rings){const e=[];for(const r of i)a.webMercatorTile2TargetWorld(t,this.m_decodeInfo,r,d),e.push(d.x,d.y,d.z);r.push(new o.Ring(t,3,e))}h.push(r)}for(const e of c){if(void 0===e)continue;const t=u.addTechnique(e),r=i.ExtendedTileInfo.getFeatureText(s,e,this.m_languages);u.addFeature(this.m_tileInfo.polygonGroup,s.env,l,r,t,i.FeatureGroupType.Polygon)}for(const e of h){if(0===e.length)continue;const t=e[0].winding;for(const r of e)u.addRingPoints(this.m_tileInfo.polygonGroup,r.contour,r.winding===t)}}getTileInfo(){return this.m_tileInfoWriter.finish(),this.m_tileInfo}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1),n=r(232),o=i.LoggerManager.instance.create("OmvTomTomFeatureModifier"),a="#AAAAAA",s="true",c="2",l="20";class u extends n.OmvGenericFeatureModifier{constructor(e){super(e)}doProcessFeature(e,t,r,i,n){return this.rewriteEnvironment(r,i),super.doProcessFeature(e,t,r,i,n)}rewriteEnvironment(e,t){this.isWood(e)?this.updateEnvironment(t,"landuse","wood"):this.isHospital(e)?this.updateEnvironment(t,"landuse","hospital"):this.isCemetery(e)?this.updateEnvironment(t,"landuse","cemetery"):this.isIndustrial(e)?this.updateEnvironment(t,"landuse","industrial"):this.isPark(e)?this.updateEnvironment(t,"landuse","park"):this.isBuiltup(e)?this.updateEnvironment(t,"landuse","builtup"):this.isWater(e)?this.updateEnvironment(t,"water"):this.isRoadLabel(e)?this.updateEnvironment(t,"road_label"):this.isRoadPath(e)?this.updateEnvironment(t,"road","path"):this.isRoadStreet(e)?this.updateEnvironment(t,"road","street"):this.isRoadPrimary(e)?this.updateEnvironment(t,"road","primary"):this.isRoadSecondary(e)?this.updateEnvironment(t,"road","secondary"):this.isRailway(e)?this.updateEnvironment(t,"road","major_rail"):this.isFerry(e)?this.updateEnvironment(t,"road","ferry"):this.isAeroway(e)?this.updateEnvironment(t,"aeroway"):this.isBorder(e)?this.updateEnvironment(t,"admin"):this.isCountryLabel(e)?this.updateEnvironment(t,"country_label"):this.isCountyLabel(e)?this.updateEnvironment(t,"county_label"):this.isRegionLabel(e)?this.updateEnvironment(t,"region_label"):this.isStateLabel(e)?this.updateEnvironment(t,"state_label"):this.isPlaceLabel(e)?this.updateEnvironment(t,"place_label"):this.isWaterLabel(e)?this.updateEnvironment(t,"water_label"):this.isMarineLabel(e)?this.updateEnvironment(t,"marine_label"):this.isPoiLabel(e)?this.updateEnvironment(t,"poi_label"):this.isBuilding(e)?(this.updateEnvironment(t,"building"),t.entries.color=a,t.entries.extrude=s,t.entries.min_height=c,t.entries.height=l):o.info(`Not yet rewritten layer: ##${t.entries.$layer}## `),this.isTunnel(e)&&(t.entries.structure="tunnel"),this.isBridge(e)&&(t.entries.structure="bridge")}updateEnvironment(e,t,r,i){e.entries.$layer=t,void 0!==r&&(e.entries.class=r),void 0!==i&&(e.entries.structure=i)}isWood(e){return"Woodland"===e||"Moor or heathland"===e}isHospital(e){return"Hospital"===e}isCemetery(e){return"Cemetery"===e}isIndustrial(e){return e.indexOf("Industrial")>=0||"Airport"===e}isPark(e){return"Park"===e||"City park"===e||"National park"===e||"Regional park"===e||e.indexOf("grass")>=0||e.indexOf("greens")>=0}isBuiltup(e){return"Built-up area"===e||"Town paved area"===e||"Shopping"===e||"University"===e||"Stadium"===e||e.indexOf("ground")>0}isWater(e){return"Other water"===e||"Ocean or sea"===e||"Ocean"===e||"Lake"===e||"Sea"===e||"Town swimming pool"===e||"River"===e}isRoadLabel(e){return e.indexOf("road label")>=0}isRoadPath(e){return e.indexOf("path")>0||"Parking road"===e||"Town walkway"===e||"Pedestrian road"===e||"Walkway road"===e||"Town carriageway divider"===e||"Runway"===e||"Non public road"===e}isRoadStreet(e){return e.indexOf("Minor local road")>=0||e.indexOf("minor local road")>=0||e.indexOf("Toll local road")>=0||e.indexOf("Local road")>=0}isRoadPrimary(e){return e.indexOf("Major local road")>=0||e.indexOf("Major road")>=0||e.indexOf("major road")>=0||e.indexOf("Motorway")>=0||e.indexOf("motorway")>=0||e.indexOf("International road")>=0||e.indexOf("international road")>=0}isRoadSecondary(e){return e.indexOf("connecting road")>=0||e.indexOf("Connecting road")>=0||e.indexOf("secondary road")>=0||e.indexOf("Secondary road")>=0}isRailway(e){return"Railway"===e}isFerry(e){return"Ferry road"===e}isBorder(e){return e.indexOf("border")>0}isCountryLabel(e){return"Country name"===e||"Country label"===e}isStateLabel(e){return"City"===e||e.indexOf("city")>0}isRegionLabel(e){return"Town"===e}isCountyLabel(e){return"Village"===e}isPlaceLabel(e){return"Park"===e||"Railway station"===e||"Airport POI"===e||"Town greens"===e}isWaterLabel(e){return"Ocean name"===e||"River label"===e||e.indexOf("water label")>0}isMarineLabel(e){return e.indexOf("water label")>0}isPoiLabel(e){return"National park name"===e||"Landmark label"===e||e.indexOf("label")>=0}isAeroway(e){return"Airport"===e}isBuilding(e){return e.indexOf("building")>=0}isTunnel(e){return e.indexOf("tunnel")>=0}isBridge(e){return e.indexOf("bridge")>=0}}t.OmvTomTomFeatureModifier=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.StyleSetDataFilter=class{constructor(e){this.styleSetEvaluator=e,this.hasKindFilter=!1}wantsLayer(e,t){return this.styleSetEvaluator.wantsLayer(e)}wantsPointFeature(e){return this.styleSetEvaluator.wantsFeature(e,"point")}wantsLineFeature(e){return this.styleSetEvaluator.wantsFeature(e,"line")}wantsPolygonFeature(e){return this.styleSetEvaluator.wantsFeature(e,"polygon")}wantsKind(){return!0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(235);class n{constructor(e){this.m_validators=[],this.m_default=e}static run(e,t){if(!t)return t;const r=Object.keys(e).reduce((r,i)=>{const o=e[i],a=t[i];return null==a?r:(o instanceof n?o.validation(a)?r[i]=a:r[i]=o.getDefault():r[i]=n.run(o,a),r)},{});return i.mergeDeep({},t,r)}addValidator(e){return this.m_validators.push(e),this}validation(e){return!this.m_validators.some(t=>!1===t(e))}getDefault(){return this.m_default}}t.Normalizer=n},function(e,t,r){"use strict";var i=r(458),n=r(118),o=r(462),a=r(236),s=r(237),c=r(463),l=r(464),u=r(485),d=r(40);e.exports=y,y.prototype.validate=function(e,t){var r;if("string"==typeof e){if(!(r=this.getSchema(e)))throw new Error('no schema with key or ref "'+e+'"')}else{var i=this._addSchema(e);r=i.validate||this._compile(i)}var n=r(t);!0!==r.$async&&(this.errors=r.errors);return n},y.prototype.compile=function(e,t){var r=this._addSchema(e,void 0,t);return r.validate||this._compile(r)},y.prototype.addSchema=function(e,t,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)this.addSchema(e[o],void 0,r,i);return this}var a=this._getId(e);if(void 0!==a&&"string"!=typeof a)throw new Error("schema id must be string");return E(this,t=n.normalizeId(t||a)),this._schemas[t]=this._addSchema(e,r,i,!0),this},y.prototype.addMetaSchema=function(e,t,r){return this.addSchema(e,t,r,!0),this},y.prototype.validateSchema=function(e,t){var r=e.$schema;if(void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(!(r=r||this._opts.defaultMeta||function(e){var t=e._opts.meta;return e._opts.defaultMeta="object"==typeof t?e._getId(t)||t:e.getSchema(p)?p:void 0,e._opts.defaultMeta}(this)))return this.logger.warn("meta-schema not available"),this.errors=null,!0;var i=this.validate(r,e);if(!i&&t){var n="schema is invalid: "+this.errorsText();if("log"!=this._opts.validateSchema)throw new Error(n);this.logger.error(n)}return i},y.prototype.getSchema=function(e){var t=v(this,e);switch(typeof t){case"object":return t.validate||this._compile(t);case"string":return this.getSchema(t);case"undefined":return function(e,t){var r=n.schema.call(e,{schema:{}},t);if(r){var o=r.schema,s=r.root,c=r.baseId,l=i.call(e,o,s,void 0,c);return e._fragments[t]=new a({ref:t,fragment:!0,schema:o,root:s,baseId:c,validate:l}),l}}(this,e)}},y.prototype.removeSchema=function(e){if(e instanceof RegExp)return _(this,this._schemas,e),_(this,this._refs,e),this;switch(typeof e){case"undefined":return _(this,this._schemas),_(this,this._refs),this._cache.clear(),this;case"string":var t=v(this,e);return t&&this._cache.del(t.cacheKey),delete this._schemas[e],delete this._refs[e],this;case"object":var r=this._opts.serialize,i=r?r(e):e;this._cache.del(i);var o=this._getId(e);o&&(o=n.normalizeId(o),delete this._schemas[o],delete this._refs[o])}return this},y.prototype.addFormat=function(e,t){"string"==typeof t&&(t=new RegExp(t));return this._formats[e]=t,this},y.prototype.errorsText=function(e,t){if(!(e=e||this.errors))return"No errors";for(var r=void 0===(t=t||{}).separator?", ":t.separator,i=void 0===t.dataVar?"data":t.dataVar,n="",o=0;o<e.length;o++){var a=e[o];a&&(n+=i+a.dataPath+" "+a.message+r)}return n.slice(0,-r.length)},y.prototype._addSchema=function(e,t,r,i){if("object"!=typeof e&&"boolean"!=typeof e)throw new Error("schema should be object or boolean");var o=this._opts.serialize,s=o?o(e):e,c=this._cache.get(s);if(c)return c;i=i||!1!==this._opts.addUsedSchema;var l=n.normalizeId(this._getId(e));l&&i&&E(this,l);var u,d=!1!==this._opts.validateSchema&&!t;d&&!(u=l&&l==n.normalizeId(e.$schema))&&this.validateSchema(e,!0);var h=n.ids.call(this,e),m=new a({id:l,schema:e,localRefs:h,cacheKey:s,meta:r});"#"!=l[0]&&i&&(this._refs[l]=m);this._cache.put(s,m),d&&u&&this.validateSchema(e,!0);return m},y.prototype._compile=function(e,t){if(e.compiling)return e.validate=o,o.schema=e.schema,o.errors=null,o.root=t||o,!0===e.schema.$async&&(o.$async=!0),o;var r,n;e.compiling=!0,e.meta&&(r=this._opts,this._opts=this._metaOpts);try{n=i.call(this,e.schema,t,e.localRefs)}catch(t){throw delete e.validate,t}finally{e.compiling=!1,e.meta&&(this._opts=r)}return e.validate=n,e.refs=n.refs,e.refVal=n.refVal,e.root=n.root,n;function o(){var t=e.validate,r=t.apply(this,arguments);return o.errors=t.errors,r}},y.prototype.compileAsync=r(486);var h=r(487);y.prototype.addKeyword=h.add,y.prototype.getKeyword=h.get,y.prototype.removeKeyword=h.remove,y.prototype.validateKeyword=h.validate;var m=r(120);y.ValidationError=m.Validation,y.MissingRefError=m.MissingRef,y.$dataMetaSchema=u;var p="http://json-schema.org/draft-07/schema",f=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],g=["/properties"];function y(e){if(!(this instanceof y))return new y(e);e=this._opts=d.copy(e)||{},function(e){var t=e._opts.logger;if(!1===t)e.logger={log:w,warn:w,error:w};else{if(void 0===t&&(t=console),!("object"==typeof t&&t.log&&t.warn&&t.error))throw new Error("logger must implement log, warn and error methods");e.logger=t}}(this),this._schemas={},this._refs={},this._fragments={},this._formats=c(e.format),this._cache=e.cache||new o,this._loadingSchemas={},this._compilations=[],this.RULES=l(),this._getId=function(e){switch(e.schemaId){case"auto":return T;case"id":return b;default:return S}}(e),e.loopRequired=e.loopRequired||1/0,"property"==e.errorDataPath&&(e._errorDataPathProperty=!0),void 0===e.serialize&&(e.serialize=s),this._metaOpts=function(e){for(var t=d.copy(e._opts),r=0;r<f.length;r++)delete t[f[r]];return t}(this),e.formats&&function(e){for(var t in e._opts.formats){var r=e._opts.formats[t];e.addFormat(t,r)}}(this),function(e){var t;e._opts.$data&&(t=r(490),e.addMetaSchema(t,t.$id,!0));if(!1===e._opts.meta)return;var i=r(243);e._opts.$data&&(i=u(i,g));e.addMetaSchema(i,p,!0),e._refs["http://json-schema.org/schema"]=p}(this),"object"==typeof e.meta&&this.addMetaSchema(e.meta),e.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),function(e){var t=e._opts.schemas;if(!t)return;if(Array.isArray(t))e.addSchema(t);else for(var r in t)e.addSchema(t[r],r)}(this)}function v(e,t){return t=n.normalizeId(t),e._schemas[t]||e._refs[t]||e._fragments[t]}function _(e,t,r){for(var i in t){var n=t[i];n.meta||r&&!r.test(i)||(e._cache.del(n.cacheKey),delete t[i])}}function b(e){return e.$id&&this.logger.warn("schema $id ignored",e.$id),e.id}function S(e){return e.id&&this.logger.warn("schema id ignored",e.id),e.$id}function T(e){if(e.$id&&e.id&&e.$id!=e.id)throw new Error("schema $id is different from id");return e.$id||e.id}function E(e,t){if(e._schemas[t]||e._refs[t])throw new Error('schema with key or id "'+t+'" already exists')}function w(){}},function(e,t,r){"use strict";var i=r(118),n=r(40),o=r(120),a=r(237),s=r(238),c=n.ucs2length,l=r(119),u=o.Validation;function d(e,t,r){var i=m.call(this,e,t,r);return i>=0?{index:i,compiling:!0}:(i=this._compilations.length,this._compilations[i]={schema:e,root:t,baseId:r},{index:i,compiling:!1})}function h(e,t,r){var i=m.call(this,e,t,r);i>=0&&this._compilations.splice(i,1)}function m(e,t,r){for(var i=0;i<this._compilations.length;i++){var n=this._compilations[i];if(n.schema==e&&n.root==t&&n.baseId==r)return i}return-1}function p(e,t){return"var pattern"+e+" = new RegExp("+n.toQuotedString(t[e])+");"}function f(e){return"var default"+e+" = defaults["+e+"];"}function g(e,t){return void 0===t[e]?"":"var refVal"+e+" = refVal["+e+"];"}function y(e){return"var customRule"+e+" = customRules["+e+"];"}function v(e,t){if(!e.length)return"";for(var r="",i=0;i<e.length;i++)r+=t(i,e);return r}e.exports=function e(t,r,m,_){var b=this,S=this._opts,T=[void 0],E={},w=[],C={},x=[],O={},A=[];r=r||{schema:t,refVal:T,refs:E};var P=d.call(this,t,r,_),R=this._compilations[P.index];if(P.compiling)return R.callValidate=function e(){var t=R.validate,r=t.apply(this,arguments);return e.errors=t.errors,r};var I=this._formats,D=this.RULES;try{var L=k(t,r,m,_);R.validate=L;var M=R.callValidate;return M&&(M.schema=L.schema,M.errors=null,M.refs=L.refs,M.refVal=L.refVal,M.root=L.root,M.$async=L.$async,S.sourceCode&&(M.source=L.source)),L}finally{h.call(this,t,r,_)}function k(t,a,d,h){var m=!a||a&&a.schema==t;if(a.schema!=r.schema)return e.call(b,t,a,d,h);var _,C=!0===t.$async,O=s({isTop:!0,schema:t,isRoot:m,baseId:h,root:a,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:o.MissingRef,RULES:D,validate:s,util:n,resolve:i,resolveRef:N,usePattern:j,useDefault:V,useCustomRule:B,opts:S,formats:I,logger:b.logger,self:b});O=v(T,g)+v(w,p)+v(x,f)+v(A,y)+O,S.processCode&&(O=S.processCode(O));try{_=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",O)(b,D,I,r,T,x,A,l,c,u),T[0]=_}catch(e){throw b.logger.error("Error compiling schema, function code:",O),e}return _.schema=t,_.errors=null,_.refs=E,_.refVal=T,_.root=m?_:a,C&&(_.$async=!0),!0===S.sourceCode&&(_.source={code:O,patterns:w,defaults:x}),_}function N(t,n,o){n=i.url(t,n);var a,s,c=E[n];if(void 0!==c)return U(a=T[c],s="refVal["+c+"]");if(!o&&r.refs){var l=r.refs[n];if(void 0!==l)return U(a=r.refVal[l],s=F(n,a))}s=F(n);var u=i.call(b,k,r,n);if(void 0===u){var d=m&&m[n];d&&(u=i.inlineRef(d,S.inlineRefs)?d:e.call(b,d,r,m,t))}if(void 0!==u)return function(e,t){var r=E[e];T[r]=t}(n,u),U(u,s);!function(e){delete E[e]}(n)}function F(e,t){var r=T.length;return T[r]=t,E[e]=r,"refVal"+r}function U(e,t){return"object"==typeof e||"boolean"==typeof e?{code:t,schema:e,inline:!0}:{code:t,$async:e&&!!e.$async}}function j(e){var t=C[e];return void 0===t&&(t=C[e]=w.length,w[t]=e),"pattern"+t}function V(e){switch(typeof e){case"boolean":case"number":return""+e;case"string":return n.toQuotedString(e);case"object":if(null===e)return"null";var t=a(e),r=O[t];return void 0===r&&(r=O[t]=x.length,x[r]=e),"default"+r}}function B(e,t,r,i){if(!1!==b._opts.validateSchema){var n=e.definition.dependencies;if(n&&!n.every((function(e){return Object.prototype.hasOwnProperty.call(r,e)})))throw new Error("parent schema must have all required keywords: "+n.join(","));var o=e.definition.validateSchema;if(o)if(!o(t)){var a="keyword schema is invalid: "+b.errorsText(o.errors);if("log"!=b._opts.validateSchema)throw new Error(a);b.logger.error(a)}}var s,c=e.definition.compile,l=e.definition.inline,u=e.definition.macro;if(c)s=c.call(b,t,r,i);else if(u)s=u.call(b,t,r,i),!1!==S.validateSchema&&b.validateSchema(s,!0);else if(l)s=l.call(b,i,e.keyword,t,r);else if(!(s=e.definition.validate))return;if(void 0===s)throw new Error('custom keyword "'+e.keyword+'"failed to compile');var d=A.length;return A[d]=s,{code:"customRule"+d,validate:s}}}},function(e,t,r){
/** @license URI.js v4.2.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */
!function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1){t[0]=t[0].slice(0,-1);for(var i=t.length-1,n=1;n<i;++n)t[n]=t[n].slice(1,-1);return t[i]=t[i].slice(1),t.join("")}return t[0]}function r(e){return"(?:"+e+")"}function i(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function n(e){return e.toUpperCase()}function o(e){var i=t("[0-9]","[A-Fa-f]"),n=r(r("%[EFef]"+i+"%"+i+i+"%"+i+i)+"|"+r("%[89A-Fa-f]"+i+"%"+i+i)+"|"+r("%"+i+i)),o="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",a=t("[\\:\\/\\?\\#\\[\\]\\@]",o),s=e?"[\\uE000-\\uF8FF]":"[]",c=t("[A-Za-z]","[0-9]","[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),l=r("[A-Za-z]"+t("[A-Za-z]","[0-9]","[\\+\\-\\.]")+"*"),u=r(r(n+"|"+t(c,o,"[\\:]"))+"*"),d=(r(r("25[0-5]")+"|"+r("2[0-4][0-9]")+"|"+r("1[0-9][0-9]")+"|"+r("[1-9][0-9]")+"|[0-9]"),r(r("25[0-5]")+"|"+r("2[0-4][0-9]")+"|"+r("1[0-9][0-9]")+"|"+r("0?[1-9][0-9]")+"|0?0?[0-9]")),h=r(d+"\\."+d+"\\."+d+"\\."+d),m=r(i+"{1,4}"),p=r(r(m+"\\:"+m)+"|"+h),f=r(r(m+"\\:")+"{6}"+p),g=r("\\:\\:"+r(m+"\\:")+"{5}"+p),y=r(r(m)+"?\\:\\:"+r(m+"\\:")+"{4}"+p),v=r(r(r(m+"\\:")+"{0,1}"+m)+"?\\:\\:"+r(m+"\\:")+"{3}"+p),_=r(r(r(m+"\\:")+"{0,2}"+m)+"?\\:\\:"+r(m+"\\:")+"{2}"+p),b=r(r(r(m+"\\:")+"{0,3}"+m)+"?\\:\\:"+m+"\\:"+p),S=r(r(r(m+"\\:")+"{0,4}"+m)+"?\\:\\:"+p),T=r(r(r(m+"\\:")+"{0,5}"+m)+"?\\:\\:"+m),E=r(r(r(m+"\\:")+"{0,6}"+m)+"?\\:\\:"),w=r([f,g,y,v,_,b,S,T,E].join("|")),C=r(r(c+"|"+n)+"+"),x=(r(w+"\\%25"+C),r(w+r("\\%25|\\%(?!"+i+"{2})")+C)),O=r("[vV]"+i+"+\\."+t(c,o,"[\\:]")+"+"),A=r("\\["+r(x+"|"+w+"|"+O)+"\\]"),P=r(r(n+"|"+t(c,o))+"*"),R=r(A+"|"+h+"(?!"+P+")|"+P),I=r("[0-9]*"),D=r(r(u+"@")+"?"+R+r("\\:"+I)+"?"),L=r(n+"|"+t(c,o,"[\\:\\@]")),M=r(L+"*"),k=r(L+"+"),N=r(r(n+"|"+t(c,o,"[\\@]"))+"+"),F=r(r("\\/"+M)+"*"),U=r("\\/"+r(k+F)+"?"),j=r(N+F),V=r(k+F),B="(?!"+L+")",G=(r(F+"|"+U+"|"+j+"|"+V+"|"+B),r(r(L+"|"+t("[\\/\\?]",s))+"*")),z=r(r(L+"|[\\/\\?]")+"*"),q=r(r("\\/\\/"+D+F)+"|"+U+"|"+V+"|"+B),H=r(l+"\\:"+q+r("\\?"+G)+"?"+r("\\#"+z)+"?"),W=r(r("\\/\\/"+D+F)+"|"+U+"|"+j+"|"+B),K=r(W+r("\\?"+G)+"?"+r("\\#"+z)+"?");return r(H+"|"+K),r(l+"\\:"+q+r("\\?"+G)+"?"),r(r("\\/\\/("+r("("+u+")@")+"?("+R+")"+r("\\:("+I+")")+"?)")+"?("+F+"|"+U+"|"+V+"|"+B+")"),r("\\?("+G+")"),r("\\#("+z+")"),r(r("\\/\\/("+r("("+u+")@")+"?("+R+")"+r("\\:("+I+")")+"?)")+"?("+F+"|"+U+"|"+j+"|"+B+")"),r("\\?("+G+")"),r("\\#("+z+")"),r(r("\\/\\/("+r("("+u+")@")+"?("+R+")"+r("\\:("+I+")")+"?)")+"?("+F+"|"+U+"|"+V+"|"+B+")"),r("\\?("+G+")"),r("\\#("+z+")"),r("("+u+")@"),r("\\:("+I+")"),{NOT_SCHEME:new RegExp(t("[^]","[A-Za-z]","[0-9]","[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",c,o),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",c,o),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",c,o),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",c,o),"g"),NOT_QUERY:new RegExp(t("[^\\%]",c,o,"[\\:\\@\\/\\?]",s),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",c,o,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",c,o),"g"),UNRESERVED:new RegExp(c,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",c,a),"g"),PCT_ENCODED:new RegExp(n,"g"),IPV4ADDRESS:new RegExp("^("+h+")$"),IPV6ADDRESS:new RegExp("^\\[?("+w+")"+r(r("\\%25|\\%(?!"+i+"{2})")+"("+C+")")+"?\\]?$")}}var a=o(!1),s=o(!0),c=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],i=!0,n=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);i=!0);}catch(e){n=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},l=2147483647,u=/^xn--/,d=/[^\0-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,m={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,f=String.fromCharCode;function g(e){throw new RangeError(m[e])}function y(e,t){var r=e.split("@"),i="";r.length>1&&(i=r[0]+"@",e=r[1]);var n=function(e,t){for(var r=[],i=e.length;i--;)r[i]=t(e[i]);return r}((e=e.replace(h,".")).split("."),t).join(".");return i+n}function v(e){for(var t=[],r=0,i=e.length;r<i;){var n=e.charCodeAt(r++);if(n>=55296&&n<=56319&&r<i){var o=e.charCodeAt(r++);56320==(64512&o)?t.push(((1023&n)<<10)+(1023&o)+65536):(t.push(n),r--)}else t.push(n)}return t}var _=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},b=function(e,t,r){var i=0;for(e=r?p(e/700):e>>1,e+=p(e/t);e>455;i+=36)e=p(e/35);return p(i+36*e/(e+38))},S=function(e){var t,r=[],i=e.length,n=0,o=128,a=72,s=e.lastIndexOf("-");s<0&&(s=0);for(var c=0;c<s;++c)e.charCodeAt(c)>=128&&g("not-basic"),r.push(e.charCodeAt(c));for(var u=s>0?s+1:0;u<i;){for(var d=n,h=1,m=36;;m+=36){u>=i&&g("invalid-input");var f=(t=e.charCodeAt(u++))-48<10?t-22:t-65<26?t-65:t-97<26?t-97:36;(f>=36||f>p((l-n)/h))&&g("overflow"),n+=f*h;var y=m<=a?1:m>=a+26?26:m-a;if(f<y)break;var v=36-y;h>p(l/v)&&g("overflow"),h*=v}var _=r.length+1;a=b(n-d,_,0==d),p(n/_)>l-o&&g("overflow"),o+=p(n/_),n%=_,r.splice(n++,0,o)}return String.fromCodePoint.apply(String,r)},T=function(e){var t=[],r=(e=v(e)).length,i=128,n=0,o=72,a=!0,s=!1,c=void 0;try{for(var u,d=e[Symbol.iterator]();!(a=(u=d.next()).done);a=!0){var h=u.value;h<128&&t.push(f(h))}}catch(e){s=!0,c=e}finally{try{!a&&d.return&&d.return()}finally{if(s)throw c}}var m=t.length,y=m;for(m&&t.push("-");y<r;){var S=l,T=!0,E=!1,w=void 0;try{for(var C,x=e[Symbol.iterator]();!(T=(C=x.next()).done);T=!0){var O=C.value;O>=i&&O<S&&(S=O)}}catch(e){E=!0,w=e}finally{try{!T&&x.return&&x.return()}finally{if(E)throw w}}var A=y+1;S-i>p((l-n)/A)&&g("overflow"),n+=(S-i)*A,i=S;var P=!0,R=!1,I=void 0;try{for(var D,L=e[Symbol.iterator]();!(P=(D=L.next()).done);P=!0){var M=D.value;if(M<i&&++n>l&&g("overflow"),M==i){for(var k=n,N=36;;N+=36){var F=N<=o?1:N>=o+26?26:N-o;if(k<F)break;var U=k-F,j=36-F;t.push(f(_(F+U%j,0))),k=p(U/j)}t.push(f(_(k,0))),o=b(n,A,y==m),n=0,++y}}}catch(e){R=!0,I=e}finally{try{!P&&L.return&&L.return()}finally{if(R)throw I}}++n,++i}return t.join("")},E={version:"2.1.0",ucs2:{decode:v,encode:function(e){return String.fromCodePoint.apply(String,function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(e))}},decode:S,encode:T,toASCII:function(e){return y(e,(function(e){return d.test(e)?"xn--"+T(e):e}))},toUnicode:function(e){return y(e,(function(e){return u.test(e)?S(e.slice(4).toLowerCase()):e}))}},w={};function C(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function x(e){for(var t="",r=0,i=e.length;r<i;){var n=parseInt(e.substr(r+1,2),16);if(n<128)t+=String.fromCharCode(n),r+=3;else if(n>=194&&n<224){if(i-r>=6){var o=parseInt(e.substr(r+4,2),16);t+=String.fromCharCode((31&n)<<6|63&o)}else t+=e.substr(r,6);r+=6}else if(n>=224){if(i-r>=9){var a=parseInt(e.substr(r+4,2),16),s=parseInt(e.substr(r+7,2),16);t+=String.fromCharCode((15&n)<<12|(63&a)<<6|63&s)}else t+=e.substr(r,9);r+=9}else t+=e.substr(r,3),r+=3}return t}function O(e,t){function r(e){var r=x(e);return r.match(t.UNRESERVED)?r:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,r).replace(t.NOT_USERINFO,C).replace(t.PCT_ENCODED,n)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_HOST,C).replace(t.PCT_ENCODED,n)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,r).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,C).replace(t.PCT_ENCODED,n)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,r).replace(t.NOT_QUERY,C).replace(t.PCT_ENCODED,n)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,r).replace(t.NOT_FRAGMENT,C).replace(t.PCT_ENCODED,n)),e}function A(e){return e.replace(/^0*(.*)/,"$1")||"0"}function P(e,t){var r=e.match(t.IPV4ADDRESS)||[],i=c(r,2)[1];return i?i.split(".").map(A).join("."):e}function R(e,t){var r=e.match(t.IPV6ADDRESS)||[],i=c(r,3),n=i[1],o=i[2];if(n){for(var a=n.toLowerCase().split("::").reverse(),s=c(a,2),l=s[0],u=s[1],d=u?u.split(":").map(A):[],h=l.split(":").map(A),m=t.IPV4ADDRESS.test(h[h.length-1]),p=m?7:8,f=h.length-p,g=Array(p),y=0;y<p;++y)g[y]=d[y]||h[f+y]||"";m&&(g[p-1]=P(g[p-1],t));var v=g.reduce((function(e,t,r){if(!t||"0"===t){var i=e[e.length-1];i&&i.index+i.length===r?i.length++:e.push({index:r,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],_=void 0;if(v&&v.length>1){var b=g.slice(0,v.index),S=g.slice(v.index+v.length);_=b.join(":")+"::"+S.join(":")}else _=g.join(":");return o&&(_+="%"+o),_}return e}var I=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,D=void 0==="".match(/(){0}/)[1];function L(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},i=!1!==t.iri?s:a;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var n=e.match(I);if(n){D?(r.scheme=n[1],r.userinfo=n[3],r.host=n[4],r.port=parseInt(n[5],10),r.path=n[6]||"",r.query=n[7],r.fragment=n[8],isNaN(r.port)&&(r.port=n[5])):(r.scheme=n[1]||void 0,r.userinfo=-1!==e.indexOf("@")?n[3]:void 0,r.host=-1!==e.indexOf("//")?n[4]:void 0,r.port=parseInt(n[5],10),r.path=n[6]||"",r.query=-1!==e.indexOf("?")?n[7]:void 0,r.fragment=-1!==e.indexOf("#")?n[8]:void 0,isNaN(r.port)&&(r.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?n[4]:void 0)),r.host&&(r.host=R(P(r.host,i),i)),void 0!==r.scheme||void 0!==r.userinfo||void 0!==r.host||void 0!==r.port||r.path||void 0!==r.query?void 0===r.scheme?r.reference="relative":void 0===r.fragment?r.reference="absolute":r.reference="uri":r.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==r.reference&&(r.error=r.error||"URI is not a "+t.reference+" reference.");var o=w[(t.scheme||r.scheme||"").toLowerCase()];if(t.unicodeSupport||o&&o.unicodeSupport)O(r,i);else{if(r.host&&(t.domainHost||o&&o.domainHost))try{r.host=E.toASCII(r.host.replace(i.PCT_ENCODED,x).toLowerCase())}catch(e){r.error=r.error||"Host's domain name can not be converted to ASCII via punycode: "+e}O(r,a)}o&&o.parse&&o.parse(r,t)}else r.error=r.error||"URI can not be parsed.";return r}var M=/^\.\.?\//,k=/^\/\.(\/|$)/,N=/^\/\.\.(\/|$)/,F=/^\/?(?:.|\n)*?(?=\/|$)/;function U(e){for(var t=[];e.length;)if(e.match(M))e=e.replace(M,"");else if(e.match(k))e=e.replace(k,"/");else if(e.match(N))e=e.replace(N,"/"),t.pop();else if("."===e||".."===e)e="";else{var r=e.match(F);if(!r)throw new Error("Unexpected dot segment condition");var i=r[0];e=e.slice(i.length),t.push(i)}return t.join("")}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.iri?s:a,i=[],n=w[(t.scheme||e.scheme||"").toLowerCase()];if(n&&n.serialize&&n.serialize(e,t),e.host)if(r.IPV6ADDRESS.test(e.host));else if(t.domainHost||n&&n.domainHost)try{e.host=t.iri?E.toUnicode(e.host):E.toASCII(e.host.replace(r.PCT_ENCODED,x).toLowerCase())}catch(r){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+r}O(e,r),"suffix"!==t.reference&&e.scheme&&(i.push(e.scheme),i.push(":"));var o=function(e,t){var r=!1!==t.iri?s:a,i=[];return void 0!==e.userinfo&&(i.push(e.userinfo),i.push("@")),void 0!==e.host&&i.push(R(P(String(e.host),r),r).replace(r.IPV6ADDRESS,(function(e,t,r){return"["+t+(r?"%25"+r:"")+"]"}))),"number"==typeof e.port&&(i.push(":"),i.push(e.port.toString(10))),i.length?i.join(""):void 0}(e,t);if(void 0!==o&&("suffix"!==t.reference&&i.push("//"),i.push(o),e.path&&"/"!==e.path.charAt(0)&&i.push("/")),void 0!==e.path){var c=e.path;t.absolutePath||n&&n.absolutePath||(c=U(c)),void 0===o&&(c=c.replace(/^\/\//,"/%2F")),i.push(c)}return void 0!==e.query&&(i.push("?"),i.push(e.query)),void 0!==e.fragment&&(i.push("#"),i.push(e.fragment)),i.join("")}function V(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={};return arguments[3]||(e=L(j(e,r),r),t=L(j(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(i.scheme=t.scheme,i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=U(t.path||""),i.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=U(t.path||""),i.query=t.query):(t.path?("/"===t.path.charAt(0)?i.path=U(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?i.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:i.path=t.path:i.path="/"+t.path,i.path=U(i.path)),i.query=t.query):(i.path=e.path,void 0!==t.query?i.query=t.query:i.query=e.query),i.userinfo=e.userinfo,i.host=e.host,i.port=e.port),i.scheme=e.scheme),i.fragment=t.fragment,i}function B(e,t){return e&&e.toString().replace(t&&t.iri?s.PCT_ENCODED:a.PCT_ENCODED,x)}var G={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){return e.port!==("https"!==String(e.scheme).toLowerCase()?80:443)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},z={scheme:"https",domainHost:G.domainHost,parse:G.parse,serialize:G.serialize},q={},H="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",W="[0-9A-Fa-f]",K=r(r("%[EFef][0-9A-Fa-f]%"+W+W+"%"+W+W)+"|"+r("%[89A-Fa-f][0-9A-Fa-f]%"+W+W)+"|"+r("%"+W+W)),Y=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),$=new RegExp(H,"g"),Z=new RegExp(K,"g"),J=new RegExp(t("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',Y),"g"),X=new RegExp(t("[^]",H,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),Q=X;function ee(e){var t=x(e);return t.match($)?t:e}var te={scheme:"mailto",parse:function(e,t){var r=e,i=r.to=r.path?r.path.split(","):[];if(r.path=void 0,r.query){for(var n=!1,o={},a=r.query.split("&"),s=0,c=a.length;s<c;++s){var l=a[s].split("=");switch(l[0]){case"to":for(var u=l[1].split(","),d=0,h=u.length;d<h;++d)i.push(u[d]);break;case"subject":r.subject=B(l[1],t);break;case"body":r.body=B(l[1],t);break;default:n=!0,o[B(l[0],t)]=B(l[1],t)}}n&&(r.headers=o)}r.query=void 0;for(var m=0,p=i.length;m<p;++m){var f=i[m].split("@");if(f[0]=B(f[0]),t.unicodeSupport)f[1]=B(f[1],t).toLowerCase();else try{f[1]=E.toASCII(B(f[1],t).toLowerCase())}catch(e){r.error=r.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}i[m]=f.join("@")}return r},serialize:function(e,t){var r,i=e,o=null!=(r=e.to)?r instanceof Array?r:"number"!=typeof r.length||r.split||r.setInterval||r.call?[r]:Array.prototype.slice.call(r):[];if(o){for(var a=0,s=o.length;a<s;++a){var c=String(o[a]),l=c.lastIndexOf("@"),u=c.slice(0,l).replace(Z,ee).replace(Z,n).replace(J,C),d=c.slice(l+1);try{d=t.iri?E.toUnicode(d):E.toASCII(B(d,t).toLowerCase())}catch(e){i.error=i.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e}o[a]=u+"@"+d}i.path=o.join(",")}var h=e.headers=e.headers||{};e.subject&&(h.subject=e.subject),e.body&&(h.body=e.body);var m=[];for(var p in h)h[p]!==q[p]&&m.push(p.replace(Z,ee).replace(Z,n).replace(X,C)+"="+h[p].replace(Z,ee).replace(Z,n).replace(Q,C));return m.length&&(i.query=m.join("&")),i}},re=/^([^\:]+)\:(.*)/,ie={scheme:"urn",parse:function(e,t){var r=e.path&&e.path.match(re),i=e;if(r){var n=t.scheme||i.scheme||"urn",o=r[1].toLowerCase(),a=r[2],s=n+":"+(t.nid||o),c=w[s];i.nid=o,i.nss=a,i.path=void 0,c&&(i=c.parse(i,t))}else i.error=i.error||"URN can not be parsed.";return i},serialize:function(e,t){var r=t.scheme||e.scheme||"urn",i=e.nid,n=r+":"+(t.nid||i),o=w[n];o&&(e=o.serialize(e,t));var a=e,s=e.nss;return a.path=(i||t.nid)+":"+s,a}},ne=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,oe={scheme:"urn:uuid",parse:function(e,t){var r=e;return r.uuid=r.nss,r.nss=void 0,t.tolerant||r.uuid&&r.uuid.match(ne)||(r.error=r.error||"UUID is not valid."),r},serialize:function(e,t){var r=e;return r.nss=(e.uuid||"").toLowerCase(),r}};w[G.scheme]=G,w[z.scheme]=z,w[te.scheme]=te,w[ie.scheme]=ie,w[oe.scheme]=oe,e.SCHEMES=w,e.pctEncChar=C,e.pctDecChars=x,e.parse=L,e.removeDotSegments=U,e.serialize=j,e.resolveComponents=V,e.resolve=function(e,t,r){var i=function(e,t){var r=e;if(t)for(var i in t)r[i]=t[i];return r}({scheme:"null"},r);return j(V(L(e,i),L(t,i),i,!0),i)},e.normalize=function(e,t){return"string"==typeof e?e=j(L(e,t),t):"object"===i(e)&&(e=L(j(e,t),t)),e},e.equal=function(e,t,r){return"string"==typeof e?e=j(L(e,r),r):"object"===i(e)&&(e=j(e,r)),"string"==typeof t?t=j(L(t,r),r):"object"===i(t)&&(t=j(t,r)),e===t},e.escapeComponent=function(e,t){return e&&e.toString().replace(t&&t.iri?s.ESCAPE:a.ESCAPE,C)},e.unescapeComponent=B,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,r){"use strict";e.exports=function(e){for(var t,r=0,i=e.length,n=0;n<i;)r++,(t=e.charCodeAt(n++))>=55296&&t<=56319&&n<i&&56320==(64512&(t=e.charCodeAt(n)))&&n++;return r}},function(e,t,r){"use strict";var i=e.exports=function(e,t,r){"function"==typeof t&&(r=t,t={}),function e(t,r,n,o,a,s,c,l,u,d){if(o&&"object"==typeof o&&!Array.isArray(o)){for(var h in r(o,a,s,c,l,u,d),o){var m=o[h];if(Array.isArray(m)){if(h in i.arrayKeywords)for(var p=0;p<m.length;p++)e(t,r,n,m[p],a+"/"+h+"/"+p,s,a,h,o,p)}else if(h in i.propsKeywords){if(m&&"object"==typeof m)for(var f in m)e(t,r,n,m[f],a+"/"+h+"/"+f.replace(/~/g,"~0").replace(/\//g,"~1"),s,a,h,o,f)}else(h in i.keywords||t.allKeys&&!(h in i.skipKeywords))&&e(t,r,n,m,a+"/"+h,s,a,h,o)}n(o,a,s,c,l,u,d)}}(t,"function"==typeof(r=t.cb||r)?r:r.pre||function(){},r.post||function(){},e,"",e)};i.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},i.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},i.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},i.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},function(e,t,r){"use strict";var i=e.exports=function(){this._cache={}};i.prototype.put=function(e,t){this._cache[e]=t},i.prototype.get=function(e){return this._cache[e]},i.prototype.del=function(e){delete this._cache[e]},i.prototype.clear=function(){this._cache={}}},function(e,t,r){"use strict";var i=r(40),n=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,o=[0,31,28,31,30,31,30,31,31,30,31,30,31],a=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d:\d\d)?$/i,s=/^[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*$/i,c=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,l=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,u=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,d=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,h=/^(?:\/(?:[^~/]|~0|~1)*)*$/,m=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,p=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;function f(e){return e="full"==e?"full":"fast",i.copy(f[e])}function g(e){var t=e.match(n);if(!t)return!1;var r=+t[1],i=+t[2],a=+t[3];return i>=1&&i<=12&&a>=1&&a<=(2==i&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(r)?29:o[i])}function y(e,t){var r=e.match(a);if(!r)return!1;var i=r[1],n=r[2],o=r[3],s=r[5];return(i<=23&&n<=59&&o<=59||23==i&&59==n&&60==o)&&(!t||s)}e.exports=f,f.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d:\d\d)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d:\d\d)$/i,uri:/^(?:[a-z][a-z0-9+-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":l,url:u,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:s,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:S,uuid:d,"json-pointer":h,"json-pointer-uri-fragment":m,"relative-json-pointer":p},f.full={date:g,time:y,"date-time":function(e){var t=e.split(v);return 2==t.length&&g(t[0])&&y(t[1],!0)},uri:function(e){return _.test(e)&&c.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":l,url:u,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:function(e){return e.length<=255&&s.test(e)},ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:S,uuid:d,"json-pointer":h,"json-pointer-uri-fragment":m,"relative-json-pointer":p};var v=/t|\s/i;var _=/\/|:/;var b=/[^\\]\\Z/;function S(e){if(b.test(e))return!1;try{return new RegExp(e),!0}catch(e){return!1}}},function(e,t,r){"use strict";var i=r(465),n=r(40).toHash;e.exports=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],t=["type","$comment"];return e.all=n(t),e.types=n(["number","integer","string","array","object","boolean","null"]),e.forEach((function(r){r.rules=r.rules.map((function(r){var n;if("object"==typeof r){var o=Object.keys(r)[0];n=r[o],r=o,n.forEach((function(r){t.push(r),e.all[r]=!0}))}return t.push(r),e.all[r]={keyword:r,code:i[r],implements:n}})),e.all.$comment={keyword:"$comment",code:i.$comment},r.type&&(e.types[r.type]=r)})),e.keywords=n(t.concat(["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"])),e.custom={},e}},function(e,t,r){"use strict";e.exports={$ref:r(466),allOf:r(467),anyOf:r(468),$comment:r(469),const:r(470),contains:r(471),dependencies:r(472),enum:r(473),format:r(474),if:r(475),items:r(476),maximum:r(239),minimum:r(239),maxItems:r(240),minItems:r(240),maxLength:r(241),minLength:r(241),maxProperties:r(242),minProperties:r(242),multipleOf:r(477),not:r(478),oneOf:r(479),pattern:r(480),properties:r(481),propertyNames:r(482),required:r(483),uniqueItems:r(484),validate:r(238)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,n,o=" ",a=e.level,s=e.dataLevel,c=e.schema[t],l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(s||""),h="valid"+a;if("#"==c||"#/"==c)e.isRoot?(i=e.async,n="validate"):(i=!0===e.root.schema.$async,n="root.refVal[0]");else{var m=e.resolveRef(e.baseId,c,e.isRoot);if(void 0===m){var p=e.MissingRefError.message(e.baseId,c);if("fail"==e.opts.missingRefs){e.logger.error(p),(v=v||[]).push(o),o="",!1!==e.createErrors?(o+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { ref: '"+e.util.escapeQuotes(c)+"' } ",!1!==e.opts.messages&&(o+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(c)+"' "),e.opts.verbose&&(o+=" , schema: "+e.util.toQuotedString(c)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),o+=" } "):o+=" {} ";var f=o;o=v.pop(),!e.compositeRule&&u?e.async?o+=" throw new ValidationError(["+f+"]); ":o+=" validate.errors = ["+f+"]; return false; ":o+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u&&(o+=" if (false) { ")}else{if("ignore"!=e.opts.missingRefs)throw new e.MissingRefError(e.baseId,c,p);e.logger.warn(p),u&&(o+=" if (true) { ")}}else if(m.inline){var g=e.util.copy(e);g.level++;var y="valid"+g.level;g.schema=m.schema,g.schemaPath="",g.errSchemaPath=c,o+=" "+e.validate(g).replace(/validate\.schema/g,m.code)+" ",u&&(o+=" if ("+y+") { ")}else i=!0===m.$async||e.async&&!1!==m.$async,n=m.code}if(n){var v;(v=v||[]).push(o),o="",e.opts.passContext?o+=" "+n+".call(this, ":o+=" "+n+"( ",o+=" "+d+", (dataPath || '')",'""'!=e.errorPath&&(o+=" + "+e.errorPath);var _=o+=" , "+(s?"data"+(s-1||""):"parentData")+" , "+(s?e.dataPathArr[s]:"parentDataProperty")+", rootData)  ";if(o=v.pop(),i){if(!e.async)throw new Error("async schema referenced by sync schema");u&&(o+=" var "+h+"; "),o+=" try { await "+_+"; ",u&&(o+=" "+h+" = true; "),o+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",u&&(o+=" "+h+" = false; "),o+=" } ",u&&(o+=" if ("+h+") { ")}else o+=" if (!"+_+") { if (vErrors === null) vErrors = "+n+".errors; else vErrors = vErrors.concat("+n+".errors); errors = vErrors.length; } ",u&&(o+=" else { ")}return o}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",n=e.schema[t],o=e.schemaPath+e.util.getProperty(t),a=e.errSchemaPath+"/"+t,s=!e.opts.allErrors,c=e.util.copy(e),l="";c.level++;var u="valid"+c.level,d=c.baseId,h=!0,m=n;if(m)for(var p,f=-1,g=m.length-1;f<g;)p=m[f+=1],(e.opts.strictKeywords?"object"==typeof p&&Object.keys(p).length>0:e.util.schemaHasRules(p,e.RULES.all))&&(h=!1,c.schema=p,c.schemaPath=o+"["+f+"]",c.errSchemaPath=a+"/"+f,i+="  "+e.validate(c)+" ",c.baseId=d,s&&(i+=" if ("+u+") { ",l+="}"));return s&&(i+=h?" if (true) { ":" "+l.slice(0,-1)+" "),i=e.util.cleanUpCode(i)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,h="errs__"+n,m=e.util.copy(e),p="";m.level++;var f="valid"+m.level;if(a.every((function(t){return e.opts.strictKeywords?"object"==typeof t&&Object.keys(t).length>0:e.util.schemaHasRules(t,e.RULES.all)}))){var g=m.baseId;i+=" var "+h+" = errors; var "+d+" = false;  ";var y=e.compositeRule;e.compositeRule=m.compositeRule=!0;var v=a;if(v)for(var _,b=-1,S=v.length-1;b<S;)_=v[b+=1],m.schema=_,m.schemaPath=s+"["+b+"]",m.errSchemaPath=c+"/"+b,i+="  "+e.validate(m)+" ",m.baseId=g,i+=" "+d+" = "+d+" || "+f+"; if (!"+d+") { ",p+="}";e.compositeRule=m.compositeRule=y,i+=" "+p+" if (!"+d+") {   var err =   ",!1!==e.createErrors?(i+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(i+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&l&&(e.async?i+=" throw new ValidationError(vErrors); ":i+=" validate.errors = vErrors; return false; "),i+=" } else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } ",e.opts.allErrors&&(i+=" } "),i=e.util.cleanUpCode(i)}else l&&(i+=" if (true) { ");return i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",n=e.schema[t],o=e.errSchemaPath+"/"+t,a=(e.opts.allErrors,e.util.toQuotedString(n));return!0===e.opts.$comment?i+=" console.log("+a+");":"function"==typeof e.opts.$comment&&(i+=" self._opts.$comment("+a+", "+e.util.toQuotedString(o)+", validate.root.schema);"),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,h=e.opts.$data&&a&&a.$data;h&&(i+=" var schema"+n+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; "),h||(i+=" var schema"+n+" = validate.schema"+s+";"),i+="var "+d+" = equal("+u+", schema"+n+"); if (!"+d+") {   ";var m=m||[];m.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { allowedValue: schema"+n+" } ",!1!==e.opts.messages&&(i+=" , message: 'should be equal to constant' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var p=i;return i=m.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+p+"]); ":i+=" validate.errors = ["+p+"]; return false; ":i+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" }",l&&(i+=" else { "),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,h="errs__"+n,m=e.util.copy(e);m.level++;var p="valid"+m.level,f="i"+n,g=m.dataLevel=e.dataLevel+1,y="data"+g,v=e.baseId,_=e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0:e.util.schemaHasRules(a,e.RULES.all);if(i+="var "+h+" = errors;var "+d+";",_){var b=e.compositeRule;e.compositeRule=m.compositeRule=!0,m.schema=a,m.schemaPath=s,m.errSchemaPath=c,i+=" var "+p+" = false; for (var "+f+" = 0; "+f+" < "+u+".length; "+f+"++) { ",m.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers,!0);var S=u+"["+f+"]";m.dataPathArr[g]=f;var T=e.validate(m);m.baseId=v,e.util.varOccurences(T,y)<2?i+=" "+e.util.varReplace(T,y,S)+" ":i+=" var "+y+" = "+S+"; "+T+" ",i+=" if ("+p+") break; }  ",e.compositeRule=m.compositeRule=b,i+="  if (!"+p+") {"}else i+=" if ("+u+".length == 0) {";var E=E||[];E.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(i+=" , message: 'should contain a valid item' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var w=i;return i=E.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+w+"]); ":i+=" validate.errors = ["+w+"]; return false; ":i+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else { ",_&&(i+="  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } "),e.opts.allErrors&&(i+=" } "),i=e.util.cleanUpCode(i)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(o||""),d="errs__"+n,h=e.util.copy(e),m="";h.level++;var p="valid"+h.level,f={},g={},y=e.opts.ownProperties;for(S in a){var v=a[S],_=Array.isArray(v)?g:f;_[S]=v}i+="var "+d+" = errors;";var b=e.errorPath;for(var S in i+="var missing"+n+";",g)if((_=g[S]).length){if(i+=" if ( "+u+e.util.getProperty(S)+" !== undefined ",y&&(i+=" && Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(S)+"') "),l){i+=" && ( ";var T=_;if(T)for(var E=-1,w=T.length-1;E<w;){R=T[E+=1],E&&(i+=" || "),i+=" ( ( "+(M=u+(L=e.util.getProperty(R)))+" === undefined ",y&&(i+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(R)+"') "),i+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?R:L)+") ) "}i+=")) {  ";var C="missing"+n,x="' + "+C+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(b,C,!0):b+" + "+C);var O=O||[];O.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { property: '"+e.util.escapeQuotes(S)+"', missingProperty: '"+x+"', depsCount: "+_.length+", deps: '"+e.util.escapeQuotes(1==_.length?_[0]:_.join(", "))+"' } ",!1!==e.opts.messages&&(i+=" , message: 'should have ",1==_.length?i+="property "+e.util.escapeQuotes(_[0]):i+="properties "+e.util.escapeQuotes(_.join(", ")),i+=" when property "+e.util.escapeQuotes(S)+" is present' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var A=i;i=O.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+A+"]); ":i+=" validate.errors = ["+A+"]; return false; ":i+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{i+=" ) { ";var P=_;if(P)for(var R,I=-1,D=P.length-1;I<D;){R=P[I+=1];var L=e.util.getProperty(R),M=(x=e.util.escapeQuotes(R),u+L);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(b,R,e.opts.jsonPointers)),i+=" if ( "+M+" === undefined ",y&&(i+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(R)+"') "),i+=") {  var err =   ",!1!==e.createErrors?(i+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { property: '"+e.util.escapeQuotes(S)+"', missingProperty: '"+x+"', depsCount: "+_.length+", deps: '"+e.util.escapeQuotes(1==_.length?_[0]:_.join(", "))+"' } ",!1!==e.opts.messages&&(i+=" , message: 'should have ",1==_.length?i+="property "+e.util.escapeQuotes(_[0]):i+="properties "+e.util.escapeQuotes(_.join(", ")),i+=" when property "+e.util.escapeQuotes(S)+" is present' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}i+=" }   ",l&&(m+="}",i+=" else { ")}e.errorPath=b;var k=h.baseId;for(var S in f){v=f[S];(e.opts.strictKeywords?"object"==typeof v&&Object.keys(v).length>0:e.util.schemaHasRules(v,e.RULES.all))&&(i+=" "+p+" = true; if ( "+u+e.util.getProperty(S)+" !== undefined ",y&&(i+=" && Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(S)+"') "),i+=") { ",h.schema=v,h.schemaPath=s+e.util.getProperty(S),h.errSchemaPath=c+"/"+e.util.escapeFragment(S),i+="  "+e.validate(h)+" ",h.baseId=k,i+=" }  ",l&&(i+=" if ("+p+") { ",m+="}"))}return l&&(i+="   "+m+" if ("+d+" == errors) {"),i=e.util.cleanUpCode(i)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,h=e.opts.$data&&a&&a.$data;h&&(i+=" var schema"+n+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; ");var m="i"+n,p="schema"+n;h||(i+=" var "+p+" = validate.schema"+s+";"),i+="var "+d+";",h&&(i+=" if (schema"+n+" === undefined) "+d+" = true; else if (!Array.isArray(schema"+n+")) "+d+" = false; else {"),i+=d+" = false;for (var "+m+"=0; "+m+"<"+p+".length; "+m+"++) if (equal("+u+", "+p+"["+m+"])) { "+d+" = true; break; }",h&&(i+="  }  "),i+=" if (!"+d+") {   ";var f=f||[];f.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { allowedValues: schema"+n+" } ",!1!==e.opts.messages&&(i+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var g=i;return i=f.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+g+"]); ":i+=" validate.errors = ["+g+"]; return false; ":i+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" }",l&&(i+=" else { "),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(o||"");if(!1===e.opts.format)return l&&(i+=" if (true) { "),i;var d,h=e.opts.$data&&a&&a.$data;h?(i+=" var schema"+n+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; ",d="schema"+n):d=a;var m=e.opts.unknownFormats,p=Array.isArray(m);if(h){i+=" var "+(f="format"+n)+" = formats["+d+"]; var "+(g="isObject"+n)+" = typeof "+f+" == 'object' && !("+f+" instanceof RegExp) && "+f+".validate; var "+(y="formatType"+n)+" = "+g+" && "+f+".type || 'string'; if ("+g+") { ",e.async&&(i+=" var async"+n+" = "+f+".async; "),i+=" "+f+" = "+f+".validate; } if (  ",h&&(i+=" ("+d+" !== undefined && typeof "+d+" != 'string') || "),i+=" (","ignore"!=m&&(i+=" ("+d+" && !"+f+" ",p&&(i+=" && self._opts.unknownFormats.indexOf("+d+") == -1 "),i+=") || "),i+=" ("+f+" && "+y+" == '"+r+"' && !(typeof "+f+" == 'function' ? ",e.async?i+=" (async"+n+" ? await "+f+"("+u+") : "+f+"("+u+")) ":i+=" "+f+"("+u+") ",i+=" : "+f+".test("+u+"))))) {"}else{var f;if(!(f=e.formats[a])){if("ignore"==m)return e.logger.warn('unknown format "'+a+'" ignored in schema at path "'+e.errSchemaPath+'"'),l&&(i+=" if (true) { "),i;if(p&&m.indexOf(a)>=0)return l&&(i+=" if (true) { "),i;throw new Error('unknown format "'+a+'" is used in schema at path "'+e.errSchemaPath+'"')}var g,y=(g="object"==typeof f&&!(f instanceof RegExp)&&f.validate)&&f.type||"string";if(g){var v=!0===f.async;f=f.validate}if(y!=r)return l&&(i+=" if (true) { "),i;if(v){if(!e.async)throw new Error("async format in sync schema");i+=" if (!(await "+(_="formats"+e.util.getProperty(a)+".validate")+"("+u+"))) { "}else{i+=" if (! ";var _="formats"+e.util.getProperty(a);g&&(_+=".validate"),i+="function"==typeof f?" "+_+"("+u+") ":" "+_+".test("+u+") ",i+=") { "}}var b=b||[];b.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { format:  ",i+=h?""+d:""+e.util.toQuotedString(a),i+="  } ",!1!==e.opts.messages&&(i+=" , message: 'should match format \"",i+=h?"' + "+d+" + '":""+e.util.escapeQuotes(a),i+="\"' "),e.opts.verbose&&(i+=" , schema:  ",i+=h?"validate.schema"+s:""+e.util.toQuotedString(a),i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var S=i;return i=b.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+S+"]); ":i+=" validate.errors = ["+S+"]; return false; ":i+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",l&&(i+=" else { "),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,h="errs__"+n,m=e.util.copy(e);m.level++;var p="valid"+m.level,f=e.schema.then,g=e.schema.else,y=void 0!==f&&(e.opts.strictKeywords?"object"==typeof f&&Object.keys(f).length>0:e.util.schemaHasRules(f,e.RULES.all)),v=void 0!==g&&(e.opts.strictKeywords?"object"==typeof g&&Object.keys(g).length>0:e.util.schemaHasRules(g,e.RULES.all)),_=m.baseId;if(y||v){var b;m.createErrors=!1,m.schema=a,m.schemaPath=s,m.errSchemaPath=c,i+=" var "+h+" = errors; var "+d+" = true;  ";var S=e.compositeRule;e.compositeRule=m.compositeRule=!0,i+="  "+e.validate(m)+" ",m.baseId=_,m.createErrors=!0,i+="  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; }  ",e.compositeRule=m.compositeRule=S,y?(i+=" if ("+p+") {  ",m.schema=e.schema.then,m.schemaPath=e.schemaPath+".then",m.errSchemaPath=e.errSchemaPath+"/then",i+="  "+e.validate(m)+" ",m.baseId=_,i+=" "+d+" = "+p+"; ",y&&v?i+=" var "+(b="ifClause"+n)+" = 'then'; ":b="'then'",i+=" } ",v&&(i+=" else { ")):i+=" if (!"+p+") { ",v&&(m.schema=e.schema.else,m.schemaPath=e.schemaPath+".else",m.errSchemaPath=e.errSchemaPath+"/else",i+="  "+e.validate(m)+" ",m.baseId=_,i+=" "+d+" = "+p+"; ",y&&v?i+=" var "+(b="ifClause"+n)+" = 'else'; ":b="'else'",i+=" } "),i+=" if (!"+d+") {   var err =   ",!1!==e.createErrors?(i+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { failingKeyword: "+b+" } ",!1!==e.opts.messages&&(i+=" , message: 'should match \"' + "+b+" + '\" schema' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&l&&(e.async?i+=" throw new ValidationError(vErrors); ":i+=" validate.errors = vErrors; return false; "),i+=" }   ",l&&(i+=" else { "),i=e.util.cleanUpCode(i)}else l&&(i+=" if (true) { ");return i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,h="errs__"+n,m=e.util.copy(e),p="";m.level++;var f="valid"+m.level,g="i"+n,y=m.dataLevel=e.dataLevel+1,v="data"+y,_=e.baseId;if(i+="var "+h+" = errors;var "+d+";",Array.isArray(a)){var b=e.schema.additionalItems;if(!1===b){i+=" "+d+" = "+u+".length <= "+a.length+"; ";var S=c;c=e.errSchemaPath+"/additionalItems",i+="  if (!"+d+") {   ";var T=T||[];T.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+a.length+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have more than "+a.length+" items' "),e.opts.verbose&&(i+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var E=i;i=T.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+E+"]); ":i+=" validate.errors = ["+E+"]; return false; ":i+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",c=S,l&&(p+="}",i+=" else { ")}var w=a;if(w)for(var C,x=-1,O=w.length-1;x<O;)if(C=w[x+=1],e.opts.strictKeywords?"object"==typeof C&&Object.keys(C).length>0:e.util.schemaHasRules(C,e.RULES.all)){i+=" "+f+" = true; if ("+u+".length > "+x+") { ";var A=u+"["+x+"]";m.schema=C,m.schemaPath=s+"["+x+"]",m.errSchemaPath=c+"/"+x,m.errorPath=e.util.getPathExpr(e.errorPath,x,e.opts.jsonPointers,!0),m.dataPathArr[y]=x;var P=e.validate(m);m.baseId=_,e.util.varOccurences(P,v)<2?i+=" "+e.util.varReplace(P,v,A)+" ":i+=" var "+v+" = "+A+"; "+P+" ",i+=" }  ",l&&(i+=" if ("+f+") { ",p+="}")}if("object"==typeof b&&(e.opts.strictKeywords?"object"==typeof b&&Object.keys(b).length>0:e.util.schemaHasRules(b,e.RULES.all))){m.schema=b,m.schemaPath=e.schemaPath+".additionalItems",m.errSchemaPath=e.errSchemaPath+"/additionalItems",i+=" "+f+" = true; if ("+u+".length > "+a.length+") {  for (var "+g+" = "+a.length+"; "+g+" < "+u+".length; "+g+"++) { ",m.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers,!0);A=u+"["+g+"]";m.dataPathArr[y]=g;P=e.validate(m);m.baseId=_,e.util.varOccurences(P,v)<2?i+=" "+e.util.varReplace(P,v,A)+" ":i+=" var "+v+" = "+A+"; "+P+" ",l&&(i+=" if (!"+f+") break; "),i+=" } }  ",l&&(i+=" if ("+f+") { ",p+="}")}}else if(e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0:e.util.schemaHasRules(a,e.RULES.all)){m.schema=a,m.schemaPath=s,m.errSchemaPath=c,i+="  for (var "+g+" = 0; "+g+" < "+u+".length; "+g+"++) { ",m.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers,!0);A=u+"["+g+"]";m.dataPathArr[y]=g;P=e.validate(m);m.baseId=_,e.util.varOccurences(P,v)<2?i+=" "+e.util.varReplace(P,v,A)+" ":i+=" var "+v+" = "+A+"; "+P+" ",l&&(i+=" if (!"+f+") break; "),i+=" }"}return l&&(i+=" "+p+" if ("+h+" == errors) {"),i=e.util.cleanUpCode(i)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,n=" ",o=e.level,a=e.dataLevel,s=e.schema[t],c=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&s&&s.$data;h?(n+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",i="schema"+o):i=s,n+="var division"+o+";if (",h&&(n+=" "+i+" !== undefined && ( typeof "+i+" != 'number' || "),n+=" (division"+o+" = "+d+" / "+i+", ",e.opts.multipleOfPrecision?n+=" Math.abs(Math.round(division"+o+") - division"+o+") > 1e-"+e.opts.multipleOfPrecision+" ":n+=" division"+o+" !== parseInt(division"+o+") ",n+=" ) ",h&&(n+="  )  "),n+=" ) {   ";var m=m||[];m.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { multipleOf: "+i+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be multiple of ",n+=h?"' + "+i:i+"'"),e.opts.verbose&&(n+=" , schema:  ",n+=h?"validate.schema"+c:""+s,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var p=n;return n=m.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+p+"]); ":n+=" validate.errors = ["+p+"]; return false; ":n+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",u&&(n+=" else { "),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(o||""),d="errs__"+n,h=e.util.copy(e);h.level++;var m="valid"+h.level;if(e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0:e.util.schemaHasRules(a,e.RULES.all)){h.schema=a,h.schemaPath=s,h.errSchemaPath=c,i+=" var "+d+" = errors;  ";var p,f=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.createErrors=!1,h.opts.allErrors&&(p=h.opts.allErrors,h.opts.allErrors=!1),i+=" "+e.validate(h)+" ",h.createErrors=!0,p&&(h.opts.allErrors=p),e.compositeRule=h.compositeRule=f,i+=" if ("+m+") {   ";var g=g||[];g.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(i+=" , message: 'should NOT be valid' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var y=i;i=g.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+y+"]); ":i+=" validate.errors = ["+y+"]; return false; ":i+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } ",e.opts.allErrors&&(i+=" } ")}else i+="  var err =   ",!1!==e.createErrors?(i+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(i+=" , message: 'should NOT be valid' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l&&(i+=" if (false) { ");return i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,h="errs__"+n,m=e.util.copy(e),p="";m.level++;var f="valid"+m.level,g=m.baseId,y="prevValid"+n,v="passingSchemas"+n;i+="var "+h+" = errors , "+y+" = false , "+d+" = false , "+v+" = null; ";var _=e.compositeRule;e.compositeRule=m.compositeRule=!0;var b=a;if(b)for(var S,T=-1,E=b.length-1;T<E;)S=b[T+=1],(e.opts.strictKeywords?"object"==typeof S&&Object.keys(S).length>0:e.util.schemaHasRules(S,e.RULES.all))?(m.schema=S,m.schemaPath=s+"["+T+"]",m.errSchemaPath=c+"/"+T,i+="  "+e.validate(m)+" ",m.baseId=g):i+=" var "+f+" = true; ",T&&(i+=" if ("+f+" && "+y+") { "+d+" = false; "+v+" = ["+v+", "+T+"]; } else { ",p+="}"),i+=" if ("+f+") { "+d+" = "+y+" = true; "+v+" = "+T+"; }";return e.compositeRule=m.compositeRule=_,i+=p+"if (!"+d+") {   var err =   ",!1!==e.createErrors?(i+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { passingSchemas: "+v+" } ",!1!==e.opts.messages&&(i+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&l&&(e.async?i+=" throw new ValidationError(vErrors); ":i+=" validate.errors = vErrors; return false; "),i+="} else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; }",e.opts.allErrors&&(i+=" } "),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,n=" ",o=e.level,a=e.dataLevel,s=e.schema[t],c=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&s&&s.$data;h?(n+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",i="schema"+o):i=s,n+="if ( ",h&&(n+=" ("+i+" !== undefined && typeof "+i+" != 'string') || "),n+=" !"+(h?"(new RegExp("+i+"))":e.usePattern(s))+".test("+d+") ) {   ";var m=m||[];m.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { pattern:  ",n+=h?""+i:""+e.util.toQuotedString(s),n+="  } ",!1!==e.opts.messages&&(n+=" , message: 'should match pattern \"",n+=h?"' + "+i+" + '":""+e.util.escapeQuotes(s),n+="\"' "),e.opts.verbose&&(n+=" , schema:  ",n+=h?"validate.schema"+c:""+e.util.toQuotedString(s),n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var p=n;return n=m.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+p+"]); ":n+=" validate.errors = ["+p+"]; return false; ":n+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",u&&(n+=" else { "),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(o||""),d="errs__"+n,h=e.util.copy(e),m="";h.level++;var p="valid"+h.level,f="key"+n,g="idx"+n,y=h.dataLevel=e.dataLevel+1,v="data"+y,_="dataProperties"+n,b=Object.keys(a||{}),S=e.schema.patternProperties||{},T=Object.keys(S),E=e.schema.additionalProperties,w=b.length||T.length,C=!1===E,x="object"==typeof E&&Object.keys(E).length,O=e.opts.removeAdditional,A=C||x||O,P=e.opts.ownProperties,R=e.baseId,I=e.schema.required;if(I&&(!e.opts.$data||!I.$data)&&I.length<e.opts.loopRequired)var D=e.util.toHash(I);if(i+="var "+d+" = errors;var "+p+" = true;",P&&(i+=" var "+_+" = undefined;"),A){if(i+=P?" "+_+" = "+_+" || Object.keys("+u+"); for (var "+g+"=0; "+g+"<"+_+".length; "+g+"++) { var "+f+" = "+_+"["+g+"]; ":" for (var "+f+" in "+u+") { ",w){if(i+=" var isAdditional"+n+" = !(false ",b.length)if(b.length>8)i+=" || validate.schema"+s+".hasOwnProperty("+f+") ";else{var L=b;if(L)for(var M=-1,k=L.length-1;M<k;)Y=L[M+=1],i+=" || "+f+" == "+e.util.toQuotedString(Y)+" "}if(T.length){var N=T;if(N)for(var F=-1,U=N.length-1;F<U;)ne=N[F+=1],i+=" || "+e.usePattern(ne)+".test("+f+") "}i+=" ); if (isAdditional"+n+") { "}if("all"==O)i+=" delete "+u+"["+f+"]; ";else{var j=e.errorPath,V="' + "+f+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers)),C)if(O)i+=" delete "+u+"["+f+"]; ";else{i+=" "+p+" = false; ";var B=c;c=e.errSchemaPath+"/additionalProperties",(te=te||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { additionalProperty: '"+V+"' } ",!1!==e.opts.messages&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is an invalid additional property":i+="should NOT have additional properties",i+="' "),e.opts.verbose&&(i+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var G=i;i=te.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+G+"]); ":i+=" validate.errors = ["+G+"]; return false; ":i+=" var err = "+G+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c=B,l&&(i+=" break; ")}else if(x)if("failing"==O){i+=" var "+d+" = errors;  ";var z=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.schema=E,h.schemaPath=e.schemaPath+".additionalProperties",h.errSchemaPath=e.errSchemaPath+"/additionalProperties",h.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers);var q=u+"["+f+"]";h.dataPathArr[y]=f;var H=e.validate(h);h.baseId=R,e.util.varOccurences(H,v)<2?i+=" "+e.util.varReplace(H,v,q)+" ":i+=" var "+v+" = "+q+"; "+H+" ",i+=" if (!"+p+") { errors = "+d+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+u+"["+f+"]; }  ",e.compositeRule=h.compositeRule=z}else{h.schema=E,h.schemaPath=e.schemaPath+".additionalProperties",h.errSchemaPath=e.errSchemaPath+"/additionalProperties",h.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers);q=u+"["+f+"]";h.dataPathArr[y]=f;H=e.validate(h);h.baseId=R,e.util.varOccurences(H,v)<2?i+=" "+e.util.varReplace(H,v,q)+" ":i+=" var "+v+" = "+q+"; "+H+" ",l&&(i+=" if (!"+p+") break; ")}e.errorPath=j}w&&(i+=" } "),i+=" }  ",l&&(i+=" if ("+p+") { ",m+="}")}var W=e.opts.useDefaults&&!e.compositeRule;if(b.length){var K=b;if(K)for(var Y,$=-1,Z=K.length-1;$<Z;){var J=a[Y=K[$+=1]];if(e.opts.strictKeywords?"object"==typeof J&&Object.keys(J).length>0:e.util.schemaHasRules(J,e.RULES.all)){var X=e.util.getProperty(Y),Q=(q=u+X,W&&void 0!==J.default);h.schema=J,h.schemaPath=s+X,h.errSchemaPath=c+"/"+e.util.escapeFragment(Y),h.errorPath=e.util.getPath(e.errorPath,Y,e.opts.jsonPointers),h.dataPathArr[y]=e.util.toQuotedString(Y);H=e.validate(h);if(h.baseId=R,e.util.varOccurences(H,v)<2){H=e.util.varReplace(H,v,q);var ee=q}else{ee=v;i+=" var "+v+" = "+q+"; "}if(Q)i+=" "+H+" ";else{if(D&&D[Y]){i+=" if ( "+ee+" === undefined ",P&&(i+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(Y)+"') "),i+=") { "+p+" = false; ";j=e.errorPath,B=c;var te,re=e.util.escapeQuotes(Y);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(j,Y,e.opts.jsonPointers)),c=e.errSchemaPath+"/required",(te=te||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+re+"' } ",!1!==e.opts.messages&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+re+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";G=i;i=te.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+G+"]); ":i+=" validate.errors = ["+G+"]; return false; ":i+=" var err = "+G+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c=B,e.errorPath=j,i+=" } else { "}else l?(i+=" if ( "+ee+" === undefined ",P&&(i+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(Y)+"') "),i+=") { "+p+" = true; } else { "):(i+=" if ("+ee+" !== undefined ",P&&(i+=" &&   Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(Y)+"') "),i+=" ) { ");i+=" "+H+" } "}}l&&(i+=" if ("+p+") { ",m+="}")}}if(T.length){var ie=T;if(ie)for(var ne,oe=-1,ae=ie.length-1;oe<ae;){J=S[ne=ie[oe+=1]];if(e.opts.strictKeywords?"object"==typeof J&&Object.keys(J).length>0:e.util.schemaHasRules(J,e.RULES.all)){h.schema=J,h.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(ne),h.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(ne),i+=P?" "+_+" = "+_+" || Object.keys("+u+"); for (var "+g+"=0; "+g+"<"+_+".length; "+g+"++) { var "+f+" = "+_+"["+g+"]; ":" for (var "+f+" in "+u+") { ",i+=" if ("+e.usePattern(ne)+".test("+f+")) { ",h.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers);q=u+"["+f+"]";h.dataPathArr[y]=f;H=e.validate(h);h.baseId=R,e.util.varOccurences(H,v)<2?i+=" "+e.util.varReplace(H,v,q)+" ":i+=" var "+v+" = "+q+"; "+H+" ",l&&(i+=" if (!"+p+") break; "),i+=" } ",l&&(i+=" else "+p+" = true; "),i+=" }  ",l&&(i+=" if ("+p+") { ",m+="}")}}}return l&&(i+=" "+m+" if ("+d+" == errors) {"),i=e.util.cleanUpCode(i)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(o||""),d="errs__"+n,h=e.util.copy(e);h.level++;var m="valid"+h.level;if(i+="var "+d+" = errors;",e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0:e.util.schemaHasRules(a,e.RULES.all)){h.schema=a,h.schemaPath=s,h.errSchemaPath=c;var p="key"+n,f="idx"+n,g="i"+n,y="' + "+p+" + '",v="data"+(h.dataLevel=e.dataLevel+1),_="dataProperties"+n,b=e.opts.ownProperties,S=e.baseId;b&&(i+=" var "+_+" = undefined; "),i+=b?" "+_+" = "+_+" || Object.keys("+u+"); for (var "+f+"=0; "+f+"<"+_+".length; "+f+"++) { var "+p+" = "+_+"["+f+"]; ":" for (var "+p+" in "+u+") { ",i+=" var startErrs"+n+" = errors; ";var T=p,E=e.compositeRule;e.compositeRule=h.compositeRule=!0;var w=e.validate(h);h.baseId=S,e.util.varOccurences(w,v)<2?i+=" "+e.util.varReplace(w,v,T)+" ":i+=" var "+v+" = "+T+"; "+w+" ",e.compositeRule=h.compositeRule=E,i+=" if (!"+m+") { for (var "+g+"=startErrs"+n+"; "+g+"<errors; "+g+"++) { vErrors["+g+"].propertyName = "+p+"; }   var err =   ",!1!==e.createErrors?(i+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { propertyName: '"+y+"' } ",!1!==e.opts.messages&&(i+=" , message: 'property name \\'"+y+"\\' is invalid' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&l&&(e.async?i+=" throw new ValidationError(vErrors); ":i+=" validate.errors = vErrors; return false; "),l&&(i+=" break; "),i+=" } }"}return l&&(i+="  if ("+d+" == errors) {"),i=e.util.cleanUpCode(i)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,h=e.opts.$data&&a&&a.$data;h&&(i+=" var schema"+n+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; ");var m="schema"+n;if(!h)if(a.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var p=[],f=a;if(f)for(var g,y=-1,v=f.length-1;y<v;){g=f[y+=1];var _=e.schema.properties[g];_&&(e.opts.strictKeywords?"object"==typeof _&&Object.keys(_).length>0:e.util.schemaHasRules(_,e.RULES.all))||(p[p.length]=g)}}else p=a;if(h||p.length){var b=e.errorPath,S=h||p.length>=e.opts.loopRequired,T=e.opts.ownProperties;if(l)if(i+=" var missing"+n+"; ",S){h||(i+=" var "+m+" = validate.schema"+s+"; ");var E="' + "+(P="schema"+n+"["+(x="i"+n)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(b,P,e.opts.jsonPointers)),i+=" var "+d+" = true; ",h&&(i+=" if (schema"+n+" === undefined) "+d+" = true; else if (!Array.isArray(schema"+n+")) "+d+" = false; else {"),i+=" for (var "+x+" = 0; "+x+" < "+m+".length; "+x+"++) { "+d+" = "+u+"["+m+"["+x+"]] !== undefined ",T&&(i+=" &&   Object.prototype.hasOwnProperty.call("+u+", "+m+"["+x+"]) "),i+="; if (!"+d+") break; } ",h&&(i+="  }  "),i+="  if (!"+d+") {   ",(A=A||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+E+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var w=i;i=A.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+w+"]); ":i+=" validate.errors = ["+w+"]; return false; ":i+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else { "}else{i+=" if ( ";var C=p;if(C)for(var x=-1,O=C.length-1;x<O;){I=C[x+=1],x&&(i+=" || "),i+=" ( ( "+(k=u+(M=e.util.getProperty(I)))+" === undefined ",T&&(i+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(I)+"') "),i+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?I:M)+") ) "}i+=") {  ";var A;E="' + "+(P="missing"+n)+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(b,P,!0):b+" + "+P),(A=A||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+E+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";w=i;i=A.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+w+"]); ":i+=" validate.errors = ["+w+"]; return false; ":i+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else { "}else if(S){h||(i+=" var "+m+" = validate.schema"+s+"; ");var P;E="' + "+(P="schema"+n+"["+(x="i"+n)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(b,P,e.opts.jsonPointers)),h&&(i+=" if ("+m+" && !Array.isArray("+m+")) {  var err =   ",!1!==e.createErrors?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+E+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+m+" !== undefined) { "),i+=" for (var "+x+" = 0; "+x+" < "+m+".length; "+x+"++) { if ("+u+"["+m+"["+x+"]] === undefined ",T&&(i+=" || ! Object.prototype.hasOwnProperty.call("+u+", "+m+"["+x+"]) "),i+=") {  var err =   ",!1!==e.createErrors?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+E+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",h&&(i+="  }  ")}else{var R=p;if(R)for(var I,D=-1,L=R.length-1;D<L;){I=R[D+=1];var M=e.util.getProperty(I),k=(E=e.util.escapeQuotes(I),u+M);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(b,I,e.opts.jsonPointers)),i+=" if ( "+k+" === undefined ",T&&(i+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(I)+"') "),i+=") {  var err =   ",!1!==e.createErrors?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+E+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=b}else l&&(i+=" if (true) {");return i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,n=" ",o=e.level,a=e.dataLevel,s=e.schema[t],c=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h="valid"+o,m=e.opts.$data&&s&&s.$data;if(m?(n+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",i="schema"+o):i=s,(s||m)&&!1!==e.opts.uniqueItems){m&&(n+=" var "+h+"; if ("+i+" === false || "+i+" === undefined) "+h+" = true; else if (typeof "+i+" != 'boolean') "+h+" = false; else { "),n+=" var i = "+d+".length , "+h+" = true , j; if (i > 1) { ";var p=e.schema.items&&e.schema.items.type,f=Array.isArray(p);if(!p||"object"==p||"array"==p||f&&(p.indexOf("object")>=0||p.indexOf("array")>=0))n+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+d+"[i], "+d+"[j])) { "+h+" = false; break outer; } } } ";else{n+=" var itemIndices = {}, item; for (;i--;) { var item = "+d+"[i]; ";var g="checkDataType"+(f?"s":"");n+=" if ("+e.util[g](p,"item",!0)+") continue; ",f&&(n+=" if (typeof item == 'string') item = '\"' + item; "),n+=" if (typeof itemIndices[item] == 'number') { "+h+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}n+=" } ",m&&(n+="  }  "),n+=" if (!"+h+") {   ";var y=y||[];y.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { i: i, j: j } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(n+=" , schema:  ",n+=m?"validate.schema"+c:""+s,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var v=n;n=y.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+v+"]); ":n+=" validate.errors = ["+v+"]; return false; ":n+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",u&&(n+=" else { ")}else u&&(n+=" if (true) { ");return n}},function(e,t,r){"use strict";var i=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];e.exports=function(e,t){for(var r=0;r<t.length;r++){e=JSON.parse(JSON.stringify(e));var n,o=t[r].split("/"),a=e;for(n=1;n<o.length;n++)a=a[o[n]];for(n=0;n<i.length;n++){var s=i[n],c=a[s];c&&(a[s]={anyOf:[c,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"}]})}}return e}},function(e,t,r){"use strict";var i=r(120).MissingRef;e.exports=function e(t,r,n){var o=this;if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");"function"==typeof r&&(n=r,r=void 0);var a=s(t).then((function(){var e=o._addSchema(t,void 0,r);return e.validate||function e(t){try{return o._compile(t)}catch(n){if(n instanceof i)return function(i){var n=i.missingSchema;if(l(n))throw new Error("Schema "+n+" is loaded but "+i.missingRef+" cannot be resolved");var a=o._loadingSchemas[n];a||(a=o._loadingSchemas[n]=o._opts.loadSchema(n)).then(c,c);return a.then((function(e){if(!l(n))return s(e).then((function(){l(n)||o.addSchema(e,n,void 0,r)}))})).then((function(){return e(t)}));function c(){delete o._loadingSchemas[n]}function l(e){return o._refs[e]||o._schemas[e]}}(n);throw n}}(e)}));n&&a.then((function(e){n(null,e)}),n);return a;function s(t){var r=t.$schema;return r&&!o.getSchema(r)?e.call(o,{$ref:r},!0):Promise.resolve()}}},function(e,t,r){"use strict";var i=/^[a-z_$][a-z0-9_$-]*$/i,n=r(488),o=r(489);e.exports={add:function(e,t){var r=this.RULES;if(r.keywords[e])throw new Error("Keyword "+e+" is already defined");if(!i.test(e))throw new Error("Keyword "+e+" is not a valid identifier");if(t){this.validateKeyword(t,!0);var o=t.type;if(Array.isArray(o))for(var a=0;a<o.length;a++)c(e,o[a],t);else c(e,o,t);var s=t.metaSchema;s&&(t.$data&&this._opts.$data&&(s={anyOf:[s,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"}]}),t.validateSchema=this.compile(s,!0))}function c(e,t,i){for(var o,a=0;a<r.length;a++){var s=r[a];if(s.type==t){o=s;break}}o||(o={type:t,rules:[]},r.push(o));var c={keyword:e,definition:i,custom:!0,code:n,implements:i.implements};o.rules.push(c),r.custom[e]=c}return r.keywords[e]=r.all[e]=!0,this},get:function(e){var t=this.RULES.custom[e];return t?t.definition:this.RULES.keywords[e]||!1},remove:function(e){var t=this.RULES;delete t.keywords[e],delete t.all[e],delete t.custom[e];for(var r=0;r<t.length;r++)for(var i=t[r].rules,n=0;n<i.length;n++)if(i[n].keyword==e){i.splice(n,1);break}return this},validate:function e(t,r){e.errors=null;var i=this._validateKeyword=this._validateKeyword||this.compile(o,!0);if(i(t))return!0;if(e.errors=i.errors,r)throw new Error("custom keyword definition is invalid: "+this.errorsText(i.errors));return!1}}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,n,o=" ",a=e.level,s=e.dataLevel,c=e.schema[t],l=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,h="data"+(s||""),m="valid"+a,p="errs__"+a,f=e.opts.$data&&c&&c.$data;f?(o+=" var schema"+a+" = "+e.util.getData(c.$data,s,e.dataPathArr)+"; ",n="schema"+a):n=c;var g,y,v,_,b,S="definition"+a,T=this.definition,E="";if(f&&T.$data){b="keywordValidate"+a;var w=T.validateSchema;o+=" var "+S+" = RULES.custom['"+t+"'].definition; var "+b+" = "+S+".validate;"}else{if(!(_=e.useCustomRule(this,c,e.schema,e)))return;n="validate.schema"+l,b=_.code,g=T.compile,y=T.inline,v=T.macro}var C=b+".errors",x="i"+a,O="ruleErr"+a,A=T.async;if(A&&!e.async)throw new Error("async keyword in sync schema");if(y||v||(o+=C+" = null;"),o+="var "+p+" = errors;var "+m+";",f&&T.$data&&(E+="}",o+=" if ("+n+" === undefined) { "+m+" = true; } else { ",w&&(E+="}",o+=" "+m+" = "+S+".validateSchema("+n+"); if ("+m+") { ")),y)T.statements?o+=" "+_.validate+" ":o+=" "+m+" = "+_.validate+"; ";else if(v){var P=e.util.copy(e);E="";P.level++;var R="valid"+P.level;P.schema=_.validate,P.schemaPath="";var I=e.compositeRule;e.compositeRule=P.compositeRule=!0;var D=e.validate(P).replace(/validate\.schema/g,b);e.compositeRule=P.compositeRule=I,o+=" "+D}else{(N=N||[]).push(o),o="",o+="  "+b+".call( ",e.opts.passContext?o+="this":o+="self",g||!1===T.schema?o+=" , "+h+" ":o+=" , "+n+" , "+h+" , validate.schema"+e.schemaPath+" ",o+=" , (dataPath || '')",'""'!=e.errorPath&&(o+=" + "+e.errorPath);var L=s?"data"+(s-1||""):"parentData",M=s?e.dataPathArr[s]:"parentDataProperty",k=o+=" , "+L+" , "+M+" , rootData )  ";o=N.pop(),!1===T.errors?(o+=" "+m+" = ",A&&(o+="await "),o+=k+"; "):o+=A?" var "+(C="customErrors"+a)+" = null; try { "+m+" = await "+k+"; } catch (e) { "+m+" = false; if (e instanceof ValidationError) "+C+" = e.errors; else throw e; } ":" "+C+" = null; "+m+" = "+k+"; "}if(T.modifying&&(o+=" if ("+L+") "+h+" = "+L+"["+M+"];"),o+=""+E,T.valid)d&&(o+=" if (true) { ");else{var N;o+=" if ( ",void 0===T.valid?(o+=" !",o+=v?""+R:""+m):o+=" "+!T.valid+" ",o+=") { ",i=this.keyword,(N=N||[]).push(o),o="",(N=N||[]).push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(i||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+this.keyword+"' } ",!1!==e.opts.messages&&(o+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),e.opts.verbose&&(o+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),o+=" } "):o+=" {} ";var F=o;o=N.pop(),!e.compositeRule&&d?e.async?o+=" throw new ValidationError(["+F+"]); ":o+=" validate.errors = ["+F+"]; return false; ":o+=" var err = "+F+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var U=o;o=N.pop(),y?T.errors?"full"!=T.errors&&(o+="  for (var "+x+"="+p+"; "+x+"<errors; "+x+"++) { var "+O+" = vErrors["+x+"]; if ("+O+".dataPath === undefined) "+O+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+O+".schemaPath === undefined) { "+O+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(o+=" "+O+".schema = "+n+"; "+O+".data = "+h+"; "),o+=" } "):!1===T.errors?o+=" "+U+" ":(o+=" if ("+p+" == errors) { "+U+" } else {  for (var "+x+"="+p+"; "+x+"<errors; "+x+"++) { var "+O+" = vErrors["+x+"]; if ("+O+".dataPath === undefined) "+O+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+O+".schemaPath === undefined) { "+O+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(o+=" "+O+".schema = "+n+"; "+O+".data = "+h+"; "),o+=" } } "):v?(o+="   var err =   ",!1!==e.createErrors?(o+=" { keyword: '"+(i||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+this.keyword+"' } ",!1!==e.opts.messages&&(o+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),e.opts.verbose&&(o+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),o+=" } "):o+=" {} ",o+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&d&&(e.async?o+=" throw new ValidationError(vErrors); ":o+=" validate.errors = vErrors; return false; ")):!1===T.errors?o+=" "+U+" ":(o+=" if (Array.isArray("+C+")) { if (vErrors === null) vErrors = "+C+"; else vErrors = vErrors.concat("+C+"); errors = vErrors.length;  for (var "+x+"="+p+"; "+x+"<errors; "+x+"++) { var "+O+" = vErrors["+x+"]; if ("+O+".dataPath === undefined) "+O+".dataPath = (dataPath || '') + "+e.errorPath+";  "+O+'.schemaPath = "'+u+'";  ',e.opts.verbose&&(o+=" "+O+".schema = "+n+"; "+O+".data = "+h+"; "),o+=" } } else { "+U+" } "),o+=" } ",d&&(o+=" else { ")}return o}},function(e,t,r){"use strict";var i=r(243);e.exports={$id:"https://github.com/epoberezkin/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:i.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:i.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}},function(e){e.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON Schema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.geoJSONSchema={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://geojson.org/schema/GeoJSON.json",title:"GeoJSON",oneOf:[{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON GeometryCollection",type:"object",required:["type","geometries"],properties:{type:{type:"string",enum:["GeometryCollection"]},geometries:{type:"array",items:{oneOf:[{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Feature",type:"object",required:["type","properties","geometry"],properties:{type:{type:"string",enum:["Feature"]},properties:{oneOf:[{type:"null"},{type:"object"}]},geometry:{oneOf:[{type:"null"},{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON GeometryCollection",type:"object",required:["type","geometries"],properties:{type:{type:"string",enum:["GeometryCollection"]},geometries:{type:"array",items:{oneOf:[{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON FeatureCollection",type:"object",required:["type","features"],properties:{type:{type:"string",enum:["FeatureCollection"]},features:{type:"array",items:{title:"GeoJSON Feature",type:"object",required:["type","properties","geometry"],properties:{type:{type:"string",enum:["Feature"]},properties:{oneOf:[{type:"null"},{type:"object"}]},geometry:{oneOf:[{type:"null"},{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON GeometryCollection",type:"object",required:["type","geometries"],properties:{type:{type:"string",enum:["GeometryCollection"]},geometries:{type:"array",items:{oneOf:[{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]},bbox:{type:"array",minItems:4,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=[[44,21.5344653,44,37.0340915,29.8011135,38.7364679,22.0000435,60],[22.0000435,60,14.1988865,38.7364679,0,37.0340915,0,21.5344653],[0,21.5344653,0,9.64132348,9.84973132,0,22.0000435,0],[22.0000435,0,34.1501817,0,44,9.64132348,44,21.5344653]],o=[n[0][0],n[0][0]],a=[n[0][1],n[0][1]];let s=`M${n[0][0]},${n[0][1]} `;for(const e of n){s+=`C${e[2]},${e[3]} ${e[4]},${e[5]} ${e[6]},${e[7]} `;for(let t=0;t<8;t++)e[t]<o[0]?o[0]=e[t]:e[t]>o[1]&&(o[1]=e[t]),e[++t]<a[0]?a[0]=e[t]:e[t]>a[1]&&(a[1]=e[t])}const c=s+="Z",l=new i.Vector2(o[0]+(o[1]-o[0])/2,-(a[1]-a[0])),u=1/(a[1]-a[0]),d=n.map(e=>new i.CubicBezierCurve(new i.Vector2(e[0],-e[1]).sub(l).multiplyScalar(u),new i.Vector2(e[2],-e[3]).sub(l).multiplyScalar(u),new i.Vector2(e[4],-e[5]).sub(l).multiplyScalar(u),new i.Vector2(e[6],-e[7]).sub(l).multiplyScalar(u)));t.defaultMarkerMask=`\ndata:image/svg+xml;utf8,<svg width="256px" height="256px" viewBox="0 0 256 256" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <defs>\n        <path d="${c}" id="path-1"></path>\n    </defs>\n    <g id="icons/icon-GeoJSON_Vector_marker" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="marker" transform="translate(106.0, 68.0)">\n            <circle id="point" stroke="rgb(0, 34, 0)" stroke-width="0.5" fill="rgb(0, 255, 0)" cx="22" cy="60" r="2"></circle>\n            <g id="pin">\n                <use fill="rgb(255, 0, 0)" xlink:href="%23path-1"></use>\n                <path stroke="rgba(0, 34, 0, 0.3)" stroke-width="1" d="M22.000041,58.5893777 C24.1093754,53.201768 26.7368945,48.7888978 30.1126352,44.5366657 C31.8413033,42.359159 37.3396557,36.2578728 37.7873826,35.7245988 C41.7852798,30.9628248 43.5,27.1088523 43.5,21.5344653 C43.5,9.91991716 33.8764347,0.5 22.0000435,0.5 C10.1235219,0.5 0.5,9.91987461 0.5,21.5344653 C0.5,27.1088542 2.21472236,30.9628286 6.21262323,35.7245985 C6.66033717,36.257856 12.1587805,42.3592285 13.8874787,44.5367734 C17.2631923,48.7889718 19.8907032,53.2018154 22.000041,58.5893777 Z"></path>\n            </g>\n            <circle id="center" fill="rgb(0, 255, 0)" cx="22" cy="22" r="6"></circle>\n        </g>\n    </g>\n</svg>`;const h=new Map;t.generatePointMarkerShape=function(e,t=1){let r=h.get(`${e}:${t}`);if(r)return r;r=[];const i=e-1;return d.forEach(e=>e.getPoints(i).forEach(e=>r.push(e.x*t,e.y*t,0))),h.set(`${e}:${t}`,r),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(21),o=r(53);t.default=function(e){const t=e===n.Units.pixels,r=`\ngl_PointSize = ${t?"radius":"minRadius"} * 2.0;\n\nif (uSelectedObject != objectIdentifier && uHoveredObject != objectIdentifier) {\n    vColor = vec4(fillColor.rgb, 1.0);\n} else if (uSelectedObject == objectIdentifier) {\n    vColor = vec4(selectedFillColor.rgb, 1.0);\n} else if (uHoveredObject == objectIdentifier) {\n    vColor = vec4(uHoverColor.rgb, 1.0);\n}\n\nif (uHoveredObject == objectIdentifier) {\n    gl_PointSize *= 1.5;\n}\n`;return{vertexShader:`\nuniform float uDPI;\nuniform vec2 uRendererSize;\n\nattribute float radius;\nattribute float minRadius;\nattribute vec4 borderColor;\nattribute vec4 fillColor;\nattribute vec4 selectedBorderColor;\nattribute vec4 selectedFillColor;\n\n${o.COMMON_VARYINGS_ATTRS_UNIFORMS}\n\nvoid main() {\n${t?r:`\n    mat4 viewMatrixFixed = viewMatrix;\n    viewMatrixFixed[3][2] = modelMatrix[3][2];\n    mat4 projMatrix = projectionMatrix * viewMatrixFixed;\n\n    float projectionCoef1 = projMatrix[0][3] * position[0] + projMatrix[1][3] * position[1]\n        + projMatrix[2][3] * position[2] + projMatrix[3][3];\n    float projectionCoef2 = projectionCoef1 + projMatrix[0][3] * radius;\n\n    vec4 projPoint = (projMatrix * vec4(position, 1.0)) / projectionCoef1;\n    vec4 projRadius = (projMatrix * vec4(position[0] + radius, position[1], position[2], 1.0))\n        / projectionCoef2;\n\n    float diff = abs(projRadius[0] - projPoint[0]) * uRendererSize[0] / 2.0;\n\n    if (diff > minRadius) {\n        gl_PointSize = 2.0;\n\n        if (uSelectedObject != objectIdentifier && uHoveredObject != objectIdentifier) {\n            vColor = vec4(borderColor.rgb, 1.0);\n        } else if (uSelectedObject == objectIdentifier) {\n            vColor = vec4(selectedBorderColor.rgb, 1.0);\n        } else if (uHoveredObject == objectIdentifier) {\n            vColor = vec4(uHoverColor.rgb, 1.0);\n        }\n    } else {\n        ${r}\n    }\n`}\n\n    gl_PointSize *= uDPI;\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n`,fragmentShader:`\n${o.COMMON_VARYINGS}\n\nvoid main() {\n    vec4 vertColor = vColor;\n    if (length(gl_PointCoord - 0.5) > 0.5) {\n        vertColor.a = 0.0;\n    }\n\n    gl_FragColor = vertColor;\n}\n`,uniforms:{uDPI:{type:"float",value:1},uRendererSize:{type:"vec2",value:null},uHoveredObject:{type:"float",value:0},uSelectedObject:{type:"float",value:0},uHoverColor:{type:"vec4",value:[0,0,0,0]},uSelectColor:{type:"vec4",value:[0,0,0,0]},uSelectHoverColor:{type:"vec4",value:[0,0,0,0]}},transparent:!0,vertexColors:i.VertexColors,userData:{radiusUnits:e}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(53);t.default=function(){return{vertexShader:`\nuniform float uDPI;\nattribute float size;\n\n${n.COMMON_VARYINGS_ATTRS_UNIFORMS}\n\nconst float DEFAULT_Z = 1.0;\nconst float HOVER_Z = 0.98;\nconst float SELECTED_Z = 0.96;\n\nvoid main() {\n    mat4 projMatrix = projectionMatrix * viewMatrix;\n\n    gl_PointSize = uDPI * size;\n    if (uHoveredObject == objectIdentifier) {\n        gl_PointSize *= 1.25;\n    }\n\n    ${n.COMMON_VERTEX}\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    gl_Position.z = DEFAULT_Z;\n\n    if (uHoveredObject == objectIdentifier) {\n        gl_Position.z = HOVER_Z;\n    }\n    if (uSelectedObject == objectIdentifier) {\n        gl_Position.z = SELECTED_Z;\n    }\n}\n`,fragmentShader:`\nconst vec3 COLOR_WHITE = vec3(1.0, 1.0, 1.0);\n${n.COMMON_VARYINGS}\nuniform sampler2D texture;\n\nvoid main() {\n    vec4 textureColor = texture2D(texture, vec2(gl_PointCoord.x, 1.0 - gl_PointCoord.y));\n    if (textureColor.a == 0.0) {\n        discard;\n    } else {\n        gl_FragColor = vec4(mix(vColor.rgb * textureColor.r, COLOR_WHITE, textureColor.g), textureColor.a);\n    }\n}\n`,uniforms:{uDPI:{type:"float",value:1},texture:{type:"t",value:null},uHoveredObject:{type:"float",value:0},uSelectedObject:{type:"float",value:0},uHoverColor:{type:"vec4",value:[0,0,0,0]},uSelectColor:{type:"vec4",value:[0,0,0,0]},uSelectHoverColor:{type:"vec4",value:[0,0,0,0]}},transparent:!0,vertexColors:i.VertexColors}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(53);t.default={vertexShader:`\nprecision highp float;\n\n${i.COMMON_VARYINGS_ATTRS_UNIFORMS}\n\nvoid main() {\n    ${i.COMMON_VERTEX}\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n`,fragmentShader:`\n${i.COMMON_VARYINGS}\n\nvoid main()\n{\n    ${i.COMMON_FRAGMENT}\n}\n`,uniforms:{uHoveredObject:{type:"float",value:0},uSelectedObject:{type:"float",value:0},uHoverColor:{type:"vec4",value:[0,0,0,0]},uSelectColor:{type:"vec4",value:[0,0,0,0]},uSelectHoverColor:{type:"vec4",value:[0,0,0,0]}},transparent:!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(53);t.default={vertexShader:`\n${i.COMMON_VARYINGS_ATTRS_UNIFORMS}\n\nvoid main() {\n    float positionZ = 1.0;\n    if (uHoveredObject == objectIdentifier || uSelectedObject == objectIdentifier) {\n        if (uHoveredObject == objectIdentifier && uSelectedObject == objectIdentifier) {\n            positionZ = 0.6;\n        } else if (uHoveredObject == objectIdentifier) {\n            positionZ = 0.5;\n        } else if (uSelectedObject == objectIdentifier) {\n            positionZ = 0.7;\n        }\n    }\n\n    ${i.COMMON_VERTEX}\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xy, 0.0, 1.0);\n    gl_Position.z = positionZ;\n}\n`,fragmentShader:`\n${i.COMMON_VARYINGS}\n\nvoid main()\n{\n    ${i.COMMON_FRAGMENT}\n}\n`,uniforms:{uHoveredObject:{type:"float",value:0},uSelectedObject:{type:"float",value:0},uHoverColor:{type:"vec4",value:[0,0,0,0]},uSelectColor:{type:"vec4",value:[0,0,0,0]},uSelectHoverColor:{type:"vec4",value:[0,0,0,0]}},transparent:!0,depthTest:!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(0),n=r(53);t.default=function(){return{vertexShader:`\nuniform float uDPI;\nattribute float size;\n\n${n.COMMON_VARYINGS_ATTRS_UNIFORMS}\n\nconst float DEFAULT_Z = 1.0;\nconst float HOVER_Z = 0.98;\nconst float SELECTED_Z = 0.96;\n\nvoid main() {\n    mat4 projMatrix = projectionMatrix * viewMatrix;\n\n    gl_PointSize = uDPI * size;\n    if (uHoveredObject == objectIdentifier) {\n        gl_PointSize *= 1.25;\n    }\n\n    ${n.COMMON_VERTEX}\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    gl_Position.z = DEFAULT_Z;\n\n    if (uHoveredObject == objectIdentifier) {\n        gl_Position.z = HOVER_Z;\n    }\n    if (uSelectedObject == objectIdentifier) {\n        gl_Position.z = SELECTED_Z;\n    }\n}\n`,fragmentShader:`\n${n.COMMON_VARYINGS}\n\nuniform sampler2D texture;\n\nvoid main() {\n    vec4 textureColor = texture2D(texture, vec2(gl_PointCoord.x, 1.0 - gl_PointCoord.y));\n    if (textureColor.a == 0.0) {\n        discard;\n    } else {\n        float mixValue = vColor.rgb != vec3(0) ? 0.7 : 0.0;\n        gl_FragColor = vec4(mix(textureColor.rgb, vColor.rgb, mixValue), textureColor.a);\n    }\n}\n`,uniforms:{uDPI:{type:"float",value:1},texture:{type:"t",value:null},uHoveredObject:{type:"float",value:0},uSelectedObject:{type:"float",value:0},uHoverColor:{type:"vec4",value:[0,0,0,0]},uSelectColor:{type:"vec4",value:[0,0,0,0]},uSelectHoverColor:{type:"vec4",value:[0,0,0,0]}},transparent:!0,vertexColors:i.VertexColors}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(12),n=r(4),o=r(32),a=r(1),s=r(0),c=r(499);class l{constructor(e,t,r,i,o=console){this.m_tileKey=e,this.m_projection=t,this.m_evaluator=i,this.m_logger=o,this.m_geometries=new Array,this.m_geoBox=n.hereTilingScheme.getGeoBox(this.m_tileKey),this.m_tileBounds=this.m_projection.projectBox(this.m_geoBox,new s.Box3),this.m_techniques=this.m_evaluator.techniques,0!==r.byteLength&&(this.m_trafficData=r)}getDecodedTile(){return{geometries:this.m_geometries,techniques:this.m_techniques,trafficData:this.m_trafficData}}}class u extends o.ThemedTileDecoder{constructor(){super(),this.m_logger=a.LoggerManager.instance.create("TrafficTileDecoder"),this.configure([])}async connect(){return Promise.resolve()}async decodeThemedTile(e,t,r,i){return this.decodeTile(e,t,i)}async decodeTile(e,t,r){const n=JSON.parse(JSON.stringify(c.trafficTheme)),o=new i.StyleSetEvaluator(n.styles),a=new l(t,r,e,o,this.m_logger),s=Object.assign(Object.assign({},a.getDecodedTile()),{tileMortonCode:t.mortonCode()});return Promise.resolve(s)}}t.TrafficTileDecoder=u;t.TrafficWorkerClient=class{constructor(e="traffic"){o.WorkerServiceManager.getInstance().register({serviceType:e,factory:e=>o.TileDecoderService.start(e,new u)})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trafficTheme={name:"traffic",styles:[{when:"type == 'traffic-road'",renderOrder:2200,technique:"solid-line",attr:{transparent:!0,opacity:1,lineWidth:{interpolation:"Linear",zoomLevels:[9,11,12,13,14,15,16,17,18],values:[900,450,350,150,100,60,22,10,6]}}},{when:"type == 'invisibleLine'",technique:"segments",attr:{visible:!1}}]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(12),n=r(32),o=r(1),a=r(21),s=r(234),c=r(244);class l{constructor(e,t,r,i,n=console,o=!1){this.m_tileKey=e,this.m_projection=t,this.m_data=r,this.m_evaluator=i,this.m_logger=n,this.m_geometries=[],this.m_topologyFeatures=new Map,this.m_cartoFeatures=new Map,this.m_buildingFeatures=new Map,this.m_imagesMap={},o||this.processData()}getDecodedTile(){return{geometries:this.m_geometries,techniques:this.m_evaluator.techniques,topologyFeatures:this.m_topologyFeatures,cartoFeatures:this.m_cartoFeatures,buildingFeatures:this.m_buildingFeatures,rawData:this.m_data,tileMortonCode:this.m_tileKey.mortonCode(),imagesMap:this.m_imagesMap}}processData(){const e=this.m_data["topology-geometry_v2"],t=this.m_data.cartography_v2,r=this.m_data["building-footprints_v2"],i={type:"FeatureCollection",features:[]};void 0!==e&&(this.m_topologyFeatures=new Map,e.forEach(e=>{if(e.segment&&e.segment.length>0){const t="segment";a.appendToArray(i.features,this.processSegments(e.segment,t)),this.m_topologyFeatures.set(t,"Segments")}if(e.node&&e.node.length>0){const t="node";a.appendToArray(i.features,this.processNodes(e.node,t)),this.m_topologyFeatures.set(t,"Nodes")}})),void 0!==t&&(this.m_cartoFeatures=new Map,a.appendToArray(i.features,this.processPlaces(t,this.m_cartoFeatures))),void 0!==r&&(this.m_buildingFeatures=new Map,a.appendToArray(i.features,this.processPlaces(r,this.m_buildingFeatures)));const n=new s.GeoJsonDecoder(this.m_tileKey,this.m_projection,i,this.m_evaluator,this.m_logger,!0).getDecodedTile();a.appendToArray(this.m_geometries,n.geometries),this.m_imagesMap=n.imagesMap}processSegments(e,t){return e.map((e,r)=>({type:"Feature",properties:{tooltip:"<table>"+`<tr><th>identifier</th><td>${e.identifier}</td></tr>`+"</table>",protobufRef:`segment[${r}]`,width:"1px",groupId:t},geometry:{type:"LineString",coordinates:e.geometry.point.map(this.point2GeoJSONCoordinate)}}))}processNodes(e,t){return e.map((e,r)=>({type:"Feature",properties:{tooltip:`<table><tr><th>identifier</th><td>${e.identifier}</td></tr></table>`,protobufRef:`node[${r}]`,radius:"5m",minRadius:"2px",groupId:t},geometry:{type:"Point",coordinates:this.point2GeoJSONCoordinate(e.geometry)}}))}processPlaces(e,t){const r=[];return e.forEach(e=>{const i=new Map(e.location.map(e=>[e.identifier,e]));e.place.forEach((e,n)=>{const o=i.get(e.location_ref.identifier);if(void 0===o)return void this.m_logger.warn(`Geometry for location "${e.location_ref.identifier}" not found`);const a=o.geometry;if(void 0===a.multi_polygon&&void 0===a.multi_line_string)return void this.m_logger.warn("Unsupported geometry type",a);const s=this.getPlaceCategories(e),c=s[0],l={tooltip:"<table>"+`<tr><th>identifier</th><td>${e.identifier}</td></tr>`+`<tr><th>name</th><td>${this.getPlaceNames(e).join(", ")}</td></tr>`+`<tr><th>category</th><td>${s.join(", ")}</td></tr>`+"</table>",protobufRef:`place[${n}]`,groupId:c};void 0!==a.multi_polygon&&r.push({type:"Feature",properties:l,geometry:{type:"MultiPolygon",coordinates:a.multi_polygon.polygon.map(e=>{const t=e.exterior_ring.point.map(this.point2GeoJSONCoordinate),r=e.interior_ring.map(e=>e.point.map(this.point2GeoJSONCoordinate));return[t].concat(r)})}}),void 0!==a.multi_line_string&&r.push({type:"Feature",properties:l,geometry:{type:"MultiLineString",coordinates:a.multi_line_string.line_string.map(e=>e.point.map(this.point2GeoJSONCoordinate))}}),t.set(c,c)})}),r}getPlaceCategories(e){return e.category.map(e=>e.identifier.substring(e.identifier.lastIndexOf(":")+1))}getPlaceNames(e){return e.name.map(e=>e.text.value)}point2GeoJSONCoordinate(e){return[e.longitude,e.latitude]}}t.RibDecoder=l;class u extends n.ThemedTileDecoder{constructor(e=!1){super(),this.m_skipGeometryCreation=e,this.m_logger=o.LoggerManager.instance.create("Reality Index Base Decoder");const t=JSON.parse(JSON.stringify(c.geoJsonTheme));this.m_dataSourceThemeEvaluator=new i.StyleSetEvaluator(t.styles),this.configure([])}async connect(){return Promise.resolve()}async decodeThemedTile(e,t,r,i){const n=new l(t,i,e,this.m_dataSourceThemeEvaluator,this.m_logger,this.m_skipGeometryCreation);return Promise.resolve(n.getDecodedTile())}}t.RibTileDecoder=u;t.RibWorkerClient=class{constructor(e="rib"){n.WorkerServiceManager.getInstance().register({serviceType:e,factory:e=>n.TileDecoderService.start(e,new u)})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(12),o=r(4),a=r(97),s=r(32),c=r(1),l=r(21),u=r(0),d=r(502),h=r(506),m=r(510);class p{constructor(e,t,r,i){this.m_tileKey=e,this.m_projection=t,this.m_messageAdapter=r,this.m_evaluator=i,this.m_geometries=[],this.m_permanencyTypes=new Set,this.m_eventTypes=new Set,this.m_hazardWarnings=new Set,this.m_circleVertices=[3,0,0,2.5237605571746826,1.621922492980957,0,0,0,0,2.5237605571746826,1.621922492980957,0,1.24624502658844,2.728895902633667,0,0,0,0,1.24624502658844,2.728895902633667,0,-.4269445240497589,2.9694643020629883,0,0,0,0,-.4269445240497589,2.9694643020629883,0,-1.9645822048187256,2.2672486305236816,0,0,0,0,-1.9645822048187256,2.2672486305236816,0,-2.87847900390625,.8451976776123047,0,0,0,0,-2.87847900390625,.8451976776123047,0,-2.87847900390625,-.8451976776123047,0,0,0,0,-2.87847900390625,-.8451976776123047,0,-1.9645822048187256,-2.2672486305236816,0,0,0,0,-1.9645822048187256,-2.2672486305236816,0,-.4269445240497589,-2.9694643020629883,0,0,0,0,-.4269445240497589,-2.9694643020629883,0,1.24624502658844,-2.728895902633667,0,0,0,0,1.24624502658844,-2.728895902633667,0,2.5237605571746826,-1.621922492980957,0,0,0,0,2.5237605571746826,-1.621922492980957,0,3,0,0,0,0,0],this.m_geoBox=o.hereTilingScheme.getGeoBox(this.m_tileKey),this.m_tileBounds=this.m_projection.projectBox(this.m_geoBox,new u.Box3),this.m_center=new u.Vector3,this.m_tileBounds.getCenter(this.m_center),this.m_messageAdapter.forEach((e,t,r)=>this.processMessage(e,r)),this.m_evaluator.getMatchingTechniques(new n.MapEnv({type:"line-inactive"}))}getDecodedTile(){return{geometries:this.m_geometries,techniques:this.m_evaluator.techniques,signPermanencyTypes:this.m_permanencyTypes,eventTypes:this.m_eventTypes,hazardWarnings:this.m_hazardWarnings}}processMessage(e,t){if(void 0===e.path.positionEstimate||0===e.path.positionEstimate.length)return;const r=new Array(e.path.positionEstimate.length),s=new Array(3*e.path.positionEstimate.length);let c=new Float32Array(e.path.positionEstimate.length*p.ARROW_VERTICES_SIZE),l=new Float32Array(e.path.positionEstimate.length*p.ARROW_CENTER_SIZE);const d=new Float32Array(e.path.positionEstimate.length*p.CIRCLE_VERTICES_SIZE),m=new Set;e.path.positionEstimate.forEach(e=>m.add(e.timeStampUTC_ms));const f=new u.Vector3;let g,y=0;const v=new Map;if(e.path.positionEstimate.forEach((e,t)=>{if(void 0!==g){const t=Math.abs(e.latitude_deg-g.latitude_deg),r=Math.abs(e.longitude_deg-g.longitude_deg);(t<1e-4||r<1e-4)&&(e.latitude_deg+=1e-5,e.longitude_deg+=1e-5)}g=e;const i=new o.GeoCoordinates(e.latitude_deg,e.longitude_deg);this.m_projection.projectPoint(i,f).sub(this.m_center);const n=3*t;s[n]=f.x,s[n+1]=f.y,s[n+2]=0;const a=this.addArrowPositions(c,l,f,e.heading_deg||0,y);void 0!==e.heading_deg&&a&&(v.set(t,y),y+=1),this.addCirclePositions(d,p.CIRCLE_VERTICES_SIZE*t,f),r[t]={timeStampUTC_ms:e.timeStampUTC_ms,longitudeDeg:e.longitude_deg,latitudeDeg:e.latitude_deg,headingDeg:e.heading_deg,speedMps:e.speed_mps}}),e.pathEvents){const r=new h.PathEventsDecoder(this.m_projection,this.m_center,this.m_evaluator).processEvents(t,e.pathEvents,e.path.positionEstimate,this.m_permanencyTypes,this.m_eventTypes,this.m_hazardWarnings);r.length>0&&this.m_geometries.push(...r)}c=c.slice(p.ARROW_VERTICES_SIZE,y*p.ARROW_VERTICES_SIZE),l=l.slice(p.ARROW_CENTER_SIZE,y*p.ARROW_CENTER_SIZE);let _=new n.MapEnv({type:"line"}),b=this.m_evaluator.getMatchingTechniques(_);if(b.length){const e=new a.LineGroup,n=new u.Vector3(0,0,0);e.add(n,s);const{vertices:o,indices:c}=e,l={pathData:r,messageId:t,type:i.GeometryType.SolidLine,index:{buffer:new Uint32Array(c).buffer,itemCount:1,type:"uint32",name:"index"},interleavedVertexAttributes:[{buffer:new Float32Array(o).buffer,type:"float",stride:e.stride,attributes:e.vertexAttributes}],vertexAttributes:[{name:"points",buffer:new Float32Array(s).buffer,itemCount:3,type:"float"}],groups:[{start:0,count:0,technique:b[0]._index,createdOffsets:[]}],pathArrowMap:v,objectType:"lines",uuid:`lines-${t}`};this.m_geometries.push(l)}if(_=new n.MapEnv({type:"arrow"}),(b=this.m_evaluator.getMatchingTechniques(_)).length){const e={messageId:t,type:i.GeometryType.Polygon,vertexAttributes:[{name:"position",buffer:c.buffer,type:"float",itemCount:3},{name:"center",buffer:l.buffer,type:"float",itemCount:3},{name:"originalPosition",buffer:c.buffer.slice(0),type:"float",itemCount:3}],groups:[{start:0,count:0,technique:b[0]._index,createdOffsets:[]}],objectType:"arrows",uuid:`arrows-${t}`};this.m_geometries.push(e)}if(_=new n.MapEnv({type:"circle"}),(b=this.m_evaluator.getMatchingTechniques(_)).length){const e={messageId:t,type:i.GeometryType.Polygon,vertexAttributes:[{name:"position",buffer:d.buffer,type:"float",itemCount:3}],groups:[{start:0,count:0,technique:b[0]._index,createdOffsets:[]}],objectType:"circles",uuid:`circles-${t}`};this.m_geometries.push(e)}}addArrowPositions(e,t,r,i,n){const o=p.ARROWS_MIN_INTERVAL*p.ARROWS_MIN_INTERVAL;for(let e=0;e<n;e++){const i=t[e*p.ARROW_CENTER_SIZE],n=t[e*p.ARROW_CENTER_SIZE+1],a=t[e*p.ARROW_CENTER_SIZE+2];if((i-r.x)*(i-r.x)+(n-r.y)*(n-r.y)+(a-r.z)*(a-r.z)<o)return!1}t[n*p.ARROW_CENTER_SIZE]=r.x,t[n*p.ARROW_CENTER_SIZE+1]=r.y,t[n*p.ARROW_CENTER_SIZE+2]=r.z;const a=new u.Vector3,s=u.Math.degToRad(i),c=Math.cos(s),l=Math.sin(s),d=new u.Matrix3;d.set(c,l,0,-l,c,0,0,0,1);const h=n*p.ARROW_VERTICES_SIZE;return[[0,10,0],[-10,-10,0],[0,-5,0],[0,-5,0],[10,-10,0],[0,10,0]].forEach((t,i)=>{const n=t;a.set(...n),a.applyMatrix3(d);const o=h+3*i;e[o]=r.x+a.x,e[o+1]=r.y+a.y,e[o+2]=r.z+a.z}),!0}addCirclePositions(e,t,r){e.set(this.m_circleVertices,t);for(let i=t/3;i<(t+this.m_circleVertices.length)/3;i++)e[3*i]+=r.x,e[3*i+1]+=r.y,e[3*i+2]+=r.z}}t.SdiiDecoder=p,p.ARROW_VERTICES_SIZE=18,p.ARROW_CENTER_SIZE=3,p.CIRCLE_VERTICES_SIZE=99,p.ARROWS_MIN_INTERVAL=400;class f extends s.ThemedTileDecoder{constructor(){super(),this.m_logger=c.LoggerManager.instance.create("SdiiDecoder"),super.configure([])}async connect(){return Promise.resolve()}async decodeTile(e,t,r){const i=JSON.parse(JSON.stringify(m.sdiiTheme)),o=new n.StyleSetEvaluator(i.styles);return this.decodeThemedTile(e,t,o,r)}async decodeThemedTile(e,t,r,i){l.reconstructLongs(e);const n=d.create(e),o=new p(t,i,n,r).getDecodedTile();return l.LongUtils.clear(),Promise.resolve(o)}}t.SdiiTileDecoder=f;t.SensorDataWorkerClient=class{constructor(e="sdii"){s.WorkerServiceManager.getInstance().register({serviceType:e,factory:e=>s.TileDecoderService.start(e,new f)})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(503),n=r(504),o=r(505);t.create=function(e){let t;if(e.hasOwnProperty("tileId")&&e.hasOwnProperty("messages"))t=new n.MessageArchive(e);else if(e.hasOwnProperty("message")&&!e.hasOwnProperty("tileId"))t=new o.MessageList(e);else{if(!e.hasOwnProperty("envelope")||!e.hasOwnProperty("path"))throw new Error("Failed to determine data type.");t=new i.Message(e)}return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(121);class n extends i.AdapterAbstract{forEach(e){e(this.m_data,0,this.getRandomString()+"-0")}}t.Message=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(121);class n extends i.AdapterAbstract{forEach(e){this.m_data.messages.forEach((t,r)=>{e(t.message,r,t.messageId)})}}t.MessageArchive=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(121);class n extends i.AdapterAbstract{forEach(e){this.m_data.message.forEach((t,r)=>{e(t,r,".message."+r)})}}t.MessageList=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2),n=r(12),o=r(69),a=r(0),s=r(507),c=r(508),l=r(509);var u;!function(e){e[e.HEAVY_RAIN=0]="HEAVY_RAIN",e[e.TRACTION_LOSS=1]="TRACTION_LOSS",e[e.FOG=2]="FOG",e[e.BROKEN_DOWN_VEHICLE=3]="BROKEN_DOWN_VEHICLE",e[e.HARD_BRAKING=4]="HARD_BRAKING",e[e.ACCIDENT=5]="ACCIDENT",e[e.REDUCED_VISIBILITY=6]="REDUCED_VISIBILITY"}(u=t.HazardWarningType||(t.HazardWarningType={}));const d=7;var h;!function(e){e.VEHICLE_STATUS="vehicleStatus",e.VEHICLE_DYNAMICS="vehicleDynamics",e.SIGN_RECOGNITION="signRecognition",e.LANE_BOUNDARY_RECOGNITION="laneBoundaryRecognition",e.EXCEPTIONAL_VEHICLE_STATE="exceptionalVehicleState",e.PROPRIETARY_INFO="proprietaryInfo",e.ENVIRONMENT_STATUS="environmentStatus",e.OBJECT_DETECTION="objectDetection",e.AD_SERVICE_AND_SENSOR_STATE="adServiceAndSensorState",e.SPECIFIC_OBSERVED_EVENT="specificObservedEvent",e.ROAD_CONDITION="roadCondition",e.ROAD_BOUNDARY_RECOGNITION="roadBoundaryRecognition",e.VEHICLE_MANEUVER="vehicleManeuver",e.LOCALIZATION_INFORMATION="localizationInformation",e.ROAD_ATTRIBUTE_RECOGNITION="roadAttributerecognition",e.PASSENGER_ENVIRONMENT="passengerEnvironment",e.ROAD_MARKING_RECOGNITION="roadMarkingRecognition",e.TRAFFIC_SIGNAL_HEAD_DETECTION="trafficSignalHeadDetection",e.PROPRIETARY_DATA_CONTAINER="proprietaryDataContainer"}(h=t.PathEventType||(t.PathEventType={}));class m{constructor(e,t,r){this.m_projection=e,this.m_center=t,this.m_evaluator=r,this.eventTypeMap=new Map,this.hazardWarningMap=new Map,this.m_positions=[],this.m_atlasOffsets=[],this.m_data=[];let i=this.m_evaluator.getMatchingTechniques(new n.MapEnv({type:"sign"}));i.length>0&&(this.m_signTechniqueIndex=i[0]._index),(i=this.m_evaluator.getMatchingTechniques(new n.MapEnv({type:"pathEvent"}))).length>0&&(this.m_otherTechniqueIndex=i[0]._index)}static getAtlasCoordinates(e,t,r){return[e%r/r,Math.floor(e/t)/t]}processEvents(e,t,r,i,n,o){const a=[];let s=0;if(Object.keys(t).forEach(c=>{const u=t[c];if(0!==u.length)if("signRecognition"===c){if(void 0===this.m_signTechniqueIndex)return;const t=new l.SignRecognitionDecoder;u.forEach((e,n)=>{const o=this.getPosition(e,r);void 0!==o&&t.processEvent(e,n,o,i)});const n=t.getGeometry(this.m_signTechniqueIndex,e);void 0!==n&&a.push(n)}else void 0!==this.m_otherTechniqueIndex&&u.forEach(e=>{const t=this.getPosition(e,r);void 0!==t&&(this.processEvent(c,e,s,t,n,o),s++)})}),void 0!==this.m_otherTechniqueIndex){const t=this.getGeometry(this.m_otherTechniqueIndex,e);void 0!==t&&a.push(t)}return a}getPosition(e,t){const r=o.fromValue(this.getEventTimestamp(e));let i,n;const s=t.find(e=>o.fromValue(e.timeStampUTC_ms).equals(r));if(s)n=s.longitude_deg,i=s.latitude_deg;else{const e=t.findIndex(e=>o.fromValue(e.timeStampUTC_ms).greaterThan(r));if(-1===e||0===e)return;const a=t[e-1],s=t[e],c=o.fromValue(a.timeStampUTC_ms),l=o.fromValue(s.timeStampUTC_ms),u=r.subtract(c).toNumber()/l.subtract(c).toNumber();i=(s.latitude_deg-a.latitude_deg)*u+a.latitude_deg,n=(s.longitude_deg-a.longitude_deg)*u+a.longitude_deg,i=(s.latitude_deg-a.latitude_deg)*u+a.latitude_deg,n=(s.longitude_deg-a.longitude_deg)*u+a.longitude_deg}const c=new a.Vector3;return this.m_projection.projectPoint({longitude:n,latitude:i},c).sub(this.m_center),e.positionOffset&&(c.x+=e.positionOffset.longitudinalOffset_m||0,c.y+=e.positionOffset.lateralOffset_m||0),c}getGeometry(e,t){if(0===this.m_positions.length)return;const r=this.m_positions.length/3,n=new Float32Array(r);n.fill(1);const o=new Float32Array(r);o.fill(0);const a=new Float32Array(2*r);for(let e=0;e<a.length;)a[e++]=m.ATLAS_SCALE[0],a[e++]=m.ATLAS_SCALE[1];return{messageId:t,type:i.GeometryType.Point,vertexAttributes:[{name:"position",buffer:new Float32Array(this.m_positions).buffer,type:"float",itemCount:3},{name:"alpha",buffer:o.buffer,type:"float",itemCount:1},{name:"atlasScale",buffer:a.buffer,type:"float",itemCount:2},{name:"atlasOffset",buffer:new Float32Array(this.m_atlasOffsets).buffer,type:"float",itemCount:2},{name:"scale",buffer:n.buffer,type:"float",itemCount:1}],groups:[{start:0,count:0,technique:e,createdOffsets:[]}],objectType:"pathEvent",uuid:`pathEvent-${t}`,pathEventsData:this.m_data,eventTypeMap:this.eventTypeMap,hazardWarningMap:this.hazardWarningMap}}processEvent(e,t,r,i,n,o){const a=this.m_positions.length;this.m_positions[a]=i.x,this.m_positions[a+1]=i.y,this.m_positions[a+2]=i.z;const l=this.getEventTimestamp(t);let d,p,f,g;switch(e){case h.SPECIFIC_OBSERVED_EVENT:f=(p=t).cause;const e=s.sdii.here.pb.SpecificObservedEvent.SpecificObservedEventCauseEnum,r=Object.keys(e).find(t=>e[t]===f);let i,n;if(void 0!==r&&p.subcause){const e=r+"SubCause";n=p.subcause[e];const t=s.sdii.here.pb.SpecificObservedEventSubCauseEnum,o=e.charAt(0).toUpperCase()+e.slice(1);let a=t[o+"Code"];if(void 0===a&&(a=t[o+"Enum"]),void 0!==a){i=Object.keys(a).find(e=>a[e]===n)}}g=this.getHazardWarningType(f,n),d={cause:r?c.convertToHumanReadable(r):"",subCause:i?c.convertToHumanReadable(i):""};break;case h.VEHICLE_STATUS:d={transmissionMode:(p=t).transmissionMode,currentGear:p.currentGear,ignitionState:p.ignitionState,engineState:p.engineState};break;case h.VEHICLE_DYNAMICS:d={engineSpeed:(p=t).engineSpeed_rpm,engineTorque:p.engineTorque_nm,brakeTorque:p.brakeTorque_nm};break;case h.LANE_BOUNDARY_RECOGNITION:d={lateralOffset:(p=t).positionOffset.lateralOffset_m,longitudinalOffset:p.positionOffset.longitudinalOffset_m,laneBoundaryColor:p.laneBoundaryColor,laneBoundaryType:p.laneBoundaryType};break;case h.EXCEPTIONAL_VEHICLE_STATE:(p=t).emergencyBraking&&(g=u.HARD_BRAKING),d={crashDetected:void 0!==p.crashDetected,emergencyBraking:void 0!==p.emergencyBraking,electronicStabilityControl:void 0!==p.electronicStabilityControl};break;case h.PROPRIETARY_INFO:if(void 0!==(p=t).keyValuePairs){const e=new Map;p.keyValuePairs.forEach(t=>e.set(c.convertToHumanReadable(t.key),t.value)),d={properties:e}}break;case h.ENVIRONMENT_STATUS:d={timeStampUTC_ms:l,lightConditions:(p=t).lightConditions,externalAirTemperature_DegC:p.externalAirTemperature_DegC,precipitation:p.precipitation,visibleDistance_m:p.visibleDistance_m,roadSurfaceTemperature_DegC:p.roadSurfaceTemperature_DegC,roadSurfaceType:p.roadSurfaceType,airPressure_Pa:p.airPressure_Pa,airHumidity_percent:p.airHumidity_percent};break;case h.OBJECT_DETECTION:d={timeStampUTC_ms:l,detectedObjectID:(p=t).detectedObjectID,objectType:p.objectType};break;case h.AD_SERVICE_AND_SENSOR_STATE:d={timeStampUTC_ms:l,sensorRoadSurface:(p=t).sensorRoadSurface,sensorEnvironment:p.sensorEnvironment};break;case h.ROAD_CONDITION:d={timeStampUTC_ms:l,roadRoughnessSegmentLevel:(p=t).roadRoughnessSegmentLevel,roadRoughnessLocalEvent:p.roadRoughnessLocalEvent};break;case h.ROAD_BOUNDARY_RECOGNITION:d={timeStampUTC_ms:l,roadBoundaryType:(p=t).roadBoundaryType,roadBoundaryRecognitionType:p.roadBoundaryRecognitionType,roadBoundaryChangeType:p.roadBoundaryChangeType,detectedObjectID:p.detectedObjectID};break;case h.VEHICLE_MANEUVER:d={timeStampUTC_ms:l,vehicleManeuverType:(p=t).vehicleManeuverType};break;case h.LOCALIZATION_INFORMATION:d={timeStampUTC_ms:l,enhancedByDeadReconning:(p=t).enhancedByDeadReconning,enhancedByMapLocalization:p.enhancedByMapLocalization};break;case h.ROAD_ATTRIBUTE_RECOGNITION:d={timeStampUTC_ms:l,roadAttribute:(p=t).roadAttribute,roadLaneCount_count:p.roadLaneCount_count,roadLaneCountConfidence_percentage:p.roadLaneCountConfidence_percentage,roadLaneDetectionCount_count:p.roadLaneDetectionCount_count};break;case h.PASSENGER_ENVIRONMENT:d={timeStampUTC_ms:l,generalPassengerCount:(p=t).generalPassengerCount,currentMediaSource:p.currentMediaSource,radioFrequency_MHz:p.radioFrequency_MHz}}if(void 0===g){n.add(e);let t=this.eventTypeMap.get(e);t||(t=[],this.eventTypeMap.set(e,t)),t.push(r)}else{o.add(g);let e=this.hazardWarningMap.get(g);e||(e=[],this.hazardWarningMap.set(g,e)),e.push(r)}const y=m.getAtlasCoordinates(this.getAtlasIndex(g),m.ATLAS_SIZE_X,m.ATLAS_SIZE_Y);this.m_atlasOffsets.push(...y),this.m_data.push({hazardWarningType:g,timeStampUTCMs:l,eventType:void 0!==g?"Hazard Warning":c.convertToHumanReadable(e||""),eventTypeRaw:e,eventDetails:d})}getEventTimestamp(e){return void 0===e.timeStampUTC_ms?e.timestampUTC_ms:e.timeStampUTC_ms}getHazardWarningType(e,t){let r;return 19===e&&1===t?r=u.HEAVY_RAIN:6===e?r=u.TRACTION_LOSS:18===e&&1===t?r=u.FOG:94===e&&2===t?r=u.BROKEN_DOWN_VEHICLE:2===e?r=u.ACCIDENT:18===e&&0===t&&(r=u.REDUCED_VISIBILITY),r}getAtlasIndex(e){return void 0!==e?e:d}}t.PathEventsDecoder=m,m.ATLAS_SIZE_X=6,m.ATLAS_SIZE_Y=6,m.ATLAS_SCALE=[1/m.ATLAS_SIZE_X,1/m.ATLAS_SIZE_Y]},function(e,t,r){"use strict";var i,n,o,a,s,c=r(231),l=c.Reader,u=c.util,d=c.roots.default||(c.roots.default={});d.sdii=((s={}).here=((a={}).pb=((o={}).Tile=function(){function e(e){if(this.messages=[],this.refs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.tileId="",e.prototype.messages=u.emptyArray,e.prototype.refs=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.Tile;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.tileId=e.string();break;case 2:i.messages&&i.messages.length||(i.messages=[]),i.messages.push(d.sdii.here.pb.MessageWrapper.decode(e,e.uint32()));break;case 3:i.refs&&i.refs.length||(i.refs=[]),i.refs.push(d.sdii.here.pb.MessageReference.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("tileId"))throw u.ProtocolError("missing required 'tileId'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.Tile)return e;var t=new d.sdii.here.pb.Tile;if(null!=e.tileId&&(t.tileId=String(e.tileId)),e.messages){if(!Array.isArray(e.messages))throw TypeError(".sdii.here.pb.Tile.messages: array expected");t.messages=[];for(var r=0;r<e.messages.length;++r){if("object"!=typeof e.messages[r])throw TypeError(".sdii.here.pb.Tile.messages: object expected");t.messages[r]=d.sdii.here.pb.MessageWrapper.fromObject(e.messages[r])}}if(e.refs){if(!Array.isArray(e.refs))throw TypeError(".sdii.here.pb.Tile.refs: array expected");for(t.refs=[],r=0;r<e.refs.length;++r){if("object"!=typeof e.refs[r])throw TypeError(".sdii.here.pb.Tile.refs: object expected");t.refs[r]=d.sdii.here.pb.MessageReference.fromObject(e.refs[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.messages=[],r.refs=[]),t.defaults&&(r.tileId=""),null!=e.tileId&&e.hasOwnProperty("tileId")&&(r.tileId=e.tileId),e.messages&&e.messages.length){r.messages=[];for(var i=0;i<e.messages.length;++i)r.messages[i]=d.sdii.here.pb.MessageWrapper.toObject(e.messages[i],t)}if(e.refs&&e.refs.length)for(r.refs=[],i=0;i<e.refs.length;++i)r.refs[i]=d.sdii.here.pb.MessageReference.toObject(e.refs[i],t);return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.MessageWrapper=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.messageId="",e.prototype.message=null,e.prototype.metadata=null,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.MessageWrapper;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.messageId=e.string();break;case 2:i.message=d.sdii.here.pb.Message.decode(e,e.uint32());break;case 3:i.metadata=d.sdii.here.pb.Metadata.decode(e,e.uint32());break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("messageId"))throw u.ProtocolError("missing required 'messageId'",{instance:i});if(!i.hasOwnProperty("message"))throw u.ProtocolError("missing required 'message'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.MessageWrapper)return e;var t=new d.sdii.here.pb.MessageWrapper;if(null!=e.messageId&&(t.messageId=String(e.messageId)),null!=e.message){if("object"!=typeof e.message)throw TypeError(".sdii.here.pb.MessageWrapper.message: object expected");t.message=d.sdii.here.pb.Message.fromObject(e.message)}if(null!=e.metadata){if("object"!=typeof e.metadata)throw TypeError(".sdii.here.pb.MessageWrapper.metadata: object expected");t.metadata=d.sdii.here.pb.Metadata.fromObject(e.metadata)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.messageId="",r.message=null,r.metadata=null),null!=e.messageId&&e.hasOwnProperty("messageId")&&(r.messageId=e.messageId),null!=e.message&&e.hasOwnProperty("message")&&(r.message=d.sdii.here.pb.Message.toObject(e.message,t)),null!=e.metadata&&e.hasOwnProperty("metadata")&&(r.metadata=d.sdii.here.pb.Metadata.toObject(e.metadata,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.MessageReference=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.tileId="",e.prototype.messageId="",e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.MessageReference;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.tileId=e.string();break;case 2:i.messageId=e.string();break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("tileId"))throw u.ProtocolError("missing required 'tileId'",{instance:i});if(!i.hasOwnProperty("messageId"))throw u.ProtocolError("missing required 'messageId'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.MessageReference)return e;var t=new d.sdii.here.pb.MessageReference;return null!=e.tileId&&(t.tileId=String(e.tileId)),null!=e.messageId&&(t.messageId=String(e.messageId)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.tileId="",r.messageId=""),null!=e.tileId&&e.hasOwnProperty("tileId")&&(r.tileId=e.tileId),null!=e.messageId&&e.hasOwnProperty("messageId")&&(r.messageId=e.messageId),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.Metadata=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.receivedTime=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.messageStartTime=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.messageEndTime=u.Long?u.Long.fromBits(0,0,!1):0,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.Metadata;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.receivedTime=e.int64();break;case 2:i.messageStartTime=e.int64();break;case 3:i.messageEndTime=e.int64();break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("receivedTime"))throw u.ProtocolError("missing required 'receivedTime'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.Metadata)return e;var t=new d.sdii.here.pb.Metadata;return null!=e.receivedTime&&(u.Long?(t.receivedTime=u.Long.fromValue(e.receivedTime)).unsigned=!1:"string"==typeof e.receivedTime?t.receivedTime=parseInt(e.receivedTime,10):"number"==typeof e.receivedTime?t.receivedTime=e.receivedTime:"object"==typeof e.receivedTime&&(t.receivedTime=new u.LongBits(e.receivedTime.low>>>0,e.receivedTime.high>>>0).toNumber())),null!=e.messageStartTime&&(u.Long?(t.messageStartTime=u.Long.fromValue(e.messageStartTime)).unsigned=!1:"string"==typeof e.messageStartTime?t.messageStartTime=parseInt(e.messageStartTime,10):"number"==typeof e.messageStartTime?t.messageStartTime=e.messageStartTime:"object"==typeof e.messageStartTime&&(t.messageStartTime=new u.LongBits(e.messageStartTime.low>>>0,e.messageStartTime.high>>>0).toNumber())),null!=e.messageEndTime&&(u.Long?(t.messageEndTime=u.Long.fromValue(e.messageEndTime)).unsigned=!1:"string"==typeof e.messageEndTime?t.messageEndTime=parseInt(e.messageEndTime,10):"number"==typeof e.messageEndTime?t.messageEndTime=e.messageEndTime:"object"==typeof e.messageEndTime&&(t.messageEndTime=new u.LongBits(e.messageEndTime.low>>>0,e.messageEndTime.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.receivedTime=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.receivedTime=t.longs===String?"0":0;u.Long?(i=new u.Long(0,0,!1),r.messageStartTime=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.messageStartTime=t.longs===String?"0":0,u.Long?(i=new u.Long(0,0,!1),r.messageEndTime=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.messageEndTime=t.longs===String?"0":0}return null!=e.receivedTime&&e.hasOwnProperty("receivedTime")&&("number"==typeof e.receivedTime?r.receivedTime=t.longs===String?String(e.receivedTime):e.receivedTime:r.receivedTime=t.longs===String?u.Long.prototype.toString.call(e.receivedTime):t.longs===Number?new u.LongBits(e.receivedTime.low>>>0,e.receivedTime.high>>>0).toNumber():e.receivedTime),null!=e.messageStartTime&&e.hasOwnProperty("messageStartTime")&&("number"==typeof e.messageStartTime?r.messageStartTime=t.longs===String?String(e.messageStartTime):e.messageStartTime:r.messageStartTime=t.longs===String?u.Long.prototype.toString.call(e.messageStartTime):t.longs===Number?new u.LongBits(e.messageStartTime.low>>>0,e.messageStartTime.high>>>0).toNumber():e.messageStartTime),null!=e.messageEndTime&&e.hasOwnProperty("messageEndTime")&&("number"==typeof e.messageEndTime?r.messageEndTime=t.longs===String?String(e.messageEndTime):e.messageEndTime:r.messageEndTime=t.longs===String?u.Long.prototype.toString.call(e.messageEndTime):t.longs===Number?new u.LongBits(e.messageEndTime.low>>>0,e.messageEndTime.high>>>0).toNumber():e.messageEndTime),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.Message=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.envelope=null,e.prototype.path=null,e.prototype.pathEvents=null,e.prototype.pathMedia=null,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.Message;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.envelope=d.sdii.here.pb.Envelope.decode(e,e.uint32());break;case 2:i.path=d.sdii.here.pb.Path.decode(e,e.uint32());break;case 3:i.pathEvents=d.sdii.here.pb.PathEvents.decode(e,e.uint32());break;case 4:i.pathMedia=d.sdii.here.pb.PathMedia.decode(e,e.uint32());break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("envelope"))throw u.ProtocolError("missing required 'envelope'",{instance:i});if(!i.hasOwnProperty("path"))throw u.ProtocolError("missing required 'path'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.Message)return e;var t=new d.sdii.here.pb.Message;if(null!=e.envelope){if("object"!=typeof e.envelope)throw TypeError(".sdii.here.pb.Message.envelope: object expected");t.envelope=d.sdii.here.pb.Envelope.fromObject(e.envelope)}if(null!=e.path){if("object"!=typeof e.path)throw TypeError(".sdii.here.pb.Message.path: object expected");t.path=d.sdii.here.pb.Path.fromObject(e.path)}if(null!=e.pathEvents){if("object"!=typeof e.pathEvents)throw TypeError(".sdii.here.pb.Message.pathEvents: object expected");t.pathEvents=d.sdii.here.pb.PathEvents.fromObject(e.pathEvents)}if(null!=e.pathMedia){if("object"!=typeof e.pathMedia)throw TypeError(".sdii.here.pb.Message.pathMedia: object expected");t.pathMedia=d.sdii.here.pb.PathMedia.fromObject(e.pathMedia)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.envelope=null,r.path=null,r.pathEvents=null,r.pathMedia=null),null!=e.envelope&&e.hasOwnProperty("envelope")&&(r.envelope=d.sdii.here.pb.Envelope.toObject(e.envelope,t)),null!=e.path&&e.hasOwnProperty("path")&&(r.path=d.sdii.here.pb.Path.toObject(e.path,t)),null!=e.pathEvents&&e.hasOwnProperty("pathEvents")&&(r.pathEvents=d.sdii.here.pb.PathEvents.toObject(e.pathEvents,t)),null!=e.pathMedia&&e.hasOwnProperty("pathMedia")&&(r.pathMedia=d.sdii.here.pb.PathMedia.toObject(e.pathMedia,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.KeyValuePairString=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.key="",e.prototype.value="",e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.KeyValuePairString;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.key=e.string();break;case 2:i.value=e.string();break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("key"))throw u.ProtocolError("missing required 'key'",{instance:i});if(!i.hasOwnProperty("value"))throw u.ProtocolError("missing required 'value'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.KeyValuePairString)return e;var t=new d.sdii.here.pb.KeyValuePairString;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.key="",r.value=""),null!=e.key&&e.hasOwnProperty("key")&&(r.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(r.value=e.value),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.ExtensionContainer=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.dataKey="",e.prototype.dataSpecification="",e.prototype.dataValue=u.newBuffer([]),e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.ExtensionContainer;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.dataKey=e.string();break;case 2:i.dataSpecification=e.string();break;case 3:i.dataValue=e.bytes();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.ExtensionContainer)return e;var t=new d.sdii.here.pb.ExtensionContainer;return null!=e.dataKey&&(t.dataKey=String(e.dataKey)),null!=e.dataSpecification&&(t.dataSpecification=String(e.dataSpecification)),null!=e.dataValue&&("string"==typeof e.dataValue?u.base64.decode(e.dataValue,t.dataValue=u.newBuffer(u.base64.length(e.dataValue)),0):e.dataValue.length&&(t.dataValue=e.dataValue)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.dataKey="",r.dataSpecification="",r.dataValue=t.bytes===String?"":[]),null!=e.dataKey&&e.hasOwnProperty("dataKey")&&(r.dataKey=e.dataKey),null!=e.dataSpecification&&e.hasOwnProperty("dataSpecification")&&(r.dataSpecification=e.dataSpecification),null!=e.dataValue&&e.hasOwnProperty("dataValue")&&(r.dataValue=t.bytes===String?u.base64.encode(e.dataValue,0,e.dataValue.length):t.bytes===Array?Array.prototype.slice.call(e.dataValue):e.dataValue),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.ProprietaryDataContainer=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.ProprietaryDataContainer;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){return e instanceof d.sdii.here.pb.ProprietaryDataContainer?e:new d.sdii.here.pb.ProprietaryDataContainer},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.Vector3D=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.longitudinalValue=0,e.prototype.lateralValue=0,e.prototype.verticalValue=0,e.prototype.longitudinalAccuracy=0,e.prototype.lateralAccuary=0,e.prototype.verticalAccuracy=0,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.Vector3D;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.longitudinalValue=e.double();break;case 2:i.lateralValue=e.double();break;case 3:i.verticalValue=e.double();break;case 4:i.longitudinalAccuracy=e.double();break;case 5:i.lateralAccuary=e.double();break;case 6:i.verticalAccuracy=e.double();break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("longitudinalValue"))throw u.ProtocolError("missing required 'longitudinalValue'",{instance:i});if(!i.hasOwnProperty("lateralValue"))throw u.ProtocolError("missing required 'lateralValue'",{instance:i});if(!i.hasOwnProperty("verticalValue"))throw u.ProtocolError("missing required 'verticalValue'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.Vector3D)return e;var t=new d.sdii.here.pb.Vector3D;return null!=e.longitudinalValue&&(t.longitudinalValue=Number(e.longitudinalValue)),null!=e.lateralValue&&(t.lateralValue=Number(e.lateralValue)),null!=e.verticalValue&&(t.verticalValue=Number(e.verticalValue)),null!=e.longitudinalAccuracy&&(t.longitudinalAccuracy=Number(e.longitudinalAccuracy)),null!=e.lateralAccuary&&(t.lateralAccuary=Number(e.lateralAccuary)),null!=e.verticalAccuracy&&(t.verticalAccuracy=Number(e.verticalAccuracy)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.longitudinalValue=0,r.lateralValue=0,r.verticalValue=0,r.longitudinalAccuracy=0,r.lateralAccuary=0,r.verticalAccuracy=0),null!=e.longitudinalValue&&e.hasOwnProperty("longitudinalValue")&&(r.longitudinalValue=t.json&&!isFinite(e.longitudinalValue)?String(e.longitudinalValue):e.longitudinalValue),null!=e.lateralValue&&e.hasOwnProperty("lateralValue")&&(r.lateralValue=t.json&&!isFinite(e.lateralValue)?String(e.lateralValue):e.lateralValue),null!=e.verticalValue&&e.hasOwnProperty("verticalValue")&&(r.verticalValue=t.json&&!isFinite(e.verticalValue)?String(e.verticalValue):e.verticalValue),null!=e.longitudinalAccuracy&&e.hasOwnProperty("longitudinalAccuracy")&&(r.longitudinalAccuracy=t.json&&!isFinite(e.longitudinalAccuracy)?String(e.longitudinalAccuracy):e.longitudinalAccuracy),null!=e.lateralAccuary&&e.hasOwnProperty("lateralAccuary")&&(r.lateralAccuary=t.json&&!isFinite(e.lateralAccuary)?String(e.lateralAccuary):e.lateralAccuary),null!=e.verticalAccuracy&&e.hasOwnProperty("verticalAccuracy")&&(r.verticalAccuracy=t.json&&!isFinite(e.verticalAccuracy)?String(e.verticalAccuracy):e.verticalAccuracy),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.VehicleMetaData=function(){function e(e){if(this.vehicleSpecificMetaData=[],this.vehicleHeightDetail=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.prototype.vehicleTypeGeneric=0,e.prototype.vehicleSpecificMetaData=u.emptyArray,e.prototype.vehicleReferencePointDeltaAboveGround_m=0,e.prototype.curvatureAccuracy_1pm=0,e.prototype.slopeAccuracy_percent=0,e.prototype.vehicleLength_m=0,e.prototype.vehicleWidth_m=0,e.prototype.vehicleHeight_m=0,e.prototype.primaryFuelTankVolume=0,e.prototype.primaryFuelType=0,e.prototype.secondaryFuelTankVolume=0,e.prototype.secondaryFuelType=0,e.prototype.vehicleHeightDetail=u.emptyArray,e.prototype.GNSSPositionReferencePointOffset=null,e.prototype.RelativePositionReferencePointOffset=null,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.VehicleMetaData;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.vehicleTypeGeneric=e.int32();break;case 2:i.vehicleSpecificMetaData&&i.vehicleSpecificMetaData.length||(i.vehicleSpecificMetaData=[]),i.vehicleSpecificMetaData.push(d.sdii.here.pb.KeyValuePairString.decode(e,e.uint32()));break;case 3:i.vehicleReferencePointDeltaAboveGround_m=e.double();break;case 4:i.curvatureAccuracy_1pm=e.double();break;case 5:i.slopeAccuracy_percent=e.double();break;case 6:i.vehicleLength_m=e.double();break;case 7:i.vehicleWidth_m=e.double();break;case 8:i.vehicleHeight_m=e.double();break;case 9:i.primaryFuelTankVolume=e.double();break;case 10:i.primaryFuelType=e.int32();break;case 11:i.secondaryFuelTankVolume=e.double();break;case 12:i.secondaryFuelType=e.int32();break;case 13:i.vehicleHeightDetail&&i.vehicleHeightDetail.length||(i.vehicleHeightDetail=[]),i.vehicleHeightDetail.push(d.sdii.here.pb.VehicleMetaData.VehicleHeightDetail.decode(e,e.uint32()));break;case 14:i.GNSSPositionReferencePointOffset=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 15:i.RelativePositionReferencePointOffset=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.VehicleMetaData)return e;var t=new d.sdii.here.pb.VehicleMetaData;switch(e.vehicleTypeGeneric){case"VEHICLE_TYPE_UNDEFINED":case 0:t.vehicleTypeGeneric=0;break;case"BUS":case 1:t.vehicleTypeGeneric=1;break;case"DELIVERY_TRUCK":case 2:t.vehicleTypeGeneric=2;break;case"EMERGENCY_VEHICLE":case 3:t.vehicleTypeGeneric=3;break;case"MOTORCYCLE":case 4:t.vehicleTypeGeneric=4;break;case"PASSENGER_CAR":case 5:t.vehicleTypeGeneric=5;break;case"TAXI":case 6:t.vehicleTypeGeneric=6;break;case"TRANSPORT_TRUCK":case 7:t.vehicleTypeGeneric=7;break;case"MOPED":case 8:t.vehicleTypeGeneric=8;break;case"TRAILER":case 9:t.vehicleTypeGeneric=9;break;case"TRAM":case 10:t.vehicleTypeGeneric=10;break;case"UNKNOWN_VEHICLE":case 11:t.vehicleTypeGeneric=11}if(e.vehicleSpecificMetaData){if(!Array.isArray(e.vehicleSpecificMetaData))throw TypeError(".sdii.here.pb.VehicleMetaData.vehicleSpecificMetaData: array expected");t.vehicleSpecificMetaData=[];for(var r=0;r<e.vehicleSpecificMetaData.length;++r){if("object"!=typeof e.vehicleSpecificMetaData[r])throw TypeError(".sdii.here.pb.VehicleMetaData.vehicleSpecificMetaData: object expected");t.vehicleSpecificMetaData[r]=d.sdii.here.pb.KeyValuePairString.fromObject(e.vehicleSpecificMetaData[r])}}switch(null!=e.vehicleReferencePointDeltaAboveGround_m&&(t.vehicleReferencePointDeltaAboveGround_m=Number(e.vehicleReferencePointDeltaAboveGround_m)),null!=e.curvatureAccuracy_1pm&&(t.curvatureAccuracy_1pm=Number(e.curvatureAccuracy_1pm)),null!=e.slopeAccuracy_percent&&(t.slopeAccuracy_percent=Number(e.slopeAccuracy_percent)),null!=e.vehicleLength_m&&(t.vehicleLength_m=Number(e.vehicleLength_m)),null!=e.vehicleWidth_m&&(t.vehicleWidth_m=Number(e.vehicleWidth_m)),null!=e.vehicleHeight_m&&(t.vehicleHeight_m=Number(e.vehicleHeight_m)),null!=e.primaryFuelTankVolume&&(t.primaryFuelTankVolume=Number(e.primaryFuelTankVolume)),e.primaryFuelType){case"FUEL_TYPE_UNDEFINED":case 0:t.primaryFuelType=0;break;case"FUEL_TYPE_OTHER":case 1:t.primaryFuelType=1;break;case"FUEL_TYPE_GASOLINE_L":case 2:t.primaryFuelType=2;break;case"FUEL_TYPE_DIESEL_L":case 3:t.primaryFuelType=3;break;case"FUEL_TYPE_AUTOGAS_KG":case 4:t.primaryFuelType=4;break;case"FUEL_TYPE_BATTERY_AH":case 5:t.primaryFuelType=5;break;case"FUEL_TYPE_HYDROGEN_KG":case 6:t.primaryFuelType=6}switch(null!=e.secondaryFuelTankVolume&&(t.secondaryFuelTankVolume=Number(e.secondaryFuelTankVolume)),e.secondaryFuelType){case"FUEL_TYPE_UNDEFINED":case 0:t.secondaryFuelType=0;break;case"FUEL_TYPE_OTHER":case 1:t.secondaryFuelType=1;break;case"FUEL_TYPE_GASOLINE_L":case 2:t.secondaryFuelType=2;break;case"FUEL_TYPE_DIESEL_L":case 3:t.secondaryFuelType=3;break;case"FUEL_TYPE_AUTOGAS_KG":case 4:t.secondaryFuelType=4;break;case"FUEL_TYPE_BATTERY_AH":case 5:t.secondaryFuelType=5;break;case"FUEL_TYPE_HYDROGEN_KG":case 6:t.secondaryFuelType=6}if(e.vehicleHeightDetail){if(!Array.isArray(e.vehicleHeightDetail))throw TypeError(".sdii.here.pb.VehicleMetaData.vehicleHeightDetail: array expected");for(t.vehicleHeightDetail=[],r=0;r<e.vehicleHeightDetail.length;++r){if("object"!=typeof e.vehicleHeightDetail[r])throw TypeError(".sdii.here.pb.VehicleMetaData.vehicleHeightDetail: object expected");t.vehicleHeightDetail[r]=d.sdii.here.pb.VehicleMetaData.VehicleHeightDetail.fromObject(e.vehicleHeightDetail[r])}}if(null!=e.GNSSPositionReferencePointOffset){if("object"!=typeof e.GNSSPositionReferencePointOffset)throw TypeError(".sdii.here.pb.VehicleMetaData.GNSSPositionReferencePointOffset: object expected");t.GNSSPositionReferencePointOffset=d.sdii.here.pb.Vector3D.fromObject(e.GNSSPositionReferencePointOffset)}if(null!=e.RelativePositionReferencePointOffset){if("object"!=typeof e.RelativePositionReferencePointOffset)throw TypeError(".sdii.here.pb.VehicleMetaData.RelativePositionReferencePointOffset: object expected");t.RelativePositionReferencePointOffset=d.sdii.here.pb.Vector3D.fromObject(e.RelativePositionReferencePointOffset)}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.vehicleSpecificMetaData=[],r.vehicleHeightDetail=[]),t.defaults&&(r.vehicleTypeGeneric=t.enums===String?"VEHICLE_TYPE_UNDEFINED":0,r.vehicleReferencePointDeltaAboveGround_m=0,r.curvatureAccuracy_1pm=0,r.slopeAccuracy_percent=0,r.vehicleLength_m=0,r.vehicleWidth_m=0,r.vehicleHeight_m=0,r.primaryFuelTankVolume=0,r.primaryFuelType=t.enums===String?"FUEL_TYPE_UNDEFINED":0,r.secondaryFuelTankVolume=0,r.secondaryFuelType=t.enums===String?"FUEL_TYPE_UNDEFINED":0,r.GNSSPositionReferencePointOffset=null,r.RelativePositionReferencePointOffset=null),null!=e.vehicleTypeGeneric&&e.hasOwnProperty("vehicleTypeGeneric")&&(r.vehicleTypeGeneric=t.enums===String?d.sdii.here.pb.VehicleMetaData.VehicleTypeGenericEnum[e.vehicleTypeGeneric]:e.vehicleTypeGeneric),e.vehicleSpecificMetaData&&e.vehicleSpecificMetaData.length){r.vehicleSpecificMetaData=[];for(var i=0;i<e.vehicleSpecificMetaData.length;++i)r.vehicleSpecificMetaData[i]=d.sdii.here.pb.KeyValuePairString.toObject(e.vehicleSpecificMetaData[i],t)}if(null!=e.vehicleReferencePointDeltaAboveGround_m&&e.hasOwnProperty("vehicleReferencePointDeltaAboveGround_m")&&(r.vehicleReferencePointDeltaAboveGround_m=t.json&&!isFinite(e.vehicleReferencePointDeltaAboveGround_m)?String(e.vehicleReferencePointDeltaAboveGround_m):e.vehicleReferencePointDeltaAboveGround_m),null!=e.curvatureAccuracy_1pm&&e.hasOwnProperty("curvatureAccuracy_1pm")&&(r.curvatureAccuracy_1pm=t.json&&!isFinite(e.curvatureAccuracy_1pm)?String(e.curvatureAccuracy_1pm):e.curvatureAccuracy_1pm),null!=e.slopeAccuracy_percent&&e.hasOwnProperty("slopeAccuracy_percent")&&(r.slopeAccuracy_percent=t.json&&!isFinite(e.slopeAccuracy_percent)?String(e.slopeAccuracy_percent):e.slopeAccuracy_percent),null!=e.vehicleLength_m&&e.hasOwnProperty("vehicleLength_m")&&(r.vehicleLength_m=t.json&&!isFinite(e.vehicleLength_m)?String(e.vehicleLength_m):e.vehicleLength_m),null!=e.vehicleWidth_m&&e.hasOwnProperty("vehicleWidth_m")&&(r.vehicleWidth_m=t.json&&!isFinite(e.vehicleWidth_m)?String(e.vehicleWidth_m):e.vehicleWidth_m),null!=e.vehicleHeight_m&&e.hasOwnProperty("vehicleHeight_m")&&(r.vehicleHeight_m=t.json&&!isFinite(e.vehicleHeight_m)?String(e.vehicleHeight_m):e.vehicleHeight_m),null!=e.primaryFuelTankVolume&&e.hasOwnProperty("primaryFuelTankVolume")&&(r.primaryFuelTankVolume=t.json&&!isFinite(e.primaryFuelTankVolume)?String(e.primaryFuelTankVolume):e.primaryFuelTankVolume),null!=e.primaryFuelType&&e.hasOwnProperty("primaryFuelType")&&(r.primaryFuelType=t.enums===String?d.sdii.here.pb.VehicleMetaData.FuelTypeEnum[e.primaryFuelType]:e.primaryFuelType),null!=e.secondaryFuelTankVolume&&e.hasOwnProperty("secondaryFuelTankVolume")&&(r.secondaryFuelTankVolume=t.json&&!isFinite(e.secondaryFuelTankVolume)?String(e.secondaryFuelTankVolume):e.secondaryFuelTankVolume),null!=e.secondaryFuelType&&e.hasOwnProperty("secondaryFuelType")&&(r.secondaryFuelType=t.enums===String?d.sdii.here.pb.VehicleMetaData.FuelTypeEnum[e.secondaryFuelType]:e.secondaryFuelType),e.vehicleHeightDetail&&e.vehicleHeightDetail.length)for(r.vehicleHeightDetail=[],i=0;i<e.vehicleHeightDetail.length;++i)r.vehicleHeightDetail[i]=d.sdii.here.pb.VehicleMetaData.VehicleHeightDetail.toObject(e.vehicleHeightDetail[i],t);return null!=e.GNSSPositionReferencePointOffset&&e.hasOwnProperty("GNSSPositionReferencePointOffset")&&(r.GNSSPositionReferencePointOffset=d.sdii.here.pb.Vector3D.toObject(e.GNSSPositionReferencePointOffset,t)),null!=e.RelativePositionReferencePointOffset&&e.hasOwnProperty("RelativePositionReferencePointOffset")&&(r.RelativePositionReferencePointOffset=d.sdii.here.pb.Vector3D.toObject(e.RelativePositionReferencePointOffset,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.VehicleTypeGenericEnum=(t={},(r=Object.create(t))[t[0]="VEHICLE_TYPE_UNDEFINED"]=0,r[t[1]="BUS"]=1,r[t[2]="DELIVERY_TRUCK"]=2,r[t[3]="EMERGENCY_VEHICLE"]=3,r[t[4]="MOTORCYCLE"]=4,r[t[5]="PASSENGER_CAR"]=5,r[t[6]="TAXI"]=6,r[t[7]="TRANSPORT_TRUCK"]=7,r[t[8]="MOPED"]=8,r[t[9]="TRAILER"]=9,r[t[10]="TRAM"]=10,r[t[11]="UNKNOWN_VEHICLE"]=11,r),e.FuelTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="FUEL_TYPE_UNDEFINED"]=0,t[e[1]="FUEL_TYPE_OTHER"]=1,t[e[2]="FUEL_TYPE_GASOLINE_L"]=2,t[e[3]="FUEL_TYPE_DIESEL_L"]=3,t[e[4]="FUEL_TYPE_AUTOGAS_KG"]=4,t[e[5]="FUEL_TYPE_BATTERY_AH"]=5,t[e[6]="FUEL_TYPE_HYDROGEN_KG"]=6,t}(),e.VehicleHeightDetail=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.longitudinalVehicleHeightReferencePoint=0,e.prototype.lateralVehicleHeightReferencePoint=0,e.prototype.vehicleHeightValue_mm=u.Long?u.Long.fromBits(0,0,!1):0,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.VehicleMetaData.VehicleHeightDetail;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.longitudinalVehicleHeightReferencePoint=e.int32();break;case 2:i.lateralVehicleHeightReferencePoint=e.int32();break;case 3:i.vehicleHeightValue_mm=e.int64();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.VehicleMetaData.VehicleHeightDetail)return e;var t=new d.sdii.here.pb.VehicleMetaData.VehicleHeightDetail;switch(e.longitudinalVehicleHeightReferencePoint){case"LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_UNDEFINED":case 0:t.longitudinalVehicleHeightReferencePoint=0;break;case"LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_FRONT":case 1:t.longitudinalVehicleHeightReferencePoint=1;break;case"LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_MIDDLE":case 2:t.longitudinalVehicleHeightReferencePoint=2;break;case"LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_REAR":case 3:t.longitudinalVehicleHeightReferencePoint=3}switch(e.lateralVehicleHeightReferencePoint){case"LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_UNDEFINED":case 0:t.lateralVehicleHeightReferencePoint=0;break;case"LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_LEFT":case 1:t.lateralVehicleHeightReferencePoint=1;break;case"LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_MIDDLE":case 2:t.lateralVehicleHeightReferencePoint=2;break;case"LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_RIGHT":case 3:t.lateralVehicleHeightReferencePoint=3}return null!=e.vehicleHeightValue_mm&&(u.Long?(t.vehicleHeightValue_mm=u.Long.fromValue(e.vehicleHeightValue_mm)).unsigned=!1:"string"==typeof e.vehicleHeightValue_mm?t.vehicleHeightValue_mm=parseInt(e.vehicleHeightValue_mm,10):"number"==typeof e.vehicleHeightValue_mm?t.vehicleHeightValue_mm=e.vehicleHeightValue_mm:"object"==typeof e.vehicleHeightValue_mm&&(t.vehicleHeightValue_mm=new u.LongBits(e.vehicleHeightValue_mm.low>>>0,e.vehicleHeightValue_mm.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults)if(r.longitudinalVehicleHeightReferencePoint=t.enums===String?"LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_UNDEFINED":0,r.lateralVehicleHeightReferencePoint=t.enums===String?"LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_UNDEFINED":0,u.Long){var i=new u.Long(0,0,!1);r.vehicleHeightValue_mm=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.vehicleHeightValue_mm=t.longs===String?"0":0;return null!=e.longitudinalVehicleHeightReferencePoint&&e.hasOwnProperty("longitudinalVehicleHeightReferencePoint")&&(r.longitudinalVehicleHeightReferencePoint=t.enums===String?d.sdii.here.pb.VehicleMetaData.VehicleHeightDetail.LongitudinalVehicleHeightReferencePointEnum[e.longitudinalVehicleHeightReferencePoint]:e.longitudinalVehicleHeightReferencePoint),null!=e.lateralVehicleHeightReferencePoint&&e.hasOwnProperty("lateralVehicleHeightReferencePoint")&&(r.lateralVehicleHeightReferencePoint=t.enums===String?d.sdii.here.pb.VehicleMetaData.VehicleHeightDetail.LateralVehicleHeightReferencePointEnum[e.lateralVehicleHeightReferencePoint]:e.lateralVehicleHeightReferencePoint),null!=e.vehicleHeightValue_mm&&e.hasOwnProperty("vehicleHeightValue_mm")&&("number"==typeof e.vehicleHeightValue_mm?r.vehicleHeightValue_mm=t.longs===String?String(e.vehicleHeightValue_mm):e.vehicleHeightValue_mm:r.vehicleHeightValue_mm=t.longs===String?u.Long.prototype.toString.call(e.vehicleHeightValue_mm):t.longs===Number?new u.LongBits(e.vehicleHeightValue_mm.low>>>0,e.vehicleHeightValue_mm.high>>>0).toNumber():e.vehicleHeightValue_mm),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.LongitudinalVehicleHeightReferencePointEnum=function(){var e={},t=Object.create(e);return t[e[0]="LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_UNDEFINED"]=0,t[e[1]="LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_FRONT"]=1,t[e[2]="LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_MIDDLE"]=2,t[e[3]="LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_REAR"]=3,t}(),e.LateralVehicleHeightReferencePointEnum=function(){var e={},t=Object.create(e);return t[e[0]="LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_UNDEFINED"]=0,t[e[1]="LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_LEFT"]=1,t[e[2]="LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_MIDDLE"]=2,t[e[3]="LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_RIGHT"]=3,t}(),e}(),e}(),o.Envelope=function(){function e(e){if(this.submissionConfigurationUUIDArray=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.prototype.version="",e.prototype.submitter="",e.prototype.vehicleMetaData=null,e.prototype.transientVehicleID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.vehicleProfileID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.transientEventID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.persistentDriverUUID="",e.prototype.persistentVehicleUUID="",e.prototype.transientVehicleUUID="",e.prototype.submissionConfigurationUUIDArray=u.emptyArray,e.prototype.mapProvider="",e.prototype.mapVersion="",e.prototype.mapStandard=0,e.prototype.transientEventUUID="",e.prototype.vehicleHeadUnitVersion="",e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.Envelope;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.version=e.string();break;case 2:i.submitter=e.string();break;case 3:i.vehicleMetaData=d.sdii.here.pb.VehicleMetaData.decode(e,e.uint32());break;case 4:i.transientVehicleID=e.int64();break;case 5:i.vehicleProfileID=e.int64();break;case 6:i.transientEventID=e.int64();break;case 7:i.persistentDriverUUID=e.string();break;case 8:i.persistentVehicleUUID=e.string();break;case 9:i.transientVehicleUUID=e.string();break;case 10:i.submissionConfigurationUUIDArray&&i.submissionConfigurationUUIDArray.length||(i.submissionConfigurationUUIDArray=[]),i.submissionConfigurationUUIDArray.push(e.string());break;case 11:i.mapProvider=e.string();break;case 12:i.mapVersion=e.string();break;case 13:i.mapStandard=e.int32();break;case 14:i.transientEventUUID=e.string();break;case 15:i.vehicleHeadUnitVersion=e.string();break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("version"))throw u.ProtocolError("missing required 'version'",{instance:i});if(!i.hasOwnProperty("submitter"))throw u.ProtocolError("missing required 'submitter'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.Envelope)return e;var t=new d.sdii.here.pb.Envelope;if(null!=e.version&&(t.version=String(e.version)),null!=e.submitter&&(t.submitter=String(e.submitter)),null!=e.vehicleMetaData){if("object"!=typeof e.vehicleMetaData)throw TypeError(".sdii.here.pb.Envelope.vehicleMetaData: object expected");t.vehicleMetaData=d.sdii.here.pb.VehicleMetaData.fromObject(e.vehicleMetaData)}if(null!=e.transientVehicleID&&(u.Long?(t.transientVehicleID=u.Long.fromValue(e.transientVehicleID)).unsigned=!1:"string"==typeof e.transientVehicleID?t.transientVehicleID=parseInt(e.transientVehicleID,10):"number"==typeof e.transientVehicleID?t.transientVehicleID=e.transientVehicleID:"object"==typeof e.transientVehicleID&&(t.transientVehicleID=new u.LongBits(e.transientVehicleID.low>>>0,e.transientVehicleID.high>>>0).toNumber())),null!=e.vehicleProfileID&&(u.Long?(t.vehicleProfileID=u.Long.fromValue(e.vehicleProfileID)).unsigned=!1:"string"==typeof e.vehicleProfileID?t.vehicleProfileID=parseInt(e.vehicleProfileID,10):"number"==typeof e.vehicleProfileID?t.vehicleProfileID=e.vehicleProfileID:"object"==typeof e.vehicleProfileID&&(t.vehicleProfileID=new u.LongBits(e.vehicleProfileID.low>>>0,e.vehicleProfileID.high>>>0).toNumber())),null!=e.transientEventID&&(u.Long?(t.transientEventID=u.Long.fromValue(e.transientEventID)).unsigned=!1:"string"==typeof e.transientEventID?t.transientEventID=parseInt(e.transientEventID,10):"number"==typeof e.transientEventID?t.transientEventID=e.transientEventID:"object"==typeof e.transientEventID&&(t.transientEventID=new u.LongBits(e.transientEventID.low>>>0,e.transientEventID.high>>>0).toNumber())),null!=e.persistentDriverUUID&&(t.persistentDriverUUID=String(e.persistentDriverUUID)),null!=e.persistentVehicleUUID&&(t.persistentVehicleUUID=String(e.persistentVehicleUUID)),null!=e.transientVehicleUUID&&(t.transientVehicleUUID=String(e.transientVehicleUUID)),e.submissionConfigurationUUIDArray){if(!Array.isArray(e.submissionConfigurationUUIDArray))throw TypeError(".sdii.here.pb.Envelope.submissionConfigurationUUIDArray: array expected");t.submissionConfigurationUUIDArray=[];for(var r=0;r<e.submissionConfigurationUUIDArray.length;++r)t.submissionConfigurationUUIDArray[r]=String(e.submissionConfigurationUUIDArray[r])}switch(null!=e.mapProvider&&(t.mapProvider=String(e.mapProvider)),null!=e.mapVersion&&(t.mapVersion=String(e.mapVersion)),e.mapStandard){case"MAP_STANDARD_UNDEFINED":case 0:t.mapStandard=0;break;case"OTHER":case 1:t.mapStandard=1;break;case"NDS":case 2:t.mapStandard=2;break;case"GDF":case 3:t.mapStandard=3;break;case"RDF":case 4:t.mapStandard=4;break;case"HERE_HDMAP":case 5:t.mapStandard=5}return null!=e.transientEventUUID&&(t.transientEventUUID=String(e.transientEventUUID)),null!=e.vehicleHeadUnitVersion&&(t.vehicleHeadUnitVersion=String(e.vehicleHeadUnitVersion)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.submissionConfigurationUUIDArray=[]),t.defaults){if(r.version="",r.submitter="",r.vehicleMetaData=null,u.Long){var i=new u.Long(0,0,!1);r.transientVehicleID=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.transientVehicleID=t.longs===String?"0":0;u.Long?(i=new u.Long(0,0,!1),r.vehicleProfileID=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.vehicleProfileID=t.longs===String?"0":0,u.Long?(i=new u.Long(0,0,!1),r.transientEventID=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.transientEventID=t.longs===String?"0":0,r.persistentDriverUUID="",r.persistentVehicleUUID="",r.transientVehicleUUID="",r.mapProvider="",r.mapVersion="",r.mapStandard=t.enums===String?"MAP_STANDARD_UNDEFINED":0,r.transientEventUUID="",r.vehicleHeadUnitVersion=""}if(null!=e.version&&e.hasOwnProperty("version")&&(r.version=e.version),null!=e.submitter&&e.hasOwnProperty("submitter")&&(r.submitter=e.submitter),null!=e.vehicleMetaData&&e.hasOwnProperty("vehicleMetaData")&&(r.vehicleMetaData=d.sdii.here.pb.VehicleMetaData.toObject(e.vehicleMetaData,t)),null!=e.transientVehicleID&&e.hasOwnProperty("transientVehicleID")&&("number"==typeof e.transientVehicleID?r.transientVehicleID=t.longs===String?String(e.transientVehicleID):e.transientVehicleID:r.transientVehicleID=t.longs===String?u.Long.prototype.toString.call(e.transientVehicleID):t.longs===Number?new u.LongBits(e.transientVehicleID.low>>>0,e.transientVehicleID.high>>>0).toNumber():e.transientVehicleID),null!=e.vehicleProfileID&&e.hasOwnProperty("vehicleProfileID")&&("number"==typeof e.vehicleProfileID?r.vehicleProfileID=t.longs===String?String(e.vehicleProfileID):e.vehicleProfileID:r.vehicleProfileID=t.longs===String?u.Long.prototype.toString.call(e.vehicleProfileID):t.longs===Number?new u.LongBits(e.vehicleProfileID.low>>>0,e.vehicleProfileID.high>>>0).toNumber():e.vehicleProfileID),null!=e.transientEventID&&e.hasOwnProperty("transientEventID")&&("number"==typeof e.transientEventID?r.transientEventID=t.longs===String?String(e.transientEventID):e.transientEventID:r.transientEventID=t.longs===String?u.Long.prototype.toString.call(e.transientEventID):t.longs===Number?new u.LongBits(e.transientEventID.low>>>0,e.transientEventID.high>>>0).toNumber():e.transientEventID),null!=e.persistentDriverUUID&&e.hasOwnProperty("persistentDriverUUID")&&(r.persistentDriverUUID=e.persistentDriverUUID),null!=e.persistentVehicleUUID&&e.hasOwnProperty("persistentVehicleUUID")&&(r.persistentVehicleUUID=e.persistentVehicleUUID),null!=e.transientVehicleUUID&&e.hasOwnProperty("transientVehicleUUID")&&(r.transientVehicleUUID=e.transientVehicleUUID),e.submissionConfigurationUUIDArray&&e.submissionConfigurationUUIDArray.length){r.submissionConfigurationUUIDArray=[];for(var n=0;n<e.submissionConfigurationUUIDArray.length;++n)r.submissionConfigurationUUIDArray[n]=e.submissionConfigurationUUIDArray[n]}return null!=e.mapProvider&&e.hasOwnProperty("mapProvider")&&(r.mapProvider=e.mapProvider),null!=e.mapVersion&&e.hasOwnProperty("mapVersion")&&(r.mapVersion=e.mapVersion),null!=e.mapStandard&&e.hasOwnProperty("mapStandard")&&(r.mapStandard=t.enums===String?d.sdii.here.pb.Envelope.MapStandardEnum[e.mapStandard]:e.mapStandard),null!=e.transientEventUUID&&e.hasOwnProperty("transientEventUUID")&&(r.transientEventUUID=e.transientEventUUID),null!=e.vehicleHeadUnitVersion&&e.hasOwnProperty("vehicleHeadUnitVersion")&&(r.vehicleHeadUnitVersion=e.vehicleHeadUnitVersion),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.MapStandardEnum=(t={},(r=Object.create(t))[t[0]="MAP_STANDARD_UNDEFINED"]=0,r[t[1]="OTHER"]=1,r[t[2]="NDS"]=2,r[t[3]="GDF"]=3,r[t[4]="RDF"]=4,r[t[5]="HERE_HDMAP"]=5,r),e}(),o.PositionEstimate=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.positionType=0,e.prototype.interpolatedPoint=!1,e.prototype.longitude_deg=0,e.prototype.latitude_deg=0,e.prototype.horizontalAccuracy_m=0,e.prototype.altitude_m=0,e.prototype.heading_deg=0,e.prototype.speed_mps=0,e.prototype.altitudeAccuracy_m=0,e.prototype.headingAccuracy_deg=0,e.prototype.speedAccuracy_mps=0,e.prototype.speedDetectionType=0,e.prototype.headingDetectionType=0,e.prototype.vehicleReferencedOrientationVector_rad=null,e.prototype.currentLaneEstimate=0,e.prototype.mapMatchedLinkID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.mapMatchedLinkIDConfidence_percent=0,e.prototype.mapMatchedLinkIDOffset_m=0,e.prototype.laneCountDirection=0,e.prototype.currentLaneEstimateConfidence_percent=0,e.prototype.firstPointAfterFixLoss=!1,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.PositionEstimate;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.int64();break;case 2:i.positionType=e.int32();break;case 3:i.interpolatedPoint=e.bool();break;case 4:i.longitude_deg=e.double();break;case 5:i.latitude_deg=e.double();break;case 6:i.horizontalAccuracy_m=e.double();break;case 7:i.altitude_m=e.double();break;case 8:i.heading_deg=e.double();break;case 9:i.speed_mps=e.double();break;case 10:i.altitudeAccuracy_m=e.double();break;case 11:i.headingAccuracy_deg=e.double();break;case 12:i.speedAccuracy_mps=e.double();break;case 13:i.speedDetectionType=e.int32();break;case 14:i.headingDetectionType=e.int32();break;case 15:i.vehicleReferencedOrientationVector_rad=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 16:i.currentLaneEstimate=e.int32();break;case 17:i.mapMatchedLinkID=e.int64();break;case 18:i.mapMatchedLinkIDConfidence_percent=e.int32();break;case 19:i.mapMatchedLinkIDOffset_m=e.double();break;case 20:i.laneCountDirection=e.int32();break;case 21:i.currentLaneEstimateConfidence_percent=e.int32();break;case 22:i.firstPointAfterFixLoss=e.bool();break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});if(!i.hasOwnProperty("positionType"))throw u.ProtocolError("missing required 'positionType'",{instance:i});if(!i.hasOwnProperty("longitude_deg"))throw u.ProtocolError("missing required 'longitude_deg'",{instance:i});if(!i.hasOwnProperty("latitude_deg"))throw u.ProtocolError("missing required 'latitude_deg'",{instance:i});if(!i.hasOwnProperty("horizontalAccuracy_m"))throw u.ProtocolError("missing required 'horizontalAccuracy_m'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.PositionEstimate)return e;var t=new d.sdii.here.pb.PositionEstimate;switch(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),e.positionType){case"POSITION_TYPE_UNDEFINED":case 0:t.positionType=0;break;case"RAW_GPS":case 1:t.positionType=1;break;case"FILTERED":case 2:t.positionType=2;break;case"MAP_MATCHED_REGULAR_MAP":case 3:t.positionType=3;break;case"MAP_MATCHED_HD_MAP":case 4:t.positionType=4;break;case"MAP_MATCHED_HD_MAP_LANE":case 5:t.positionType=5}switch(null!=e.interpolatedPoint&&(t.interpolatedPoint=Boolean(e.interpolatedPoint)),null!=e.longitude_deg&&(t.longitude_deg=Number(e.longitude_deg)),null!=e.latitude_deg&&(t.latitude_deg=Number(e.latitude_deg)),null!=e.horizontalAccuracy_m&&(t.horizontalAccuracy_m=Number(e.horizontalAccuracy_m)),null!=e.altitude_m&&(t.altitude_m=Number(e.altitude_m)),null!=e.heading_deg&&(t.heading_deg=Number(e.heading_deg)),null!=e.speed_mps&&(t.speed_mps=Number(e.speed_mps)),null!=e.altitudeAccuracy_m&&(t.altitudeAccuracy_m=Number(e.altitudeAccuracy_m)),null!=e.headingAccuracy_deg&&(t.headingAccuracy_deg=Number(e.headingAccuracy_deg)),null!=e.speedAccuracy_mps&&(t.speedAccuracy_mps=Number(e.speedAccuracy_mps)),e.speedDetectionType){case"SPEED_DETECTION_UNDEFINED":case 0:t.speedDetectionType=0;break;case"SPEED_RAW_GPS":case 1:t.speedDetectionType=1;break;case"SPEED_WHEEL_TICKS":case 2:t.speedDetectionType=2;break;case"SPEED_RADAR_SONAR":case 3:t.speedDetectionType=3;break;case"SPEED_FILTERED":case 4:t.speedDetectionType=4}switch(e.headingDetectionType){case"HEADING_DETECTION_UNDEFINED":case 0:t.headingDetectionType=0;break;case"HEADING_RAW_GPS":case 1:t.headingDetectionType=1;break;case"HEADING_MAGNETIC_SENSOR":case 2:t.headingDetectionType=2;break;case"HEADING_MULTI_SENSOR_FUSION":case 3:t.headingDetectionType=3;break;case"HEADING_BY_MAP":case 4:t.headingDetectionType=4}if(null!=e.vehicleReferencedOrientationVector_rad){if("object"!=typeof e.vehicleReferencedOrientationVector_rad)throw TypeError(".sdii.here.pb.PositionEstimate.vehicleReferencedOrientationVector_rad: object expected");t.vehicleReferencedOrientationVector_rad=d.sdii.here.pb.Vector3D.fromObject(e.vehicleReferencedOrientationVector_rad)}switch(null!=e.currentLaneEstimate&&(t.currentLaneEstimate=0|e.currentLaneEstimate),null!=e.mapMatchedLinkID&&(u.Long?(t.mapMatchedLinkID=u.Long.fromValue(e.mapMatchedLinkID)).unsigned=!1:"string"==typeof e.mapMatchedLinkID?t.mapMatchedLinkID=parseInt(e.mapMatchedLinkID,10):"number"==typeof e.mapMatchedLinkID?t.mapMatchedLinkID=e.mapMatchedLinkID:"object"==typeof e.mapMatchedLinkID&&(t.mapMatchedLinkID=new u.LongBits(e.mapMatchedLinkID.low>>>0,e.mapMatchedLinkID.high>>>0).toNumber())),null!=e.mapMatchedLinkIDConfidence_percent&&(t.mapMatchedLinkIDConfidence_percent=0|e.mapMatchedLinkIDConfidence_percent),null!=e.mapMatchedLinkIDOffset_m&&(t.mapMatchedLinkIDOffset_m=Number(e.mapMatchedLinkIDOffset_m)),e.laneCountDirection){case"LANE_COUNT_DIRECTION_UNDEFINED":case 0:t.laneCountDirection=0;break;case"LANE_COUNT_DIRECTION_FROM_LEFT":case 1:t.laneCountDirection=1;break;case"LANE_COUNT_DIRECTION_FROM_RIGHT":case 2:t.laneCountDirection=2}if(null!=e.currentLaneEstimateConfidence_percent&&(t.currentLaneEstimateConfidence_percent=0|e.currentLaneEstimateConfidence_percent),null!=e.firstPointAfterFixLoss&&(t.firstPointAfterFixLoss=Boolean(e.firstPointAfterFixLoss)),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.PositionEstimate.extensionContainer: array expected");t.extensionContainer=[];for(var r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.PositionEstimate.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.extensionContainer=[]),t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timeStampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timeStampUTC_ms=t.longs===String?"0":0;r.positionType=t.enums===String?"POSITION_TYPE_UNDEFINED":0,r.interpolatedPoint=!1,r.longitude_deg=0,r.latitude_deg=0,r.horizontalAccuracy_m=0,r.altitude_m=0,r.heading_deg=0,r.speed_mps=0,r.altitudeAccuracy_m=0,r.headingAccuracy_deg=0,r.speedAccuracy_mps=0,r.speedDetectionType=t.enums===String?"SPEED_DETECTION_UNDEFINED":0,r.headingDetectionType=t.enums===String?"HEADING_DETECTION_UNDEFINED":0,r.vehicleReferencedOrientationVector_rad=null,r.currentLaneEstimate=0,u.Long?(i=new u.Long(0,0,!1),r.mapMatchedLinkID=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.mapMatchedLinkID=t.longs===String?"0":0,r.mapMatchedLinkIDConfidence_percent=0,r.mapMatchedLinkIDOffset_m=0,r.laneCountDirection=t.enums===String?"LANE_COUNT_DIRECTION_UNDEFINED":0,r.currentLaneEstimateConfidence_percent=0,r.firstPointAfterFixLoss=!1}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?r.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:r.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.positionType&&e.hasOwnProperty("positionType")&&(r.positionType=t.enums===String?d.sdii.here.pb.PositionEstimate.PositionTypeEnum[e.positionType]:e.positionType),null!=e.interpolatedPoint&&e.hasOwnProperty("interpolatedPoint")&&(r.interpolatedPoint=e.interpolatedPoint),null!=e.longitude_deg&&e.hasOwnProperty("longitude_deg")&&(r.longitude_deg=t.json&&!isFinite(e.longitude_deg)?String(e.longitude_deg):e.longitude_deg),null!=e.latitude_deg&&e.hasOwnProperty("latitude_deg")&&(r.latitude_deg=t.json&&!isFinite(e.latitude_deg)?String(e.latitude_deg):e.latitude_deg),null!=e.horizontalAccuracy_m&&e.hasOwnProperty("horizontalAccuracy_m")&&(r.horizontalAccuracy_m=t.json&&!isFinite(e.horizontalAccuracy_m)?String(e.horizontalAccuracy_m):e.horizontalAccuracy_m),null!=e.altitude_m&&e.hasOwnProperty("altitude_m")&&(r.altitude_m=t.json&&!isFinite(e.altitude_m)?String(e.altitude_m):e.altitude_m),null!=e.heading_deg&&e.hasOwnProperty("heading_deg")&&(r.heading_deg=t.json&&!isFinite(e.heading_deg)?String(e.heading_deg):e.heading_deg),null!=e.speed_mps&&e.hasOwnProperty("speed_mps")&&(r.speed_mps=t.json&&!isFinite(e.speed_mps)?String(e.speed_mps):e.speed_mps),null!=e.altitudeAccuracy_m&&e.hasOwnProperty("altitudeAccuracy_m")&&(r.altitudeAccuracy_m=t.json&&!isFinite(e.altitudeAccuracy_m)?String(e.altitudeAccuracy_m):e.altitudeAccuracy_m),null!=e.headingAccuracy_deg&&e.hasOwnProperty("headingAccuracy_deg")&&(r.headingAccuracy_deg=t.json&&!isFinite(e.headingAccuracy_deg)?String(e.headingAccuracy_deg):e.headingAccuracy_deg),null!=e.speedAccuracy_mps&&e.hasOwnProperty("speedAccuracy_mps")&&(r.speedAccuracy_mps=t.json&&!isFinite(e.speedAccuracy_mps)?String(e.speedAccuracy_mps):e.speedAccuracy_mps),null!=e.speedDetectionType&&e.hasOwnProperty("speedDetectionType")&&(r.speedDetectionType=t.enums===String?d.sdii.here.pb.PositionEstimate.SpeedDetectionEnum[e.speedDetectionType]:e.speedDetectionType),null!=e.headingDetectionType&&e.hasOwnProperty("headingDetectionType")&&(r.headingDetectionType=t.enums===String?d.sdii.here.pb.PositionEstimate.HeadingDetectionEnum[e.headingDetectionType]:e.headingDetectionType),null!=e.vehicleReferencedOrientationVector_rad&&e.hasOwnProperty("vehicleReferencedOrientationVector_rad")&&(r.vehicleReferencedOrientationVector_rad=d.sdii.here.pb.Vector3D.toObject(e.vehicleReferencedOrientationVector_rad,t)),null!=e.currentLaneEstimate&&e.hasOwnProperty("currentLaneEstimate")&&(r.currentLaneEstimate=e.currentLaneEstimate),null!=e.mapMatchedLinkID&&e.hasOwnProperty("mapMatchedLinkID")&&("number"==typeof e.mapMatchedLinkID?r.mapMatchedLinkID=t.longs===String?String(e.mapMatchedLinkID):e.mapMatchedLinkID:r.mapMatchedLinkID=t.longs===String?u.Long.prototype.toString.call(e.mapMatchedLinkID):t.longs===Number?new u.LongBits(e.mapMatchedLinkID.low>>>0,e.mapMatchedLinkID.high>>>0).toNumber():e.mapMatchedLinkID),null!=e.mapMatchedLinkIDConfidence_percent&&e.hasOwnProperty("mapMatchedLinkIDConfidence_percent")&&(r.mapMatchedLinkIDConfidence_percent=e.mapMatchedLinkIDConfidence_percent),null!=e.mapMatchedLinkIDOffset_m&&e.hasOwnProperty("mapMatchedLinkIDOffset_m")&&(r.mapMatchedLinkIDOffset_m=t.json&&!isFinite(e.mapMatchedLinkIDOffset_m)?String(e.mapMatchedLinkIDOffset_m):e.mapMatchedLinkIDOffset_m),null!=e.laneCountDirection&&e.hasOwnProperty("laneCountDirection")&&(r.laneCountDirection=t.enums===String?d.sdii.here.pb.PositionEstimate.LaneCountDirectionEnum[e.laneCountDirection]:e.laneCountDirection),null!=e.currentLaneEstimateConfidence_percent&&e.hasOwnProperty("currentLaneEstimateConfidence_percent")&&(r.currentLaneEstimateConfidence_percent=e.currentLaneEstimateConfidence_percent),null!=e.firstPointAfterFixLoss&&e.hasOwnProperty("firstPointAfterFixLoss")&&(r.firstPointAfterFixLoss=e.firstPointAfterFixLoss),e.extensionContainer&&e.extensionContainer.length){r.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.PositionTypeEnum=(t={},(r=Object.create(t))[t[0]="POSITION_TYPE_UNDEFINED"]=0,r[t[1]="RAW_GPS"]=1,r[t[2]="FILTERED"]=2,r[t[3]="MAP_MATCHED_REGULAR_MAP"]=3,r[t[4]="MAP_MATCHED_HD_MAP"]=4,r[t[5]="MAP_MATCHED_HD_MAP_LANE"]=5,r),e.SpeedDetectionEnum=function(){var e={},t=Object.create(e);return t[e[0]="SPEED_DETECTION_UNDEFINED"]=0,t[e[1]="SPEED_RAW_GPS"]=1,t[e[2]="SPEED_WHEEL_TICKS"]=2,t[e[3]="SPEED_RADAR_SONAR"]=3,t[e[4]="SPEED_FILTERED"]=4,t}(),e.HeadingDetectionEnum=function(){var e={},t=Object.create(e);return t[e[0]="HEADING_DETECTION_UNDEFINED"]=0,t[e[1]="HEADING_RAW_GPS"]=1,t[e[2]="HEADING_MAGNETIC_SENSOR"]=2,t[e[3]="HEADING_MULTI_SENSOR_FUSION"]=3,t[e[4]="HEADING_BY_MAP"]=4,t}(),e.LaneCountDirectionEnum=function(){var e={},t=Object.create(e);return t[e[0]="LANE_COUNT_DIRECTION_UNDEFINED"]=0,t[e[1]="LANE_COUNT_DIRECTION_FROM_LEFT"]=1,t[e[2]="LANE_COUNT_DIRECTION_FROM_RIGHT"]=2,t}(),e}(),o.PathSegment=function(){function e(e){if(this.positionEstimate=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.positionEstimate=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.PathSegment;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.positionEstimate&&i.positionEstimate.length||(i.positionEstimate=[]),i.positionEstimate.push(d.sdii.here.pb.PositionEstimate.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.PathSegment)return e;var t=new d.sdii.here.pb.PathSegment;if(e.positionEstimate){if(!Array.isArray(e.positionEstimate))throw TypeError(".sdii.here.pb.PathSegment.positionEstimate: array expected");t.positionEstimate=[];for(var r=0;r<e.positionEstimate.length;++r){if("object"!=typeof e.positionEstimate[r])throw TypeError(".sdii.here.pb.PathSegment.positionEstimate: object expected");t.positionEstimate[r]=d.sdii.here.pb.PositionEstimate.fromObject(e.positionEstimate[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.positionEstimate=[]),e.positionEstimate&&e.positionEstimate.length){r.positionEstimate=[];for(var i=0;i<e.positionEstimate.length;++i)r.positionEstimate[i]=d.sdii.here.pb.PositionEstimate.toObject(e.positionEstimate[i],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.Path=function(){function e(e){if(this.positionEstimate=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.positionEstimate=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.Path;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.positionEstimate&&i.positionEstimate.length||(i.positionEstimate=[]),i.positionEstimate.push(d.sdii.here.pb.PositionEstimate.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.Path)return e;var t=new d.sdii.here.pb.Path;if(e.positionEstimate){if(!Array.isArray(e.positionEstimate))throw TypeError(".sdii.here.pb.Path.positionEstimate: array expected");t.positionEstimate=[];for(var r=0;r<e.positionEstimate.length;++r){if("object"!=typeof e.positionEstimate[r])throw TypeError(".sdii.here.pb.Path.positionEstimate: object expected");t.positionEstimate[r]=d.sdii.here.pb.PositionEstimate.fromObject(e.positionEstimate[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.positionEstimate=[]),e.positionEstimate&&e.positionEstimate.length){r.positionEstimate=[];for(var i=0;i<e.positionEstimate.length;++i)r.positionEstimate[i]=d.sdii.here.pb.PositionEstimate.toObject(e.positionEstimate[i],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.WheelReferenceBitfield=(i={},(n=Object.create(i))[i[1]="frontAxleLeft"]=1,n[i[2]="frontAxleRight"]=2,n[i[4]="rearAxleLeft"]=4,n[i[8]="rearAxleRight"]=8,n),o.VehicleStatus=function(){function e(e){if(this.doorStates=[],this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.transmissionMode=0,e.prototype.lightStateBitfield=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.wiperState=0,e.prototype.temperatureExternal_cel=0,e.prototype.wiperSpeed_wpm=0,e.prototype.driveWheelReference=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.chassisClearance_m=0,e.prototype.mileage_km=0,e.prototype.primaryFuelState=0,e.prototype.primaryFuelStateAccuracy=0,e.prototype.estimatedPrimaryRange_km=0,e.prototype.secondaryFuelState=0,e.prototype.secondaryFuelStateAccuracy=0,e.prototype.estimatedSecondaryRange_km=0,e.prototype.maintenanceLightState=1,e.prototype.currentGear=0,e.prototype.ignitionState=0,e.prototype.engineState=0,e.prototype.doorStates=u.emptyArray,e.prototype.ventilationState=null,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.VehicleStatus;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.int64();break;case 2:i.transmissionMode=e.int32();break;case 3:i.lightStateBitfield=e.int64();break;case 4:i.wiperState=e.int32();break;case 5:i.temperatureExternal_cel=e.double();break;case 6:i.wiperSpeed_wpm=e.int32();break;case 7:i.driveWheelReference=e.int64();break;case 8:i.chassisClearance_m=e.double();break;case 9:i.mileage_km=e.double();break;case 10:i.primaryFuelState=e.double();break;case 11:i.primaryFuelStateAccuracy=e.double();break;case 12:i.estimatedPrimaryRange_km=e.double();break;case 13:i.secondaryFuelState=e.double();break;case 14:i.secondaryFuelStateAccuracy=e.double();break;case 15:i.estimatedSecondaryRange_km=e.double();break;case 16:i.maintenanceLightState=e.int32();break;case 17:i.currentGear=e.uint32();break;case 18:i.ignitionState=e.int32();break;case 19:i.engineState=e.int32();break;case 20:i.doorStates&&i.doorStates.length||(i.doorStates=[]),i.doorStates.push(d.sdii.here.pb.VehicleStatus.DoorStateMessage.decode(e,e.uint32()));break;case 21:i.ventilationState=d.sdii.here.pb.VehicleStatus.VentilationStateMessage.decode(e,e.uint32());break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.VehicleStatus)return e;var t=new d.sdii.here.pb.VehicleStatus;switch(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),e.transmissionMode){case"TRANSMISSION_MODE_UNDEFINED":case 0:t.transmissionMode=0;break;case"PARK":case 1:t.transmissionMode=1;break;case"COASTING":case 2:t.transmissionMode=2;break;case"DRIVE":case 3:t.transmissionMode=3;break;case"REVERSE":case 4:t.transmissionMode=4}switch(null!=e.lightStateBitfield&&(u.Long?(t.lightStateBitfield=u.Long.fromValue(e.lightStateBitfield)).unsigned=!1:"string"==typeof e.lightStateBitfield?t.lightStateBitfield=parseInt(e.lightStateBitfield,10):"number"==typeof e.lightStateBitfield?t.lightStateBitfield=e.lightStateBitfield:"object"==typeof e.lightStateBitfield&&(t.lightStateBitfield=new u.LongBits(e.lightStateBitfield.low>>>0,e.lightStateBitfield.high>>>0).toNumber())),e.wiperState){case"WIPER_STATE_UNDEFINED":case 0:t.wiperState=0;break;case"WIPING_OFF":case 1:t.wiperState=1;break;case"WIPING_SLOW":case 2:t.wiperState=2;break;case"WIPING_MEDIUM":case 3:t.wiperState=3;break;case"WIPING_FAST":case 4:t.wiperState=4;break;case"WIPING_INTERVALL":case 5:t.wiperState=5}switch(null!=e.temperatureExternal_cel&&(t.temperatureExternal_cel=Number(e.temperatureExternal_cel)),null!=e.wiperSpeed_wpm&&(t.wiperSpeed_wpm=0|e.wiperSpeed_wpm),null!=e.driveWheelReference&&(u.Long?(t.driveWheelReference=u.Long.fromValue(e.driveWheelReference)).unsigned=!1:"string"==typeof e.driveWheelReference?t.driveWheelReference=parseInt(e.driveWheelReference,10):"number"==typeof e.driveWheelReference?t.driveWheelReference=e.driveWheelReference:"object"==typeof e.driveWheelReference&&(t.driveWheelReference=new u.LongBits(e.driveWheelReference.low>>>0,e.driveWheelReference.high>>>0).toNumber())),null!=e.chassisClearance_m&&(t.chassisClearance_m=Number(e.chassisClearance_m)),null!=e.mileage_km&&(t.mileage_km=Number(e.mileage_km)),null!=e.primaryFuelState&&(t.primaryFuelState=Number(e.primaryFuelState)),null!=e.primaryFuelStateAccuracy&&(t.primaryFuelStateAccuracy=Number(e.primaryFuelStateAccuracy)),null!=e.estimatedPrimaryRange_km&&(t.estimatedPrimaryRange_km=Number(e.estimatedPrimaryRange_km)),null!=e.secondaryFuelState&&(t.secondaryFuelState=Number(e.secondaryFuelState)),null!=e.secondaryFuelStateAccuracy&&(t.secondaryFuelStateAccuracy=Number(e.secondaryFuelStateAccuracy)),null!=e.estimatedSecondaryRange_km&&(t.estimatedSecondaryRange_km=Number(e.estimatedSecondaryRange_km)),e.maintenanceLightState){case"WARNING_ENGINE_CONTROL":case 1:t.maintenanceLightState=1;break;case"WARNING_OIL_PRESSURE":case 2:t.maintenanceLightState=2;break;case"WARNING_COOLANT_TEMP":case 4:t.maintenanceLightState=4;break;case"WARNING_VEHICLE_SERVICE":case 8:t.maintenanceLightState=8;break;case"WARNING_BATTERY_CHARGING":case 16:t.maintenanceLightState=16;break;case"WARNING_TIRE_PRESSURE":case 32:t.maintenanceLightState=32;break;case"WARNING_LAMP_OUT":case 64:t.maintenanceLightState=64;break;case"WARNING_OTHER_HIGH_PRIO":case 128:t.maintenanceLightState=128;break;case"WARNING_OTHER_LOW_PRIO":case 256:t.maintenanceLightState=256}switch(null!=e.currentGear&&(t.currentGear=e.currentGear>>>0),e.ignitionState){case"IGNITION_STATE_UNDEFINED":case 0:t.ignitionState=0;break;case"IGNITION_OFF":case 1:t.ignitionState=1;break;case"IGNITION_ON":case 2:t.ignitionState=2}switch(e.engineState){case"ENGINE_STATE_UNDEFINED":case 0:t.engineState=0;break;case"ENGINE_OFF":case 1:t.engineState=1;break;case"ENGINE_ECO_OFF":case 2:t.engineState=2;break;case"ENGINE_SET":case 3:t.engineState=3;break;case"ENGINE_RUN":case 4:t.engineState=4}if(e.doorStates){if(!Array.isArray(e.doorStates))throw TypeError(".sdii.here.pb.VehicleStatus.doorStates: array expected");t.doorStates=[];for(var r=0;r<e.doorStates.length;++r){if("object"!=typeof e.doorStates[r])throw TypeError(".sdii.here.pb.VehicleStatus.doorStates: object expected");t.doorStates[r]=d.sdii.here.pb.VehicleStatus.DoorStateMessage.fromObject(e.doorStates[r])}}if(null!=e.ventilationState){if("object"!=typeof e.ventilationState)throw TypeError(".sdii.here.pb.VehicleStatus.ventilationState: object expected");t.ventilationState=d.sdii.here.pb.VehicleStatus.VentilationStateMessage.fromObject(e.ventilationState)}if(e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.VehicleStatus.extensionContainer: array expected");for(t.extensionContainer=[],r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.VehicleStatus.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.doorStates=[],r.extensionContainer=[]),t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timeStampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timeStampUTC_ms=t.longs===String?"0":0;r.transmissionMode=t.enums===String?"TRANSMISSION_MODE_UNDEFINED":0,u.Long?(i=new u.Long(0,0,!1),r.lightStateBitfield=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.lightStateBitfield=t.longs===String?"0":0,r.wiperState=t.enums===String?"WIPER_STATE_UNDEFINED":0,r.temperatureExternal_cel=0,r.wiperSpeed_wpm=0,u.Long?(i=new u.Long(0,0,!1),r.driveWheelReference=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.driveWheelReference=t.longs===String?"0":0,r.chassisClearance_m=0,r.mileage_km=0,r.primaryFuelState=0,r.primaryFuelStateAccuracy=0,r.estimatedPrimaryRange_km=0,r.secondaryFuelState=0,r.secondaryFuelStateAccuracy=0,r.estimatedSecondaryRange_km=0,r.maintenanceLightState=t.enums===String?"WARNING_ENGINE_CONTROL":1,r.currentGear=0,r.ignitionState=t.enums===String?"IGNITION_STATE_UNDEFINED":0,r.engineState=t.enums===String?"ENGINE_STATE_UNDEFINED":0,r.ventilationState=null}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?r.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:r.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.transmissionMode&&e.hasOwnProperty("transmissionMode")&&(r.transmissionMode=t.enums===String?d.sdii.here.pb.VehicleStatus.TransmissionModeEnum[e.transmissionMode]:e.transmissionMode),null!=e.lightStateBitfield&&e.hasOwnProperty("lightStateBitfield")&&("number"==typeof e.lightStateBitfield?r.lightStateBitfield=t.longs===String?String(e.lightStateBitfield):e.lightStateBitfield:r.lightStateBitfield=t.longs===String?u.Long.prototype.toString.call(e.lightStateBitfield):t.longs===Number?new u.LongBits(e.lightStateBitfield.low>>>0,e.lightStateBitfield.high>>>0).toNumber():e.lightStateBitfield),null!=e.wiperState&&e.hasOwnProperty("wiperState")&&(r.wiperState=t.enums===String?d.sdii.here.pb.VehicleStatus.WiperStateEnum[e.wiperState]:e.wiperState),null!=e.temperatureExternal_cel&&e.hasOwnProperty("temperatureExternal_cel")&&(r.temperatureExternal_cel=t.json&&!isFinite(e.temperatureExternal_cel)?String(e.temperatureExternal_cel):e.temperatureExternal_cel),null!=e.wiperSpeed_wpm&&e.hasOwnProperty("wiperSpeed_wpm")&&(r.wiperSpeed_wpm=e.wiperSpeed_wpm),null!=e.driveWheelReference&&e.hasOwnProperty("driveWheelReference")&&("number"==typeof e.driveWheelReference?r.driveWheelReference=t.longs===String?String(e.driveWheelReference):e.driveWheelReference:r.driveWheelReference=t.longs===String?u.Long.prototype.toString.call(e.driveWheelReference):t.longs===Number?new u.LongBits(e.driveWheelReference.low>>>0,e.driveWheelReference.high>>>0).toNumber():e.driveWheelReference),null!=e.chassisClearance_m&&e.hasOwnProperty("chassisClearance_m")&&(r.chassisClearance_m=t.json&&!isFinite(e.chassisClearance_m)?String(e.chassisClearance_m):e.chassisClearance_m),null!=e.mileage_km&&e.hasOwnProperty("mileage_km")&&(r.mileage_km=t.json&&!isFinite(e.mileage_km)?String(e.mileage_km):e.mileage_km),null!=e.primaryFuelState&&e.hasOwnProperty("primaryFuelState")&&(r.primaryFuelState=t.json&&!isFinite(e.primaryFuelState)?String(e.primaryFuelState):e.primaryFuelState),null!=e.primaryFuelStateAccuracy&&e.hasOwnProperty("primaryFuelStateAccuracy")&&(r.primaryFuelStateAccuracy=t.json&&!isFinite(e.primaryFuelStateAccuracy)?String(e.primaryFuelStateAccuracy):e.primaryFuelStateAccuracy),null!=e.estimatedPrimaryRange_km&&e.hasOwnProperty("estimatedPrimaryRange_km")&&(r.estimatedPrimaryRange_km=t.json&&!isFinite(e.estimatedPrimaryRange_km)?String(e.estimatedPrimaryRange_km):e.estimatedPrimaryRange_km),null!=e.secondaryFuelState&&e.hasOwnProperty("secondaryFuelState")&&(r.secondaryFuelState=t.json&&!isFinite(e.secondaryFuelState)?String(e.secondaryFuelState):e.secondaryFuelState),null!=e.secondaryFuelStateAccuracy&&e.hasOwnProperty("secondaryFuelStateAccuracy")&&(r.secondaryFuelStateAccuracy=t.json&&!isFinite(e.secondaryFuelStateAccuracy)?String(e.secondaryFuelStateAccuracy):e.secondaryFuelStateAccuracy),null!=e.estimatedSecondaryRange_km&&e.hasOwnProperty("estimatedSecondaryRange_km")&&(r.estimatedSecondaryRange_km=t.json&&!isFinite(e.estimatedSecondaryRange_km)?String(e.estimatedSecondaryRange_km):e.estimatedSecondaryRange_km),null!=e.maintenanceLightState&&e.hasOwnProperty("maintenanceLightState")&&(r.maintenanceLightState=t.enums===String?d.sdii.here.pb.VehicleStatus.MaintenanceLightStateBitfield[e.maintenanceLightState]:e.maintenanceLightState),null!=e.currentGear&&e.hasOwnProperty("currentGear")&&(r.currentGear=e.currentGear),null!=e.ignitionState&&e.hasOwnProperty("ignitionState")&&(r.ignitionState=t.enums===String?d.sdii.here.pb.VehicleStatus.IgnitionStateEnum[e.ignitionState]:e.ignitionState),null!=e.engineState&&e.hasOwnProperty("engineState")&&(r.engineState=t.enums===String?d.sdii.here.pb.VehicleStatus.EngineStateEnum[e.engineState]:e.engineState),e.doorStates&&e.doorStates.length){r.doorStates=[];for(var n=0;n<e.doorStates.length;++n)r.doorStates[n]=d.sdii.here.pb.VehicleStatus.DoorStateMessage.toObject(e.doorStates[n],t)}if(null!=e.ventilationState&&e.hasOwnProperty("ventilationState")&&(r.ventilationState=d.sdii.here.pb.VehicleStatus.VentilationStateMessage.toObject(e.ventilationState,t)),e.extensionContainer&&e.extensionContainer.length)for(r.extensionContainer=[],n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t);return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.TransmissionModeEnum=function(){var e={},t=Object.create(e);return t[e[0]="TRANSMISSION_MODE_UNDEFINED"]=0,t[e[1]="PARK"]=1,t[e[2]="COASTING"]=2,t[e[3]="DRIVE"]=3,t[e[4]="REVERSE"]=4,t}(),e.LightStateBitfield=function(){var e={},t=Object.create(e);return t[e[1]="LOWBEAMS"]=1,t[e[2]="HIGHBEAMS"]=2,t[e[4]="FOGLAMP_FRONT"]=4,t[e[8]="FOGLAMP_REAR"]=8,t[e[16]="HAZARD"]=16,t[e[32]="LEFT_TURN"]=32,t[e[64]="RIGHT_TURN"]=64,t}(),e.WiperStateEnum=function(){var e={},t=Object.create(e);return t[e[0]="WIPER_STATE_UNDEFINED"]=0,t[e[1]="WIPING_OFF"]=1,t[e[2]="WIPING_SLOW"]=2,t[e[3]="WIPING_MEDIUM"]=3,t[e[4]="WIPING_FAST"]=4,t[e[5]="WIPING_INTERVALL"]=5,t}(),e.MaintenanceLightStateBitfield=function(){var e={},t=Object.create(e);return t[e[1]="WARNING_ENGINE_CONTROL"]=1,t[e[2]="WARNING_OIL_PRESSURE"]=2,t[e[4]="WARNING_COOLANT_TEMP"]=4,t[e[8]="WARNING_VEHICLE_SERVICE"]=8,t[e[16]="WARNING_BATTERY_CHARGING"]=16,t[e[32]="WARNING_TIRE_PRESSURE"]=32,t[e[64]="WARNING_LAMP_OUT"]=64,t[e[128]="WARNING_OTHER_HIGH_PRIO"]=128,t[e[256]="WARNING_OTHER_LOW_PRIO"]=256,t}(),e.IgnitionStateEnum=function(){var e={},t=Object.create(e);return t[e[0]="IGNITION_STATE_UNDEFINED"]=0,t[e[1]="IGNITION_OFF"]=1,t[e[2]="IGNITION_ON"]=2,t}(),e.EngineStateEnum=function(){var e={},t=Object.create(e);return t[e[0]="ENGINE_STATE_UNDEFINED"]=0,t[e[1]="ENGINE_OFF"]=1,t[e[2]="ENGINE_ECO_OFF"]=2,t[e[3]="ENGINE_SET"]=3,t[e[4]="ENGINE_RUN"]=4,t}(),e.DoorStateMessage=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.door=0,e.prototype.state=0,e.prototype.lock=0,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.VehicleStatus.DoorStateMessage;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.door=e.int32();break;case 2:i.state=e.int32();break;case 3:i.lock=e.int32();break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("door"))throw u.ProtocolError("missing required 'door'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.VehicleStatus.DoorStateMessage)return e;var t=new d.sdii.here.pb.VehicleStatus.DoorStateMessage;switch(e.door){case"DOOR_IDENTIFICATION_UNDEFINED":case 0:t.door=0;break;case"DOOR_IDENTIFICATION_FRONT_LEFT":case 1:t.door=1;break;case"DOOR_IDENTIFICATION_FRONT_RIGHT":case 2:t.door=2;break;case"DOOR_IDENTIFICATION_REAR_LEFT":case 3:t.door=3;break;case"DOOR_IDENTIFICATION_REAR_RIGHT":case 4:t.door=4;break;case"DOOR_IDENTIFICATION_OTHER_LEFT":case 5:t.door=5;break;case"DOOR_IDENTIFICATION_OTHER_RIGHT":case 6:t.door=6;break;case"DOOR_IDENTIFICATION_TRUNK":case 10:t.door=10;break;case"DOOR_IDENTIFICATION_ENGINE_DOOR":case 20:t.door=20;break;case"DOOR_IDENTIFICATION_FUEL_ENTRY":case 21:t.door=21;break;case"DOOR_IDENTIFICATION_OTHER_MAINTENANCE":case 22:t.door=22}switch(e.state){case"DOOR_STATE_UNDEFINED":case 0:t.state=0;break;case"DOOR_STATE_OPEN":case 1:t.state=1;break;case"DOOR_STATE_CLOSE":case 2:t.state=2}switch(e.lock){case"DOOR_LOCK_STATE_UNDEFINED":case 0:t.lock=0;break;case"DOOR_LOCK_STATE_UNLOCKED":case 1:t.lock=1;break;case"DOOR_LOCK_STATE_LOCKED":case 2:t.lock=2;break;case"DOOR_LOCK_STATE_NO_LOCK":case 3:t.lock=3;break;case"DOOR_LOCK_STATE_AUTO_LOCKED":case 4:t.lock=4}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.door=t.enums===String?"DOOR_IDENTIFICATION_UNDEFINED":0,r.state=t.enums===String?"DOOR_STATE_UNDEFINED":0,r.lock=t.enums===String?"DOOR_LOCK_STATE_UNDEFINED":0),null!=e.door&&e.hasOwnProperty("door")&&(r.door=t.enums===String?d.sdii.here.pb.VehicleStatus.DoorStateMessage.DoorIdentificationEnum[e.door]:e.door),null!=e.state&&e.hasOwnProperty("state")&&(r.state=t.enums===String?d.sdii.here.pb.VehicleStatus.DoorStateMessage.DoorStateEnum[e.state]:e.state),null!=e.lock&&e.hasOwnProperty("lock")&&(r.lock=t.enums===String?d.sdii.here.pb.VehicleStatus.DoorStateMessage.DoorLockStateEnum[e.lock]:e.lock),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.DoorIdentificationEnum=function(){var e={},t=Object.create(e);return t[e[0]="DOOR_IDENTIFICATION_UNDEFINED"]=0,t[e[1]="DOOR_IDENTIFICATION_FRONT_LEFT"]=1,t[e[2]="DOOR_IDENTIFICATION_FRONT_RIGHT"]=2,t[e[3]="DOOR_IDENTIFICATION_REAR_LEFT"]=3,t[e[4]="DOOR_IDENTIFICATION_REAR_RIGHT"]=4,t[e[5]="DOOR_IDENTIFICATION_OTHER_LEFT"]=5,t[e[6]="DOOR_IDENTIFICATION_OTHER_RIGHT"]=6,t[e[10]="DOOR_IDENTIFICATION_TRUNK"]=10,t[e[20]="DOOR_IDENTIFICATION_ENGINE_DOOR"]=20,t[e[21]="DOOR_IDENTIFICATION_FUEL_ENTRY"]=21,t[e[22]="DOOR_IDENTIFICATION_OTHER_MAINTENANCE"]=22,t}(),e.DoorStateEnum=function(){var e={},t=Object.create(e);return t[e[0]="DOOR_STATE_UNDEFINED"]=0,t[e[1]="DOOR_STATE_OPEN"]=1,t[e[2]="DOOR_STATE_CLOSE"]=2,t}(),e.DoorLockStateEnum=function(){var e={},t=Object.create(e);return t[e[0]="DOOR_LOCK_STATE_UNDEFINED"]=0,t[e[1]="DOOR_LOCK_STATE_UNLOCKED"]=1,t[e[2]="DOOR_LOCK_STATE_LOCKED"]=2,t[e[3]="DOOR_LOCK_STATE_NO_LOCK"]=3,t[e[4]="DOOR_LOCK_STATE_AUTO_LOCKED"]=4,t}(),e}(),e.VentilationStateMessage=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.mainVentilationState=0,e.prototype.mainVentilationSetting=0,e.prototype.circulationSetting=0,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.VehicleStatus.VentilationStateMessage;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.mainVentilationState=e.int32();break;case 2:i.mainVentilationSetting=e.int32();break;case 3:i.circulationSetting=e.int32();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.VehicleStatus.VentilationStateMessage)return e;var t=new d.sdii.here.pb.VehicleStatus.VentilationStateMessage;switch(e.mainVentilationState){case"VENTILATION_STATE_UNDEFINED":case 0:t.mainVentilationState=0;break;case"VENTILATION_STATE_ON":case 1:t.mainVentilationState=1;break;case"VENTILATION_STATE_OFF":case 2:t.mainVentilationState=2}switch(e.mainVentilationSetting){case"VENTILATION_SETTING_UNDEFINED":case 0:t.mainVentilationSetting=0;break;case"VENTILATION_SETTING_AUTOMATIC":case 1:t.mainVentilationSetting=1;break;case"VENTILATION_SETTING_MANUAL":case 2:t.mainVentilationSetting=2}switch(e.circulationSetting){case"CIRCULATION_SETTING_UNDEFINED":case 0:t.circulationSetting=0;break;case"CIRCULATION_SETTING_OFF":case 1:t.circulationSetting=1;break;case"CIRCULATION_SETTING_ON":case 2:t.circulationSetting=2}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.mainVentilationState=t.enums===String?"VENTILATION_STATE_UNDEFINED":0,r.mainVentilationSetting=t.enums===String?"VENTILATION_SETTING_UNDEFINED":0,r.circulationSetting=t.enums===String?"CIRCULATION_SETTING_UNDEFINED":0),null!=e.mainVentilationState&&e.hasOwnProperty("mainVentilationState")&&(r.mainVentilationState=t.enums===String?d.sdii.here.pb.VehicleStatus.VentilationStateMessage.VentilationStateEnum[e.mainVentilationState]:e.mainVentilationState),null!=e.mainVentilationSetting&&e.hasOwnProperty("mainVentilationSetting")&&(r.mainVentilationSetting=t.enums===String?d.sdii.here.pb.VehicleStatus.VentilationStateMessage.VentilationSettingEnum[e.mainVentilationSetting]:e.mainVentilationSetting),null!=e.circulationSetting&&e.hasOwnProperty("circulationSetting")&&(r.circulationSetting=t.enums===String?d.sdii.here.pb.VehicleStatus.VentilationStateMessage.CirculationSettingEnum[e.circulationSetting]:e.circulationSetting),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.VentilationStateEnum=function(){var e={},t=Object.create(e);return t[e[0]="VENTILATION_STATE_UNDEFINED"]=0,t[e[1]="VENTILATION_STATE_ON"]=1,t[e[2]="VENTILATION_STATE_OFF"]=2,t}(),e.VentilationSettingEnum=function(){var e={},t=Object.create(e);return t[e[0]="VENTILATION_SETTING_UNDEFINED"]=0,t[e[1]="VENTILATION_SETTING_AUTOMATIC"]=1,t[e[2]="VENTILATION_SETTING_MANUAL"]=2,t}(),e.CirculationSettingEnum=function(){var e={},t=Object.create(e);return t[e[0]="CIRCULATION_SETTING_UNDEFINED"]=0,t[e[1]="CIRCULATION_SETTING_OFF"]=1,t[e[2]="CIRCULATION_SETTING_ON"]=2,t}(),e}(),e}(),o.VehicleDynamics=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.curvature_1pm=0,e.prototype.slope_percent=0,e.prototype.curvatureAccuracy_1pm=0,e.prototype.slopeAccuracy_percent=0,e.prototype.averageSuspensionTravel_mm=0,e.prototype.averageAccelerationVector_mps2=null,e.prototype.averageRotationRateVector_omega=null,e.prototype.averageSuspensionTravelAccuracy_mm=0,e.prototype.bankAngle_percent=0,e.prototype.steeringWheelAngle_deg=0,e.prototype.steeringWheelAngleAccuracy_deg=0,e.prototype.steeringWheelAngleChange_degPerSec=0,e.prototype.steeringWheelAngleChangeAccuracy_degPerSec=0,e.prototype.accelerationPedalPosition_percent=0,e.prototype.brakePedalPosition_percent=0,e.prototype.engineSpeed_rpm=0,e.prototype.engineTorque_nm=0,e.prototype.brakeTorque_nm=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.VehicleDynamics;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.int64();break;case 2:i.curvature_1pm=e.double();break;case 3:i.slope_percent=e.double();break;case 4:i.curvatureAccuracy_1pm=e.double();break;case 5:i.slopeAccuracy_percent=e.double();break;case 6:i.averageSuspensionTravel_mm=e.int32();break;case 7:i.averageAccelerationVector_mps2=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 8:i.averageRotationRateVector_omega=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 9:i.averageSuspensionTravelAccuracy_mm=e.int32();break;case 10:i.bankAngle_percent=e.double();break;case 100:i.steeringWheelAngle_deg=e.int32();break;case 101:i.steeringWheelAngleAccuracy_deg=e.int32();break;case 102:i.steeringWheelAngleChange_degPerSec=e.int32();break;case 103:i.steeringWheelAngleChangeAccuracy_degPerSec=e.int32();break;case 104:i.accelerationPedalPosition_percent=e.int32();break;case 105:i.brakePedalPosition_percent=e.int32();break;case 200:i.engineSpeed_rpm=e.int32();break;case 201:i.engineTorque_nm=e.int32();break;case 202:i.brakeTorque_nm=e.int32();break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.VehicleDynamics)return e;var t=new d.sdii.here.pb.VehicleDynamics;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),null!=e.curvature_1pm&&(t.curvature_1pm=Number(e.curvature_1pm)),null!=e.slope_percent&&(t.slope_percent=Number(e.slope_percent)),null!=e.curvatureAccuracy_1pm&&(t.curvatureAccuracy_1pm=Number(e.curvatureAccuracy_1pm)),null!=e.slopeAccuracy_percent&&(t.slopeAccuracy_percent=Number(e.slopeAccuracy_percent)),null!=e.averageSuspensionTravel_mm&&(t.averageSuspensionTravel_mm=0|e.averageSuspensionTravel_mm),null!=e.averageAccelerationVector_mps2){if("object"!=typeof e.averageAccelerationVector_mps2)throw TypeError(".sdii.here.pb.VehicleDynamics.averageAccelerationVector_mps2: object expected");t.averageAccelerationVector_mps2=d.sdii.here.pb.Vector3D.fromObject(e.averageAccelerationVector_mps2)}if(null!=e.averageRotationRateVector_omega){if("object"!=typeof e.averageRotationRateVector_omega)throw TypeError(".sdii.here.pb.VehicleDynamics.averageRotationRateVector_omega: object expected");t.averageRotationRateVector_omega=d.sdii.here.pb.Vector3D.fromObject(e.averageRotationRateVector_omega)}if(null!=e.averageSuspensionTravelAccuracy_mm&&(t.averageSuspensionTravelAccuracy_mm=0|e.averageSuspensionTravelAccuracy_mm),null!=e.bankAngle_percent&&(t.bankAngle_percent=Number(e.bankAngle_percent)),null!=e.steeringWheelAngle_deg&&(t.steeringWheelAngle_deg=0|e.steeringWheelAngle_deg),null!=e.steeringWheelAngleAccuracy_deg&&(t.steeringWheelAngleAccuracy_deg=0|e.steeringWheelAngleAccuracy_deg),null!=e.steeringWheelAngleChange_degPerSec&&(t.steeringWheelAngleChange_degPerSec=0|e.steeringWheelAngleChange_degPerSec),null!=e.steeringWheelAngleChangeAccuracy_degPerSec&&(t.steeringWheelAngleChangeAccuracy_degPerSec=0|e.steeringWheelAngleChangeAccuracy_degPerSec),null!=e.accelerationPedalPosition_percent&&(t.accelerationPedalPosition_percent=0|e.accelerationPedalPosition_percent),null!=e.brakePedalPosition_percent&&(t.brakePedalPosition_percent=0|e.brakePedalPosition_percent),null!=e.engineSpeed_rpm&&(t.engineSpeed_rpm=0|e.engineSpeed_rpm),null!=e.engineTorque_nm&&(t.engineTorque_nm=0|e.engineTorque_nm),null!=e.brakeTorque_nm&&(t.brakeTorque_nm=0|e.brakeTorque_nm),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.VehicleDynamics.extensionContainer: array expected");t.extensionContainer=[];for(var r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.VehicleDynamics.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.extensionContainer=[]),t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timeStampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timeStampUTC_ms=t.longs===String?"0":0;r.curvature_1pm=0,r.slope_percent=0,r.curvatureAccuracy_1pm=0,r.slopeAccuracy_percent=0,r.averageSuspensionTravel_mm=0,r.averageAccelerationVector_mps2=null,r.averageRotationRateVector_omega=null,r.averageSuspensionTravelAccuracy_mm=0,r.bankAngle_percent=0,r.steeringWheelAngle_deg=0,r.steeringWheelAngleAccuracy_deg=0,r.steeringWheelAngleChange_degPerSec=0,r.steeringWheelAngleChangeAccuracy_degPerSec=0,r.accelerationPedalPosition_percent=0,r.brakePedalPosition_percent=0,r.engineSpeed_rpm=0,r.engineTorque_nm=0,r.brakeTorque_nm=0}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?r.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:r.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.curvature_1pm&&e.hasOwnProperty("curvature_1pm")&&(r.curvature_1pm=t.json&&!isFinite(e.curvature_1pm)?String(e.curvature_1pm):e.curvature_1pm),null!=e.slope_percent&&e.hasOwnProperty("slope_percent")&&(r.slope_percent=t.json&&!isFinite(e.slope_percent)?String(e.slope_percent):e.slope_percent),null!=e.curvatureAccuracy_1pm&&e.hasOwnProperty("curvatureAccuracy_1pm")&&(r.curvatureAccuracy_1pm=t.json&&!isFinite(e.curvatureAccuracy_1pm)?String(e.curvatureAccuracy_1pm):e.curvatureAccuracy_1pm),null!=e.slopeAccuracy_percent&&e.hasOwnProperty("slopeAccuracy_percent")&&(r.slopeAccuracy_percent=t.json&&!isFinite(e.slopeAccuracy_percent)?String(e.slopeAccuracy_percent):e.slopeAccuracy_percent),null!=e.averageSuspensionTravel_mm&&e.hasOwnProperty("averageSuspensionTravel_mm")&&(r.averageSuspensionTravel_mm=e.averageSuspensionTravel_mm),null!=e.averageAccelerationVector_mps2&&e.hasOwnProperty("averageAccelerationVector_mps2")&&(r.averageAccelerationVector_mps2=d.sdii.here.pb.Vector3D.toObject(e.averageAccelerationVector_mps2,t)),null!=e.averageRotationRateVector_omega&&e.hasOwnProperty("averageRotationRateVector_omega")&&(r.averageRotationRateVector_omega=d.sdii.here.pb.Vector3D.toObject(e.averageRotationRateVector_omega,t)),null!=e.averageSuspensionTravelAccuracy_mm&&e.hasOwnProperty("averageSuspensionTravelAccuracy_mm")&&(r.averageSuspensionTravelAccuracy_mm=e.averageSuspensionTravelAccuracy_mm),null!=e.bankAngle_percent&&e.hasOwnProperty("bankAngle_percent")&&(r.bankAngle_percent=t.json&&!isFinite(e.bankAngle_percent)?String(e.bankAngle_percent):e.bankAngle_percent),null!=e.steeringWheelAngle_deg&&e.hasOwnProperty("steeringWheelAngle_deg")&&(r.steeringWheelAngle_deg=e.steeringWheelAngle_deg),null!=e.steeringWheelAngleAccuracy_deg&&e.hasOwnProperty("steeringWheelAngleAccuracy_deg")&&(r.steeringWheelAngleAccuracy_deg=e.steeringWheelAngleAccuracy_deg),null!=e.steeringWheelAngleChange_degPerSec&&e.hasOwnProperty("steeringWheelAngleChange_degPerSec")&&(r.steeringWheelAngleChange_degPerSec=e.steeringWheelAngleChange_degPerSec),null!=e.steeringWheelAngleChangeAccuracy_degPerSec&&e.hasOwnProperty("steeringWheelAngleChangeAccuracy_degPerSec")&&(r.steeringWheelAngleChangeAccuracy_degPerSec=e.steeringWheelAngleChangeAccuracy_degPerSec),null!=e.accelerationPedalPosition_percent&&e.hasOwnProperty("accelerationPedalPosition_percent")&&(r.accelerationPedalPosition_percent=e.accelerationPedalPosition_percent),null!=e.brakePedalPosition_percent&&e.hasOwnProperty("brakePedalPosition_percent")&&(r.brakePedalPosition_percent=e.brakePedalPosition_percent),null!=e.engineSpeed_rpm&&e.hasOwnProperty("engineSpeed_rpm")&&(r.engineSpeed_rpm=e.engineSpeed_rpm),null!=e.engineTorque_nm&&e.hasOwnProperty("engineTorque_nm")&&(r.engineTorque_nm=e.engineTorque_nm),null!=e.brakeTorque_nm&&e.hasOwnProperty("brakeTorque_nm")&&(r.brakeTorque_nm=e.brakeTorque_nm),e.extensionContainer&&e.extensionContainer.length){r.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.PositionOffset=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.lateralOffset_m=0,e.prototype.lateralOffsetSimple=0,e.prototype.longitudinalOffset_m=0,e.prototype.longitudinalOffsetSimple=0,e.prototype.verticalOffset_m=0,e.prototype.verticalOffsetSimple=0,e.prototype.lateralOffsetAccuracy_m=0,e.prototype.longitudinalOffsetAccuracy_m=0,e.prototype.verticalOffsetAccuracy_m=0,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.PositionOffset;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.lateralOffset_m=e.double();break;case 2:i.lateralOffsetSimple=e.int32();break;case 3:i.longitudinalOffset_m=e.double();break;case 4:i.longitudinalOffsetSimple=e.int32();break;case 5:i.verticalOffset_m=e.double();break;case 6:i.verticalOffsetSimple=e.int32();break;case 7:i.lateralOffsetAccuracy_m=e.double();break;case 8:i.longitudinalOffsetAccuracy_m=e.double();break;case 9:i.verticalOffsetAccuracy_m=e.double();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.PositionOffset)return e;var t=new d.sdii.here.pb.PositionOffset;switch(null!=e.lateralOffset_m&&(t.lateralOffset_m=Number(e.lateralOffset_m)),e.lateralOffsetSimple){case"LATERAL_OFFSET_SIMPLE_UNDEFINED":case 0:t.lateralOffsetSimple=0;break;case"LATERAL_OFFSET_SIMPLE_LEFT":case 1:t.lateralOffsetSimple=1;break;case"LATERAL_OFFSET_SIMPLE_MIDDLE":case 2:t.lateralOffsetSimple=2;break;case"LATERAL_OFFSET_SIMPLE_RIGHT":case 3:t.lateralOffsetSimple=3}switch(null!=e.longitudinalOffset_m&&(t.longitudinalOffset_m=Number(e.longitudinalOffset_m)),e.longitudinalOffsetSimple){case"LONGITUDINAL_OFFSET_SIMPLE_UNDEFINED":case 0:t.longitudinalOffsetSimple=0;break;case"LONGITUDINAL_OFFSET_SIMPLE_FRONT":case 1:t.longitudinalOffsetSimple=1;break;case"LONGITUDINAL_OFFSET_SIMPLE_CENTER":case 2:t.longitudinalOffsetSimple=2;break;case"LONGITUDINAL_OFFSET_SIMPLE_BACK":case 3:t.longitudinalOffsetSimple=3}switch(null!=e.verticalOffset_m&&(t.verticalOffset_m=Number(e.verticalOffset_m)),e.verticalOffsetSimple){case"VERTICAL_OFFSET_SIMPLE_UNDEFINED":case 0:t.verticalOffsetSimple=0;break;case"VERTICAL_OFFSET_SIMPLE_ABOVE":case 1:t.verticalOffsetSimple=1;break;case"VERTICAL_OFFSET_SIMPLE_AT_LEVEL":case 2:t.verticalOffsetSimple=2;break;case"VERTICAL_OFFSET_SIMPLE_BELOW":case 3:t.verticalOffsetSimple=3}return null!=e.lateralOffsetAccuracy_m&&(t.lateralOffsetAccuracy_m=Number(e.lateralOffsetAccuracy_m)),null!=e.longitudinalOffsetAccuracy_m&&(t.longitudinalOffsetAccuracy_m=Number(e.longitudinalOffsetAccuracy_m)),null!=e.verticalOffsetAccuracy_m&&(t.verticalOffsetAccuracy_m=Number(e.verticalOffsetAccuracy_m)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.lateralOffset_m=0,r.lateralOffsetSimple=t.enums===String?"LATERAL_OFFSET_SIMPLE_UNDEFINED":0,r.longitudinalOffset_m=0,r.longitudinalOffsetSimple=t.enums===String?"LONGITUDINAL_OFFSET_SIMPLE_UNDEFINED":0,r.verticalOffset_m=0,r.verticalOffsetSimple=t.enums===String?"VERTICAL_OFFSET_SIMPLE_UNDEFINED":0,r.lateralOffsetAccuracy_m=0,r.longitudinalOffsetAccuracy_m=0,r.verticalOffsetAccuracy_m=0),null!=e.lateralOffset_m&&e.hasOwnProperty("lateralOffset_m")&&(r.lateralOffset_m=t.json&&!isFinite(e.lateralOffset_m)?String(e.lateralOffset_m):e.lateralOffset_m),null!=e.lateralOffsetSimple&&e.hasOwnProperty("lateralOffsetSimple")&&(r.lateralOffsetSimple=t.enums===String?d.sdii.here.pb.PositionOffset.LateralOffsetSimpleEnum[e.lateralOffsetSimple]:e.lateralOffsetSimple),null!=e.longitudinalOffset_m&&e.hasOwnProperty("longitudinalOffset_m")&&(r.longitudinalOffset_m=t.json&&!isFinite(e.longitudinalOffset_m)?String(e.longitudinalOffset_m):e.longitudinalOffset_m),null!=e.longitudinalOffsetSimple&&e.hasOwnProperty("longitudinalOffsetSimple")&&(r.longitudinalOffsetSimple=t.enums===String?d.sdii.here.pb.PositionOffset.LongitudinalOffsetSimpleEnum[e.longitudinalOffsetSimple]:e.longitudinalOffsetSimple),null!=e.verticalOffset_m&&e.hasOwnProperty("verticalOffset_m")&&(r.verticalOffset_m=t.json&&!isFinite(e.verticalOffset_m)?String(e.verticalOffset_m):e.verticalOffset_m),null!=e.verticalOffsetSimple&&e.hasOwnProperty("verticalOffsetSimple")&&(r.verticalOffsetSimple=t.enums===String?d.sdii.here.pb.PositionOffset.VerticalOffsetSimpleEnum[e.verticalOffsetSimple]:e.verticalOffsetSimple),null!=e.lateralOffsetAccuracy_m&&e.hasOwnProperty("lateralOffsetAccuracy_m")&&(r.lateralOffsetAccuracy_m=t.json&&!isFinite(e.lateralOffsetAccuracy_m)?String(e.lateralOffsetAccuracy_m):e.lateralOffsetAccuracy_m),null!=e.longitudinalOffsetAccuracy_m&&e.hasOwnProperty("longitudinalOffsetAccuracy_m")&&(r.longitudinalOffsetAccuracy_m=t.json&&!isFinite(e.longitudinalOffsetAccuracy_m)?String(e.longitudinalOffsetAccuracy_m):e.longitudinalOffsetAccuracy_m),null!=e.verticalOffsetAccuracy_m&&e.hasOwnProperty("verticalOffsetAccuracy_m")&&(r.verticalOffsetAccuracy_m=t.json&&!isFinite(e.verticalOffsetAccuracy_m)?String(e.verticalOffsetAccuracy_m):e.verticalOffsetAccuracy_m),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.LateralOffsetSimpleEnum=function(){var e={},t=Object.create(e);return t[e[0]="LATERAL_OFFSET_SIMPLE_UNDEFINED"]=0,t[e[1]="LATERAL_OFFSET_SIMPLE_LEFT"]=1,t[e[2]="LATERAL_OFFSET_SIMPLE_MIDDLE"]=2,t[e[3]="LATERAL_OFFSET_SIMPLE_RIGHT"]=3,t}(),e.LongitudinalOffsetSimpleEnum=function(){var e={},t=Object.create(e);return t[e[0]="LONGITUDINAL_OFFSET_SIMPLE_UNDEFINED"]=0,t[e[1]="LONGITUDINAL_OFFSET_SIMPLE_FRONT"]=1,t[e[2]="LONGITUDINAL_OFFSET_SIMPLE_CENTER"]=2,t[e[3]="LONGITUDINAL_OFFSET_SIMPLE_BACK"]=3,t}(),e.VerticalOffsetSimpleEnum=function(){var e={},t=Object.create(e);return t[e[0]="VERTICAL_OFFSET_SIMPLE_UNDEFINED"]=0,t[e[1]="VERTICAL_OFFSET_SIMPLE_ABOVE"]=1,t[e[2]="VERTICAL_OFFSET_SIMPLE_AT_LEVEL"]=2,t[e[3]="VERTICAL_OFFSET_SIMPLE_BELOW"]=3,t}(),e}(),o.SignRecognition=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.positionOffset=null,e.prototype.roadSignType=0,e.prototype.roadSignPermanency=0,e.prototype.roadSignValue="",e.prototype.roadSignDependencies=0,e.prototype.roadSignValidity=0,e.prototype.roadSignValidityValue=0,e.prototype.roadSignRecognitionType=0,e.prototype.detectedObjectID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.mediaID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.signRecognitionConfidence_percent=0,e.prototype.mapMatchedSignID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.unspecifiedSignType="",e.prototype.size3D=null,e.prototype.signShape=0,e.prototype.rotation=null,e.prototype.roadSignDependencyText="",e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.SignRecognition;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.int64();break;case 2:i.positionOffset=d.sdii.here.pb.PositionOffset.decode(e,e.uint32());break;case 3:i.roadSignType=e.int32();break;case 4:i.roadSignPermanency=e.int32();break;case 5:i.roadSignValue=e.string();break;case 6:i.roadSignDependencies=e.int32();break;case 7:i.roadSignValidity=e.int32();break;case 8:i.roadSignValidityValue=e.double();break;case 9:i.roadSignRecognitionType=e.int32();break;case 10:i.detectedObjectID=e.int64();break;case 11:i.mediaID=e.int64();break;case 12:i.signRecognitionConfidence_percent=e.int32();break;case 13:i.mapMatchedSignID=e.int64();break;case 14:i.unspecifiedSignType=e.string();break;case 15:i.size3D=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 16:i.signShape=e.int32();break;case 17:i.rotation=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 18:i.roadSignDependencyText=e.string();break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});if(!i.hasOwnProperty("roadSignType"))throw u.ProtocolError("missing required 'roadSignType'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.SignRecognition)return e;var t=new d.sdii.here.pb.SignRecognition;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),null!=e.positionOffset){if("object"!=typeof e.positionOffset)throw TypeError(".sdii.here.pb.SignRecognition.positionOffset: object expected");t.positionOffset=d.sdii.here.pb.PositionOffset.fromObject(e.positionOffset)}switch(e.roadSignType){case"ROAD_SIGN_TYPE_UNDEFINED":case 0:t.roadSignType=0;break;case"SPEED_LIMIT_START":case 1:t.roadSignType=1;break;case"SPEED_LIMIT_END":case 2:t.roadSignType=2;break;case"NO_OVERTAKING_PASSENGER_CARS_START":case 3:t.roadSignType=3;break;case"NO_OVERTAKING_PASSENGER_CARS_END":case 4:t.roadSignType=4;break;case"NO_OVERTAKING_TRUCKS_START":case 5:t.roadSignType=5;break;case"NO_OVERTAKING_TRUCKS_END":case 6:t.roadSignType=6;break;case"ALL_RESTRICTIONS_END":case 7:t.roadSignType=7;break;case"CITY_START":case 8:t.roadSignType=8;break;case"CITY_END":case 9:t.roadSignType=9;break;case"MOTORWAY_START":case 10:t.roadSignType=10;break;case"MOTORWAY_END":case 11:t.roadSignType=11;break;case"CONSTRUCTION_START":case 12:t.roadSignType=12;break;case"CONSTRUCTION_END":case 13:t.roadSignType=13;break;case"PROTECTED_OVERTAKING_EXTRALANE":case 14:t.roadSignType=14;break;case"PROTECTED_OVERTAKING_EXTRALANE_RIGHTSIDE":case 15:t.roadSignType=15;break;case"PROTECTED_OVERTAKING_EXTRALANE_LEFTSIDE":case 16:t.roadSignType=16;break;case"LANE_MERGE_RIGHT":case 17:t.roadSignType=17;break;case"LANE_MERGE_LEFT":case 18:t.roadSignType=18;break;case"LANE_MERGE_CENTER":case 19:t.roadSignType=19;break;case"RAILWAY_CROSSING_PROTECTED":case 20:t.roadSignType=20;break;case"RAILWAY_CROSSING_UNPROTECTED":case 21:t.roadSignType=21;break;case"ROAD_NARROWS":case 22:t.roadSignType=22;break;case"SHARP_CURVE":case 23:t.roadSignType=23;break;case"SHARP_CURVE_LEFT":case 24:t.roadSignType=24;break;case"SHARP_CURVE_RIGHT":case 25:t.roadSignType=25;break;case"WINDING_ROAD_STARTING_LEFT":case 26:t.roadSignType=26;break;case"WINDING_ROAD_STARTING_RIGHT":case 27:t.roadSignType=27;break;case"STEEP_HILL":case 28:t.roadSignType=28;break;case"STEEP_HILL_UPWARDS":case 29:t.roadSignType=29;break;case"STEEP_HILL_DOWNWARDS":case 30:t.roadSignType=30;break;case"STOP_SIGN":case 31:t.roadSignType=31;break;case"LATERAL_WIND":case 32:t.roadSignType=32;break;case"GENERAL_WARNING":case 33:t.roadSignType=33;break;case"RISK_OF_GROUNDING":case 34:t.roadSignType=34;break;case"ANIMAL_CROSSING":case 35:t.roadSignType=35;break;case"ICY_CONDITIONS":case 36:t.roadSignType=36;break;case"SLIPPERY_ROAD":case 37:t.roadSignType=37;break;case"FALLING_ROCKS":case 38:t.roadSignType=38;break;case"SCHOOL_ZONE":case 39:t.roadSignType=39;break;case"TRAMWAY_CROSSING":case 40:t.roadSignType=40;break;case"CONGESTION_HAZARD":case 41:t.roadSignType=41;break;case"ACCIDENT_HAZARD":case 42:t.roadSignType=42;break;case"PRIORITY_OVER_ONCOMING_TRAFFIC":case 43:t.roadSignType=43;break;case"YIELD_TO_ONCOMING_TRAFFIC":case 44:t.roadSignType=44;break;case"PREFERENCE_ROAD_START":case 45:t.roadSignType=45;break;case"PREFERENCE_ROAD_END":case 46:t.roadSignType=46;break;case"TRAFFIC_CALMING_START":case 47:t.roadSignType=47;break;case"TRAFFIC_CALMING_END":case 48:t.roadSignType=48;break;case"ENVIRONMENTAL_AREA_START":case 49:t.roadSignType=49;break;case"ENVIRONMENTAL_AREA_END":case 50:t.roadSignType=50;break;case"GIVE_WAY":case 51:t.roadSignType=51;break;case"ROUNDABOUT_INTERSECTION":case 52:t.roadSignType=52;break;case"MANDATORY_TURN_RIGHT_ONLY":case 53:t.roadSignType=53;break;case"MANDATORY_TURN_LEFT_ONLY":case 54:t.roadSignType=54;break;case"MANDATORY_TURN_STRAIGHT_ONLY":case 55:t.roadSignType=55;break;case"NO_ENTRY":case 56:t.roadSignType=56;break;case"ADVISORY_SPEED":case 57:t.roadSignType=57;break;case"HIGH_OCCUPANCY_VEHICLE_LANE":case 58:t.roadSignType=58;break;case"SHOULDER_OPEN_FOR_TRAFFIC":case 59:t.roadSignType=59;break;case"SHOULDER_CLOSE_FOR_TRAFFIC":case 60:t.roadSignType=60;break;case"LANE_CLOSED":case 61:t.roadSignType=61;break;case"PEDESTRIAN_CROSSING":case 62:t.roadSignType=62;break;case"RAILWAY_CROSSING_GENERAL":case 63:t.roadSignType=63}switch(e.roadSignPermanency){case"ROAD_SIGN_PERMANENCY_UNDEFINED":case 0:t.roadSignPermanency=0;break;case"STATIC":case 1:t.roadSignPermanency=1;break;case"VARIABLE":case 2:t.roadSignPermanency=2;break;case"VARIABLE_DEACTIVATED":case 3:t.roadSignPermanency=3}switch(null!=e.roadSignValue&&(t.roadSignValue=String(e.roadSignValue)),e.roadSignDependencies){case"ROAD_SIGN_DEPENDENCY_UNDEFINED":case 0:t.roadSignDependencies=0;break;case"RAIN":case 1:t.roadSignDependencies=1;break;case"SNOW":case 2:t.roadSignDependencies=2;break;case"TIME":case 3:t.roadSignDependencies=3;break;case"SEASON":case 4:t.roadSignDependencies=4;break;case"FOG":case 5:t.roadSignDependencies=5;break;case"SCHOOL":case 6:t.roadSignDependencies=6;break;case"TRUCKS":case 7:t.roadSignDependencies=7;break;case"TRAILER":case 8:t.roadSignDependencies=8;break;case"PASSENGER_CARS_WITH_TRAILER":case 9:t.roadSignDependencies=9;break;case"TRUCKS_WITH_TRAILER":case 10:t.roadSignDependencies=10;break;case"EXCEPT_TRACTOR":case 11:t.roadSignDependencies=11;break;case"BUS":case 12:t.roadSignDependencies=12;break;case"OTHER_DEPENDENCY_AS_TEXT":case 100:t.roadSignDependencies=100}switch(e.roadSignValidity){case"ROAD_SIGN_VALIDITY_UNDEFINED":case 0:t.roadSignValidity=0;break;case"STARTING_IN":case 1:t.roadSignValidity=1;break;case"VALID_FOR":case 2:t.roadSignValidity=2;break;case"IN_RIGHT_DIRECTION":case 3:t.roadSignValidity=3;break;case"IN_LEFT_DIRECTION":case 4:t.roadSignValidity=4;break;case"ZONE":case 5:t.roadSignValidity=5;break;case"BEGIN_OF_VALIDITY":case 6:t.roadSignValidity=6;break;case"END_OF_VALIDITY":case 7:t.roadSignValidity=7}switch(null!=e.roadSignValidityValue&&(t.roadSignValidityValue=Number(e.roadSignValidityValue)),e.roadSignRecognitionType){case"ROAD_SIGN_RECOGNITION_TYPE_UNDEFINED":case 0:t.roadSignRecognitionType=0;break;case"SIGN_DETECTED":case 1:t.roadSignRecognitionType=1;break;case"SIGN_NOT_DETECTED":case 2:t.roadSignRecognitionType=2;break;case"SIGN_TEMPORARY_INVALIDATED":case 3:t.roadSignRecognitionType=3;break;case"SIGN_MISMATCHED":case 4:t.roadSignRecognitionType=4}if(null!=e.detectedObjectID&&(u.Long?(t.detectedObjectID=u.Long.fromValue(e.detectedObjectID)).unsigned=!1:"string"==typeof e.detectedObjectID?t.detectedObjectID=parseInt(e.detectedObjectID,10):"number"==typeof e.detectedObjectID?t.detectedObjectID=e.detectedObjectID:"object"==typeof e.detectedObjectID&&(t.detectedObjectID=new u.LongBits(e.detectedObjectID.low>>>0,e.detectedObjectID.high>>>0).toNumber())),null!=e.mediaID&&(u.Long?(t.mediaID=u.Long.fromValue(e.mediaID)).unsigned=!1:"string"==typeof e.mediaID?t.mediaID=parseInt(e.mediaID,10):"number"==typeof e.mediaID?t.mediaID=e.mediaID:"object"==typeof e.mediaID&&(t.mediaID=new u.LongBits(e.mediaID.low>>>0,e.mediaID.high>>>0).toNumber())),null!=e.signRecognitionConfidence_percent&&(t.signRecognitionConfidence_percent=0|e.signRecognitionConfidence_percent),null!=e.mapMatchedSignID&&(u.Long?(t.mapMatchedSignID=u.Long.fromValue(e.mapMatchedSignID)).unsigned=!1:"string"==typeof e.mapMatchedSignID?t.mapMatchedSignID=parseInt(e.mapMatchedSignID,10):"number"==typeof e.mapMatchedSignID?t.mapMatchedSignID=e.mapMatchedSignID:"object"==typeof e.mapMatchedSignID&&(t.mapMatchedSignID=new u.LongBits(e.mapMatchedSignID.low>>>0,e.mapMatchedSignID.high>>>0).toNumber())),null!=e.unspecifiedSignType&&(t.unspecifiedSignType=String(e.unspecifiedSignType)),null!=e.size3D){if("object"!=typeof e.size3D)throw TypeError(".sdii.here.pb.SignRecognition.size3D: object expected");t.size3D=d.sdii.here.pb.Vector3D.fromObject(e.size3D)}switch(e.signShape){case"ROAD_SIGN_RECOGNITION_SHAPE_UNDEFINED":case 0:t.signShape=0;break;case"RECTANGLE":case 1:t.signShape=1;break;case"SQUARE":case 2:t.signShape=2;break;case"TRIANGLE_UP":case 3:t.signShape=3;break;case"TRIANGLE_DOWN":case 4:t.signShape=4;break;case"DIAMOND":case 5:t.signShape=5;break;case"HEXAGON":case 6:t.signShape=6;break;case"CIRCLE":case 7:t.signShape=7}if(null!=e.rotation){if("object"!=typeof e.rotation)throw TypeError(".sdii.here.pb.SignRecognition.rotation: object expected");t.rotation=d.sdii.here.pb.Vector3D.fromObject(e.rotation)}if(null!=e.roadSignDependencyText&&(t.roadSignDependencyText=String(e.roadSignDependencyText)),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.SignRecognition.extensionContainer: array expected");t.extensionContainer=[];for(var r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.SignRecognition.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.extensionContainer=[]),t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timeStampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timeStampUTC_ms=t.longs===String?"0":0;r.positionOffset=null,r.roadSignType=t.enums===String?"ROAD_SIGN_TYPE_UNDEFINED":0,r.roadSignPermanency=t.enums===String?"ROAD_SIGN_PERMANENCY_UNDEFINED":0,r.roadSignValue="",r.roadSignDependencies=t.enums===String?"ROAD_SIGN_DEPENDENCY_UNDEFINED":0,r.roadSignValidity=t.enums===String?"ROAD_SIGN_VALIDITY_UNDEFINED":0,r.roadSignValidityValue=0,r.roadSignRecognitionType=t.enums===String?"ROAD_SIGN_RECOGNITION_TYPE_UNDEFINED":0,u.Long?(i=new u.Long(0,0,!1),r.detectedObjectID=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.detectedObjectID=t.longs===String?"0":0,u.Long?(i=new u.Long(0,0,!1),r.mediaID=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.mediaID=t.longs===String?"0":0,r.signRecognitionConfidence_percent=0,u.Long?(i=new u.Long(0,0,!1),r.mapMatchedSignID=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.mapMatchedSignID=t.longs===String?"0":0,r.unspecifiedSignType="",r.size3D=null,r.signShape=t.enums===String?"ROAD_SIGN_RECOGNITION_SHAPE_UNDEFINED":0,r.rotation=null,r.roadSignDependencyText=""}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?r.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:r.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.positionOffset&&e.hasOwnProperty("positionOffset")&&(r.positionOffset=d.sdii.here.pb.PositionOffset.toObject(e.positionOffset,t)),null!=e.roadSignType&&e.hasOwnProperty("roadSignType")&&(r.roadSignType=t.enums===String?d.sdii.here.pb.SignRecognition.RoadSignTypeEnum[e.roadSignType]:e.roadSignType),null!=e.roadSignPermanency&&e.hasOwnProperty("roadSignPermanency")&&(r.roadSignPermanency=t.enums===String?d.sdii.here.pb.SignRecognition.RoadSignPermanencyEnum[e.roadSignPermanency]:e.roadSignPermanency),null!=e.roadSignValue&&e.hasOwnProperty("roadSignValue")&&(r.roadSignValue=e.roadSignValue),null!=e.roadSignDependencies&&e.hasOwnProperty("roadSignDependencies")&&(r.roadSignDependencies=t.enums===String?d.sdii.here.pb.SignRecognition.RoadSignDependenciesEnum[e.roadSignDependencies]:e.roadSignDependencies),null!=e.roadSignValidity&&e.hasOwnProperty("roadSignValidity")&&(r.roadSignValidity=t.enums===String?d.sdii.here.pb.SignRecognition.RoadSignValidityEnum[e.roadSignValidity]:e.roadSignValidity),null!=e.roadSignValidityValue&&e.hasOwnProperty("roadSignValidityValue")&&(r.roadSignValidityValue=t.json&&!isFinite(e.roadSignValidityValue)?String(e.roadSignValidityValue):e.roadSignValidityValue),null!=e.roadSignRecognitionType&&e.hasOwnProperty("roadSignRecognitionType")&&(r.roadSignRecognitionType=t.enums===String?d.sdii.here.pb.SignRecognition.RoadSignRecognitionTypeEnum[e.roadSignRecognitionType]:e.roadSignRecognitionType),null!=e.detectedObjectID&&e.hasOwnProperty("detectedObjectID")&&("number"==typeof e.detectedObjectID?r.detectedObjectID=t.longs===String?String(e.detectedObjectID):e.detectedObjectID:r.detectedObjectID=t.longs===String?u.Long.prototype.toString.call(e.detectedObjectID):t.longs===Number?new u.LongBits(e.detectedObjectID.low>>>0,e.detectedObjectID.high>>>0).toNumber():e.detectedObjectID),null!=e.mediaID&&e.hasOwnProperty("mediaID")&&("number"==typeof e.mediaID?r.mediaID=t.longs===String?String(e.mediaID):e.mediaID:r.mediaID=t.longs===String?u.Long.prototype.toString.call(e.mediaID):t.longs===Number?new u.LongBits(e.mediaID.low>>>0,e.mediaID.high>>>0).toNumber():e.mediaID),null!=e.signRecognitionConfidence_percent&&e.hasOwnProperty("signRecognitionConfidence_percent")&&(r.signRecognitionConfidence_percent=e.signRecognitionConfidence_percent),null!=e.mapMatchedSignID&&e.hasOwnProperty("mapMatchedSignID")&&("number"==typeof e.mapMatchedSignID?r.mapMatchedSignID=t.longs===String?String(e.mapMatchedSignID):e.mapMatchedSignID:r.mapMatchedSignID=t.longs===String?u.Long.prototype.toString.call(e.mapMatchedSignID):t.longs===Number?new u.LongBits(e.mapMatchedSignID.low>>>0,e.mapMatchedSignID.high>>>0).toNumber():e.mapMatchedSignID),null!=e.unspecifiedSignType&&e.hasOwnProperty("unspecifiedSignType")&&(r.unspecifiedSignType=e.unspecifiedSignType),null!=e.size3D&&e.hasOwnProperty("size3D")&&(r.size3D=d.sdii.here.pb.Vector3D.toObject(e.size3D,t)),null!=e.signShape&&e.hasOwnProperty("signShape")&&(r.signShape=t.enums===String?d.sdii.here.pb.SignRecognition.RoadSignRecognitionShapeEnum[e.signShape]:e.signShape),null!=e.rotation&&e.hasOwnProperty("rotation")&&(r.rotation=d.sdii.here.pb.Vector3D.toObject(e.rotation,t)),null!=e.roadSignDependencyText&&e.hasOwnProperty("roadSignDependencyText")&&(r.roadSignDependencyText=e.roadSignDependencyText),e.extensionContainer&&e.extensionContainer.length){r.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.RoadSignTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_SIGN_TYPE_UNDEFINED"]=0,t[e[1]="SPEED_LIMIT_START"]=1,t[e[2]="SPEED_LIMIT_END"]=2,t[e[3]="NO_OVERTAKING_PASSENGER_CARS_START"]=3,t[e[4]="NO_OVERTAKING_PASSENGER_CARS_END"]=4,t[e[5]="NO_OVERTAKING_TRUCKS_START"]=5,t[e[6]="NO_OVERTAKING_TRUCKS_END"]=6,t[e[7]="ALL_RESTRICTIONS_END"]=7,t[e[8]="CITY_START"]=8,t[e[9]="CITY_END"]=9,t[e[10]="MOTORWAY_START"]=10,t[e[11]="MOTORWAY_END"]=11,t[e[12]="CONSTRUCTION_START"]=12,t[e[13]="CONSTRUCTION_END"]=13,t[e[14]="PROTECTED_OVERTAKING_EXTRALANE"]=14,t[e[15]="PROTECTED_OVERTAKING_EXTRALANE_RIGHTSIDE"]=15,t[e[16]="PROTECTED_OVERTAKING_EXTRALANE_LEFTSIDE"]=16,t[e[17]="LANE_MERGE_RIGHT"]=17,t[e[18]="LANE_MERGE_LEFT"]=18,t[e[19]="LANE_MERGE_CENTER"]=19,t[e[20]="RAILWAY_CROSSING_PROTECTED"]=20,t[e[21]="RAILWAY_CROSSING_UNPROTECTED"]=21,t[e[22]="ROAD_NARROWS"]=22,t[e[23]="SHARP_CURVE"]=23,t[e[24]="SHARP_CURVE_LEFT"]=24,t[e[25]="SHARP_CURVE_RIGHT"]=25,t[e[26]="WINDING_ROAD_STARTING_LEFT"]=26,t[e[27]="WINDING_ROAD_STARTING_RIGHT"]=27,t[e[28]="STEEP_HILL"]=28,t[e[29]="STEEP_HILL_UPWARDS"]=29,t[e[30]="STEEP_HILL_DOWNWARDS"]=30,t[e[31]="STOP_SIGN"]=31,t[e[32]="LATERAL_WIND"]=32,t[e[33]="GENERAL_WARNING"]=33,t[e[34]="RISK_OF_GROUNDING"]=34,t[e[35]="ANIMAL_CROSSING"]=35,t[e[36]="ICY_CONDITIONS"]=36,t[e[37]="SLIPPERY_ROAD"]=37,t[e[38]="FALLING_ROCKS"]=38,t[e[39]="SCHOOL_ZONE"]=39,t[e[40]="TRAMWAY_CROSSING"]=40,t[e[41]="CONGESTION_HAZARD"]=41,t[e[42]="ACCIDENT_HAZARD"]=42,t[e[43]="PRIORITY_OVER_ONCOMING_TRAFFIC"]=43,t[e[44]="YIELD_TO_ONCOMING_TRAFFIC"]=44,t[e[45]="PREFERENCE_ROAD_START"]=45,t[e[46]="PREFERENCE_ROAD_END"]=46,t[e[47]="TRAFFIC_CALMING_START"]=47,t[e[48]="TRAFFIC_CALMING_END"]=48,t[e[49]="ENVIRONMENTAL_AREA_START"]=49,t[e[50]="ENVIRONMENTAL_AREA_END"]=50,t[e[51]="GIVE_WAY"]=51,t[e[52]="ROUNDABOUT_INTERSECTION"]=52,t[e[53]="MANDATORY_TURN_RIGHT_ONLY"]=53,t[e[54]="MANDATORY_TURN_LEFT_ONLY"]=54,t[e[55]="MANDATORY_TURN_STRAIGHT_ONLY"]=55,t[e[56]="NO_ENTRY"]=56,t[e[57]="ADVISORY_SPEED"]=57,t[e[58]="HIGH_OCCUPANCY_VEHICLE_LANE"]=58,t[e[59]="SHOULDER_OPEN_FOR_TRAFFIC"]=59,t[e[60]="SHOULDER_CLOSE_FOR_TRAFFIC"]=60,t[e[61]="LANE_CLOSED"]=61,t[e[62]="PEDESTRIAN_CROSSING"]=62,t[e[63]="RAILWAY_CROSSING_GENERAL"]=63,t}(),e.RoadSignPermanencyEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_SIGN_PERMANENCY_UNDEFINED"]=0,t[e[1]="STATIC"]=1,t[e[2]="VARIABLE"]=2,t[e[3]="VARIABLE_DEACTIVATED"]=3,t}(),e.RoadSignDependenciesEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_SIGN_DEPENDENCY_UNDEFINED"]=0,t[e[1]="RAIN"]=1,t[e[2]="SNOW"]=2,t[e[3]="TIME"]=3,t[e[4]="SEASON"]=4,t[e[5]="FOG"]=5,t[e[6]="SCHOOL"]=6,t[e[7]="TRUCKS"]=7,t[e[8]="TRAILER"]=8,t[e[9]="PASSENGER_CARS_WITH_TRAILER"]=9,t[e[10]="TRUCKS_WITH_TRAILER"]=10,t[e[11]="EXCEPT_TRACTOR"]=11,t[e[12]="BUS"]=12,t[e[100]="OTHER_DEPENDENCY_AS_TEXT"]=100,t}(),e.RoadSignValidityEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_SIGN_VALIDITY_UNDEFINED"]=0,t[e[1]="STARTING_IN"]=1,t[e[2]="VALID_FOR"]=2,t[e[3]="IN_RIGHT_DIRECTION"]=3,t[e[4]="IN_LEFT_DIRECTION"]=4,t[e[5]="ZONE"]=5,t[e[6]="BEGIN_OF_VALIDITY"]=6,t[e[7]="END_OF_VALIDITY"]=7,t}(),e.RoadSignRecognitionTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_SIGN_RECOGNITION_TYPE_UNDEFINED"]=0,t[e[1]="SIGN_DETECTED"]=1,t[e[2]="SIGN_NOT_DETECTED"]=2,t[e[3]="SIGN_TEMPORARY_INVALIDATED"]=3,t[e[4]="SIGN_MISMATCHED"]=4,t}(),e.RoadSignRecognitionShapeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_SIGN_RECOGNITION_SHAPE_UNDEFINED"]=0,t[e[1]="RECTANGLE"]=1,t[e[2]="SQUARE"]=2,t[e[3]="TRIANGLE_UP"]=3,t[e[4]="TRIANGLE_DOWN"]=4,t[e[5]="DIAMOND"]=5,t[e[6]="HEXAGON"]=6,t[e[7]="CIRCLE"]=7,t}(),e}(),o.LaneBoundaryRecognition=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.positionOffset=null,e.prototype.laneBoundaryType=0,e.prototype.laneBoundaryColor=0,e.prototype.curvature_1pm=0,e.prototype.laneMarkerWidth_mm=0,e.prototype.laneMarkerWidthAccuracy_mm=0,e.prototype.laneDeclination_deg=0,e.prototype.laneDeclinationAccuracy_deg=0,e.prototype.laneBoundaryTypeConfidence_percent=0,e.prototype.mapMatchedLaneID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.laneBoundaryRecognitionType=0,e.prototype.laneBoundaryRecognitionChange=0,e.prototype.detectedObjectID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.verticalCurvature_1pm=0,e.prototype.verticalCurvatureAccuracy_1pm=0,e.prototype.laneBoundaryPositionReference=0,e.prototype.laneBoundaryEgoLaneReference=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.LaneBoundaryRecognition;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.int64();break;case 2:i.positionOffset=d.sdii.here.pb.PositionOffset.decode(e,e.uint32());break;case 3:i.laneBoundaryType=e.int32();break;case 4:i.laneBoundaryColor=e.int32();break;case 5:i.curvature_1pm=e.double();break;case 6:i.laneMarkerWidth_mm=e.int32();break;case 7:i.laneMarkerWidthAccuracy_mm=e.int32();break;case 8:i.laneDeclination_deg=e.double();break;case 9:i.laneDeclinationAccuracy_deg=e.double();break;case 10:i.laneBoundaryTypeConfidence_percent=e.int32();break;case 11:i.mapMatchedLaneID=e.int64();break;case 12:i.laneBoundaryRecognitionType=e.int32();break;case 13:i.laneBoundaryRecognitionChange=e.int32();break;case 14:i.detectedObjectID=e.int64();break;case 15:i.verticalCurvature_1pm=e.double();break;case 16:i.verticalCurvatureAccuracy_1pm=e.double();break;case 17:i.laneBoundaryPositionReference=e.int32();break;case 18:i.laneBoundaryEgoLaneReference=e.int32();break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});if(!i.hasOwnProperty("positionOffset"))throw u.ProtocolError("missing required 'positionOffset'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.LaneBoundaryRecognition)return e;var t=new d.sdii.here.pb.LaneBoundaryRecognition;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),null!=e.positionOffset){if("object"!=typeof e.positionOffset)throw TypeError(".sdii.here.pb.LaneBoundaryRecognition.positionOffset: object expected");t.positionOffset=d.sdii.here.pb.PositionOffset.fromObject(e.positionOffset)}switch(e.laneBoundaryType){case"LANE_BOUNDARY_TYPE_UNDEFINED":case 0:t.laneBoundaryType=0;break;case"SINGLE_SOLID_PAINT":case 1:t.laneBoundaryType=1;break;case"DOUBLE_SOLID_PAINT":case 2:t.laneBoundaryType=2;break;case"LONG_DASHED_PAINT":case 3:t.laneBoundaryType=3;break;case"SHORT_DASHED_PAINT":case 4:t.laneBoundaryType=4;break;case"SHADED_AREA_PAINT":case 5:t.laneBoundaryType=5;break;case"DASHED_BLOCKS":case 6:t.laneBoundaryType=6;break;case"DOUBLE_LINE_DASHED_SOLID_PAINT":case 7:t.laneBoundaryType=7;break;case"DOUBLE_LINE_SOLID_DASHED_PAINT":case 8:t.laneBoundaryType=8;break;case"PHYSICAL_DIVIDER":case 9:t.laneBoundaryType=9;break;case"DOUBLE_DASHED_LINES":case 10:t.laneBoundaryType=10}switch(e.laneBoundaryColor){case"LANE_BOUNDARY_COLOR_UNDEFINED":case 0:t.laneBoundaryColor=0;break;case"WHITE":case 1:t.laneBoundaryColor=1;break;case"YELLOW":case 2:t.laneBoundaryColor=2;break;case"BLUE":case 3:t.laneBoundaryColor=3;break;case"RED":case 4:t.laneBoundaryColor=4}switch(null!=e.curvature_1pm&&(t.curvature_1pm=Number(e.curvature_1pm)),null!=e.laneMarkerWidth_mm&&(t.laneMarkerWidth_mm=0|e.laneMarkerWidth_mm),null!=e.laneMarkerWidthAccuracy_mm&&(t.laneMarkerWidthAccuracy_mm=0|e.laneMarkerWidthAccuracy_mm),null!=e.laneDeclination_deg&&(t.laneDeclination_deg=Number(e.laneDeclination_deg)),null!=e.laneDeclinationAccuracy_deg&&(t.laneDeclinationAccuracy_deg=Number(e.laneDeclinationAccuracy_deg)),null!=e.laneBoundaryTypeConfidence_percent&&(t.laneBoundaryTypeConfidence_percent=0|e.laneBoundaryTypeConfidence_percent),null!=e.mapMatchedLaneID&&(u.Long?(t.mapMatchedLaneID=u.Long.fromValue(e.mapMatchedLaneID)).unsigned=!1:"string"==typeof e.mapMatchedLaneID?t.mapMatchedLaneID=parseInt(e.mapMatchedLaneID,10):"number"==typeof e.mapMatchedLaneID?t.mapMatchedLaneID=e.mapMatchedLaneID:"object"==typeof e.mapMatchedLaneID&&(t.mapMatchedLaneID=new u.LongBits(e.mapMatchedLaneID.low>>>0,e.mapMatchedLaneID.high>>>0).toNumber())),e.laneBoundaryRecognitionType){case"LANE_BOUNDARY_RECOGNITION_TYPE_UNDEFINED":case 0:t.laneBoundaryRecognitionType=0;break;case"LANE_DETECTED":case 1:t.laneBoundaryRecognitionType=1;break;case"LANE_NOT_DETECTED":case 2:t.laneBoundaryRecognitionType=2}switch(e.laneBoundaryRecognitionChange){case"LANE_BOUNDARY_RECOGNITION_CHANGE_UNDEFINED":case 0:t.laneBoundaryRecognitionChange=0;break;case"LANE_BOUNDARY_START":case 1:t.laneBoundaryRecognitionChange=1;break;case"LANE_BOUNDARY_END":case 2:t.laneBoundaryRecognitionChange=2}switch(null!=e.detectedObjectID&&(u.Long?(t.detectedObjectID=u.Long.fromValue(e.detectedObjectID)).unsigned=!1:"string"==typeof e.detectedObjectID?t.detectedObjectID=parseInt(e.detectedObjectID,10):"number"==typeof e.detectedObjectID?t.detectedObjectID=e.detectedObjectID:"object"==typeof e.detectedObjectID&&(t.detectedObjectID=new u.LongBits(e.detectedObjectID.low>>>0,e.detectedObjectID.high>>>0).toNumber())),null!=e.verticalCurvature_1pm&&(t.verticalCurvature_1pm=Number(e.verticalCurvature_1pm)),null!=e.verticalCurvatureAccuracy_1pm&&(t.verticalCurvatureAccuracy_1pm=Number(e.verticalCurvatureAccuracy_1pm)),e.laneBoundaryPositionReference){case"LANE_BOUNDARY_POSITION_REFERENCE_UNDEFINED":case 0:t.laneBoundaryPositionReference=0;break;case"LANE_BOUNDARY_POSITION_REFERENCE_INNER":case 1:t.laneBoundaryPositionReference=1;break;case"LANE_BOUNDARY_POSITION_REFERENCE_MIDDLE":case 2:t.laneBoundaryPositionReference=2;break;case"LANE_BOUNDARY_POSITION_REFERENCE_OUTER":case 3:t.laneBoundaryPositionReference=3}switch(e.laneBoundaryEgoLaneReference){case"LANE_BOUNDARY_EGO_LANE_REFERENCE_UNDEFINED":case 0:t.laneBoundaryEgoLaneReference=0;break;case"LANE_BOUNDARY_EGO_LANE_REFERENCE_TRUE":case 1:t.laneBoundaryEgoLaneReference=1;break;case"LANE_BOUNDARY_EGO_LANE_REFERENCE_TRUE_LEFT":case 2:t.laneBoundaryEgoLaneReference=2;break;case"LANE_BOUNDARY_EGO_LANE_REFERENCE_TRUE_RIGHT":case 3:t.laneBoundaryEgoLaneReference=3;break;case"LANE_BOUNDARY_EGO_LANE_REFERENCE_FALSE":case 4:t.laneBoundaryEgoLaneReference=4}if(e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.LaneBoundaryRecognition.extensionContainer: array expected");t.extensionContainer=[];for(var r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.LaneBoundaryRecognition.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.extensionContainer=[]),t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timeStampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timeStampUTC_ms=t.longs===String?"0":0;r.positionOffset=null,r.laneBoundaryType=t.enums===String?"LANE_BOUNDARY_TYPE_UNDEFINED":0,r.laneBoundaryColor=t.enums===String?"LANE_BOUNDARY_COLOR_UNDEFINED":0,r.curvature_1pm=0,r.laneMarkerWidth_mm=0,r.laneMarkerWidthAccuracy_mm=0,r.laneDeclination_deg=0,r.laneDeclinationAccuracy_deg=0,r.laneBoundaryTypeConfidence_percent=0,u.Long?(i=new u.Long(0,0,!1),r.mapMatchedLaneID=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.mapMatchedLaneID=t.longs===String?"0":0,r.laneBoundaryRecognitionType=t.enums===String?"LANE_BOUNDARY_RECOGNITION_TYPE_UNDEFINED":0,r.laneBoundaryRecognitionChange=t.enums===String?"LANE_BOUNDARY_RECOGNITION_CHANGE_UNDEFINED":0,u.Long?(i=new u.Long(0,0,!1),r.detectedObjectID=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.detectedObjectID=t.longs===String?"0":0,r.verticalCurvature_1pm=0,r.verticalCurvatureAccuracy_1pm=0,r.laneBoundaryPositionReference=t.enums===String?"LANE_BOUNDARY_POSITION_REFERENCE_UNDEFINED":0,r.laneBoundaryEgoLaneReference=t.enums===String?"LANE_BOUNDARY_EGO_LANE_REFERENCE_UNDEFINED":0}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?r.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:r.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.positionOffset&&e.hasOwnProperty("positionOffset")&&(r.positionOffset=d.sdii.here.pb.PositionOffset.toObject(e.positionOffset,t)),null!=e.laneBoundaryType&&e.hasOwnProperty("laneBoundaryType")&&(r.laneBoundaryType=t.enums===String?d.sdii.here.pb.LaneBoundaryRecognition.LaneBoundaryTypeEnum[e.laneBoundaryType]:e.laneBoundaryType),null!=e.laneBoundaryColor&&e.hasOwnProperty("laneBoundaryColor")&&(r.laneBoundaryColor=t.enums===String?d.sdii.here.pb.LaneBoundaryRecognition.LaneBoundaryColorEnum[e.laneBoundaryColor]:e.laneBoundaryColor),null!=e.curvature_1pm&&e.hasOwnProperty("curvature_1pm")&&(r.curvature_1pm=t.json&&!isFinite(e.curvature_1pm)?String(e.curvature_1pm):e.curvature_1pm),null!=e.laneMarkerWidth_mm&&e.hasOwnProperty("laneMarkerWidth_mm")&&(r.laneMarkerWidth_mm=e.laneMarkerWidth_mm),null!=e.laneMarkerWidthAccuracy_mm&&e.hasOwnProperty("laneMarkerWidthAccuracy_mm")&&(r.laneMarkerWidthAccuracy_mm=e.laneMarkerWidthAccuracy_mm),null!=e.laneDeclination_deg&&e.hasOwnProperty("laneDeclination_deg")&&(r.laneDeclination_deg=t.json&&!isFinite(e.laneDeclination_deg)?String(e.laneDeclination_deg):e.laneDeclination_deg),null!=e.laneDeclinationAccuracy_deg&&e.hasOwnProperty("laneDeclinationAccuracy_deg")&&(r.laneDeclinationAccuracy_deg=t.json&&!isFinite(e.laneDeclinationAccuracy_deg)?String(e.laneDeclinationAccuracy_deg):e.laneDeclinationAccuracy_deg),null!=e.laneBoundaryTypeConfidence_percent&&e.hasOwnProperty("laneBoundaryTypeConfidence_percent")&&(r.laneBoundaryTypeConfidence_percent=e.laneBoundaryTypeConfidence_percent),null!=e.mapMatchedLaneID&&e.hasOwnProperty("mapMatchedLaneID")&&("number"==typeof e.mapMatchedLaneID?r.mapMatchedLaneID=t.longs===String?String(e.mapMatchedLaneID):e.mapMatchedLaneID:r.mapMatchedLaneID=t.longs===String?u.Long.prototype.toString.call(e.mapMatchedLaneID):t.longs===Number?new u.LongBits(e.mapMatchedLaneID.low>>>0,e.mapMatchedLaneID.high>>>0).toNumber():e.mapMatchedLaneID),null!=e.laneBoundaryRecognitionType&&e.hasOwnProperty("laneBoundaryRecognitionType")&&(r.laneBoundaryRecognitionType=t.enums===String?d.sdii.here.pb.LaneBoundaryRecognition.LaneBoundaryRecognitionTypeEnum[e.laneBoundaryRecognitionType]:e.laneBoundaryRecognitionType),null!=e.laneBoundaryRecognitionChange&&e.hasOwnProperty("laneBoundaryRecognitionChange")&&(r.laneBoundaryRecognitionChange=t.enums===String?d.sdii.here.pb.LaneBoundaryRecognition.LaneBoundaryRecognitionChangeEnum[e.laneBoundaryRecognitionChange]:e.laneBoundaryRecognitionChange),null!=e.detectedObjectID&&e.hasOwnProperty("detectedObjectID")&&("number"==typeof e.detectedObjectID?r.detectedObjectID=t.longs===String?String(e.detectedObjectID):e.detectedObjectID:r.detectedObjectID=t.longs===String?u.Long.prototype.toString.call(e.detectedObjectID):t.longs===Number?new u.LongBits(e.detectedObjectID.low>>>0,e.detectedObjectID.high>>>0).toNumber():e.detectedObjectID),null!=e.verticalCurvature_1pm&&e.hasOwnProperty("verticalCurvature_1pm")&&(r.verticalCurvature_1pm=t.json&&!isFinite(e.verticalCurvature_1pm)?String(e.verticalCurvature_1pm):e.verticalCurvature_1pm),null!=e.verticalCurvatureAccuracy_1pm&&e.hasOwnProperty("verticalCurvatureAccuracy_1pm")&&(r.verticalCurvatureAccuracy_1pm=t.json&&!isFinite(e.verticalCurvatureAccuracy_1pm)?String(e.verticalCurvatureAccuracy_1pm):e.verticalCurvatureAccuracy_1pm),null!=e.laneBoundaryPositionReference&&e.hasOwnProperty("laneBoundaryPositionReference")&&(r.laneBoundaryPositionReference=t.enums===String?d.sdii.here.pb.LaneBoundaryRecognition.LaneBoundaryPositionReferenceEnum[e.laneBoundaryPositionReference]:e.laneBoundaryPositionReference),null!=e.laneBoundaryEgoLaneReference&&e.hasOwnProperty("laneBoundaryEgoLaneReference")&&(r.laneBoundaryEgoLaneReference=t.enums===String?d.sdii.here.pb.LaneBoundaryRecognition.LaneBoundaryEgoLaneReferenceEnum[e.laneBoundaryEgoLaneReference]:e.laneBoundaryEgoLaneReference),e.extensionContainer&&e.extensionContainer.length){r.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.LaneBoundaryTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="LANE_BOUNDARY_TYPE_UNDEFINED"]=0,t[e[1]="SINGLE_SOLID_PAINT"]=1,t[e[2]="DOUBLE_SOLID_PAINT"]=2,t[e[3]="LONG_DASHED_PAINT"]=3,t[e[4]="SHORT_DASHED_PAINT"]=4,t[e[5]="SHADED_AREA_PAINT"]=5,t[e[6]="DASHED_BLOCKS"]=6,t[e[7]="DOUBLE_LINE_DASHED_SOLID_PAINT"]=7,t[e[8]="DOUBLE_LINE_SOLID_DASHED_PAINT"]=8,t[e[9]="PHYSICAL_DIVIDER"]=9,t[e[10]="DOUBLE_DASHED_LINES"]=10,t}(),e.LaneBoundaryColorEnum=function(){var e={},t=Object.create(e);return t[e[0]="LANE_BOUNDARY_COLOR_UNDEFINED"]=0,t[e[1]="WHITE"]=1,t[e[2]="YELLOW"]=2,t[e[3]="BLUE"]=3,t[e[4]="RED"]=4,t}(),e.LaneBoundaryRecognitionTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="LANE_BOUNDARY_RECOGNITION_TYPE_UNDEFINED"]=0,t[e[1]="LANE_DETECTED"]=1,t[e[2]="LANE_NOT_DETECTED"]=2,t}(),e.LaneBoundaryRecognitionChangeEnum=function(){var e={},t=Object.create(e);return t[e[0]="LANE_BOUNDARY_RECOGNITION_CHANGE_UNDEFINED"]=0,t[e[1]="LANE_BOUNDARY_START"]=1,t[e[2]="LANE_BOUNDARY_END"]=2,t}(),e.LaneBoundaryPositionReferenceEnum=function(){var e={},t=Object.create(e);return t[e[0]="LANE_BOUNDARY_POSITION_REFERENCE_UNDEFINED"]=0,t[e[1]="LANE_BOUNDARY_POSITION_REFERENCE_INNER"]=1,t[e[2]="LANE_BOUNDARY_POSITION_REFERENCE_MIDDLE"]=2,t[e[3]="LANE_BOUNDARY_POSITION_REFERENCE_OUTER"]=3,t}(),e.LaneBoundaryEgoLaneReferenceEnum=function(){var e={},t=Object.create(e);return t[e[0]="LANE_BOUNDARY_EGO_LANE_REFERENCE_UNDEFINED"]=0,t[e[1]="LANE_BOUNDARY_EGO_LANE_REFERENCE_TRUE"]=1,t[e[2]="LANE_BOUNDARY_EGO_LANE_REFERENCE_TRUE_LEFT"]=2,t[e[3]="LANE_BOUNDARY_EGO_LANE_REFERENCE_TRUE_RIGHT"]=3,t[e[4]="LANE_BOUNDARY_EGO_LANE_REFERENCE_FALSE"]=4,t}(),e}(),o.TireSlippageEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.TireSlippageEvent;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){return e instanceof d.sdii.here.pb.TireSlippageEvent?e:new d.sdii.here.pb.TireSlippageEvent},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.CrashDetectedEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.vehicleIsDrivable=!1,e.prototype.airbagsDeployed=!1,e.prototype.eCallActivated=!1,e.prototype.vehicleIsObstacleOnRoad=!1,e.prototype.maxAccelerationVector_mps2=null,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.CrashDetectedEvent;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.vehicleIsDrivable=e.bool();break;case 2:i.airbagsDeployed=e.bool();break;case 3:i.eCallActivated=e.bool();break;case 4:i.vehicleIsObstacleOnRoad=e.bool();break;case 5:i.maxAccelerationVector_mps2=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.CrashDetectedEvent)return e;var t=new d.sdii.here.pb.CrashDetectedEvent;if(null!=e.vehicleIsDrivable&&(t.vehicleIsDrivable=Boolean(e.vehicleIsDrivable)),null!=e.airbagsDeployed&&(t.airbagsDeployed=Boolean(e.airbagsDeployed)),null!=e.eCallActivated&&(t.eCallActivated=Boolean(e.eCallActivated)),null!=e.vehicleIsObstacleOnRoad&&(t.vehicleIsObstacleOnRoad=Boolean(e.vehicleIsObstacleOnRoad)),null!=e.maxAccelerationVector_mps2){if("object"!=typeof e.maxAccelerationVector_mps2)throw TypeError(".sdii.here.pb.CrashDetectedEvent.maxAccelerationVector_mps2: object expected");t.maxAccelerationVector_mps2=d.sdii.here.pb.Vector3D.fromObject(e.maxAccelerationVector_mps2)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.vehicleIsDrivable=!1,r.airbagsDeployed=!1,r.eCallActivated=!1,r.vehicleIsObstacleOnRoad=!1,r.maxAccelerationVector_mps2=null),null!=e.vehicleIsDrivable&&e.hasOwnProperty("vehicleIsDrivable")&&(r.vehicleIsDrivable=e.vehicleIsDrivable),null!=e.airbagsDeployed&&e.hasOwnProperty("airbagsDeployed")&&(r.airbagsDeployed=e.airbagsDeployed),null!=e.eCallActivated&&e.hasOwnProperty("eCallActivated")&&(r.eCallActivated=e.eCallActivated),null!=e.vehicleIsObstacleOnRoad&&e.hasOwnProperty("vehicleIsObstacleOnRoad")&&(r.vehicleIsObstacleOnRoad=e.vehicleIsObstacleOnRoad),null!=e.maxAccelerationVector_mps2&&e.hasOwnProperty("maxAccelerationVector_mps2")&&(r.maxAccelerationVector_mps2=d.sdii.here.pb.Vector3D.toObject(e.maxAccelerationVector_mps2,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.EmergencyBrakingEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.maxAccelerationVector_mps2=null,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.EmergencyBrakingEvent;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.maxAccelerationVector_mps2=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.EmergencyBrakingEvent)return e;var t=new d.sdii.here.pb.EmergencyBrakingEvent;if(null!=e.maxAccelerationVector_mps2){if("object"!=typeof e.maxAccelerationVector_mps2)throw TypeError(".sdii.here.pb.EmergencyBrakingEvent.maxAccelerationVector_mps2: object expected");t.maxAccelerationVector_mps2=d.sdii.here.pb.Vector3D.fromObject(e.maxAccelerationVector_mps2)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.maxAccelerationVector_mps2=null),null!=e.maxAccelerationVector_mps2&&e.hasOwnProperty("maxAccelerationVector_mps2")&&(r.maxAccelerationVector_mps2=d.sdii.here.pb.Vector3D.toObject(e.maxAccelerationVector_mps2,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.DynamicStabilityControlEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.DynamicStabilityControlEvent;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){return e instanceof d.sdii.here.pb.DynamicStabilityControlEvent?e:new d.sdii.here.pb.DynamicStabilityControlEvent},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.AntiLockBrakingSystemEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.AntiLockBrakingSystemEvent;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){return e instanceof d.sdii.here.pb.AntiLockBrakingSystemEvent?e:new d.sdii.here.pb.AntiLockBrakingSystemEvent},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.ElectronicStabilityControlEvent=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.antiSlipActionEvent=!1,e.prototype.antiLockActionEvent=!1,e.prototype.electronicStabilityControlEvent=!1,e.prototype.requestedAccelerationVector_mps2=null,e.prototype.requestedRotationRateVector_omega=null,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.ElectronicStabilityControlEvent;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.antiSlipActionEvent=e.bool();break;case 2:i.antiLockActionEvent=e.bool();break;case 3:i.electronicStabilityControlEvent=e.bool();break;case 4:i.requestedAccelerationVector_mps2=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 5:i.requestedRotationRateVector_omega=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.ElectronicStabilityControlEvent)return e;var t=new d.sdii.here.pb.ElectronicStabilityControlEvent;if(null!=e.antiSlipActionEvent&&(t.antiSlipActionEvent=Boolean(e.antiSlipActionEvent)),null!=e.antiLockActionEvent&&(t.antiLockActionEvent=Boolean(e.antiLockActionEvent)),null!=e.electronicStabilityControlEvent&&(t.electronicStabilityControlEvent=Boolean(e.electronicStabilityControlEvent)),null!=e.requestedAccelerationVector_mps2){if("object"!=typeof e.requestedAccelerationVector_mps2)throw TypeError(".sdii.here.pb.ElectronicStabilityControlEvent.requestedAccelerationVector_mps2: object expected");t.requestedAccelerationVector_mps2=d.sdii.here.pb.Vector3D.fromObject(e.requestedAccelerationVector_mps2)}if(null!=e.requestedRotationRateVector_omega){if("object"!=typeof e.requestedRotationRateVector_omega)throw TypeError(".sdii.here.pb.ElectronicStabilityControlEvent.requestedRotationRateVector_omega: object expected");t.requestedRotationRateVector_omega=d.sdii.here.pb.Vector3D.fromObject(e.requestedRotationRateVector_omega)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.antiSlipActionEvent=!1,r.antiLockActionEvent=!1,r.electronicStabilityControlEvent=!1,r.requestedAccelerationVector_mps2=null,r.requestedRotationRateVector_omega=null),null!=e.antiSlipActionEvent&&e.hasOwnProperty("antiSlipActionEvent")&&(r.antiSlipActionEvent=e.antiSlipActionEvent),null!=e.antiLockActionEvent&&e.hasOwnProperty("antiLockActionEvent")&&(r.antiLockActionEvent=e.antiLockActionEvent),null!=e.electronicStabilityControlEvent&&e.hasOwnProperty("electronicStabilityControlEvent")&&(r.electronicStabilityControlEvent=e.electronicStabilityControlEvent),null!=e.requestedAccelerationVector_mps2&&e.hasOwnProperty("requestedAccelerationVector_mps2")&&(r.requestedAccelerationVector_mps2=d.sdii.here.pb.Vector3D.toObject(e.requestedAccelerationVector_mps2,t)),null!=e.requestedRotationRateVector_omega&&e.hasOwnProperty("requestedRotationRateVector_omega")&&(r.requestedRotationRateVector_omega=d.sdii.here.pb.Vector3D.toObject(e.requestedRotationRateVector_omega,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.ExceptionalVehicleState=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.tireSlippage=null,e.prototype.crashDetected=null,e.prototype.emergencyBraking=null,e.prototype.dynamicStabilityControl=null,e.prototype.antiLockBrakingSystem=null,e.prototype.electronicStabilityControl=null,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.ExceptionalVehicleState;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.int64();break;case 2:i.tireSlippage=d.sdii.here.pb.TireSlippageEvent.decode(e,e.uint32());break;case 3:i.crashDetected=d.sdii.here.pb.CrashDetectedEvent.decode(e,e.uint32());break;case 4:i.emergencyBraking=d.sdii.here.pb.EmergencyBrakingEvent.decode(e,e.uint32());break;case 5:i.dynamicStabilityControl=d.sdii.here.pb.DynamicStabilityControlEvent.decode(e,e.uint32());break;case 6:i.antiLockBrakingSystem=d.sdii.here.pb.AntiLockBrakingSystemEvent.decode(e,e.uint32());break;case 7:i.electronicStabilityControl=d.sdii.here.pb.ElectronicStabilityControlEvent.decode(e,e.uint32());break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.ExceptionalVehicleState)return e;var t=new d.sdii.here.pb.ExceptionalVehicleState;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),null!=e.tireSlippage){if("object"!=typeof e.tireSlippage)throw TypeError(".sdii.here.pb.ExceptionalVehicleState.tireSlippage: object expected");t.tireSlippage=d.sdii.here.pb.TireSlippageEvent.fromObject(e.tireSlippage)}if(null!=e.crashDetected){if("object"!=typeof e.crashDetected)throw TypeError(".sdii.here.pb.ExceptionalVehicleState.crashDetected: object expected");t.crashDetected=d.sdii.here.pb.CrashDetectedEvent.fromObject(e.crashDetected)}if(null!=e.emergencyBraking){if("object"!=typeof e.emergencyBraking)throw TypeError(".sdii.here.pb.ExceptionalVehicleState.emergencyBraking: object expected");t.emergencyBraking=d.sdii.here.pb.EmergencyBrakingEvent.fromObject(e.emergencyBraking)}if(null!=e.dynamicStabilityControl){if("object"!=typeof e.dynamicStabilityControl)throw TypeError(".sdii.here.pb.ExceptionalVehicleState.dynamicStabilityControl: object expected");t.dynamicStabilityControl=d.sdii.here.pb.DynamicStabilityControlEvent.fromObject(e.dynamicStabilityControl)}if(null!=e.antiLockBrakingSystem){if("object"!=typeof e.antiLockBrakingSystem)throw TypeError(".sdii.here.pb.ExceptionalVehicleState.antiLockBrakingSystem: object expected");t.antiLockBrakingSystem=d.sdii.here.pb.AntiLockBrakingSystemEvent.fromObject(e.antiLockBrakingSystem)}if(null!=e.electronicStabilityControl){if("object"!=typeof e.electronicStabilityControl)throw TypeError(".sdii.here.pb.ExceptionalVehicleState.electronicStabilityControl: object expected");t.electronicStabilityControl=d.sdii.here.pb.ElectronicStabilityControlEvent.fromObject(e.electronicStabilityControl)}if(e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.ExceptionalVehicleState.extensionContainer: array expected");t.extensionContainer=[];for(var r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.ExceptionalVehicleState.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.extensionContainer=[]),t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timeStampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timeStampUTC_ms=t.longs===String?"0":0;r.tireSlippage=null,r.crashDetected=null,r.emergencyBraking=null,r.dynamicStabilityControl=null,r.antiLockBrakingSystem=null,r.electronicStabilityControl=null}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?r.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:r.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.tireSlippage&&e.hasOwnProperty("tireSlippage")&&(r.tireSlippage=d.sdii.here.pb.TireSlippageEvent.toObject(e.tireSlippage,t)),null!=e.crashDetected&&e.hasOwnProperty("crashDetected")&&(r.crashDetected=d.sdii.here.pb.CrashDetectedEvent.toObject(e.crashDetected,t)),null!=e.emergencyBraking&&e.hasOwnProperty("emergencyBraking")&&(r.emergencyBraking=d.sdii.here.pb.EmergencyBrakingEvent.toObject(e.emergencyBraking,t)),null!=e.dynamicStabilityControl&&e.hasOwnProperty("dynamicStabilityControl")&&(r.dynamicStabilityControl=d.sdii.here.pb.DynamicStabilityControlEvent.toObject(e.dynamicStabilityControl,t)),null!=e.antiLockBrakingSystem&&e.hasOwnProperty("antiLockBrakingSystem")&&(r.antiLockBrakingSystem=d.sdii.here.pb.AntiLockBrakingSystemEvent.toObject(e.antiLockBrakingSystem,t)),null!=e.electronicStabilityControl&&e.hasOwnProperty("electronicStabilityControl")&&(r.electronicStabilityControl=d.sdii.here.pb.ElectronicStabilityControlEvent.toObject(e.electronicStabilityControl,t)),e.extensionContainer&&e.extensionContainer.length){r.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.ProprietaryInfo=function(){function e(e){if(this.keyValuePairs=[],this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.keyValuePairs=u.emptyArray,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.ProprietaryInfo;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.int64();break;case 2:i.keyValuePairs&&i.keyValuePairs.length||(i.keyValuePairs=[]),i.keyValuePairs.push(d.sdii.here.pb.KeyValuePairString.decode(e,e.uint32()));break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.ProprietaryInfo)return e;var t=new d.sdii.here.pb.ProprietaryInfo;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),e.keyValuePairs){if(!Array.isArray(e.keyValuePairs))throw TypeError(".sdii.here.pb.ProprietaryInfo.keyValuePairs: array expected");t.keyValuePairs=[];for(var r=0;r<e.keyValuePairs.length;++r){if("object"!=typeof e.keyValuePairs[r])throw TypeError(".sdii.here.pb.ProprietaryInfo.keyValuePairs: object expected");t.keyValuePairs[r]=d.sdii.here.pb.KeyValuePairString.fromObject(e.keyValuePairs[r])}}if(e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.ProprietaryInfo.extensionContainer: array expected");for(t.extensionContainer=[],r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.ProprietaryInfo.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.keyValuePairs=[],r.extensionContainer=[]),t.defaults)if(u.Long){var i=new u.Long(0,0,!1);r.timeStampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timeStampUTC_ms=t.longs===String?"0":0;if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?r.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:r.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),e.keyValuePairs&&e.keyValuePairs.length){r.keyValuePairs=[];for(var n=0;n<e.keyValuePairs.length;++n)r.keyValuePairs[n]=d.sdii.here.pb.KeyValuePairString.toObject(e.keyValuePairs[n],t)}if(e.extensionContainer&&e.extensionContainer.length)for(r.extensionContainer=[],n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t);return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.EnvironmentStatus=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.lightConditions=0,e.prototype.externalAirTemperature_DegC=0,e.prototype.externalAirTemperatureAccuracy_DegC=0,e.prototype.precipitation=0,e.prototype.visibleDistance_m=0,e.prototype.roadSurfaceTemperature_DegC=0,e.prototype.roadSurfaceTemperatureAccuracy_DegC=0,e.prototype.roadSurfaceType=0,e.prototype.airPressure_Pa=0,e.prototype.airHumidity_percent=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.EnvironmentStatus;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.int64();break;case 2:i.lightConditions=e.int32();break;case 3:i.externalAirTemperature_DegC=e.double();break;case 4:i.externalAirTemperatureAccuracy_DegC=e.double();break;case 5:i.precipitation=e.int32();break;case 6:i.visibleDistance_m=e.double();break;case 7:i.roadSurfaceTemperature_DegC=e.double();break;case 8:i.roadSurfaceTemperatureAccuracy_DegC=e.double();break;case 9:i.roadSurfaceType=e.int32();break;case 10:i.airPressure_Pa=e.int32();break;case 11:i.airHumidity_percent=e.int32();break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.EnvironmentStatus)return e;var t=new d.sdii.here.pb.EnvironmentStatus;switch(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),e.lightConditions){case"LIGHT_CONDITIONS_UNDEFINED":case 0:t.lightConditions=0;break;case"GENERAL_DAYLIGHT":case 1:t.lightConditions=1;break;case"GENERAL_DARK":case 2:t.lightConditions=2;break;case"DAYLIGHT_SUN":case 3:t.lightConditions=3;break;case"DAYLIGHT_CLOUD":case 4:t.lightConditions=4;break;case"DUSK_OR_DAWN":case 5:t.lightConditions=5;break;case"NIGHT_LUMINATED":case 6:t.lightConditions=6;break;case"NIGHT_DARK":case 7:t.lightConditions=7}switch(null!=e.externalAirTemperature_DegC&&(t.externalAirTemperature_DegC=Number(e.externalAirTemperature_DegC)),null!=e.externalAirTemperatureAccuracy_DegC&&(t.externalAirTemperatureAccuracy_DegC=Number(e.externalAirTemperatureAccuracy_DegC)),e.precipitation){case"PRECIPITATION_TYPE_UNDEFINED":case 0:t.precipitation=0;break;case"NONE":case 1:t.precipitation=1;break;case"RAIN":case 2:t.precipitation=2;break;case"HAIL":case 3:t.precipitation=3;break;case"SNOW":case 4:t.precipitation=4}switch(null!=e.visibleDistance_m&&(t.visibleDistance_m=Number(e.visibleDistance_m)),null!=e.roadSurfaceTemperature_DegC&&(t.roadSurfaceTemperature_DegC=Number(e.roadSurfaceTemperature_DegC)),null!=e.roadSurfaceTemperatureAccuracy_DegC&&(t.roadSurfaceTemperatureAccuracy_DegC=Number(e.roadSurfaceTemperatureAccuracy_DegC)),e.roadSurfaceType){case"ROAD_SURFACE_TYPE_UNDEFINED":case 0:t.roadSurfaceType=0;break;case"ASPHALT":case 1:t.roadSurfaceType=1;break;case"CONCRETE":case 2:t.roadSurfaceType=2;break;case"PAVED":case 3:t.roadSurfaceType=3;break;case"GRAVEL":case 4:t.roadSurfaceType=4;break;case"ICEORSNOW":case 5:t.roadSurfaceType=5;break;case"UNKNOWN":case 6:t.roadSurfaceType=6}if(null!=e.airPressure_Pa&&(t.airPressure_Pa=0|e.airPressure_Pa),null!=e.airHumidity_percent&&(t.airHumidity_percent=0|e.airHumidity_percent),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.EnvironmentStatus.extensionContainer: array expected");t.extensionContainer=[];for(var r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.EnvironmentStatus.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.extensionContainer=[]),t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timeStampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timeStampUTC_ms=t.longs===String?"0":0;r.lightConditions=t.enums===String?"LIGHT_CONDITIONS_UNDEFINED":0,r.externalAirTemperature_DegC=0,r.externalAirTemperatureAccuracy_DegC=0,r.precipitation=t.enums===String?"PRECIPITATION_TYPE_UNDEFINED":0,r.visibleDistance_m=0,r.roadSurfaceTemperature_DegC=0,r.roadSurfaceTemperatureAccuracy_DegC=0,r.roadSurfaceType=t.enums===String?"ROAD_SURFACE_TYPE_UNDEFINED":0,r.airPressure_Pa=0,r.airHumidity_percent=0}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?r.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:r.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.lightConditions&&e.hasOwnProperty("lightConditions")&&(r.lightConditions=t.enums===String?d.sdii.here.pb.EnvironmentStatus.LightConditionsEnum[e.lightConditions]:e.lightConditions),null!=e.externalAirTemperature_DegC&&e.hasOwnProperty("externalAirTemperature_DegC")&&(r.externalAirTemperature_DegC=t.json&&!isFinite(e.externalAirTemperature_DegC)?String(e.externalAirTemperature_DegC):e.externalAirTemperature_DegC),null!=e.externalAirTemperatureAccuracy_DegC&&e.hasOwnProperty("externalAirTemperatureAccuracy_DegC")&&(r.externalAirTemperatureAccuracy_DegC=t.json&&!isFinite(e.externalAirTemperatureAccuracy_DegC)?String(e.externalAirTemperatureAccuracy_DegC):e.externalAirTemperatureAccuracy_DegC),null!=e.precipitation&&e.hasOwnProperty("precipitation")&&(r.precipitation=t.enums===String?d.sdii.here.pb.EnvironmentStatus.PrecipitationEnum[e.precipitation]:e.precipitation),null!=e.visibleDistance_m&&e.hasOwnProperty("visibleDistance_m")&&(r.visibleDistance_m=t.json&&!isFinite(e.visibleDistance_m)?String(e.visibleDistance_m):e.visibleDistance_m),null!=e.roadSurfaceTemperature_DegC&&e.hasOwnProperty("roadSurfaceTemperature_DegC")&&(r.roadSurfaceTemperature_DegC=t.json&&!isFinite(e.roadSurfaceTemperature_DegC)?String(e.roadSurfaceTemperature_DegC):e.roadSurfaceTemperature_DegC),null!=e.roadSurfaceTemperatureAccuracy_DegC&&e.hasOwnProperty("roadSurfaceTemperatureAccuracy_DegC")&&(r.roadSurfaceTemperatureAccuracy_DegC=t.json&&!isFinite(e.roadSurfaceTemperatureAccuracy_DegC)?String(e.roadSurfaceTemperatureAccuracy_DegC):e.roadSurfaceTemperatureAccuracy_DegC),null!=e.roadSurfaceType&&e.hasOwnProperty("roadSurfaceType")&&(r.roadSurfaceType=t.enums===String?d.sdii.here.pb.EnvironmentStatus.RoadSurfaceTypeEnum[e.roadSurfaceType]:e.roadSurfaceType),null!=e.airPressure_Pa&&e.hasOwnProperty("airPressure_Pa")&&(r.airPressure_Pa=e.airPressure_Pa),null!=e.airHumidity_percent&&e.hasOwnProperty("airHumidity_percent")&&(r.airHumidity_percent=e.airHumidity_percent),e.extensionContainer&&e.extensionContainer.length){r.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.LightConditionsEnum=function(){var e={},t=Object.create(e);return t[e[0]="LIGHT_CONDITIONS_UNDEFINED"]=0,t[e[1]="GENERAL_DAYLIGHT"]=1,t[e[2]="GENERAL_DARK"]=2,t[e[3]="DAYLIGHT_SUN"]=3,t[e[4]="DAYLIGHT_CLOUD"]=4,t[e[5]="DUSK_OR_DAWN"]=5,t[e[6]="NIGHT_LUMINATED"]=6,t[e[7]="NIGHT_DARK"]=7,t}(),e.PrecipitationEnum=function(){var e={},t=Object.create(e);return t[e[0]="PRECIPITATION_TYPE_UNDEFINED"]=0,t[e[1]="NONE"]=1,t[e[2]="RAIN"]=2,t[e[3]="HAIL"]=3,t[e[4]="SNOW"]=4,t}(),e.RoadSurfaceTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_SURFACE_TYPE_UNDEFINED"]=0,t[e[1]="ASPHALT"]=1,t[e[2]="CONCRETE"]=2,t[e[3]="PAVED"]=3,t[e[4]="GRAVEL"]=4,t[e[5]="ICEORSNOW"]=5,t[e[6]="UNKNOWN"]=6,t}(),e}(),o.ObjectDetection=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.detectedObjectID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.positionOffset=null,e.prototype.movingVector_mps=null,e.prototype.objectType=0,e.prototype.objectSizeVector_m=null,e.prototype.objectSizeAccuracyVector_m=null,e.prototype.mediaID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.objectSurfaceType=0,e.prototype.objectSurfaceMaterialType=0,e.prototype.mapMatchedObjectID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.objectRecognitionType=0,e.prototype.objectCount=0,e.prototype.objectRecognitionMatchType=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.ObjectDetection;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.int64();break;case 2:i.detectedObjectID=e.int64();break;case 3:i.positionOffset=d.sdii.here.pb.PositionOffset.decode(e,e.uint32());break;case 4:i.movingVector_mps=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 5:i.objectType=e.int32();break;case 6:i.objectSizeVector_m=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 7:i.objectSizeAccuracyVector_m=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 8:i.mediaID=e.int64();break;case 9:i.objectSurfaceType=e.int32();break;case 10:i.objectSurfaceMaterialType=e.int32();break;case 11:i.mapMatchedObjectID=e.int64();break;case 12:i.objectRecognitionType=e.int32();break;case 13:i.objectCount=e.int32();break;case 14:i.objectRecognitionMatchType=e.int32();break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.ObjectDetection)return e;var t=new d.sdii.here.pb.ObjectDetection;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),null!=e.detectedObjectID&&(u.Long?(t.detectedObjectID=u.Long.fromValue(e.detectedObjectID)).unsigned=!1:"string"==typeof e.detectedObjectID?t.detectedObjectID=parseInt(e.detectedObjectID,10):"number"==typeof e.detectedObjectID?t.detectedObjectID=e.detectedObjectID:"object"==typeof e.detectedObjectID&&(t.detectedObjectID=new u.LongBits(e.detectedObjectID.low>>>0,e.detectedObjectID.high>>>0).toNumber())),null!=e.positionOffset){if("object"!=typeof e.positionOffset)throw TypeError(".sdii.here.pb.ObjectDetection.positionOffset: object expected");t.positionOffset=d.sdii.here.pb.PositionOffset.fromObject(e.positionOffset)}if(null!=e.movingVector_mps){if("object"!=typeof e.movingVector_mps)throw TypeError(".sdii.here.pb.ObjectDetection.movingVector_mps: object expected");t.movingVector_mps=d.sdii.here.pb.Vector3D.fromObject(e.movingVector_mps)}switch(e.objectType){case"OBJECT_TYPE_UNDEFINED":case 0:t.objectType=0;break;case"MOVING_GENERAL":case 1:t.objectType=1;break;case"STATIC_GENERAL":case 2:t.objectType=2;break;case"STATIC_GENERAL_VERTICAL":case 3:t.objectType=3;break;case"STATIC_GENERAL_TRANSVERSAL":case 4:t.objectType=4;break;case"STATIC_GENERAL_LATERAL":case 5:t.objectType=5;break;case"MOVING_VEHICLE":case 6:t.objectType=6;break;case"MOVING_TRUCK":case 7:t.objectType=7;break;case"MOVING_BIKE":case 8:t.objectType=8;break;case"MOVING_PERSON":case 9:t.objectType=9;break;case"STATIC_BRIDGE":case 10:t.objectType=10;break;case"STATIC_TUNNEL":case 11:t.objectType=11;break;case"STATIC_POLE":case 12:t.objectType=12;break;case"STATIC_BAR":case 13:t.objectType=13;break;case"STATIC_TREE":case 14:t.objectType=14;break;case"STATIC_WALL":case 15:t.objectType=15;break;case"STATIC_BOLLARD":case 16:t.objectType=16;break;case"STATIC_GUIDERAIL":case 17:t.objectType=17;break;case"STATIC_TRAFFICISLAND":case 18:t.objectType=18;break;case"STATIC_SIGN":case 19:t.objectType=19;break;case"STATIC_TRAFFIC_LIGHT":case 20:t.objectType=20}if(null!=e.objectSizeVector_m){if("object"!=typeof e.objectSizeVector_m)throw TypeError(".sdii.here.pb.ObjectDetection.objectSizeVector_m: object expected");t.objectSizeVector_m=d.sdii.here.pb.Vector3D.fromObject(e.objectSizeVector_m)}if(null!=e.objectSizeAccuracyVector_m){if("object"!=typeof e.objectSizeAccuracyVector_m)throw TypeError(".sdii.here.pb.ObjectDetection.objectSizeAccuracyVector_m: object expected");t.objectSizeAccuracyVector_m=d.sdii.here.pb.Vector3D.fromObject(e.objectSizeAccuracyVector_m)}switch(null!=e.mediaID&&(u.Long?(t.mediaID=u.Long.fromValue(e.mediaID)).unsigned=!1:"string"==typeof e.mediaID?t.mediaID=parseInt(e.mediaID,10):"number"==typeof e.mediaID?t.mediaID=e.mediaID:"object"==typeof e.mediaID&&(t.mediaID=new u.LongBits(e.mediaID.low>>>0,e.mediaID.high>>>0).toNumber())),e.objectSurfaceType){case"OBJECT_SURFACE_UNDEFINED":case 0:t.objectSurfaceType=0;break;case"UNKNOWN_SURFACE":case 1:t.objectSurfaceType=1;break;case"FLAT":case 2:t.objectSurfaceType=2;break;case"ROUGH":case 3:t.objectSurfaceType=3}switch(e.objectSurfaceMaterialType){case"OBJECT_SURFACE_MATERIAL_UNDEFINED":case 0:t.objectSurfaceMaterialType=0;break;case"UNKNOWN_MATERIAL":case 1:t.objectSurfaceMaterialType=1;break;case"STONE":case 2:t.objectSurfaceMaterialType=2;break;case"ASPHALT":case 3:t.objectSurfaceMaterialType=3;break;case"ORGANIC":case 4:t.objectSurfaceMaterialType=4;break;case"METALLIC":case 5:t.objectSurfaceMaterialType=5;break;case"PLASTIC":case 6:t.objectSurfaceMaterialType=6;break;case"WOOD":case 7:t.objectSurfaceMaterialType=7}switch(null!=e.mapMatchedObjectID&&(u.Long?(t.mapMatchedObjectID=u.Long.fromValue(e.mapMatchedObjectID)).unsigned=!1:"string"==typeof e.mapMatchedObjectID?t.mapMatchedObjectID=parseInt(e.mapMatchedObjectID,10):"number"==typeof e.mapMatchedObjectID?t.mapMatchedObjectID=e.mapMatchedObjectID:"object"==typeof e.mapMatchedObjectID&&(t.mapMatchedObjectID=new u.LongBits(e.mapMatchedObjectID.low>>>0,e.mapMatchedObjectID.high>>>0).toNumber())),e.objectRecognitionType){case"OBJECT_RECOGNITION_TYPE_UNDEFINED":case 0:t.objectRecognitionType=0;break;case"OBJECT_DETECTED":case 1:t.objectRecognitionType=1;break;case"OBJECT_NOT_DETECTED":case 2:t.objectRecognitionType=2}switch(null!=e.objectCount&&(t.objectCount=0|e.objectCount),e.objectRecognitionMatchType){case"OBJECT_RECOGNITION_MATCH_TYPE_UNDEFINED":case 0:t.objectRecognitionMatchType=0;break;case"OBJECT_MATCHED":case 1:t.objectRecognitionMatchType=1;break;case"OBJECT_NOT_MATCHED":case 2:t.objectRecognitionMatchType=2}if(e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.ObjectDetection.extensionContainer: array expected");t.extensionContainer=[];for(var r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.ObjectDetection.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.extensionContainer=[]),t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timeStampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timeStampUTC_ms=t.longs===String?"0":0;u.Long?(i=new u.Long(0,0,!1),r.detectedObjectID=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.detectedObjectID=t.longs===String?"0":0,r.positionOffset=null,r.movingVector_mps=null,r.objectType=t.enums===String?"OBJECT_TYPE_UNDEFINED":0,r.objectSizeVector_m=null,r.objectSizeAccuracyVector_m=null,u.Long?(i=new u.Long(0,0,!1),r.mediaID=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.mediaID=t.longs===String?"0":0,r.objectSurfaceType=t.enums===String?"OBJECT_SURFACE_UNDEFINED":0,r.objectSurfaceMaterialType=t.enums===String?"OBJECT_SURFACE_MATERIAL_UNDEFINED":0,u.Long?(i=new u.Long(0,0,!1),r.mapMatchedObjectID=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.mapMatchedObjectID=t.longs===String?"0":0,r.objectRecognitionType=t.enums===String?"OBJECT_RECOGNITION_TYPE_UNDEFINED":0,r.objectCount=0,r.objectRecognitionMatchType=t.enums===String?"OBJECT_RECOGNITION_MATCH_TYPE_UNDEFINED":0}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?r.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:r.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.detectedObjectID&&e.hasOwnProperty("detectedObjectID")&&("number"==typeof e.detectedObjectID?r.detectedObjectID=t.longs===String?String(e.detectedObjectID):e.detectedObjectID:r.detectedObjectID=t.longs===String?u.Long.prototype.toString.call(e.detectedObjectID):t.longs===Number?new u.LongBits(e.detectedObjectID.low>>>0,e.detectedObjectID.high>>>0).toNumber():e.detectedObjectID),null!=e.positionOffset&&e.hasOwnProperty("positionOffset")&&(r.positionOffset=d.sdii.here.pb.PositionOffset.toObject(e.positionOffset,t)),null!=e.movingVector_mps&&e.hasOwnProperty("movingVector_mps")&&(r.movingVector_mps=d.sdii.here.pb.Vector3D.toObject(e.movingVector_mps,t)),null!=e.objectType&&e.hasOwnProperty("objectType")&&(r.objectType=t.enums===String?d.sdii.here.pb.ObjectDetection.ObjectTypeEnum[e.objectType]:e.objectType),null!=e.objectSizeVector_m&&e.hasOwnProperty("objectSizeVector_m")&&(r.objectSizeVector_m=d.sdii.here.pb.Vector3D.toObject(e.objectSizeVector_m,t)),null!=e.objectSizeAccuracyVector_m&&e.hasOwnProperty("objectSizeAccuracyVector_m")&&(r.objectSizeAccuracyVector_m=d.sdii.here.pb.Vector3D.toObject(e.objectSizeAccuracyVector_m,t)),null!=e.mediaID&&e.hasOwnProperty("mediaID")&&("number"==typeof e.mediaID?r.mediaID=t.longs===String?String(e.mediaID):e.mediaID:r.mediaID=t.longs===String?u.Long.prototype.toString.call(e.mediaID):t.longs===Number?new u.LongBits(e.mediaID.low>>>0,e.mediaID.high>>>0).toNumber():e.mediaID),null!=e.objectSurfaceType&&e.hasOwnProperty("objectSurfaceType")&&(r.objectSurfaceType=t.enums===String?d.sdii.here.pb.ObjectDetection.ObjectSurfaceTypeEnum[e.objectSurfaceType]:e.objectSurfaceType),null!=e.objectSurfaceMaterialType&&e.hasOwnProperty("objectSurfaceMaterialType")&&(r.objectSurfaceMaterialType=t.enums===String?d.sdii.here.pb.ObjectDetection.ObjectSurfaceMaterialTypeEnum[e.objectSurfaceMaterialType]:e.objectSurfaceMaterialType),null!=e.mapMatchedObjectID&&e.hasOwnProperty("mapMatchedObjectID")&&("number"==typeof e.mapMatchedObjectID?r.mapMatchedObjectID=t.longs===String?String(e.mapMatchedObjectID):e.mapMatchedObjectID:r.mapMatchedObjectID=t.longs===String?u.Long.prototype.toString.call(e.mapMatchedObjectID):t.longs===Number?new u.LongBits(e.mapMatchedObjectID.low>>>0,e.mapMatchedObjectID.high>>>0).toNumber():e.mapMatchedObjectID),null!=e.objectRecognitionType&&e.hasOwnProperty("objectRecognitionType")&&(r.objectRecognitionType=t.enums===String?d.sdii.here.pb.ObjectDetection.ObjectRecognitionTypeEnum[e.objectRecognitionType]:e.objectRecognitionType),null!=e.objectCount&&e.hasOwnProperty("objectCount")&&(r.objectCount=e.objectCount),null!=e.objectRecognitionMatchType&&e.hasOwnProperty("objectRecognitionMatchType")&&(r.objectRecognitionMatchType=t.enums===String?d.sdii.here.pb.ObjectDetection.ObjectRecognitionMatchTypeEnum[e.objectRecognitionMatchType]:e.objectRecognitionMatchType),e.extensionContainer&&e.extensionContainer.length){r.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.ObjectTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="OBJECT_TYPE_UNDEFINED"]=0,t[e[1]="MOVING_GENERAL"]=1,t[e[2]="STATIC_GENERAL"]=2,t[e[3]="STATIC_GENERAL_VERTICAL"]=3,t[e[4]="STATIC_GENERAL_TRANSVERSAL"]=4,t[e[5]="STATIC_GENERAL_LATERAL"]=5,t[e[6]="MOVING_VEHICLE"]=6,t[e[7]="MOVING_TRUCK"]=7,t[e[8]="MOVING_BIKE"]=8,t[e[9]="MOVING_PERSON"]=9,t[e[10]="STATIC_BRIDGE"]=10,t[e[11]="STATIC_TUNNEL"]=11,t[e[12]="STATIC_POLE"]=12,t[e[13]="STATIC_BAR"]=13,t[e[14]="STATIC_TREE"]=14,t[e[15]="STATIC_WALL"]=15,t[e[16]="STATIC_BOLLARD"]=16,t[e[17]="STATIC_GUIDERAIL"]=17,t[e[18]="STATIC_TRAFFICISLAND"]=18,t[e[19]="STATIC_SIGN"]=19,t[e[20]="STATIC_TRAFFIC_LIGHT"]=20,t}(),e.ObjectSurfaceTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="OBJECT_SURFACE_UNDEFINED"]=0,t[e[1]="UNKNOWN_SURFACE"]=1,t[e[2]="FLAT"]=2,t[e[3]="ROUGH"]=3,t}(),e.ObjectSurfaceMaterialTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="OBJECT_SURFACE_MATERIAL_UNDEFINED"]=0,t[e[1]="UNKNOWN_MATERIAL"]=1,t[e[2]="STONE"]=2,t[e[3]="ASPHALT"]=3,t[e[4]="ORGANIC"]=4,t[e[5]="METALLIC"]=5,t[e[6]="PLASTIC"]=6,t[e[7]="WOOD"]=7,t}(),e.ObjectRecognitionTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="OBJECT_RECOGNITION_TYPE_UNDEFINED"]=0,t[e[1]="OBJECT_DETECTED"]=1,t[e[2]="OBJECT_NOT_DETECTED"]=2,t}(),e.ObjectRecognitionMatchTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="OBJECT_RECOGNITION_MATCH_TYPE_UNDEFINED"]=0,t[e[1]="OBJECT_MATCHED"]=1,t[e[2]="OBJECT_NOT_MATCHED"]=2,t}(),e}(),o.ADServiceAndSensorState=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.adSpeedControl=!1,e.prototype.adBrakeControl=!1,e.prototype.adSteeringControl=!1,e.prototype.adConnectionAvailable=!1,e.prototype.sensorObjectRecognition=!1,e.prototype.sensorSignRecognition=!1,e.prototype.sensorLaneRecognition=!1,e.prototype.sensorRoadSurface=!1,e.prototype.sensorEnvironment=!1,e.prototype.sensorParkingPilotAvailable=!1,e.prototype.sensorParkingSpotAvailable=!1,e.prototype.sensorParkingSpotEnabled=!1,e.prototype.adParkingPilotEnabled=!1,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.ADServiceAndSensorState;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.int64();break;case 2:i.adSpeedControl=e.bool();break;case 3:i.adBrakeControl=e.bool();break;case 4:i.adSteeringControl=e.bool();break;case 5:i.adConnectionAvailable=e.bool();break;case 6:i.sensorObjectRecognition=e.bool();break;case 7:i.sensorSignRecognition=e.bool();break;case 8:i.sensorLaneRecognition=e.bool();break;case 9:i.sensorRoadSurface=e.bool();break;case 10:i.sensorEnvironment=e.bool();break;case 11:i.sensorParkingPilotAvailable=e.bool();break;case 12:i.sensorParkingSpotAvailable=e.bool();break;case 13:i.sensorParkingSpotEnabled=e.bool();break;case 101:i.adParkingPilotEnabled=e.bool();break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.ADServiceAndSensorState)return e;var t=new d.sdii.here.pb.ADServiceAndSensorState;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),null!=e.adSpeedControl&&(t.adSpeedControl=Boolean(e.adSpeedControl)),null!=e.adBrakeControl&&(t.adBrakeControl=Boolean(e.adBrakeControl)),null!=e.adSteeringControl&&(t.adSteeringControl=Boolean(e.adSteeringControl)),null!=e.adConnectionAvailable&&(t.adConnectionAvailable=Boolean(e.adConnectionAvailable)),null!=e.sensorObjectRecognition&&(t.sensorObjectRecognition=Boolean(e.sensorObjectRecognition)),null!=e.sensorSignRecognition&&(t.sensorSignRecognition=Boolean(e.sensorSignRecognition)),null!=e.sensorLaneRecognition&&(t.sensorLaneRecognition=Boolean(e.sensorLaneRecognition)),null!=e.sensorRoadSurface&&(t.sensorRoadSurface=Boolean(e.sensorRoadSurface)),null!=e.sensorEnvironment&&(t.sensorEnvironment=Boolean(e.sensorEnvironment)),null!=e.sensorParkingPilotAvailable&&(t.sensorParkingPilotAvailable=Boolean(e.sensorParkingPilotAvailable)),null!=e.sensorParkingSpotAvailable&&(t.sensorParkingSpotAvailable=Boolean(e.sensorParkingSpotAvailable)),null!=e.sensorParkingSpotEnabled&&(t.sensorParkingSpotEnabled=Boolean(e.sensorParkingSpotEnabled)),null!=e.adParkingPilotEnabled&&(t.adParkingPilotEnabled=Boolean(e.adParkingPilotEnabled)),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.ADServiceAndSensorState.extensionContainer: array expected");t.extensionContainer=[];for(var r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.ADServiceAndSensorState.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.extensionContainer=[]),t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timeStampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timeStampUTC_ms=t.longs===String?"0":0;r.adSpeedControl=!1,r.adBrakeControl=!1,r.adSteeringControl=!1,r.adConnectionAvailable=!1,r.sensorObjectRecognition=!1,r.sensorSignRecognition=!1,r.sensorLaneRecognition=!1,r.sensorRoadSurface=!1,r.sensorEnvironment=!1,r.sensorParkingPilotAvailable=!1,r.sensorParkingSpotAvailable=!1,r.sensorParkingSpotEnabled=!1,r.adParkingPilotEnabled=!1}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?r.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:r.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.adSpeedControl&&e.hasOwnProperty("adSpeedControl")&&(r.adSpeedControl=e.adSpeedControl),null!=e.adBrakeControl&&e.hasOwnProperty("adBrakeControl")&&(r.adBrakeControl=e.adBrakeControl),null!=e.adSteeringControl&&e.hasOwnProperty("adSteeringControl")&&(r.adSteeringControl=e.adSteeringControl),null!=e.adConnectionAvailable&&e.hasOwnProperty("adConnectionAvailable")&&(r.adConnectionAvailable=e.adConnectionAvailable),null!=e.sensorObjectRecognition&&e.hasOwnProperty("sensorObjectRecognition")&&(r.sensorObjectRecognition=e.sensorObjectRecognition),null!=e.sensorSignRecognition&&e.hasOwnProperty("sensorSignRecognition")&&(r.sensorSignRecognition=e.sensorSignRecognition),null!=e.sensorLaneRecognition&&e.hasOwnProperty("sensorLaneRecognition")&&(r.sensorLaneRecognition=e.sensorLaneRecognition),null!=e.sensorRoadSurface&&e.hasOwnProperty("sensorRoadSurface")&&(r.sensorRoadSurface=e.sensorRoadSurface),null!=e.sensorEnvironment&&e.hasOwnProperty("sensorEnvironment")&&(r.sensorEnvironment=e.sensorEnvironment),null!=e.sensorParkingPilotAvailable&&e.hasOwnProperty("sensorParkingPilotAvailable")&&(r.sensorParkingPilotAvailable=e.sensorParkingPilotAvailable),null!=e.sensorParkingSpotAvailable&&e.hasOwnProperty("sensorParkingSpotAvailable")&&(r.sensorParkingSpotAvailable=e.sensorParkingSpotAvailable),null!=e.sensorParkingSpotEnabled&&e.hasOwnProperty("sensorParkingSpotEnabled")&&(r.sensorParkingSpotEnabled=e.sensorParkingSpotEnabled),null!=e.adParkingPilotEnabled&&e.hasOwnProperty("adParkingPilotEnabled")&&(r.adParkingPilotEnabled=e.adParkingPilotEnabled),e.extensionContainer&&e.extensionContainer.length){r.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.SpecificObservedEventSubCauseEnum=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t;return e.prototype.trafficConditionSubCause=0,e.prototype.accidentSubCause=0,e.prototype.roadworksSubCause=0,e.prototype.adverseWeatherCondition_AdhesionSubCause=0,e.prototype.hazardousLocation_SurfaceConditionSubCause=0,e.prototype.hazardousLocation_ObstacleOnTheRoadSubCause=0,e.prototype.hazardousLocation_AnimalOnTheRoadSubCause=0,e.prototype.humanPresenceOnTheRoadSubCause=0,e.prototype.wrongWayDrivingSubCause=0,e.prototype.rescueAndRecoveryWorkInProgressSubCause=0,e.prototype.adverseWeatherCondition_ExtremeWeatherConditionSubCause=0,e.prototype.adverseWeatherCondition_VisibilitySubCause=0,e.prototype.adverseWeatherCondition_PrecipitationSubCause=0,e.prototype.slowVehicleSubCause=0,e.prototype.dangerousEndOfQueueSubCause=0,e.prototype.vehicleBreakdownSubCause=0,e.prototype.postCrashSubCause=0,e.prototype.humanProblemSubCause=0,e.prototype.stationaryVehicleSubCause=0,e.prototype.emergencyVehicleApproachingSubCause=0,e.prototype.hazardousLocation_DangerousCurveSubCause=0,e.prototype.collisionRiskSubCause=0,e.prototype.signalViolationSubCauseCodeSubCause=0,e.prototype.dangerousSituationSubCause=0,Object.defineProperty(e.prototype,"subcause",{get:u.oneOfGetter(t=["trafficConditionSubCause","accidentSubCause","roadworksSubCause","adverseWeatherCondition_AdhesionSubCause","hazardousLocation_SurfaceConditionSubCause","hazardousLocation_ObstacleOnTheRoadSubCause","hazardousLocation_AnimalOnTheRoadSubCause","humanPresenceOnTheRoadSubCause","wrongWayDrivingSubCause","rescueAndRecoveryWorkInProgressSubCause","adverseWeatherCondition_ExtremeWeatherConditionSubCause","adverseWeatherCondition_VisibilitySubCause","adverseWeatherCondition_PrecipitationSubCause","slowVehicleSubCause","dangerousEndOfQueueSubCause","vehicleBreakdownSubCause","postCrashSubCause","humanProblemSubCause","stationaryVehicleSubCause","emergencyVehicleApproachingSubCause","hazardousLocation_DangerousCurveSubCause","collisionRiskSubCause","signalViolationSubCauseCodeSubCause","dangerousSituationSubCause"]),set:u.oneOfSetter(t)}),e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.SpecificObservedEventSubCauseEnum;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.trafficConditionSubCause=e.int32();break;case 2:i.accidentSubCause=e.int32();break;case 3:i.roadworksSubCause=e.int32();break;case 6:i.adverseWeatherCondition_AdhesionSubCause=e.int32();break;case 9:i.hazardousLocation_SurfaceConditionSubCause=e.int32();break;case 10:i.hazardousLocation_ObstacleOnTheRoadSubCause=e.int32();break;case 11:i.hazardousLocation_AnimalOnTheRoadSubCause=e.int32();break;case 12:i.humanPresenceOnTheRoadSubCause=e.int32();break;case 14:i.wrongWayDrivingSubCause=e.int32();break;case 15:i.rescueAndRecoveryWorkInProgressSubCause=e.int32();break;case 17:i.adverseWeatherCondition_ExtremeWeatherConditionSubCause=e.int32();break;case 18:i.adverseWeatherCondition_VisibilitySubCause=e.int32();break;case 19:i.adverseWeatherCondition_PrecipitationSubCause=e.int32();break;case 26:i.slowVehicleSubCause=e.int32();break;case 27:i.dangerousEndOfQueueSubCause=e.int32();break;case 91:i.vehicleBreakdownSubCause=e.int32();break;case 92:i.postCrashSubCause=e.int32();break;case 93:i.humanProblemSubCause=e.int32();break;case 94:i.stationaryVehicleSubCause=e.int32();break;case 95:i.emergencyVehicleApproachingSubCause=e.int32();break;case 96:i.hazardousLocation_DangerousCurveSubCause=e.int32();break;case 97:i.collisionRiskSubCause=e.int32();break;case 98:i.signalViolationSubCauseCodeSubCause=e.int32();break;case 99:i.dangerousSituationSubCause=e.int32();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.SpecificObservedEventSubCauseEnum)return e;var t=new d.sdii.here.pb.SpecificObservedEventSubCauseEnum;switch(e.trafficConditionSubCause){case"unavailableTrafficConditionSubCause":case 0:t.trafficConditionSubCause=0;break;case"increasedVolumeOfTraffic":case 1:t.trafficConditionSubCause=1;break;case"trafficJamSlowlyIncreasing":case 2:t.trafficConditionSubCause=2;break;case"trafficJamIncreasing":case 3:t.trafficConditionSubCause=3;break;case"trafficJamStronglyIncreasing":case 4:t.trafficConditionSubCause=4;break;case"trafficStationary":case 5:t.trafficConditionSubCause=5;break;case"trafficJamSlightlyDecreasing":case 6:t.trafficConditionSubCause=6;break;case"trafficJamDecreasing":case 7:t.trafficConditionSubCause=7;break;case"trafficJamStronglyDecreasing":case 8:t.trafficConditionSubCause=8}switch(e.accidentSubCause){case"unavailableAccidentSubCause":case 0:t.accidentSubCause=0;break;case"multiVehicleAccident":case 1:t.accidentSubCause=1;break;case"heavyAccident":case 2:t.accidentSubCause=2;break;case"accidentInvolvingLorry":case 3:t.accidentSubCause=3;break;case"accidentInvolvingBus":case 4:t.accidentSubCause=4;break;case"accidentInvolvingHazardousMaterials":case 5:t.accidentSubCause=5;break;case"accidentOnOppositeLane":case 6:t.accidentSubCause=6;break;case"unsecuredAccident":case 7:t.accidentSubCause=7;break;case"assistanceRequested":case 8:t.accidentSubCause=8}switch(e.roadworksSubCause){case"unavailableRoadworksSubCause":case 0:t.roadworksSubCause=0;break;case"majorRoadWorks":case 1:t.roadworksSubCause=1;break;case"roadMarkingWork":case 2:t.roadworksSubCause=2;break;case"slowMovingRoadMaintenance":case 3:t.roadworksSubCause=3;break;case"shortTermStationaryRoadworks":case 4:t.roadworksSubCause=4;break;case"streetCleaning":case 5:t.roadworksSubCause=5;break;case"winterService":case 6:t.roadworksSubCause=6}switch(e.adverseWeatherCondition_AdhesionSubCause){case"unavailableAdverseWeatherCondition_AdhesionSubCause":case 0:t.adverseWeatherCondition_AdhesionSubCause=0;break;case"heavyFrostOnRoad":case 1:t.adverseWeatherCondition_AdhesionSubCause=1;break;case"fuelOnRoad":case 2:t.adverseWeatherCondition_AdhesionSubCause=2;break;case"mudOnRoad":case 3:t.adverseWeatherCondition_AdhesionSubCause=3;break;case"snowOnRoad":case 4:t.adverseWeatherCondition_AdhesionSubCause=4;break;case"iceOnRoad":case 5:t.adverseWeatherCondition_AdhesionSubCause=5;break;case"blackIceOnRoad":case 6:t.adverseWeatherCondition_AdhesionSubCause=6;break;case"oilOnRoad":case 7:t.adverseWeatherCondition_AdhesionSubCause=7;break;case"looseChippings":case 8:t.adverseWeatherCondition_AdhesionSubCause=8;break;case"instantBlackIce":case 9:t.adverseWeatherCondition_AdhesionSubCause=9;break;case"roadsSalted":case 10:t.adverseWeatherCondition_AdhesionSubCause=10}switch(e.hazardousLocation_SurfaceConditionSubCause){case"unavailableHazardousLocation_SurfaceConditionSubCause":case 0:t.hazardousLocation_SurfaceConditionSubCause=0;break;case"rockfalls":case 1:t.hazardousLocation_SurfaceConditionSubCause=1;break;case"earthquakeDamage":case 2:t.hazardousLocation_SurfaceConditionSubCause=2;break;case"sewerCollapse":case 3:t.hazardousLocation_SurfaceConditionSubCause=3;break;case"subsidence":case 4:t.hazardousLocation_SurfaceConditionSubCause=4;break;case"snowDrifts":case 5:t.hazardousLocation_SurfaceConditionSubCause=5;break;case"stormDamage":case 6:t.hazardousLocation_SurfaceConditionSubCause=6;break;case"burstPipe":case 7:t.hazardousLocation_SurfaceConditionSubCause=7;break;case"volcanoEruption":case 8:t.hazardousLocation_SurfaceConditionSubCause=8;break;case"fallingIce":case 9:t.hazardousLocation_SurfaceConditionSubCause=9}switch(e.hazardousLocation_ObstacleOnTheRoadSubCause){case"unavailableHazardousLocation_ObstacleOnTheRoadSubCause":case 0:t.hazardousLocation_ObstacleOnTheRoadSubCause=0;break;case"shedload":case 1:t.hazardousLocation_ObstacleOnTheRoadSubCause=1;break;case"partsOfVehicles":case 2:t.hazardousLocation_ObstacleOnTheRoadSubCause=2;break;case"partsOfTyres":case 3:t.hazardousLocation_ObstacleOnTheRoadSubCause=3;break;case"bigObjects":case 4:t.hazardousLocation_ObstacleOnTheRoadSubCause=4;break;case"fallenTrees":case 5:t.hazardousLocation_ObstacleOnTheRoadSubCause=5;break;case"hubCaps":case 6:t.hazardousLocation_ObstacleOnTheRoadSubCause=6;break;case"waitingVehicles":case 7:t.hazardousLocation_ObstacleOnTheRoadSubCause=7}switch(e.hazardousLocation_AnimalOnTheRoadSubCause){case"unavailableHazardousLocation_AnimalOnTheRoadSubCause":case 0:t.hazardousLocation_AnimalOnTheRoadSubCause=0;break;case"wildAnimals":case 1:t.hazardousLocation_AnimalOnTheRoadSubCause=1;break;case"herdOfAnimals":case 2:t.hazardousLocation_AnimalOnTheRoadSubCause=2;break;case"smallAnimals":case 3:t.hazardousLocation_AnimalOnTheRoadSubCause=3;break;case"largeAnimals":case 4:t.hazardousLocation_AnimalOnTheRoadSubCause=4}switch(e.humanPresenceOnTheRoadSubCause){case"unavailableHumanPresenceOnTheRoadSubCause":case 0:t.humanPresenceOnTheRoadSubCause=0;break;case"childrenOnRoadway":case 1:t.humanPresenceOnTheRoadSubCause=1;break;case"cyclistOnRoadway":case 2:t.humanPresenceOnTheRoadSubCause=2;break;case"motorcyclistOnRoadway":case 3:t.humanPresenceOnTheRoadSubCause=3}switch(e.wrongWayDrivingSubCause){case"unavailableWrongWayDrivingSubCause":case 0:t.wrongWayDrivingSubCause=0;break;case"wrongLane":case 1:t.wrongWayDrivingSubCause=1;break;case"wrongDirection":case 2:t.wrongWayDrivingSubCause=2}switch(e.rescueAndRecoveryWorkInProgressSubCause){case"unavailableRescueAndRecoveryWorkInProgressSubCause":case 0:t.rescueAndRecoveryWorkInProgressSubCause=0;break;case"emergencyVehicles":case 1:t.rescueAndRecoveryWorkInProgressSubCause=1;break;case"rescueHelicopterLanding":case 2:t.rescueAndRecoveryWorkInProgressSubCause=2;break;case"policeActivityOngoing":case 3:t.rescueAndRecoveryWorkInProgressSubCause=3;break;case"medicalEmergencyOngoing":case 4:t.rescueAndRecoveryWorkInProgressSubCause=4;break;case"childAbductionInProgress":case 5:t.rescueAndRecoveryWorkInProgressSubCause=5}switch(e.adverseWeatherCondition_ExtremeWeatherConditionSubCause){case"unavailableAdverseWeatherCondition_ExtremeWeatherConditionSubCause":case 0:t.adverseWeatherCondition_ExtremeWeatherConditionSubCause=0;break;case"strongWinds":case 1:t.adverseWeatherCondition_ExtremeWeatherConditionSubCause=1;break;case"damagingHail":case 2:t.adverseWeatherCondition_ExtremeWeatherConditionSubCause=2;break;case"hurricane":case 3:t.adverseWeatherCondition_ExtremeWeatherConditionSubCause=3;break;case"thunderstorm":case 4:t.adverseWeatherCondition_ExtremeWeatherConditionSubCause=4;break;case"tornado":case 5:t.adverseWeatherCondition_ExtremeWeatherConditionSubCause=5;break;case"blizzard":case 6:t.adverseWeatherCondition_ExtremeWeatherConditionSubCause=6}switch(e.adverseWeatherCondition_VisibilitySubCause){case"unavailableAdverseWeatherCondition_VisibilitySubCause":case 0:t.adverseWeatherCondition_VisibilitySubCause=0;break;case"fog":case 1:t.adverseWeatherCondition_VisibilitySubCause=1;break;case"smoke":case 2:t.adverseWeatherCondition_VisibilitySubCause=2;break;case"heavySnowFallVisibility":case 3:t.adverseWeatherCondition_VisibilitySubCause=3;break;case"heavyRainVisibility":case 4:t.adverseWeatherCondition_VisibilitySubCause=4;break;case"heavyHail":case 5:t.adverseWeatherCondition_VisibilitySubCause=5;break;case"lowSunGlare":case 6:t.adverseWeatherCondition_VisibilitySubCause=6;break;case"sandstorms":case 7:t.adverseWeatherCondition_VisibilitySubCause=7;break;case"swarmsOfInsects":case 8:t.adverseWeatherCondition_VisibilitySubCause=8}switch(e.adverseWeatherCondition_PrecipitationSubCause){case"unavailableAdverseWeatherCondition_PrecipitationSubCause":case 0:t.adverseWeatherCondition_PrecipitationSubCause=0;break;case"heavyRainPrecipitation":case 1:t.adverseWeatherCondition_PrecipitationSubCause=1;break;case"heavySnowFallPrecipitation":case 2:t.adverseWeatherCondition_PrecipitationSubCause=2;break;case"softHail":case 3:t.adverseWeatherCondition_PrecipitationSubCause=3}switch(e.slowVehicleSubCause){case"unavailableSlowVehicleSubCause":case 0:t.slowVehicleSubCause=0;break;case"maintenanceVehicle":case 1:t.slowVehicleSubCause=1;break;case"vehiclesSlowingToLookAtAccident":case 2:t.slowVehicleSubCause=2;break;case"abnormalLoad":case 3:t.slowVehicleSubCause=3;break;case"abnormalWideLoad":case 4:t.slowVehicleSubCause=4;break;case"convoy":case 5:t.slowVehicleSubCause=5;break;case"snowplough":case 6:t.slowVehicleSubCause=6;break;case"deicing":case 7:t.slowVehicleSubCause=7;break;case"saltingVehicles":case 8:t.slowVehicleSubCause=8}switch(e.dangerousEndOfQueueSubCause){case"unavailableDangerousEndOfQueueSubCause":case 0:t.dangerousEndOfQueueSubCause=0;break;case"suddenEndOfQueue":case 1:t.dangerousEndOfQueueSubCause=1;break;case"queueOverHill":case 2:t.dangerousEndOfQueueSubCause=2;break;case"queueAroundBend":case 3:t.dangerousEndOfQueueSubCause=3;break;case"queueInTunnel":case 4:t.dangerousEndOfQueueSubCause=4}switch(e.vehicleBreakdownSubCause){case"unavailableVehicleBreakdownSubCause":case 0:t.vehicleBreakdownSubCause=0;break;case"lackOfFuel":case 1:t.vehicleBreakdownSubCause=1;break;case"lackOfBatteryPower":case 2:t.vehicleBreakdownSubCause=2;break;case"engineProblem":case 3:t.vehicleBreakdownSubCause=3;break;case"transmissionProblem":case 4:t.vehicleBreakdownSubCause=4;break;case"engineCoolingProblem":case 5:t.vehicleBreakdownSubCause=5;break;case"brakingSystemProblem":case 6:t.vehicleBreakdownSubCause=6;break;case"steeringProblem":case 7:t.vehicleBreakdownSubCause=7;break;case"tyrePuncture":case 8:t.vehicleBreakdownSubCause=8}switch(e.postCrashSubCause){case"unavailablePostCrashSubCause":case 0:t.postCrashSubCause=0;break;case"accidentWithoutECallTriggered":case 1:t.postCrashSubCause=1;break;case"accidentWithECallManuallyTriggered":case 2:t.postCrashSubCause=2;break;case"accidentWithECallAutomaticallyTriggered":case 3:t.postCrashSubCause=3;break;case"accidentWithECallTriggeredWithoutAccessToCellularNetwork":case 4:t.postCrashSubCause=4}switch(e.humanProblemSubCause){case"unavailableHumanProblemSubCause":case 0:t.humanProblemSubCause=0;break;case"glycemiaProblem":case 1:t.humanProblemSubCause=1;break;case"heartProblem":case 2:t.humanProblemSubCause=2}switch(e.stationaryVehicleSubCause){case"unavailableStationaryVehicleSubCause":case 0:t.stationaryVehicleSubCause=0;break;case"humanProblem":case 1:t.stationaryVehicleSubCause=1;break;case"vehicleBreakdown":case 2:t.stationaryVehicleSubCause=2;break;case"postCrash":case 3:t.stationaryVehicleSubCause=3;break;case"publicTransportStop":case 4:t.stationaryVehicleSubCause=4;break;case"carryingDangerousGoods":case 5:t.stationaryVehicleSubCause=5}switch(e.emergencyVehicleApproachingSubCause){case"unavailableEmergencyVehicleApproachingSubCause":case 0:t.emergencyVehicleApproachingSubCause=0;break;case"emergencyVehicleApproaching":case 1:t.emergencyVehicleApproachingSubCause=1;break;case"prioritizedVehicleApproaching":case 2:t.emergencyVehicleApproachingSubCause=2}switch(e.hazardousLocation_DangerousCurveSubCause){case"unavailableHazardousLocation_DangerousCurveSubCause":case 0:t.hazardousLocation_DangerousCurveSubCause=0;break;case"dangerousLeftTurnCurve":case 1:t.hazardousLocation_DangerousCurveSubCause=1;break;case"dangerousRightTurnCurve":case 2:t.hazardousLocation_DangerousCurveSubCause=2;break;case"multipleCurvesStartingWithUnknownTurningDirection":case 3:t.hazardousLocation_DangerousCurveSubCause=3;break;case"multipleCurvesStartingWithLeftTurn":case 4:t.hazardousLocation_DangerousCurveSubCause=4;break;case"multipleCurvesStartingWithRightTurn":case 5:t.hazardousLocation_DangerousCurveSubCause=5}switch(e.collisionRiskSubCause){case"unavailableCollisionRiskSubCause":case 0:t.collisionRiskSubCause=0;break;case"longitudinalCollisionRisk":case 1:t.collisionRiskSubCause=1;break;case"crossingCollisionRisk":case 2:t.collisionRiskSubCause=2;break;case"lateralCollisionRisk":case 3:t.collisionRiskSubCause=3;break;case"vulnerableRoadUser":case 4:t.collisionRiskSubCause=4}switch(e.signalViolationSubCauseCodeSubCause){case"unavailableSignalViolationSubCauseCodeSubCause":case 0:t.signalViolationSubCauseCodeSubCause=0;break;case"stopSignViolation":case 1:t.signalViolationSubCauseCodeSubCause=1;break;case"trafficLightViolation":case 2:t.signalViolationSubCauseCodeSubCause=2;break;case"turningRegulationViolation":case 3:t.signalViolationSubCauseCodeSubCause=3}switch(e.dangerousSituationSubCause){case"unavailableDangerousSituationSubCause":case 0:t.dangerousSituationSubCause=0;break;case"emergencyElectronicBrakeEngaged":case 1:t.dangerousSituationSubCause=1;break;case"preCrashSystemEngaged":case 2:t.dangerousSituationSubCause=2;break;case"espEngaged":case 3:t.dangerousSituationSubCause=3;break;case"absEngaged":case 4:t.dangerousSituationSubCause=4;break;case"aebEngaged":case 5:t.dangerousSituationSubCause=5;break;case"brakeWarningEngaged":case 6:t.dangerousSituationSubCause=6;break;case"collisionRiskWarningEngaged":case 7:t.dangerousSituationSubCause=7}return t},e.toObject=function(e,t){t||(t={});var r={};return null!=e.trafficConditionSubCause&&e.hasOwnProperty("trafficConditionSubCause")&&(r.trafficConditionSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.TrafficConditionSubCauseEnum[e.trafficConditionSubCause]:e.trafficConditionSubCause,t.oneofs&&(r.subcause="trafficConditionSubCause")),null!=e.accidentSubCause&&e.hasOwnProperty("accidentSubCause")&&(r.accidentSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.AccidentSubCauseEnum[e.accidentSubCause]:e.accidentSubCause,t.oneofs&&(r.subcause="accidentSubCause")),null!=e.roadworksSubCause&&e.hasOwnProperty("roadworksSubCause")&&(r.roadworksSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.RoadworksSubCauseEnum[e.roadworksSubCause]:e.roadworksSubCause,t.oneofs&&(r.subcause="roadworksSubCause")),null!=e.adverseWeatherCondition_AdhesionSubCause&&e.hasOwnProperty("adverseWeatherCondition_AdhesionSubCause")&&(r.adverseWeatherCondition_AdhesionSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.AdverseWeatherCondition_AdhesionSubCauseEnum[e.adverseWeatherCondition_AdhesionSubCause]:e.adverseWeatherCondition_AdhesionSubCause,t.oneofs&&(r.subcause="adverseWeatherCondition_AdhesionSubCause")),null!=e.hazardousLocation_SurfaceConditionSubCause&&e.hasOwnProperty("hazardousLocation_SurfaceConditionSubCause")&&(r.hazardousLocation_SurfaceConditionSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.HazardousLocation_SurfaceConditionSubCauseCode[e.hazardousLocation_SurfaceConditionSubCause]:e.hazardousLocation_SurfaceConditionSubCause,t.oneofs&&(r.subcause="hazardousLocation_SurfaceConditionSubCause")),null!=e.hazardousLocation_ObstacleOnTheRoadSubCause&&e.hasOwnProperty("hazardousLocation_ObstacleOnTheRoadSubCause")&&(r.hazardousLocation_ObstacleOnTheRoadSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.HazardousLocation_ObstacleOnTheRoadSubCauseCode[e.hazardousLocation_ObstacleOnTheRoadSubCause]:e.hazardousLocation_ObstacleOnTheRoadSubCause,t.oneofs&&(r.subcause="hazardousLocation_ObstacleOnTheRoadSubCause")),null!=e.hazardousLocation_AnimalOnTheRoadSubCause&&e.hasOwnProperty("hazardousLocation_AnimalOnTheRoadSubCause")&&(r.hazardousLocation_AnimalOnTheRoadSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.HazardousLocation_AnimalOnTheRoadSubCauseCode[e.hazardousLocation_AnimalOnTheRoadSubCause]:e.hazardousLocation_AnimalOnTheRoadSubCause,t.oneofs&&(r.subcause="hazardousLocation_AnimalOnTheRoadSubCause")),null!=e.humanPresenceOnTheRoadSubCause&&e.hasOwnProperty("humanPresenceOnTheRoadSubCause")&&(r.humanPresenceOnTheRoadSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.HumanPresenceOnTheRoadSubCauseCode[e.humanPresenceOnTheRoadSubCause]:e.humanPresenceOnTheRoadSubCause,t.oneofs&&(r.subcause="humanPresenceOnTheRoadSubCause")),null!=e.wrongWayDrivingSubCause&&e.hasOwnProperty("wrongWayDrivingSubCause")&&(r.wrongWayDrivingSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.WrongWayDrivingSubCauseCode[e.wrongWayDrivingSubCause]:e.wrongWayDrivingSubCause,t.oneofs&&(r.subcause="wrongWayDrivingSubCause")),null!=e.rescueAndRecoveryWorkInProgressSubCause&&e.hasOwnProperty("rescueAndRecoveryWorkInProgressSubCause")&&(r.rescueAndRecoveryWorkInProgressSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.RescueAndRecoveryWorkInProgressSubCauseCode[e.rescueAndRecoveryWorkInProgressSubCause]:e.rescueAndRecoveryWorkInProgressSubCause,t.oneofs&&(r.subcause="rescueAndRecoveryWorkInProgressSubCause")),null!=e.adverseWeatherCondition_ExtremeWeatherConditionSubCause&&e.hasOwnProperty("adverseWeatherCondition_ExtremeWeatherConditionSubCause")&&(r.adverseWeatherCondition_ExtremeWeatherConditionSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.AdverseWeatherCondition_ExtremeWeatherConditionSubCauseCode[e.adverseWeatherCondition_ExtremeWeatherConditionSubCause]:e.adverseWeatherCondition_ExtremeWeatherConditionSubCause,t.oneofs&&(r.subcause="adverseWeatherCondition_ExtremeWeatherConditionSubCause")),null!=e.adverseWeatherCondition_VisibilitySubCause&&e.hasOwnProperty("adverseWeatherCondition_VisibilitySubCause")&&(r.adverseWeatherCondition_VisibilitySubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.AdverseWeatherCondition_VisibilitySubCauseCode[e.adverseWeatherCondition_VisibilitySubCause]:e.adverseWeatherCondition_VisibilitySubCause,t.oneofs&&(r.subcause="adverseWeatherCondition_VisibilitySubCause")),null!=e.adverseWeatherCondition_PrecipitationSubCause&&e.hasOwnProperty("adverseWeatherCondition_PrecipitationSubCause")&&(r.adverseWeatherCondition_PrecipitationSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.AdverseWeatherCondition_PrecipitationSubCauseCode[e.adverseWeatherCondition_PrecipitationSubCause]:e.adverseWeatherCondition_PrecipitationSubCause,t.oneofs&&(r.subcause="adverseWeatherCondition_PrecipitationSubCause")),null!=e.slowVehicleSubCause&&e.hasOwnProperty("slowVehicleSubCause")&&(r.slowVehicleSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.SlowVehicleSubCauseCode[e.slowVehicleSubCause]:e.slowVehicleSubCause,t.oneofs&&(r.subcause="slowVehicleSubCause")),null!=e.dangerousEndOfQueueSubCause&&e.hasOwnProperty("dangerousEndOfQueueSubCause")&&(r.dangerousEndOfQueueSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.DangerousEndOfQueueSubCauseCode[e.dangerousEndOfQueueSubCause]:e.dangerousEndOfQueueSubCause,t.oneofs&&(r.subcause="dangerousEndOfQueueSubCause")),null!=e.vehicleBreakdownSubCause&&e.hasOwnProperty("vehicleBreakdownSubCause")&&(r.vehicleBreakdownSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.VehicleBreakdownSubCauseCode[e.vehicleBreakdownSubCause]:e.vehicleBreakdownSubCause,t.oneofs&&(r.subcause="vehicleBreakdownSubCause")),null!=e.postCrashSubCause&&e.hasOwnProperty("postCrashSubCause")&&(r.postCrashSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.PostCrashSubCauseCode[e.postCrashSubCause]:e.postCrashSubCause,t.oneofs&&(r.subcause="postCrashSubCause")),null!=e.humanProblemSubCause&&e.hasOwnProperty("humanProblemSubCause")&&(r.humanProblemSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.HumanProblemSubCauseCode[e.humanProblemSubCause]:e.humanProblemSubCause,t.oneofs&&(r.subcause="humanProblemSubCause")),null!=e.stationaryVehicleSubCause&&e.hasOwnProperty("stationaryVehicleSubCause")&&(r.stationaryVehicleSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.StationaryVehicleSubCauseCode[e.stationaryVehicleSubCause]:e.stationaryVehicleSubCause,t.oneofs&&(r.subcause="stationaryVehicleSubCause")),null!=e.emergencyVehicleApproachingSubCause&&e.hasOwnProperty("emergencyVehicleApproachingSubCause")&&(r.emergencyVehicleApproachingSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.EmergencyVehicleApproachingSubCauseCode[e.emergencyVehicleApproachingSubCause]:e.emergencyVehicleApproachingSubCause,t.oneofs&&(r.subcause="emergencyVehicleApproachingSubCause")),null!=e.hazardousLocation_DangerousCurveSubCause&&e.hasOwnProperty("hazardousLocation_DangerousCurveSubCause")&&(r.hazardousLocation_DangerousCurveSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.HazardousLocation_DangerousCurveSubCauseCode[e.hazardousLocation_DangerousCurveSubCause]:e.hazardousLocation_DangerousCurveSubCause,t.oneofs&&(r.subcause="hazardousLocation_DangerousCurveSubCause")),null!=e.collisionRiskSubCause&&e.hasOwnProperty("collisionRiskSubCause")&&(r.collisionRiskSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.CollisionRiskSubCauseCode[e.collisionRiskSubCause]:e.collisionRiskSubCause,t.oneofs&&(r.subcause="collisionRiskSubCause")),null!=e.signalViolationSubCauseCodeSubCause&&e.hasOwnProperty("signalViolationSubCauseCodeSubCause")&&(r.signalViolationSubCauseCodeSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.SignalViolationSubCauseCode[e.signalViolationSubCauseCodeSubCause]:e.signalViolationSubCauseCodeSubCause,t.oneofs&&(r.subcause="signalViolationSubCauseCodeSubCause")),null!=e.dangerousSituationSubCause&&e.hasOwnProperty("dangerousSituationSubCause")&&(r.dangerousSituationSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.DangerousSituationSubCauseCode[e.dangerousSituationSubCause]:e.dangerousSituationSubCause,t.oneofs&&(r.subcause="dangerousSituationSubCause")),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.TrafficConditionSubCauseEnum=function(){var e={},t=Object.create(e);return t[e[0]="unavailableTrafficConditionSubCause"]=0,t[e[1]="increasedVolumeOfTraffic"]=1,t[e[2]="trafficJamSlowlyIncreasing"]=2,t[e[3]="trafficJamIncreasing"]=3,t[e[4]="trafficJamStronglyIncreasing"]=4,t[e[5]="trafficStationary"]=5,t[e[6]="trafficJamSlightlyDecreasing"]=6,t[e[7]="trafficJamDecreasing"]=7,t[e[8]="trafficJamStronglyDecreasing"]=8,t}(),e.AccidentSubCauseEnum=function(){var e={},t=Object.create(e);return t[e[0]="unavailableAccidentSubCause"]=0,t[e[1]="multiVehicleAccident"]=1,t[e[2]="heavyAccident"]=2,t[e[3]="accidentInvolvingLorry"]=3,t[e[4]="accidentInvolvingBus"]=4,t[e[5]="accidentInvolvingHazardousMaterials"]=5,t[e[6]="accidentOnOppositeLane"]=6,t[e[7]="unsecuredAccident"]=7,t[e[8]="assistanceRequested"]=8,t}(),e.RoadworksSubCauseEnum=function(){var e={},t=Object.create(e);return t[e[0]="unavailableRoadworksSubCause"]=0,t[e[1]="majorRoadWorks"]=1,t[e[2]="roadMarkingWork"]=2,t[e[3]="slowMovingRoadMaintenance"]=3,t[e[4]="shortTermStationaryRoadworks"]=4,t[e[5]="streetCleaning"]=5,t[e[6]="winterService"]=6,t}(),e.AdverseWeatherCondition_AdhesionSubCauseEnum=function(){var e={},t=Object.create(e);return t[e[0]="unavailableAdverseWeatherCondition_AdhesionSubCause"]=0,t[e[1]="heavyFrostOnRoad"]=1,t[e[2]="fuelOnRoad"]=2,t[e[3]="mudOnRoad"]=3,t[e[4]="snowOnRoad"]=4,t[e[5]="iceOnRoad"]=5,t[e[6]="blackIceOnRoad"]=6,t[e[7]="oilOnRoad"]=7,t[e[8]="looseChippings"]=8,t[e[9]="instantBlackIce"]=9,t[e[10]="roadsSalted"]=10,t}(),e.HazardousLocation_SurfaceConditionSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableHazardousLocation_SurfaceConditionSubCause"]=0,t[e[1]="rockfalls"]=1,t[e[2]="earthquakeDamage"]=2,t[e[3]="sewerCollapse"]=3,t[e[4]="subsidence"]=4,t[e[5]="snowDrifts"]=5,t[e[6]="stormDamage"]=6,t[e[7]="burstPipe"]=7,t[e[8]="volcanoEruption"]=8,t[e[9]="fallingIce"]=9,t}(),e.HazardousLocation_ObstacleOnTheRoadSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableHazardousLocation_ObstacleOnTheRoadSubCause"]=0,t[e[1]="shedload"]=1,t[e[2]="partsOfVehicles"]=2,t[e[3]="partsOfTyres"]=3,t[e[4]="bigObjects"]=4,t[e[5]="fallenTrees"]=5,t[e[6]="hubCaps"]=6,t[e[7]="waitingVehicles"]=7,t}(),e.HazardousLocation_AnimalOnTheRoadSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableHazardousLocation_AnimalOnTheRoadSubCause"]=0,t[e[1]="wildAnimals"]=1,t[e[2]="herdOfAnimals"]=2,t[e[3]="smallAnimals"]=3,t[e[4]="largeAnimals"]=4,t}(),e.HumanPresenceOnTheRoadSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableHumanPresenceOnTheRoadSubCause"]=0,t[e[1]="childrenOnRoadway"]=1,t[e[2]="cyclistOnRoadway"]=2,t[e[3]="motorcyclistOnRoadway"]=3,t}(),e.WrongWayDrivingSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableWrongWayDrivingSubCause"]=0,t[e[1]="wrongLane"]=1,t[e[2]="wrongDirection"]=2,t}(),e.RescueAndRecoveryWorkInProgressSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableRescueAndRecoveryWorkInProgressSubCause"]=0,t[e[1]="emergencyVehicles"]=1,t[e[2]="rescueHelicopterLanding"]=2,t[e[3]="policeActivityOngoing"]=3,t[e[4]="medicalEmergencyOngoing"]=4,t[e[5]="childAbductionInProgress"]=5,t}(),e.AdverseWeatherCondition_ExtremeWeatherConditionSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableAdverseWeatherCondition_ExtremeWeatherConditionSubCause"]=0,t[e[1]="strongWinds"]=1,t[e[2]="damagingHail"]=2,t[e[3]="hurricane"]=3,t[e[4]="thunderstorm"]=4,t[e[5]="tornado"]=5,t[e[6]="blizzard"]=6,t}(),e.AdverseWeatherCondition_VisibilitySubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableAdverseWeatherCondition_VisibilitySubCause"]=0,t[e[1]="fog"]=1,t[e[2]="smoke"]=2,t[e[3]="heavySnowFallVisibility"]=3,t[e[4]="heavyRainVisibility"]=4,t[e[5]="heavyHail"]=5,t[e[6]="lowSunGlare"]=6,t[e[7]="sandstorms"]=7,t[e[8]="swarmsOfInsects"]=8,t}(),e.AdverseWeatherCondition_PrecipitationSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableAdverseWeatherCondition_PrecipitationSubCause"]=0,t[e[1]="heavyRainPrecipitation"]=1,t[e[2]="heavySnowFallPrecipitation"]=2,t[e[3]="softHail"]=3,t}(),e.SlowVehicleSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableSlowVehicleSubCause"]=0,t[e[1]="maintenanceVehicle"]=1,t[e[2]="vehiclesSlowingToLookAtAccident"]=2,t[e[3]="abnormalLoad"]=3,t[e[4]="abnormalWideLoad"]=4,t[e[5]="convoy"]=5,t[e[6]="snowplough"]=6,t[e[7]="deicing"]=7,t[e[8]="saltingVehicles"]=8,t}(),e.DangerousEndOfQueueSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableDangerousEndOfQueueSubCause"]=0,t[e[1]="suddenEndOfQueue"]=1,t[e[2]="queueOverHill"]=2,t[e[3]="queueAroundBend"]=3,t[e[4]="queueInTunnel"]=4,t}(),e.VehicleBreakdownSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableVehicleBreakdownSubCause"]=0,t[e[1]="lackOfFuel"]=1,t[e[2]="lackOfBatteryPower"]=2,t[e[3]="engineProblem"]=3,t[e[4]="transmissionProblem"]=4,t[e[5]="engineCoolingProblem"]=5,t[e[6]="brakingSystemProblem"]=6,t[e[7]="steeringProblem"]=7,t[e[8]="tyrePuncture"]=8,t}(),e.PostCrashSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailablePostCrashSubCause"]=0,t[e[1]="accidentWithoutECallTriggered"]=1,t[e[2]="accidentWithECallManuallyTriggered"]=2,t[e[3]="accidentWithECallAutomaticallyTriggered"]=3,t[e[4]="accidentWithECallTriggeredWithoutAccessToCellularNetwork"]=4,t}(),e.HumanProblemSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableHumanProblemSubCause"]=0,t[e[1]="glycemiaProblem"]=1,t[e[2]="heartProblem"]=2,t}(),e.StationaryVehicleSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableStationaryVehicleSubCause"]=0,t[e[1]="humanProblem"]=1,t[e[2]="vehicleBreakdown"]=2,t[e[3]="postCrash"]=3,t[e[4]="publicTransportStop"]=4,t[e[5]="carryingDangerousGoods"]=5,t}(),e.EmergencyVehicleApproachingSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableEmergencyVehicleApproachingSubCause"]=0,t[e[1]="emergencyVehicleApproaching"]=1,t[e[2]="prioritizedVehicleApproaching"]=2,t}(),e.HazardousLocation_DangerousCurveSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableHazardousLocation_DangerousCurveSubCause"]=0,t[e[1]="dangerousLeftTurnCurve"]=1,t[e[2]="dangerousRightTurnCurve"]=2,t[e[3]="multipleCurvesStartingWithUnknownTurningDirection"]=3,t[e[4]="multipleCurvesStartingWithLeftTurn"]=4,t[e[5]="multipleCurvesStartingWithRightTurn"]=5,t}(),e.CollisionRiskSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableCollisionRiskSubCause"]=0,t[e[1]="longitudinalCollisionRisk"]=1,t[e[2]="crossingCollisionRisk"]=2,t[e[3]="lateralCollisionRisk"]=3,t[e[4]="vulnerableRoadUser"]=4,t}(),e.SignalViolationSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableSignalViolationSubCauseCodeSubCause"]=0,t[e[1]="stopSignViolation"]=1,t[e[2]="trafficLightViolation"]=2,t[e[3]="turningRegulationViolation"]=3,t}(),e.DangerousSituationSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableDangerousSituationSubCause"]=0,t[e[1]="emergencyElectronicBrakeEngaged"]=1,t[e[2]="preCrashSystemEngaged"]=2,t[e[3]="espEngaged"]=3,t[e[4]="absEngaged"]=4,t[e[5]="aebEngaged"]=5,t[e[6]="brakeWarningEngaged"]=6,t[e[7]="collisionRiskWarningEngaged"]=7,t}(),e}(),o.SpecificObservedEvent=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.cause=1,e.prototype.subcause=null,e.prototype.relevanceTrafficDirection=0,e.prototype.relevanceEventReference=0,e.prototype.relevanceDistance=0,e.prototype.eventTimeToLive=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.specificObservedEventConfidence_percent=0,e.prototype.negotiationFlag=0,e.prototype.eventID="",e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.SpecificObservedEvent;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.int64();break;case 2:i.cause=e.int32();break;case 3:i.subcause=d.sdii.here.pb.SpecificObservedEventSubCauseEnum.decode(e,e.uint32());break;case 4:i.relevanceTrafficDirection=e.int32();break;case 5:i.relevanceEventReference=e.int32();break;case 6:i.relevanceDistance=e.int32();break;case 7:i.eventTimeToLive=e.int64();break;case 8:i.specificObservedEventConfidence_percent=e.int32();break;case 9:i.negotiationFlag=e.int32();break;case 10:i.eventID=e.string();break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.SpecificObservedEvent)return e;var t=new d.sdii.here.pb.SpecificObservedEvent;switch(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),e.cause){case"trafficCondition":case 1:t.cause=1;break;case"accident":case 2:t.cause=2;break;case"roadWorks":case 3:t.cause=3;break;case"adverseWeatherCondition_Adhesion":case 6:t.cause=6;break;case"hazardousLocation_SurfaceCondition":case 9:t.cause=9;break;case"hazardousLocation_ObstacleOnTheRoad":case 10:t.cause=10;break;case"hazardousLocation_AnimalOnTheRoad":case 11:t.cause=11;break;case"humanPresenceOnTheRoad":case 12:t.cause=12;break;case"wrongWayDriving":case 14:t.cause=14;break;case"rescueAndRecoveryWorkInProgress":case 15:t.cause=15;break;case"adverseWeatherCondition_ExtremeWeatherCondition":case 17:t.cause=17;break;case"adverseWeatherCondition_Visibility":case 18:t.cause=18;break;case"adverseWeatherCondition_Precipitation":case 19:t.cause=19;break;case"slowVehicle":case 26:t.cause=26;break;case"dangerousEndOfQueue":case 27:t.cause=27;break;case"vehicleBreakdown":case 91:t.cause=91;break;case"postCrash":case 92:t.cause=92;break;case"humanProblem":case 93:t.cause=93;break;case"stationaryVehicle":case 94:t.cause=94;break;case"emergencyVehicleApproaching":case 95:t.cause=95;break;case"hazardousLocation_DangerousCurve":case 96:t.cause=96;break;case"collisionRisk":case 97:t.cause=97;break;case"signalViolation":case 98:t.cause=98;break;case"dangerousSituation":case 99:t.cause=99}if(null!=e.subcause){if("object"!=typeof e.subcause)throw TypeError(".sdii.here.pb.SpecificObservedEvent.subcause: object expected");t.subcause=d.sdii.here.pb.SpecificObservedEventSubCauseEnum.fromObject(e.subcause)}switch(e.relevanceTrafficDirection){case"allTrafficDirections":case 0:t.relevanceTrafficDirection=0;break;case"sameTraffic":case 1:t.relevanceTrafficDirection=1;break;case"oppositeTraffic":case 2:t.relevanceTrafficDirection=2}switch(e.relevanceEventReference){case"allStreamsTraffic":case 0:t.relevanceEventReference=0;break;case"upStreamTraffic":case 1:t.relevanceEventReference=1;break;case"downStreamTraffic":case 2:t.relevanceEventReference=2}switch(e.relevanceDistance){case"lessThan50M":case 0:t.relevanceDistance=0;break;case"lessThan100M":case 1:t.relevanceDistance=1;break;case"lessThan200M":case 2:t.relevanceDistance=2;break;case"lessThan500M":case 3:t.relevanceDistance=3;break;case"lessThan1000M":case 4:t.relevanceDistance=4;break;case"lessThan5KM":case 5:t.relevanceDistance=5;break;case"lessThan10KM":case 6:t.relevanceDistance=6;break;case"over10KM":case 7:t.relevanceDistance=7}switch(null!=e.eventTimeToLive&&(u.Long?(t.eventTimeToLive=u.Long.fromValue(e.eventTimeToLive)).unsigned=!1:"string"==typeof e.eventTimeToLive?t.eventTimeToLive=parseInt(e.eventTimeToLive,10):"number"==typeof e.eventTimeToLive?t.eventTimeToLive=e.eventTimeToLive:"object"==typeof e.eventTimeToLive&&(t.eventTimeToLive=new u.LongBits(e.eventTimeToLive.low>>>0,e.eventTimeToLive.high>>>0).toNumber())),null!=e.specificObservedEventConfidence_percent&&(t.specificObservedEventConfidence_percent=0|e.specificObservedEventConfidence_percent),e.negotiationFlag){case"NEGOTIATION_TYPE_UNDEFINED":case 0:t.negotiationFlag=0;break;case"NEGOTIATION_TYPE_SUPPORT":case 1:t.negotiationFlag=1;break;case"NEGOTIATION_TYPE_CONTRADICT":case 2:t.negotiationFlag=2;break;case"NEGOTIATION_TYPE_CANCEL":case 3:t.negotiationFlag=3}if(null!=e.eventID&&(t.eventID=String(e.eventID)),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.SpecificObservedEvent.extensionContainer: array expected");t.extensionContainer=[];for(var r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.SpecificObservedEvent.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.extensionContainer=[]),t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timeStampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timeStampUTC_ms=t.longs===String?"0":0;r.cause=t.enums===String?"trafficCondition":1,r.subcause=null,r.relevanceTrafficDirection=t.enums===String?"allTrafficDirections":0,r.relevanceEventReference=t.enums===String?"allStreamsTraffic":0,r.relevanceDistance=t.enums===String?"lessThan50M":0,u.Long?(i=new u.Long(0,0,!1),r.eventTimeToLive=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.eventTimeToLive=t.longs===String?"0":0,r.specificObservedEventConfidence_percent=0,r.negotiationFlag=t.enums===String?"NEGOTIATION_TYPE_UNDEFINED":0,r.eventID=""}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?r.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:r.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.cause&&e.hasOwnProperty("cause")&&(r.cause=t.enums===String?d.sdii.here.pb.SpecificObservedEvent.SpecificObservedEventCauseEnum[e.cause]:e.cause),null!=e.subcause&&e.hasOwnProperty("subcause")&&(r.subcause=d.sdii.here.pb.SpecificObservedEventSubCauseEnum.toObject(e.subcause,t)),null!=e.relevanceTrafficDirection&&e.hasOwnProperty("relevanceTrafficDirection")&&(r.relevanceTrafficDirection=t.enums===String?d.sdii.here.pb.SpecificObservedEvent.RelevanceTrafficDirectionEnum[e.relevanceTrafficDirection]:e.relevanceTrafficDirection),null!=e.relevanceEventReference&&e.hasOwnProperty("relevanceEventReference")&&(r.relevanceEventReference=t.enums===String?d.sdii.here.pb.SpecificObservedEvent.RelevanceEventReferenceEnum[e.relevanceEventReference]:e.relevanceEventReference),null!=e.relevanceDistance&&e.hasOwnProperty("relevanceDistance")&&(r.relevanceDistance=t.enums===String?d.sdii.here.pb.SpecificObservedEvent.RelevanceDistance[e.relevanceDistance]:e.relevanceDistance),null!=e.eventTimeToLive&&e.hasOwnProperty("eventTimeToLive")&&("number"==typeof e.eventTimeToLive?r.eventTimeToLive=t.longs===String?String(e.eventTimeToLive):e.eventTimeToLive:r.eventTimeToLive=t.longs===String?u.Long.prototype.toString.call(e.eventTimeToLive):t.longs===Number?new u.LongBits(e.eventTimeToLive.low>>>0,e.eventTimeToLive.high>>>0).toNumber():e.eventTimeToLive),null!=e.specificObservedEventConfidence_percent&&e.hasOwnProperty("specificObservedEventConfidence_percent")&&(r.specificObservedEventConfidence_percent=e.specificObservedEventConfidence_percent),null!=e.negotiationFlag&&e.hasOwnProperty("negotiationFlag")&&(r.negotiationFlag=t.enums===String?d.sdii.here.pb.SpecificObservedEvent.NegotiationTypeEnum[e.negotiationFlag]:e.negotiationFlag),null!=e.eventID&&e.hasOwnProperty("eventID")&&(r.eventID=e.eventID),e.extensionContainer&&e.extensionContainer.length){r.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.SpecificObservedEventCauseEnum=function(){var e={},t=Object.create(e);return t[e[1]="trafficCondition"]=1,t[e[2]="accident"]=2,t[e[3]="roadWorks"]=3,t[e[6]="adverseWeatherCondition_Adhesion"]=6,t[e[9]="hazardousLocation_SurfaceCondition"]=9,t[e[10]="hazardousLocation_ObstacleOnTheRoad"]=10,t[e[11]="hazardousLocation_AnimalOnTheRoad"]=11,t[e[12]="humanPresenceOnTheRoad"]=12,t[e[14]="wrongWayDriving"]=14,t[e[15]="rescueAndRecoveryWorkInProgress"]=15,t[e[17]="adverseWeatherCondition_ExtremeWeatherCondition"]=17,t[e[18]="adverseWeatherCondition_Visibility"]=18,t[e[19]="adverseWeatherCondition_Precipitation"]=19,t[e[26]="slowVehicle"]=26,t[e[27]="dangerousEndOfQueue"]=27,t[e[91]="vehicleBreakdown"]=91,t[e[92]="postCrash"]=92,t[e[93]="humanProblem"]=93,t[e[94]="stationaryVehicle"]=94,t[e[95]="emergencyVehicleApproaching"]=95,t[e[96]="hazardousLocation_DangerousCurve"]=96,t[e[97]="collisionRisk"]=97,t[e[98]="signalViolation"]=98,t[e[99]="dangerousSituation"]=99,t}(),e.RelevanceTrafficDirectionEnum=function(){var e={},t=Object.create(e);return t[e[0]="allTrafficDirections"]=0,t[e[1]="sameTraffic"]=1,t[e[2]="oppositeTraffic"]=2,t}(),e.RelevanceEventReferenceEnum=function(){var e={},t=Object.create(e);return t[e[0]="allStreamsTraffic"]=0,t[e[1]="upStreamTraffic"]=1,t[e[2]="downStreamTraffic"]=2,t}(),e.RelevanceDistance=function(){var e={},t=Object.create(e);return t[e[0]="lessThan50M"]=0,t[e[1]="lessThan100M"]=1,t[e[2]="lessThan200M"]=2,t[e[3]="lessThan500M"]=3,t[e[4]="lessThan1000M"]=4,t[e[5]="lessThan5KM"]=5,t[e[6]="lessThan10KM"]=6,t[e[7]="over10KM"]=7,t}(),e.NegotiationTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="NEGOTIATION_TYPE_UNDEFINED"]=0,t[e[1]="NEGOTIATION_TYPE_SUPPORT"]=1,t[e[2]="NEGOTIATION_TYPE_CONTRADICT"]=2,t[e[3]="NEGOTIATION_TYPE_CANCEL"]=3,t}(),e}(),o.RoadCondition=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.roadRoughnessSegmentLevel=0,e.prototype.roadRoughnessSegmentDuration_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.roadRoughnessSegmentLength_m=0,e.prototype.roadRoughnessLocalEvent=!1,e.prototype.roadRoughnessLateralPosition=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.RoadCondition;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.int64();break;case 2:i.roadRoughnessSegmentLevel=e.int32();break;case 3:i.roadRoughnessSegmentDuration_ms=e.int64();break;case 4:i.roadRoughnessSegmentLength_m=e.int32();break;case 5:i.roadRoughnessLocalEvent=e.bool();break;case 6:i.roadRoughnessLateralPosition=e.int32();break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.RoadCondition)return e;var t=new d.sdii.here.pb.RoadCondition;switch(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),null!=e.roadRoughnessSegmentLevel&&(t.roadRoughnessSegmentLevel=0|e.roadRoughnessSegmentLevel),null!=e.roadRoughnessSegmentDuration_ms&&(u.Long?(t.roadRoughnessSegmentDuration_ms=u.Long.fromValue(e.roadRoughnessSegmentDuration_ms)).unsigned=!1:"string"==typeof e.roadRoughnessSegmentDuration_ms?t.roadRoughnessSegmentDuration_ms=parseInt(e.roadRoughnessSegmentDuration_ms,10):"number"==typeof e.roadRoughnessSegmentDuration_ms?t.roadRoughnessSegmentDuration_ms=e.roadRoughnessSegmentDuration_ms:"object"==typeof e.roadRoughnessSegmentDuration_ms&&(t.roadRoughnessSegmentDuration_ms=new u.LongBits(e.roadRoughnessSegmentDuration_ms.low>>>0,e.roadRoughnessSegmentDuration_ms.high>>>0).toNumber())),null!=e.roadRoughnessSegmentLength_m&&(t.roadRoughnessSegmentLength_m=0|e.roadRoughnessSegmentLength_m),null!=e.roadRoughnessLocalEvent&&(t.roadRoughnessLocalEvent=Boolean(e.roadRoughnessLocalEvent)),e.roadRoughnessLateralPosition){case"bothSidesOfVehicle":case 0:t.roadRoughnessLateralPosition=0;break;case"leftSideOfVehicle":case 1:t.roadRoughnessLateralPosition=1;break;case"rightSideOfVehicle":case 2:t.roadRoughnessLateralPosition=2}if(e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.RoadCondition.extensionContainer: array expected");t.extensionContainer=[];for(var r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.RoadCondition.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.extensionContainer=[]),t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timeStampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timeStampUTC_ms=t.longs===String?"0":0;r.roadRoughnessSegmentLevel=0,u.Long?(i=new u.Long(0,0,!1),r.roadRoughnessSegmentDuration_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.roadRoughnessSegmentDuration_ms=t.longs===String?"0":0,r.roadRoughnessSegmentLength_m=0,r.roadRoughnessLocalEvent=!1,r.roadRoughnessLateralPosition=t.enums===String?"bothSidesOfVehicle":0}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?r.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:r.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.roadRoughnessSegmentLevel&&e.hasOwnProperty("roadRoughnessSegmentLevel")&&(r.roadRoughnessSegmentLevel=e.roadRoughnessSegmentLevel),null!=e.roadRoughnessSegmentDuration_ms&&e.hasOwnProperty("roadRoughnessSegmentDuration_ms")&&("number"==typeof e.roadRoughnessSegmentDuration_ms?r.roadRoughnessSegmentDuration_ms=t.longs===String?String(e.roadRoughnessSegmentDuration_ms):e.roadRoughnessSegmentDuration_ms:r.roadRoughnessSegmentDuration_ms=t.longs===String?u.Long.prototype.toString.call(e.roadRoughnessSegmentDuration_ms):t.longs===Number?new u.LongBits(e.roadRoughnessSegmentDuration_ms.low>>>0,e.roadRoughnessSegmentDuration_ms.high>>>0).toNumber():e.roadRoughnessSegmentDuration_ms),null!=e.roadRoughnessSegmentLength_m&&e.hasOwnProperty("roadRoughnessSegmentLength_m")&&(r.roadRoughnessSegmentLength_m=e.roadRoughnessSegmentLength_m),null!=e.roadRoughnessLocalEvent&&e.hasOwnProperty("roadRoughnessLocalEvent")&&(r.roadRoughnessLocalEvent=e.roadRoughnessLocalEvent),null!=e.roadRoughnessLateralPosition&&e.hasOwnProperty("roadRoughnessLateralPosition")&&(r.roadRoughnessLateralPosition=t.enums===String?d.sdii.here.pb.RoadCondition.RoadRoughnessLateralPositionEnum[e.roadRoughnessLateralPosition]:e.roadRoughnessLateralPosition),e.extensionContainer&&e.extensionContainer.length){r.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.RoadRoughnessLateralPositionEnum=function(){var e={},t=Object.create(e);return t[e[0]="bothSidesOfVehicle"]=0,t[e[1]="leftSideOfVehicle"]=1,t[e[2]="rightSideOfVehicle"]=2,t}(),e}(),o.RoadBoundaryRecognition=function(){function e(e){if(this.positionOffset=[],this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.positionOffset=u.emptyArray,e.prototype.roadBoundaryType=0,e.prototype.roadBoundaryRecognitionType=0,e.prototype.roadBoundaryChangeType=0,e.prototype.detectedObjectID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.RoadBoundaryRecognition;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.int64();break;case 2:i.positionOffset&&i.positionOffset.length||(i.positionOffset=[]),i.positionOffset.push(d.sdii.here.pb.PositionOffset.decode(e,e.uint32()));break;case 3:i.roadBoundaryType=e.int32();break;case 4:i.roadBoundaryRecognitionType=e.int32();break;case 5:i.roadBoundaryChangeType=e.int32();break;case 6:i.detectedObjectID=e.int64();break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.RoadBoundaryRecognition)return e;var t=new d.sdii.here.pb.RoadBoundaryRecognition;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),e.positionOffset){if(!Array.isArray(e.positionOffset))throw TypeError(".sdii.here.pb.RoadBoundaryRecognition.positionOffset: array expected");t.positionOffset=[];for(var r=0;r<e.positionOffset.length;++r){if("object"!=typeof e.positionOffset[r])throw TypeError(".sdii.here.pb.RoadBoundaryRecognition.positionOffset: object expected");t.positionOffset[r]=d.sdii.here.pb.PositionOffset.fromObject(e.positionOffset[r])}}switch(e.roadBoundaryType){case"ROAD_BOUNDARY_TYPE_UNDEFINED":case 0:t.roadBoundaryType=0;break;case"GENERAL_UNPASSABLE":case 1:t.roadBoundaryType=1;break;case"GENERAL_PASSABLE":case 2:t.roadBoundaryType=2;break;case"PASSABLE_FREESPACE":case 3:t.roadBoundaryType=3;break;case"PASSABLE_GREENFIELD":case 4:t.roadBoundaryType=4;break;case"PASSABLE_PAVEMENT":case 5:t.roadBoundaryType=5;break;case"UNPASSABLE_WALL":case 6:t.roadBoundaryType=6;break;case"UNPASSABLE_GUARDRAIL":case 7:t.roadBoundaryType=7;break;case"UNPASSABLE_DIVIDER":case 8:t.roadBoundaryType=8;break;case"UNPASSABLE_CURBSTONE":case 9:t.roadBoundaryType=9;break;case"UNPASSABLE_PARKINGVEHICLE":case 10:t.roadBoundaryType=10;break;case"UNPASSABLE_PARKINGVEHICLE_DIAGONAL":case 11:t.roadBoundaryType=11;break;case"PASSABLE_FREEPARKINGSPACE":case 12:t.roadBoundaryType=12}switch(e.roadBoundaryRecognitionType){case"ROAD_BOUNDARY_UNDEFINED":case 0:t.roadBoundaryRecognitionType=0;break;case"ROAD_BOUNDARY_DETECTED":case 1:t.roadBoundaryRecognitionType=1;break;case"ROAD_BOUNDARY_NOT_DETECTED":case 2:t.roadBoundaryRecognitionType=2}switch(e.roadBoundaryChangeType){case"ROAD_BOUNDARY_CHANGE_UNDEFINED":case 0:t.roadBoundaryChangeType=0;break;case"ROAD_BOUNDARY_START":case 1:t.roadBoundaryChangeType=1;break;case"ROAD_BOUNDARY_END":case 2:t.roadBoundaryChangeType=2}if(null!=e.detectedObjectID&&(u.Long?(t.detectedObjectID=u.Long.fromValue(e.detectedObjectID)).unsigned=!1:"string"==typeof e.detectedObjectID?t.detectedObjectID=parseInt(e.detectedObjectID,10):"number"==typeof e.detectedObjectID?t.detectedObjectID=e.detectedObjectID:"object"==typeof e.detectedObjectID&&(t.detectedObjectID=new u.LongBits(e.detectedObjectID.low>>>0,e.detectedObjectID.high>>>0).toNumber())),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.RoadBoundaryRecognition.extensionContainer: array expected");for(t.extensionContainer=[],r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.RoadBoundaryRecognition.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.positionOffset=[],r.extensionContainer=[]),t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timeStampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timeStampUTC_ms=t.longs===String?"0":0;r.roadBoundaryType=t.enums===String?"ROAD_BOUNDARY_TYPE_UNDEFINED":0,r.roadBoundaryRecognitionType=t.enums===String?"ROAD_BOUNDARY_UNDEFINED":0,r.roadBoundaryChangeType=t.enums===String?"ROAD_BOUNDARY_CHANGE_UNDEFINED":0,u.Long?(i=new u.Long(0,0,!1),r.detectedObjectID=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.detectedObjectID=t.longs===String?"0":0}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?r.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:r.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),e.positionOffset&&e.positionOffset.length){r.positionOffset=[];for(var n=0;n<e.positionOffset.length;++n)r.positionOffset[n]=d.sdii.here.pb.PositionOffset.toObject(e.positionOffset[n],t)}if(null!=e.roadBoundaryType&&e.hasOwnProperty("roadBoundaryType")&&(r.roadBoundaryType=t.enums===String?d.sdii.here.pb.RoadBoundaryRecognition.RoadBoundaryTypeEnum[e.roadBoundaryType]:e.roadBoundaryType),null!=e.roadBoundaryRecognitionType&&e.hasOwnProperty("roadBoundaryRecognitionType")&&(r.roadBoundaryRecognitionType=t.enums===String?d.sdii.here.pb.RoadBoundaryRecognition.RoadBoundaryRecognitionTypeEnum[e.roadBoundaryRecognitionType]:e.roadBoundaryRecognitionType),null!=e.roadBoundaryChangeType&&e.hasOwnProperty("roadBoundaryChangeType")&&(r.roadBoundaryChangeType=t.enums===String?d.sdii.here.pb.RoadBoundaryRecognition.RoadBoundaryChangeTypeEnum[e.roadBoundaryChangeType]:e.roadBoundaryChangeType),null!=e.detectedObjectID&&e.hasOwnProperty("detectedObjectID")&&("number"==typeof e.detectedObjectID?r.detectedObjectID=t.longs===String?String(e.detectedObjectID):e.detectedObjectID:r.detectedObjectID=t.longs===String?u.Long.prototype.toString.call(e.detectedObjectID):t.longs===Number?new u.LongBits(e.detectedObjectID.low>>>0,e.detectedObjectID.high>>>0).toNumber():e.detectedObjectID),e.extensionContainer&&e.extensionContainer.length)for(r.extensionContainer=[],n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t);return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.RoadBoundaryTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_BOUNDARY_TYPE_UNDEFINED"]=0,t[e[1]="GENERAL_UNPASSABLE"]=1,t[e[2]="GENERAL_PASSABLE"]=2,t[e[3]="PASSABLE_FREESPACE"]=3,t[e[4]="PASSABLE_GREENFIELD"]=4,t[e[5]="PASSABLE_PAVEMENT"]=5,t[e[6]="UNPASSABLE_WALL"]=6,t[e[7]="UNPASSABLE_GUARDRAIL"]=7,t[e[8]="UNPASSABLE_DIVIDER"]=8,t[e[9]="UNPASSABLE_CURBSTONE"]=9,t[e[10]="UNPASSABLE_PARKINGVEHICLE"]=10,t[e[11]="UNPASSABLE_PARKINGVEHICLE_DIAGONAL"]=11,t[e[12]="PASSABLE_FREEPARKINGSPACE"]=12,t}(),e.RoadBoundaryRecognitionTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_BOUNDARY_UNDEFINED"]=0,t[e[1]="ROAD_BOUNDARY_DETECTED"]=1,t[e[2]="ROAD_BOUNDARY_NOT_DETECTED"]=2,t}(),e.RoadBoundaryChangeTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_BOUNDARY_CHANGE_UNDEFINED"]=0,t[e[1]="ROAD_BOUNDARY_START"]=1,t[e[2]="ROAD_BOUNDARY_END"]=2,t}(),e}(),o.VehicleManeuverEvent=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.vehicleManeuverType=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.VehicleManeuverEvent;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timestampUTC_ms=e.int64();break;case 2:i.vehicleManeuverType=e.int32();break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timestampUTC_ms"))throw u.ProtocolError("missing required 'timestampUTC_ms'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.VehicleManeuverEvent)return e;var t=new d.sdii.here.pb.VehicleManeuverEvent;switch(null!=e.timestampUTC_ms&&(u.Long?(t.timestampUTC_ms=u.Long.fromValue(e.timestampUTC_ms)).unsigned=!1:"string"==typeof e.timestampUTC_ms?t.timestampUTC_ms=parseInt(e.timestampUTC_ms,10):"number"==typeof e.timestampUTC_ms?t.timestampUTC_ms=e.timestampUTC_ms:"object"==typeof e.timestampUTC_ms&&(t.timestampUTC_ms=new u.LongBits(e.timestampUTC_ms.low>>>0,e.timestampUTC_ms.high>>>0).toNumber())),e.vehicleManeuverType){case"VEHICLE_MANEUVER_TYPE_UNDEFINED":case 0:t.vehicleManeuverType=0;break;case"LANE_CHANGE":case 1:t.vehicleManeuverType=1;break;case"LANE_CHANGE_RIGHT":case 2:t.vehicleManeuverType=2;break;case"LANE_CHANGE_LEFT":case 3:t.vehicleManeuverType=3;break;case"PARKED_IN":case 11:t.vehicleManeuverType=11;break;case"PARKED_IN_LATERAL":case 12:t.vehicleManeuverType=12;break;case"PARKED_IN_DIAGONAL":case 13:t.vehicleManeuverType=13;break;case"PARKED_IN_LONGITUDINAL":case 14:t.vehicleManeuverType=14;break;case"PARKED_OUT":case 15:t.vehicleManeuverType=15}if(e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.VehicleManeuverEvent.extensionContainer: array expected");t.extensionContainer=[];for(var r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.VehicleManeuverEvent.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.extensionContainer=[]),t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timestampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timestampUTC_ms=t.longs===String?"0":0;r.vehicleManeuverType=t.enums===String?"VEHICLE_MANEUVER_TYPE_UNDEFINED":0}if(null!=e.timestampUTC_ms&&e.hasOwnProperty("timestampUTC_ms")&&("number"==typeof e.timestampUTC_ms?r.timestampUTC_ms=t.longs===String?String(e.timestampUTC_ms):e.timestampUTC_ms:r.timestampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timestampUTC_ms):t.longs===Number?new u.LongBits(e.timestampUTC_ms.low>>>0,e.timestampUTC_ms.high>>>0).toNumber():e.timestampUTC_ms),null!=e.vehicleManeuverType&&e.hasOwnProperty("vehicleManeuverType")&&(r.vehicleManeuverType=t.enums===String?d.sdii.here.pb.VehicleManeuverEvent.VehicleManeuverTypeEvent[e.vehicleManeuverType]:e.vehicleManeuverType),e.extensionContainer&&e.extensionContainer.length){r.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.VehicleManeuverTypeEvent=function(){var e={},t=Object.create(e);return t[e[0]="VEHICLE_MANEUVER_TYPE_UNDEFINED"]=0,t[e[1]="LANE_CHANGE"]=1,t[e[2]="LANE_CHANGE_RIGHT"]=2,t[e[3]="LANE_CHANGE_LEFT"]=3,t[e[11]="PARKED_IN"]=11,t[e[12]="PARKED_IN_LATERAL"]=12,t[e[13]="PARKED_IN_DIAGONAL"]=13,t[e[14]="PARKED_IN_LONGITUDINAL"]=14,t[e[15]="PARKED_OUT"]=15,t}(),e}(),o.LocalizationInformation=function(){function e(e){if(this.usedLocalizationSystems=[],this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.usedLocalizationSystems=u.emptyArray,e.prototype.enhancedByDeadReconning=!1,e.prototype.enhancedByMapLocalization=!1,e.prototype.HDOP=0,e.prototype.VDOP=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.LocalizationInformation;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timestampUTC_ms=e.int64();break;case 2:i.usedLocalizationSystems&&i.usedLocalizationSystems.length||(i.usedLocalizationSystems=[]),i.usedLocalizationSystems.push(d.sdii.here.pb.LocalizationInformation.PositioningSystem.decode(e,e.uint32()));break;case 3:i.enhancedByDeadReconning=e.bool();break;case 4:i.enhancedByMapLocalization=e.bool();break;case 5:i.HDOP=e.double();break;case 6:i.VDOP=e.double();break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timestampUTC_ms"))throw u.ProtocolError("missing required 'timestampUTC_ms'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.LocalizationInformation)return e;var t=new d.sdii.here.pb.LocalizationInformation;if(null!=e.timestampUTC_ms&&(u.Long?(t.timestampUTC_ms=u.Long.fromValue(e.timestampUTC_ms)).unsigned=!1:"string"==typeof e.timestampUTC_ms?t.timestampUTC_ms=parseInt(e.timestampUTC_ms,10):"number"==typeof e.timestampUTC_ms?t.timestampUTC_ms=e.timestampUTC_ms:"object"==typeof e.timestampUTC_ms&&(t.timestampUTC_ms=new u.LongBits(e.timestampUTC_ms.low>>>0,e.timestampUTC_ms.high>>>0).toNumber())),e.usedLocalizationSystems){if(!Array.isArray(e.usedLocalizationSystems))throw TypeError(".sdii.here.pb.LocalizationInformation.usedLocalizationSystems: array expected");t.usedLocalizationSystems=[];for(var r=0;r<e.usedLocalizationSystems.length;++r){if("object"!=typeof e.usedLocalizationSystems[r])throw TypeError(".sdii.here.pb.LocalizationInformation.usedLocalizationSystems: object expected");t.usedLocalizationSystems[r]=d.sdii.here.pb.LocalizationInformation.PositioningSystem.fromObject(e.usedLocalizationSystems[r])}}if(null!=e.enhancedByDeadReconning&&(t.enhancedByDeadReconning=Boolean(e.enhancedByDeadReconning)),null!=e.enhancedByMapLocalization&&(t.enhancedByMapLocalization=Boolean(e.enhancedByMapLocalization)),null!=e.HDOP&&(t.HDOP=Number(e.HDOP)),null!=e.VDOP&&(t.VDOP=Number(e.VDOP)),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.LocalizationInformation.extensionContainer: array expected");for(t.extensionContainer=[],r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.LocalizationInformation.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.usedLocalizationSystems=[],r.extensionContainer=[]),t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timestampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timestampUTC_ms=t.longs===String?"0":0;r.enhancedByDeadReconning=!1,r.enhancedByMapLocalization=!1,r.HDOP=0,r.VDOP=0}if(null!=e.timestampUTC_ms&&e.hasOwnProperty("timestampUTC_ms")&&("number"==typeof e.timestampUTC_ms?r.timestampUTC_ms=t.longs===String?String(e.timestampUTC_ms):e.timestampUTC_ms:r.timestampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timestampUTC_ms):t.longs===Number?new u.LongBits(e.timestampUTC_ms.low>>>0,e.timestampUTC_ms.high>>>0).toNumber():e.timestampUTC_ms),e.usedLocalizationSystems&&e.usedLocalizationSystems.length){r.usedLocalizationSystems=[];for(var n=0;n<e.usedLocalizationSystems.length;++n)r.usedLocalizationSystems[n]=d.sdii.here.pb.LocalizationInformation.PositioningSystem.toObject(e.usedLocalizationSystems[n],t)}if(null!=e.enhancedByDeadReconning&&e.hasOwnProperty("enhancedByDeadReconning")&&(r.enhancedByDeadReconning=e.enhancedByDeadReconning),null!=e.enhancedByMapLocalization&&e.hasOwnProperty("enhancedByMapLocalization")&&(r.enhancedByMapLocalization=e.enhancedByMapLocalization),null!=e.HDOP&&e.hasOwnProperty("HDOP")&&(r.HDOP=t.json&&!isFinite(e.HDOP)?String(e.HDOP):e.HDOP),null!=e.VDOP&&e.hasOwnProperty("VDOP")&&(r.VDOP=t.json&&!isFinite(e.VDOP)?String(e.VDOP):e.VDOP),e.extensionContainer&&e.extensionContainer.length)for(r.extensionContainer=[],n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t);return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.PositioningSystem=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.positioningSystem=0,e.prototype.gnssFix=0,e.prototype.numberOfSatellites=0,e.prototype.enhancedByCellOrWifi=!1,e.prototype.enhancedByDifferentialSignal=!1,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.LocalizationInformation.PositioningSystem;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.positioningSystem=e.int32();break;case 2:i.gnssFix=e.int32();break;case 3:i.numberOfSatellites=e.int32();break;case 4:i.enhancedByCellOrWifi=e.bool();break;case 5:i.enhancedByDifferentialSignal=e.bool();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.LocalizationInformation.PositioningSystem)return e;var t=new d.sdii.here.pb.LocalizationInformation.PositioningSystem;switch(e.positioningSystem){case"POSITIONING_SYSTEM_TYPE_UNDEFINED":case 0:t.positioningSystem=0;break;case"POSITIONING_SYSTEM_TYPE_OTHER":case 1:t.positioningSystem=1;break;case"POSITIONING_SYSTEM_TYPE_GPS":case 2:t.positioningSystem=2;break;case"POSITIONING_SYSTEM_TYPE_GLONASS":case 3:t.positioningSystem=3;break;case"POSITIONING_SYSTEM_TYPE_GALLILEO":case 4:t.positioningSystem=4;break;case"POSITIONING_SYSTEM_TYPE_IRNSS":case 5:t.positioningSystem=5;break;case"POSITIONING_SYSTEM_TYPE_BeiDou":case 6:t.positioningSystem=6}switch(e.gnssFix){case"GNSS_FIX_UNDEFINED":case 0:t.gnssFix=0;break;case"GNSS_FIX_NO":case 1:t.gnssFix=1;break;case"GNSS_FIX_2D":case 2:t.gnssFix=2;break;case"GNSS_FIX_3D":case 3:t.gnssFix=3}return null!=e.numberOfSatellites&&(t.numberOfSatellites=0|e.numberOfSatellites),null!=e.enhancedByCellOrWifi&&(t.enhancedByCellOrWifi=Boolean(e.enhancedByCellOrWifi)),null!=e.enhancedByDifferentialSignal&&(t.enhancedByDifferentialSignal=Boolean(e.enhancedByDifferentialSignal)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.positioningSystem=t.enums===String?"POSITIONING_SYSTEM_TYPE_UNDEFINED":0,r.gnssFix=t.enums===String?"GNSS_FIX_UNDEFINED":0,r.numberOfSatellites=0,r.enhancedByCellOrWifi=!1,r.enhancedByDifferentialSignal=!1),null!=e.positioningSystem&&e.hasOwnProperty("positioningSystem")&&(r.positioningSystem=t.enums===String?d.sdii.here.pb.LocalizationInformation.PositioningSystem.PositioningSystemTypeEnum[e.positioningSystem]:e.positioningSystem),null!=e.gnssFix&&e.hasOwnProperty("gnssFix")&&(r.gnssFix=t.enums===String?d.sdii.here.pb.LocalizationInformation.PositioningSystem.GNSSFixEnum[e.gnssFix]:e.gnssFix),null!=e.numberOfSatellites&&e.hasOwnProperty("numberOfSatellites")&&(r.numberOfSatellites=e.numberOfSatellites),null!=e.enhancedByCellOrWifi&&e.hasOwnProperty("enhancedByCellOrWifi")&&(r.enhancedByCellOrWifi=e.enhancedByCellOrWifi),null!=e.enhancedByDifferentialSignal&&e.hasOwnProperty("enhancedByDifferentialSignal")&&(r.enhancedByDifferentialSignal=e.enhancedByDifferentialSignal),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.PositioningSystemTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="POSITIONING_SYSTEM_TYPE_UNDEFINED"]=0,t[e[1]="POSITIONING_SYSTEM_TYPE_OTHER"]=1,t[e[2]="POSITIONING_SYSTEM_TYPE_GPS"]=2,t[e[3]="POSITIONING_SYSTEM_TYPE_GLONASS"]=3,t[e[4]="POSITIONING_SYSTEM_TYPE_GALLILEO"]=4,t[e[5]="POSITIONING_SYSTEM_TYPE_IRNSS"]=5,t[e[6]="POSITIONING_SYSTEM_TYPE_BeiDou"]=6,t}(),e.GNSSFixEnum=function(){var e={},t=Object.create(e);return t[e[0]="GNSS_FIX_UNDEFINED"]=0,t[e[1]="GNSS_FIX_NO"]=1,t[e[2]="GNSS_FIX_2D"]=2,t[e[3]="GNSS_FIX_3D"]=3,t}(),e}(),e}(),o.RoadAttributeRecognition=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.roadAttribute=0,e.prototype.roadLaneCount_count=0,e.prototype.roadLaneCountConfidence_percentage=0,e.prototype.roadLaneDetectionCount_count=0,e.prototype.roadAttributeReference=0,e.prototype.referencedValue_m=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.RoadAttributeRecognition;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timestampUTC_ms=e.int64();break;case 2:i.roadAttribute=e.int32();break;case 3:i.roadLaneCount_count=e.int32();break;case 4:i.roadLaneCountConfidence_percentage=e.int32();break;case 5:i.roadLaneDetectionCount_count=e.int32();break;case 100:i.roadAttributeReference=e.int32();break;case 101:i.referencedValue_m=e.int32();break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timestampUTC_ms"))throw u.ProtocolError("missing required 'timestampUTC_ms'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.RoadAttributeRecognition)return e;var t=new d.sdii.here.pb.RoadAttributeRecognition;switch(null!=e.timestampUTC_ms&&(u.Long?(t.timestampUTC_ms=u.Long.fromValue(e.timestampUTC_ms)).unsigned=!1:"string"==typeof e.timestampUTC_ms?t.timestampUTC_ms=parseInt(e.timestampUTC_ms,10):"number"==typeof e.timestampUTC_ms?t.timestampUTC_ms=e.timestampUTC_ms:"object"==typeof e.timestampUTC_ms&&(t.timestampUTC_ms=new u.LongBits(e.timestampUTC_ms.low>>>0,e.timestampUTC_ms.high>>>0).toNumber())),e.roadAttribute){case"ROAD_ATTRIBUTE_UNDEFINED":case 0:t.roadAttribute=0;break;case"ROAD_ATTRIBUTE_MOTORWAY":case 1:t.roadAttribute=1;break;case"ROAD_ATTRIBUTE_ONE_WAY_TRAFFIC":case 2:t.roadAttribute=2;break;case"ROAD_ATTRIBUTE_TWO_WAY_TRAFFIC":case 3:t.roadAttribute=3;break;case"ROAD_ATTRIBUTE_TUNNEL":case 20:t.roadAttribute=20;break;case"ROAD_ATTRIBUTE_BRIDGE":case 21:t.roadAttribute=21;break;case"ROAD_ATTRIBUTE_ARTIFICIAL_ILLUMINATION":case 22:t.roadAttribute=22;break;case"ROAD_ATTRIBUTE_ROAD_WORKS":case 23:t.roadAttribute=23;break;case"ROAD_ATTRIBUTE_ROAD_WORKS_NARROW_LANES":case 24:t.roadAttribute=24;break;case"ROAD_ATTRIBUTE_LANE_START_RIGHT_SIDE":case 50:t.roadAttribute=50;break;case"ROAD_ATTRIBUTE_LANE_START_LEFT_SIDE":case 51:t.roadAttribute=51;break;case"ROAD_ATTRIBUTE_LANE_END_RIGHT_SIDE":case 52:t.roadAttribute=52;break;case"ROAD_ATTRIBUTE_LANE_END_LEFT_SIDE":case 53:t.roadAttribute=53;break;case"ROAD_ATTRIBUTE_LANE_SPLIT_MIDDLE":case 54:t.roadAttribute=54;break;case"ROAD_ATTRIBUTE_LANE_MERGE_MIDDLE":case 55:t.roadAttribute=55;break;case"ROAD_ATTRIBUTE_CROSS_WALK":case 56:t.roadAttribute=56}switch(null!=e.roadLaneCount_count&&(t.roadLaneCount_count=0|e.roadLaneCount_count),null!=e.roadLaneCountConfidence_percentage&&(t.roadLaneCountConfidence_percentage=0|e.roadLaneCountConfidence_percentage),null!=e.roadLaneDetectionCount_count&&(t.roadLaneDetectionCount_count=0|e.roadLaneDetectionCount_count),e.roadAttributeReference){case"REFERENCE_TYPE_UNDEFINED":case 0:t.roadAttributeReference=0;break;case"SINGLE_RECOGNITION":case 1:t.roadAttributeReference=1;break;case"STARTED_BEFORE":case 2:t.roadAttributeReference=2;break;case"ENDED_BEFORE":case 3:t.roadAttributeReference=3}if(null!=e.referencedValue_m&&(t.referencedValue_m=0|e.referencedValue_m),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.RoadAttributeRecognition.extensionContainer: array expected");t.extensionContainer=[];for(var r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.RoadAttributeRecognition.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.extensionContainer=[]),t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timestampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timestampUTC_ms=t.longs===String?"0":0;r.roadAttribute=t.enums===String?"ROAD_ATTRIBUTE_UNDEFINED":0,r.roadLaneCount_count=0,r.roadLaneCountConfidence_percentage=0,r.roadLaneDetectionCount_count=0,r.roadAttributeReference=t.enums===String?"REFERENCE_TYPE_UNDEFINED":0,r.referencedValue_m=0}if(null!=e.timestampUTC_ms&&e.hasOwnProperty("timestampUTC_ms")&&("number"==typeof e.timestampUTC_ms?r.timestampUTC_ms=t.longs===String?String(e.timestampUTC_ms):e.timestampUTC_ms:r.timestampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timestampUTC_ms):t.longs===Number?new u.LongBits(e.timestampUTC_ms.low>>>0,e.timestampUTC_ms.high>>>0).toNumber():e.timestampUTC_ms),null!=e.roadAttribute&&e.hasOwnProperty("roadAttribute")&&(r.roadAttribute=t.enums===String?d.sdii.here.pb.RoadAttributeRecognition.RoadAttributeTypeEnum[e.roadAttribute]:e.roadAttribute),null!=e.roadLaneCount_count&&e.hasOwnProperty("roadLaneCount_count")&&(r.roadLaneCount_count=e.roadLaneCount_count),null!=e.roadLaneCountConfidence_percentage&&e.hasOwnProperty("roadLaneCountConfidence_percentage")&&(r.roadLaneCountConfidence_percentage=e.roadLaneCountConfidence_percentage),null!=e.roadLaneDetectionCount_count&&e.hasOwnProperty("roadLaneDetectionCount_count")&&(r.roadLaneDetectionCount_count=e.roadLaneDetectionCount_count),null!=e.roadAttributeReference&&e.hasOwnProperty("roadAttributeReference")&&(r.roadAttributeReference=t.enums===String?d.sdii.here.pb.RoadAttributeRecognition.ReferenceTypeEnum[e.roadAttributeReference]:e.roadAttributeReference),null!=e.referencedValue_m&&e.hasOwnProperty("referencedValue_m")&&(r.referencedValue_m=e.referencedValue_m),e.extensionContainer&&e.extensionContainer.length){r.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.RoadAttributeTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_ATTRIBUTE_UNDEFINED"]=0,t[e[1]="ROAD_ATTRIBUTE_MOTORWAY"]=1,t[e[2]="ROAD_ATTRIBUTE_ONE_WAY_TRAFFIC"]=2,t[e[3]="ROAD_ATTRIBUTE_TWO_WAY_TRAFFIC"]=3,t[e[20]="ROAD_ATTRIBUTE_TUNNEL"]=20,t[e[21]="ROAD_ATTRIBUTE_BRIDGE"]=21,t[e[22]="ROAD_ATTRIBUTE_ARTIFICIAL_ILLUMINATION"]=22,t[e[23]="ROAD_ATTRIBUTE_ROAD_WORKS"]=23,t[e[24]="ROAD_ATTRIBUTE_ROAD_WORKS_NARROW_LANES"]=24,t[e[50]="ROAD_ATTRIBUTE_LANE_START_RIGHT_SIDE"]=50,t[e[51]="ROAD_ATTRIBUTE_LANE_START_LEFT_SIDE"]=51,t[e[52]="ROAD_ATTRIBUTE_LANE_END_RIGHT_SIDE"]=52,t[e[53]="ROAD_ATTRIBUTE_LANE_END_LEFT_SIDE"]=53,t[e[54]="ROAD_ATTRIBUTE_LANE_SPLIT_MIDDLE"]=54,t[e[55]="ROAD_ATTRIBUTE_LANE_MERGE_MIDDLE"]=55,t[e[56]="ROAD_ATTRIBUTE_CROSS_WALK"]=56,t}(),e.ReferenceTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="REFERENCE_TYPE_UNDEFINED"]=0,t[e[1]="SINGLE_RECOGNITION"]=1,t[e[2]="STARTED_BEFORE"]=2,t[e[3]="ENDED_BEFORE"]=3,t}(),e}(),o.PassengerEnvironment=function(){function e(e){if(this.passengerSeatUsage=[],this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.generalPassengerCount=0,e.prototype.passengerSeatUsage=u.emptyArray,e.prototype.currentMediaSource=0,e.prototype.radioFrequency_MHz=0,e.prototype.navigationSearchDestination="",e.prototype.navigationDestinationLongitude_deg=0,e.prototype.navigationDestinationLatitude_deg=0,e.prototype.navigationOriginLongitude_deg=0,e.prototype.navigationOriginLatitude_deg=0,e.prototype.navigationAndRouting_ETA_ms=0,e.prototype.navigationAndRouting_ETT_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.routingSelectionPathType=0,e.prototype.extensionContainer=u.emptyArray,e.prototype.timeDriving_min=0,e.prototype.mostRecentParkingTime_min=0,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.PassengerEnvironment;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.int64();break;case 2:i.generalPassengerCount=e.int32();break;case 3:i.passengerSeatUsage&&i.passengerSeatUsage.length||(i.passengerSeatUsage=[]),i.passengerSeatUsage.push(d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage.decode(e,e.uint32()));break;case 100:i.currentMediaSource=e.int32();break;case 101:i.radioFrequency_MHz=e.double();break;case 200:i.navigationSearchDestination=e.string();break;case 201:i.navigationDestinationLongitude_deg=e.double();break;case 202:i.navigationDestinationLatitude_deg=e.double();break;case 203:i.navigationOriginLongitude_deg=e.double();break;case 204:i.navigationOriginLatitude_deg=e.double();break;case 205:i.navigationAndRouting_ETA_ms=e.double();break;case 206:i.navigationAndRouting_ETT_ms=e.int64();break;case 207:i.routingSelectionPathType=e.int32();break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;case 300:i.timeDriving_min=e.int32();break;case 301:i.mostRecentParkingTime_min=e.int32();break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.PassengerEnvironment)return e;var t=new d.sdii.here.pb.PassengerEnvironment;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),null!=e.generalPassengerCount&&(t.generalPassengerCount=0|e.generalPassengerCount),e.passengerSeatUsage){if(!Array.isArray(e.passengerSeatUsage))throw TypeError(".sdii.here.pb.PassengerEnvironment.passengerSeatUsage: array expected");t.passengerSeatUsage=[];for(var r=0;r<e.passengerSeatUsage.length;++r){if("object"!=typeof e.passengerSeatUsage[r])throw TypeError(".sdii.here.pb.PassengerEnvironment.passengerSeatUsage: object expected");t.passengerSeatUsage[r]=d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage.fromObject(e.passengerSeatUsage[r])}}switch(e.currentMediaSource){case"MEDIA_SOURCE_UNDEFINED":case 0:t.currentMediaSource=0;break;case"MEDIA_SOURCE_OFF":case 1:t.currentMediaSource=1;break;case"MEDIA_SOURCE_RADIO":case 2:t.currentMediaSource=2;break;case"MEDIA_SOURCE_EXTERNAL_SOURCE":case 3:t.currentMediaSource=3}switch(null!=e.radioFrequency_MHz&&(t.radioFrequency_MHz=Number(e.radioFrequency_MHz)),null!=e.navigationSearchDestination&&(t.navigationSearchDestination=String(e.navigationSearchDestination)),null!=e.navigationDestinationLongitude_deg&&(t.navigationDestinationLongitude_deg=Number(e.navigationDestinationLongitude_deg)),null!=e.navigationDestinationLatitude_deg&&(t.navigationDestinationLatitude_deg=Number(e.navigationDestinationLatitude_deg)),null!=e.navigationOriginLongitude_deg&&(t.navigationOriginLongitude_deg=Number(e.navigationOriginLongitude_deg)),null!=e.navigationOriginLatitude_deg&&(t.navigationOriginLatitude_deg=Number(e.navigationOriginLatitude_deg)),null!=e.navigationAndRouting_ETA_ms&&(t.navigationAndRouting_ETA_ms=Number(e.navigationAndRouting_ETA_ms)),null!=e.navigationAndRouting_ETT_ms&&(u.Long?(t.navigationAndRouting_ETT_ms=u.Long.fromValue(e.navigationAndRouting_ETT_ms)).unsigned=!1:"string"==typeof e.navigationAndRouting_ETT_ms?t.navigationAndRouting_ETT_ms=parseInt(e.navigationAndRouting_ETT_ms,10):"number"==typeof e.navigationAndRouting_ETT_ms?t.navigationAndRouting_ETT_ms=e.navigationAndRouting_ETT_ms:"object"==typeof e.navigationAndRouting_ETT_ms&&(t.navigationAndRouting_ETT_ms=new u.LongBits(e.navigationAndRouting_ETT_ms.low>>>0,e.navigationAndRouting_ETT_ms.high>>>0).toNumber())),e.routingSelectionPathType){case"ROUTING_SELECTED_PATH_TYPE_UNDEFINED":case 0:t.routingSelectionPathType=0;break;case"ROUTING_SELECTED_PATH_TYPE_SHORTEST":case 1:t.routingSelectionPathType=1;break;case"ROUTING_SELECTED_PATH_TYPE_FASTEST":case 2:t.routingSelectionPathType=2;break;case"ROUTING_SELECTED_PATH_TYPE_ECONOMIC":case 3:t.routingSelectionPathType=3}if(e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.PassengerEnvironment.extensionContainer: array expected");for(t.extensionContainer=[],r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.PassengerEnvironment.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return null!=e.timeDriving_min&&(t.timeDriving_min=0|e.timeDriving_min),null!=e.mostRecentParkingTime_min&&(t.mostRecentParkingTime_min=0|e.mostRecentParkingTime_min),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.passengerSeatUsage=[],r.extensionContainer=[]),t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timeStampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timeStampUTC_ms=t.longs===String?"0":0;r.generalPassengerCount=0,r.currentMediaSource=t.enums===String?"MEDIA_SOURCE_UNDEFINED":0,r.radioFrequency_MHz=0,r.navigationSearchDestination="",r.navigationDestinationLongitude_deg=0,r.navigationDestinationLatitude_deg=0,r.navigationOriginLongitude_deg=0,r.navigationOriginLatitude_deg=0,r.navigationAndRouting_ETA_ms=0,u.Long?(i=new u.Long(0,0,!1),r.navigationAndRouting_ETT_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.navigationAndRouting_ETT_ms=t.longs===String?"0":0,r.routingSelectionPathType=t.enums===String?"ROUTING_SELECTED_PATH_TYPE_UNDEFINED":0,r.timeDriving_min=0,r.mostRecentParkingTime_min=0}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?r.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:r.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.generalPassengerCount&&e.hasOwnProperty("generalPassengerCount")&&(r.generalPassengerCount=e.generalPassengerCount),e.passengerSeatUsage&&e.passengerSeatUsage.length){r.passengerSeatUsage=[];for(var n=0;n<e.passengerSeatUsage.length;++n)r.passengerSeatUsage[n]=d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage.toObject(e.passengerSeatUsage[n],t)}if(null!=e.currentMediaSource&&e.hasOwnProperty("currentMediaSource")&&(r.currentMediaSource=t.enums===String?d.sdii.here.pb.PassengerEnvironment.MediaSourceEnum[e.currentMediaSource]:e.currentMediaSource),null!=e.radioFrequency_MHz&&e.hasOwnProperty("radioFrequency_MHz")&&(r.radioFrequency_MHz=t.json&&!isFinite(e.radioFrequency_MHz)?String(e.radioFrequency_MHz):e.radioFrequency_MHz),null!=e.navigationSearchDestination&&e.hasOwnProperty("navigationSearchDestination")&&(r.navigationSearchDestination=e.navigationSearchDestination),null!=e.navigationDestinationLongitude_deg&&e.hasOwnProperty("navigationDestinationLongitude_deg")&&(r.navigationDestinationLongitude_deg=t.json&&!isFinite(e.navigationDestinationLongitude_deg)?String(e.navigationDestinationLongitude_deg):e.navigationDestinationLongitude_deg),null!=e.navigationDestinationLatitude_deg&&e.hasOwnProperty("navigationDestinationLatitude_deg")&&(r.navigationDestinationLatitude_deg=t.json&&!isFinite(e.navigationDestinationLatitude_deg)?String(e.navigationDestinationLatitude_deg):e.navigationDestinationLatitude_deg),null!=e.navigationOriginLongitude_deg&&e.hasOwnProperty("navigationOriginLongitude_deg")&&(r.navigationOriginLongitude_deg=t.json&&!isFinite(e.navigationOriginLongitude_deg)?String(e.navigationOriginLongitude_deg):e.navigationOriginLongitude_deg),null!=e.navigationOriginLatitude_deg&&e.hasOwnProperty("navigationOriginLatitude_deg")&&(r.navigationOriginLatitude_deg=t.json&&!isFinite(e.navigationOriginLatitude_deg)?String(e.navigationOriginLatitude_deg):e.navigationOriginLatitude_deg),null!=e.navigationAndRouting_ETA_ms&&e.hasOwnProperty("navigationAndRouting_ETA_ms")&&(r.navigationAndRouting_ETA_ms=t.json&&!isFinite(e.navigationAndRouting_ETA_ms)?String(e.navigationAndRouting_ETA_ms):e.navigationAndRouting_ETA_ms),null!=e.navigationAndRouting_ETT_ms&&e.hasOwnProperty("navigationAndRouting_ETT_ms")&&("number"==typeof e.navigationAndRouting_ETT_ms?r.navigationAndRouting_ETT_ms=t.longs===String?String(e.navigationAndRouting_ETT_ms):e.navigationAndRouting_ETT_ms:r.navigationAndRouting_ETT_ms=t.longs===String?u.Long.prototype.toString.call(e.navigationAndRouting_ETT_ms):t.longs===Number?new u.LongBits(e.navigationAndRouting_ETT_ms.low>>>0,e.navigationAndRouting_ETT_ms.high>>>0).toNumber():e.navigationAndRouting_ETT_ms),null!=e.routingSelectionPathType&&e.hasOwnProperty("routingSelectionPathType")&&(r.routingSelectionPathType=t.enums===String?d.sdii.here.pb.PassengerEnvironment.RoutingSelectionPathTypeEnum[e.routingSelectionPathType]:e.routingSelectionPathType),e.extensionContainer&&e.extensionContainer.length)for(r.extensionContainer=[],n=0;n<e.extensionContainer.length;++n)r.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t);return null!=e.timeDriving_min&&e.hasOwnProperty("timeDriving_min")&&(r.timeDriving_min=e.timeDriving_min),null!=e.mostRecentParkingTime_min&&e.hasOwnProperty("mostRecentParkingTime_min")&&(r.mostRecentParkingTime_min=e.mostRecentParkingTime_min),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.PassengerSeatUsage=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.simpleSeatRow=0,e.prototype.simpleSeatColumn=0,e.prototype.seatRowNumber=0,e.prototype.seatColumnNumber=0,e.prototype.seatUsage=0,e.prototype.seatOccupancyType=0,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.simpleSeatRow=e.int32();break;case 2:i.simpleSeatColumn=e.int32();break;case 3:i.seatRowNumber=e.int32();break;case 4:i.seatColumnNumber=e.int32();break;case 5:i.seatUsage=e.int32();break;case 6:i.seatOccupancyType=e.int32();break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage)return e;var t=new d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage;switch(e.simpleSeatRow){case"PASSENGER_SEAT_ROW_UNDEFINED":case 0:t.simpleSeatRow=0;break;case"PASSENGER_SEAT_ROW_FRONT":case 1:t.simpleSeatRow=1;break;case"PASSENGER_SEAT_ROW_MIDDLE":case 2:t.simpleSeatRow=2;break;case"PASSENGER_SEAT_ROW_REAR":case 3:t.simpleSeatRow=3}switch(e.simpleSeatColumn){case"PASSENGER_SEAT_COLUMN_UNDEFINED":case 0:t.simpleSeatColumn=0;break;case"PASSENGER_SEAT_COLUMN_LEFT":case 1:t.simpleSeatColumn=1;break;case"PASSENGER_SEAT_COLUMN_MIDDLE":case 2:t.simpleSeatColumn=2;break;case"PASSENGER_SEAT_COLUMN_RIGHT":case 3:t.simpleSeatColumn=3}switch(null!=e.seatRowNumber&&(t.seatRowNumber=0|e.seatRowNumber),null!=e.seatColumnNumber&&(t.seatColumnNumber=0|e.seatColumnNumber),e.seatUsage){case"PASSENGER_SEAT_USAGE_UNDEFINED":case 0:t.seatUsage=0;break;case"PASSENGER_SEAT_USAGE_FREE":case 1:t.seatUsage=1;break;case"PASSENGER_SEAT_USAGE_OCCUPIED":case 2:t.seatUsage=2}switch(e.seatOccupancyType){case"PASSENGER_OCCUPANCY_TYPE_UNDEFINED":case 0:t.seatOccupancyType=0;break;case"PASSENGER_OCCUPANCY_LIGHT_WEIGHT":case 1:t.seatOccupancyType=1;break;case"PASSENGER_OCCUPANCY_HEAVY_WEIGHT":case 2:t.seatOccupancyType=2;break;case"PASSENGER_OCCUPANCY_CHILD_SAEFTY_SEAT":case 3:t.seatOccupancyType=3;break;case"PASSENGER_OCCUPANCY_BABY_CARRIER":case 4:t.seatOccupancyType=4}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.simpleSeatRow=t.enums===String?"PASSENGER_SEAT_ROW_UNDEFINED":0,r.simpleSeatColumn=t.enums===String?"PASSENGER_SEAT_COLUMN_UNDEFINED":0,r.seatRowNumber=0,r.seatColumnNumber=0,r.seatUsage=t.enums===String?"PASSENGER_SEAT_USAGE_UNDEFINED":0,r.seatOccupancyType=t.enums===String?"PASSENGER_OCCUPANCY_TYPE_UNDEFINED":0),null!=e.simpleSeatRow&&e.hasOwnProperty("simpleSeatRow")&&(r.simpleSeatRow=t.enums===String?d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage.PassengerSeatRowSimpleEnum[e.simpleSeatRow]:e.simpleSeatRow),null!=e.simpleSeatColumn&&e.hasOwnProperty("simpleSeatColumn")&&(r.simpleSeatColumn=t.enums===String?d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage.PassengerSeatColumnSimpleEnum[e.simpleSeatColumn]:e.simpleSeatColumn),null!=e.seatRowNumber&&e.hasOwnProperty("seatRowNumber")&&(r.seatRowNumber=e.seatRowNumber),null!=e.seatColumnNumber&&e.hasOwnProperty("seatColumnNumber")&&(r.seatColumnNumber=e.seatColumnNumber),null!=e.seatUsage&&e.hasOwnProperty("seatUsage")&&(r.seatUsage=t.enums===String?d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage.PassengerSeatUsageEnum[e.seatUsage]:e.seatUsage),null!=e.seatOccupancyType&&e.hasOwnProperty("seatOccupancyType")&&(r.seatOccupancyType=t.enums===String?d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage.PassengerOccupancyTypeEnum[e.seatOccupancyType]:e.seatOccupancyType),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.PassengerSeatRowSimpleEnum=function(){var e={},t=Object.create(e);return t[e[0]="PASSENGER_SEAT_ROW_UNDEFINED"]=0,t[e[1]="PASSENGER_SEAT_ROW_FRONT"]=1,t[e[2]="PASSENGER_SEAT_ROW_MIDDLE"]=2,t[e[3]="PASSENGER_SEAT_ROW_REAR"]=3,t}(),e.PassengerSeatColumnSimpleEnum=function(){var e={},t=Object.create(e);return t[e[0]="PASSENGER_SEAT_COLUMN_UNDEFINED"]=0,t[e[1]="PASSENGER_SEAT_COLUMN_LEFT"]=1,t[e[2]="PASSENGER_SEAT_COLUMN_MIDDLE"]=2,t[e[3]="PASSENGER_SEAT_COLUMN_RIGHT"]=3,t}(),e.PassengerSeatUsageEnum=function(){var e={},t=Object.create(e);return t[e[0]="PASSENGER_SEAT_USAGE_UNDEFINED"]=0,t[e[1]="PASSENGER_SEAT_USAGE_FREE"]=1,t[e[2]="PASSENGER_SEAT_USAGE_OCCUPIED"]=2,t}(),e.PassengerOccupancyTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="PASSENGER_OCCUPANCY_TYPE_UNDEFINED"]=0,t[e[1]="PASSENGER_OCCUPANCY_LIGHT_WEIGHT"]=1,t[e[2]="PASSENGER_OCCUPANCY_HEAVY_WEIGHT"]=2,t[e[3]="PASSENGER_OCCUPANCY_CHILD_SAEFTY_SEAT"]=3,t[e[4]="PASSENGER_OCCUPANCY_BABY_CARRIER"]=4,t}(),e}(),e.MediaSourceEnum=function(){var e={},t=Object.create(e);return t[e[0]="MEDIA_SOURCE_UNDEFINED"]=0,t[e[1]="MEDIA_SOURCE_OFF"]=1,t[e[2]="MEDIA_SOURCE_RADIO"]=2,t[e[3]="MEDIA_SOURCE_EXTERNAL_SOURCE"]=3,t}(),e.RoutingSelectionPathTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROUTING_SELECTED_PATH_TYPE_UNDEFINED"]=0,t[e[1]="ROUTING_SELECTED_PATH_TYPE_SHORTEST"]=1,t[e[2]="ROUTING_SELECTED_PATH_TYPE_FASTEST"]=2,t[e[3]="ROUTING_SELECTED_PATH_TYPE_ECONOMIC"]=3,t}(),e}(),o.RoadMarkingRecognition=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timeStampUTC_ms=0,e.prototype.roadMarkingType=0,e.prototype.positionOffset=null,e.prototype.laneMarkingSize=null,e.prototype.laneReferenceID=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.RoadMarkingRecognition;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.double();break;case 2:i.roadMarkingType=e.int32();break;case 3:i.positionOffset=d.sdii.here.pb.PositionOffset.decode(e,e.uint32());break;case 4:i.laneMarkingSize=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 5:i.laneReferenceID=e.int32();break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.RoadMarkingRecognition)return e;var t=new d.sdii.here.pb.RoadMarkingRecognition;switch(null!=e.timeStampUTC_ms&&(t.timeStampUTC_ms=Number(e.timeStampUTC_ms)),e.roadMarkingType){case"ROAD_MARKING_TYPE_UNDEFINED":case 0:t.roadMarkingType=0;break;case"ROAD_MARKING_TYPE_ARROW_LEFT":case 1:t.roadMarkingType=1;break;case"ROAD_RKING_TYPE_ARROW_STRAIGHT_LEFT":case 2:t.roadMarkingType=2;break;case"ROAD_MARKING_TYPE_ARROW_STRAIGHT":case 3:t.roadMarkingType=3;break;case"ROAD_MARKING_TYPE_ARROW_STRAIGHT_RIGHT":case 4:t.roadMarkingType=4;break;case"ROAD_MARKING_TYPE_ARROW_RIGHT":case 5:t.roadMarkingType=5;break;case"ROAD_MARKING_TYPE_ARROW_UNDEFINED":case 6:t.roadMarkingType=6}if(null!=e.positionOffset){if("object"!=typeof e.positionOffset)throw TypeError(".sdii.here.pb.RoadMarkingRecognition.positionOffset: object expected");t.positionOffset=d.sdii.here.pb.PositionOffset.fromObject(e.positionOffset)}if(null!=e.laneMarkingSize){if("object"!=typeof e.laneMarkingSize)throw TypeError(".sdii.here.pb.RoadMarkingRecognition.laneMarkingSize: object expected");t.laneMarkingSize=d.sdii.here.pb.Vector3D.fromObject(e.laneMarkingSize)}if(null!=e.laneReferenceID&&(t.laneReferenceID=0|e.laneReferenceID),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.RoadMarkingRecognition.extensionContainer: array expected");t.extensionContainer=[];for(var r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.RoadMarkingRecognition.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.extensionContainer=[]),t.defaults&&(r.timeStampUTC_ms=0,r.roadMarkingType=t.enums===String?"ROAD_MARKING_TYPE_UNDEFINED":0,r.positionOffset=null,r.laneMarkingSize=null,r.laneReferenceID=0),null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&(r.timeStampUTC_ms=t.json&&!isFinite(e.timeStampUTC_ms)?String(e.timeStampUTC_ms):e.timeStampUTC_ms),null!=e.roadMarkingType&&e.hasOwnProperty("roadMarkingType")&&(r.roadMarkingType=t.enums===String?d.sdii.here.pb.RoadMarkingRecognition.RoadMarkingTypeEnum[e.roadMarkingType]:e.roadMarkingType),null!=e.positionOffset&&e.hasOwnProperty("positionOffset")&&(r.positionOffset=d.sdii.here.pb.PositionOffset.toObject(e.positionOffset,t)),null!=e.laneMarkingSize&&e.hasOwnProperty("laneMarkingSize")&&(r.laneMarkingSize=d.sdii.here.pb.Vector3D.toObject(e.laneMarkingSize,t)),null!=e.laneReferenceID&&e.hasOwnProperty("laneReferenceID")&&(r.laneReferenceID=e.laneReferenceID),e.extensionContainer&&e.extensionContainer.length){r.extensionContainer=[];for(var i=0;i<e.extensionContainer.length;++i)r.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[i],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.RoadMarkingTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_MARKING_TYPE_UNDEFINED"]=0,t[e[1]="ROAD_MARKING_TYPE_ARROW_LEFT"]=1,t[e[2]="ROAD_RKING_TYPE_ARROW_STRAIGHT_LEFT"]=2,t[e[3]="ROAD_MARKING_TYPE_ARROW_STRAIGHT"]=3,t[e[4]="ROAD_MARKING_TYPE_ARROW_STRAIGHT_RIGHT"]=4,t[e[5]="ROAD_MARKING_TYPE_ARROW_RIGHT"]=5,t[e[6]="ROAD_MARKING_TYPE_ARROW_UNDEFINED"]=6,t}(),e}(),o.TrafficSignalHeadRecognition=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timeStampUTC_ms=0,e.prototype.positionOffset=null,e.prototype.trafficSignalDesignType=0,e.prototype.trafficSignalHeadOrientationType=0,e.prototype.trafficSignalLightColorBitfield=0,e.prototype.laneReferenceID=0,e.prototype.objectReferenceID=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.TrafficSignalHeadRecognition;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.double();break;case 2:i.positionOffset=d.sdii.here.pb.PositionOffset.decode(e,e.uint32());break;case 3:i.trafficSignalDesignType=e.int32();break;case 4:i.trafficSignalHeadOrientationType=e.int32();break;case 5:i.trafficSignalLightColorBitfield=e.int32();break;case 6:i.laneReferenceID=e.int32();break;case 7:i.objectReferenceID=e.int32();break;case 250:i.extensionContainer&&i.extensionContainer.length||(i.extensionContainer=[]),i.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.TrafficSignalHeadRecognition)return e;var t=new d.sdii.here.pb.TrafficSignalHeadRecognition;if(null!=e.timeStampUTC_ms&&(t.timeStampUTC_ms=Number(e.timeStampUTC_ms)),null!=e.positionOffset){if("object"!=typeof e.positionOffset)throw TypeError(".sdii.here.pb.TrafficSignalHeadRecognition.positionOffset: object expected");t.positionOffset=d.sdii.here.pb.PositionOffset.fromObject(e.positionOffset)}switch(e.trafficSignalDesignType){case"TRAFFIC_SIGNAL_HEAD_TYPE_UNDEFINED":case 0:t.trafficSignalDesignType=0;break;case"TRAFFIC_SIGNAL_HEAD_TYPE_UNKNOWN":case 1:t.trafficSignalDesignType=1;break;case"TRAFFIC_SIGNAL_HEAD_TYPE_REDYELLOWGREEN":case 2:t.trafficSignalDesignType=2;break;case"TRAFFIC_SIGNAL_HEAD_TYPE_REDYELLOW":case 3:t.trafficSignalDesignType=3;break;case"TRAFFIC_SIGNAL_HEAD_TYPE_3LIGHTS":case 4:t.trafficSignalDesignType=4;break;case"TRAFFIC_SIGNAL_HEAD_TYPE_2LIGHTS":case 5:t.trafficSignalDesignType=5;break;case"TRAFFIC_SIGNAL_HEAD_TYPE_2YELLOWLIGHTS":case 6:t.trafficSignalDesignType=6}switch(e.trafficSignalHeadOrientationType){case"TRAFFIC_SIGNAL_HEAD_ORIENTATION_TYPE_UNDEFINED":case 0:t.trafficSignalHeadOrientationType=0;break;case"TRAFFIC_SIGNAL_HEAD_ORIENTATION_TYPE_VERTICAL":case 1:t.trafficSignalHeadOrientationType=1;break;case"TRAFFIC_SIGNAL_HEAD_ORIENTATION_TYPE_HORIZONTAL":case 2:t.trafficSignalHeadOrientationType=2}if(null!=e.trafficSignalLightColorBitfield&&(t.trafficSignalLightColorBitfield=0|e.trafficSignalLightColorBitfield),null!=e.laneReferenceID&&(t.laneReferenceID=0|e.laneReferenceID),null!=e.objectReferenceID&&(t.objectReferenceID=0|e.objectReferenceID),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.TrafficSignalHeadRecognition.extensionContainer: array expected");t.extensionContainer=[];for(var r=0;r<e.extensionContainer.length;++r){if("object"!=typeof e.extensionContainer[r])throw TypeError(".sdii.here.pb.TrafficSignalHeadRecognition.extensionContainer: object expected");t.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.extensionContainer=[]),t.defaults&&(r.timeStampUTC_ms=0,r.positionOffset=null,r.trafficSignalDesignType=t.enums===String?"TRAFFIC_SIGNAL_HEAD_TYPE_UNDEFINED":0,r.trafficSignalHeadOrientationType=t.enums===String?"TRAFFIC_SIGNAL_HEAD_ORIENTATION_TYPE_UNDEFINED":0,r.trafficSignalLightColorBitfield=0,r.laneReferenceID=0,r.objectReferenceID=0),null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&(r.timeStampUTC_ms=t.json&&!isFinite(e.timeStampUTC_ms)?String(e.timeStampUTC_ms):e.timeStampUTC_ms),null!=e.positionOffset&&e.hasOwnProperty("positionOffset")&&(r.positionOffset=d.sdii.here.pb.PositionOffset.toObject(e.positionOffset,t)),null!=e.trafficSignalDesignType&&e.hasOwnProperty("trafficSignalDesignType")&&(r.trafficSignalDesignType=t.enums===String?d.sdii.here.pb.TrafficSignalHeadRecognition.TrafficSignalHeadDesignTypeEnum[e.trafficSignalDesignType]:e.trafficSignalDesignType),null!=e.trafficSignalHeadOrientationType&&e.hasOwnProperty("trafficSignalHeadOrientationType")&&(r.trafficSignalHeadOrientationType=t.enums===String?d.sdii.here.pb.TrafficSignalHeadRecognition.TrafficSignalHeadOrientationTypeEnum[e.trafficSignalHeadOrientationType]:e.trafficSignalHeadOrientationType),null!=e.trafficSignalLightColorBitfield&&e.hasOwnProperty("trafficSignalLightColorBitfield")&&(r.trafficSignalLightColorBitfield=e.trafficSignalLightColorBitfield),null!=e.laneReferenceID&&e.hasOwnProperty("laneReferenceID")&&(r.laneReferenceID=e.laneReferenceID),null!=e.objectReferenceID&&e.hasOwnProperty("objectReferenceID")&&(r.objectReferenceID=e.objectReferenceID),e.extensionContainer&&e.extensionContainer.length){r.extensionContainer=[];for(var i=0;i<e.extensionContainer.length;++i)r.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[i],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.TrafficSignalHeadDesignTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="TRAFFIC_SIGNAL_HEAD_TYPE_UNDEFINED"]=0,t[e[1]="TRAFFIC_SIGNAL_HEAD_TYPE_UNKNOWN"]=1,t[e[2]="TRAFFIC_SIGNAL_HEAD_TYPE_REDYELLOWGREEN"]=2,t[e[3]="TRAFFIC_SIGNAL_HEAD_TYPE_REDYELLOW"]=3,t[e[4]="TRAFFIC_SIGNAL_HEAD_TYPE_3LIGHTS"]=4,t[e[5]="TRAFFIC_SIGNAL_HEAD_TYPE_2LIGHTS"]=5,t[e[6]="TRAFFIC_SIGNAL_HEAD_TYPE_2YELLOWLIGHTS"]=6,t}(),e.TrafficSignalHeadOrientationTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="TRAFFIC_SIGNAL_HEAD_ORIENTATION_TYPE_UNDEFINED"]=0,t[e[1]="TRAFFIC_SIGNAL_HEAD_ORIENTATION_TYPE_VERTICAL"]=1,t[e[2]="TRAFFIC_SIGNAL_HEAD_ORIENTATION_TYPE_HORIZONTAL"]=2,t}(),e}(),o.PathEvents=function(){function e(e){if(this.vehicleStatus=[],this.vehicleDynamics=[],this.signRecognition=[],this.laneBoundaryRecognition=[],this.exceptionalVehicleState=[],this.proprietaryInfo=[],this.environmentStatus=[],this.objectDetection=[],this.adServiceAndSensorState=[],this.specificObservedEvent=[],this.roadCondition=[],this.roadBoundaryRecognition=[],this.vehicleManeuver=[],this.localizationInformation=[],this.roadAttributerecognition=[],this.passengerEnvironment=[],this.roadMarkingRecognition=[],this.trafficSignalHeadDetection=[],this.proprietaryDataContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.vehicleStatus=u.emptyArray,e.prototype.vehicleDynamics=u.emptyArray,e.prototype.signRecognition=u.emptyArray,e.prototype.laneBoundaryRecognition=u.emptyArray,e.prototype.exceptionalVehicleState=u.emptyArray,e.prototype.proprietaryInfo=u.emptyArray,e.prototype.environmentStatus=u.emptyArray,e.prototype.objectDetection=u.emptyArray,e.prototype.adServiceAndSensorState=u.emptyArray,e.prototype.specificObservedEvent=u.emptyArray,e.prototype.roadCondition=u.emptyArray,e.prototype.roadBoundaryRecognition=u.emptyArray,e.prototype.vehicleManeuver=u.emptyArray,e.prototype.localizationInformation=u.emptyArray,e.prototype.roadAttributerecognition=u.emptyArray,e.prototype.passengerEnvironment=u.emptyArray,e.prototype.roadMarkingRecognition=u.emptyArray,e.prototype.trafficSignalHeadDetection=u.emptyArray,e.prototype.proprietaryDataContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.PathEvents;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.vehicleStatus&&i.vehicleStatus.length||(i.vehicleStatus=[]),i.vehicleStatus.push(d.sdii.here.pb.VehicleStatus.decode(e,e.uint32()));break;case 2:i.vehicleDynamics&&i.vehicleDynamics.length||(i.vehicleDynamics=[]),i.vehicleDynamics.push(d.sdii.here.pb.VehicleDynamics.decode(e,e.uint32()));break;case 3:i.signRecognition&&i.signRecognition.length||(i.signRecognition=[]),i.signRecognition.push(d.sdii.here.pb.SignRecognition.decode(e,e.uint32()));break;case 4:i.laneBoundaryRecognition&&i.laneBoundaryRecognition.length||(i.laneBoundaryRecognition=[]),i.laneBoundaryRecognition.push(d.sdii.here.pb.LaneBoundaryRecognition.decode(e,e.uint32()));break;case 5:i.exceptionalVehicleState&&i.exceptionalVehicleState.length||(i.exceptionalVehicleState=[]),i.exceptionalVehicleState.push(d.sdii.here.pb.ExceptionalVehicleState.decode(e,e.uint32()));break;case 6:i.proprietaryInfo&&i.proprietaryInfo.length||(i.proprietaryInfo=[]),i.proprietaryInfo.push(d.sdii.here.pb.ProprietaryInfo.decode(e,e.uint32()));break;case 7:i.environmentStatus&&i.environmentStatus.length||(i.environmentStatus=[]),i.environmentStatus.push(d.sdii.here.pb.EnvironmentStatus.decode(e,e.uint32()));break;case 8:i.objectDetection&&i.objectDetection.length||(i.objectDetection=[]),i.objectDetection.push(d.sdii.here.pb.ObjectDetection.decode(e,e.uint32()));break;case 9:i.adServiceAndSensorState&&i.adServiceAndSensorState.length||(i.adServiceAndSensorState=[]),i.adServiceAndSensorState.push(d.sdii.here.pb.ADServiceAndSensorState.decode(e,e.uint32()));break;case 10:i.specificObservedEvent&&i.specificObservedEvent.length||(i.specificObservedEvent=[]),i.specificObservedEvent.push(d.sdii.here.pb.SpecificObservedEvent.decode(e,e.uint32()));break;case 11:i.roadCondition&&i.roadCondition.length||(i.roadCondition=[]),i.roadCondition.push(d.sdii.here.pb.RoadCondition.decode(e,e.uint32()));break;case 12:i.roadBoundaryRecognition&&i.roadBoundaryRecognition.length||(i.roadBoundaryRecognition=[]),i.roadBoundaryRecognition.push(d.sdii.here.pb.RoadBoundaryRecognition.decode(e,e.uint32()));break;case 13:i.vehicleManeuver&&i.vehicleManeuver.length||(i.vehicleManeuver=[]),i.vehicleManeuver.push(d.sdii.here.pb.VehicleManeuverEvent.decode(e,e.uint32()));break;case 14:i.localizationInformation&&i.localizationInformation.length||(i.localizationInformation=[]),i.localizationInformation.push(d.sdii.here.pb.LocalizationInformation.decode(e,e.uint32()));break;case 15:i.roadAttributerecognition&&i.roadAttributerecognition.length||(i.roadAttributerecognition=[]),i.roadAttributerecognition.push(d.sdii.here.pb.RoadAttributeRecognition.decode(e,e.uint32()));break;case 16:i.passengerEnvironment&&i.passengerEnvironment.length||(i.passengerEnvironment=[]),i.passengerEnvironment.push(d.sdii.here.pb.PassengerEnvironment.decode(e,e.uint32()));break;case 17:i.roadMarkingRecognition&&i.roadMarkingRecognition.length||(i.roadMarkingRecognition=[]),i.roadMarkingRecognition.push(d.sdii.here.pb.RoadMarkingRecognition.decode(e,e.uint32()));break;case 18:i.trafficSignalHeadDetection&&i.trafficSignalHeadDetection.length||(i.trafficSignalHeadDetection=[]),i.trafficSignalHeadDetection.push(d.sdii.here.pb.TrafficSignalHeadRecognition.decode(e,e.uint32()));break;case 250:i.proprietaryDataContainer&&i.proprietaryDataContainer.length||(i.proprietaryDataContainer=[]),i.proprietaryDataContainer.push(d.sdii.here.pb.ProprietaryDataContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.PathEvents)return e;var t=new d.sdii.here.pb.PathEvents;if(e.vehicleStatus){if(!Array.isArray(e.vehicleStatus))throw TypeError(".sdii.here.pb.PathEvents.vehicleStatus: array expected");t.vehicleStatus=[];for(var r=0;r<e.vehicleStatus.length;++r){if("object"!=typeof e.vehicleStatus[r])throw TypeError(".sdii.here.pb.PathEvents.vehicleStatus: object expected");t.vehicleStatus[r]=d.sdii.here.pb.VehicleStatus.fromObject(e.vehicleStatus[r])}}if(e.vehicleDynamics){if(!Array.isArray(e.vehicleDynamics))throw TypeError(".sdii.here.pb.PathEvents.vehicleDynamics: array expected");for(t.vehicleDynamics=[],r=0;r<e.vehicleDynamics.length;++r){if("object"!=typeof e.vehicleDynamics[r])throw TypeError(".sdii.here.pb.PathEvents.vehicleDynamics: object expected");t.vehicleDynamics[r]=d.sdii.here.pb.VehicleDynamics.fromObject(e.vehicleDynamics[r])}}if(e.signRecognition){if(!Array.isArray(e.signRecognition))throw TypeError(".sdii.here.pb.PathEvents.signRecognition: array expected");for(t.signRecognition=[],r=0;r<e.signRecognition.length;++r){if("object"!=typeof e.signRecognition[r])throw TypeError(".sdii.here.pb.PathEvents.signRecognition: object expected");t.signRecognition[r]=d.sdii.here.pb.SignRecognition.fromObject(e.signRecognition[r])}}if(e.laneBoundaryRecognition){if(!Array.isArray(e.laneBoundaryRecognition))throw TypeError(".sdii.here.pb.PathEvents.laneBoundaryRecognition: array expected");for(t.laneBoundaryRecognition=[],r=0;r<e.laneBoundaryRecognition.length;++r){if("object"!=typeof e.laneBoundaryRecognition[r])throw TypeError(".sdii.here.pb.PathEvents.laneBoundaryRecognition: object expected");t.laneBoundaryRecognition[r]=d.sdii.here.pb.LaneBoundaryRecognition.fromObject(e.laneBoundaryRecognition[r])}}if(e.exceptionalVehicleState){if(!Array.isArray(e.exceptionalVehicleState))throw TypeError(".sdii.here.pb.PathEvents.exceptionalVehicleState: array expected");for(t.exceptionalVehicleState=[],r=0;r<e.exceptionalVehicleState.length;++r){if("object"!=typeof e.exceptionalVehicleState[r])throw TypeError(".sdii.here.pb.PathEvents.exceptionalVehicleState: object expected");t.exceptionalVehicleState[r]=d.sdii.here.pb.ExceptionalVehicleState.fromObject(e.exceptionalVehicleState[r])}}if(e.proprietaryInfo){if(!Array.isArray(e.proprietaryInfo))throw TypeError(".sdii.here.pb.PathEvents.proprietaryInfo: array expected");for(t.proprietaryInfo=[],r=0;r<e.proprietaryInfo.length;++r){if("object"!=typeof e.proprietaryInfo[r])throw TypeError(".sdii.here.pb.PathEvents.proprietaryInfo: object expected");t.proprietaryInfo[r]=d.sdii.here.pb.ProprietaryInfo.fromObject(e.proprietaryInfo[r])}}if(e.environmentStatus){if(!Array.isArray(e.environmentStatus))throw TypeError(".sdii.here.pb.PathEvents.environmentStatus: array expected");for(t.environmentStatus=[],r=0;r<e.environmentStatus.length;++r){if("object"!=typeof e.environmentStatus[r])throw TypeError(".sdii.here.pb.PathEvents.environmentStatus: object expected");t.environmentStatus[r]=d.sdii.here.pb.EnvironmentStatus.fromObject(e.environmentStatus[r])}}if(e.objectDetection){if(!Array.isArray(e.objectDetection))throw TypeError(".sdii.here.pb.PathEvents.objectDetection: array expected");for(t.objectDetection=[],r=0;r<e.objectDetection.length;++r){if("object"!=typeof e.objectDetection[r])throw TypeError(".sdii.here.pb.PathEvents.objectDetection: object expected");t.objectDetection[r]=d.sdii.here.pb.ObjectDetection.fromObject(e.objectDetection[r])}}if(e.adServiceAndSensorState){if(!Array.isArray(e.adServiceAndSensorState))throw TypeError(".sdii.here.pb.PathEvents.adServiceAndSensorState: array expected");for(t.adServiceAndSensorState=[],r=0;r<e.adServiceAndSensorState.length;++r){if("object"!=typeof e.adServiceAndSensorState[r])throw TypeError(".sdii.here.pb.PathEvents.adServiceAndSensorState: object expected");t.adServiceAndSensorState[r]=d.sdii.here.pb.ADServiceAndSensorState.fromObject(e.adServiceAndSensorState[r])}}if(e.specificObservedEvent){if(!Array.isArray(e.specificObservedEvent))throw TypeError(".sdii.here.pb.PathEvents.specificObservedEvent: array expected");for(t.specificObservedEvent=[],r=0;r<e.specificObservedEvent.length;++r){if("object"!=typeof e.specificObservedEvent[r])throw TypeError(".sdii.here.pb.PathEvents.specificObservedEvent: object expected");t.specificObservedEvent[r]=d.sdii.here.pb.SpecificObservedEvent.fromObject(e.specificObservedEvent[r])}}if(e.roadCondition){if(!Array.isArray(e.roadCondition))throw TypeError(".sdii.here.pb.PathEvents.roadCondition: array expected");for(t.roadCondition=[],r=0;r<e.roadCondition.length;++r){if("object"!=typeof e.roadCondition[r])throw TypeError(".sdii.here.pb.PathEvents.roadCondition: object expected");t.roadCondition[r]=d.sdii.here.pb.RoadCondition.fromObject(e.roadCondition[r])}}if(e.roadBoundaryRecognition){if(!Array.isArray(e.roadBoundaryRecognition))throw TypeError(".sdii.here.pb.PathEvents.roadBoundaryRecognition: array expected");for(t.roadBoundaryRecognition=[],r=0;r<e.roadBoundaryRecognition.length;++r){if("object"!=typeof e.roadBoundaryRecognition[r])throw TypeError(".sdii.here.pb.PathEvents.roadBoundaryRecognition: object expected");t.roadBoundaryRecognition[r]=d.sdii.here.pb.RoadBoundaryRecognition.fromObject(e.roadBoundaryRecognition[r])}}if(e.vehicleManeuver){if(!Array.isArray(e.vehicleManeuver))throw TypeError(".sdii.here.pb.PathEvents.vehicleManeuver: array expected");for(t.vehicleManeuver=[],r=0;r<e.vehicleManeuver.length;++r){if("object"!=typeof e.vehicleManeuver[r])throw TypeError(".sdii.here.pb.PathEvents.vehicleManeuver: object expected");t.vehicleManeuver[r]=d.sdii.here.pb.VehicleManeuverEvent.fromObject(e.vehicleManeuver[r])}}if(e.localizationInformation){if(!Array.isArray(e.localizationInformation))throw TypeError(".sdii.here.pb.PathEvents.localizationInformation: array expected");for(t.localizationInformation=[],r=0;r<e.localizationInformation.length;++r){if("object"!=typeof e.localizationInformation[r])throw TypeError(".sdii.here.pb.PathEvents.localizationInformation: object expected");t.localizationInformation[r]=d.sdii.here.pb.LocalizationInformation.fromObject(e.localizationInformation[r])}}if(e.roadAttributerecognition){if(!Array.isArray(e.roadAttributerecognition))throw TypeError(".sdii.here.pb.PathEvents.roadAttributerecognition: array expected");for(t.roadAttributerecognition=[],r=0;r<e.roadAttributerecognition.length;++r){if("object"!=typeof e.roadAttributerecognition[r])throw TypeError(".sdii.here.pb.PathEvents.roadAttributerecognition: object expected");t.roadAttributerecognition[r]=d.sdii.here.pb.RoadAttributeRecognition.fromObject(e.roadAttributerecognition[r])}}if(e.passengerEnvironment){if(!Array.isArray(e.passengerEnvironment))throw TypeError(".sdii.here.pb.PathEvents.passengerEnvironment: array expected");for(t.passengerEnvironment=[],r=0;r<e.passengerEnvironment.length;++r){if("object"!=typeof e.passengerEnvironment[r])throw TypeError(".sdii.here.pb.PathEvents.passengerEnvironment: object expected");t.passengerEnvironment[r]=d.sdii.here.pb.PassengerEnvironment.fromObject(e.passengerEnvironment[r])}}if(e.roadMarkingRecognition){if(!Array.isArray(e.roadMarkingRecognition))throw TypeError(".sdii.here.pb.PathEvents.roadMarkingRecognition: array expected");for(t.roadMarkingRecognition=[],r=0;r<e.roadMarkingRecognition.length;++r){if("object"!=typeof e.roadMarkingRecognition[r])throw TypeError(".sdii.here.pb.PathEvents.roadMarkingRecognition: object expected");t.roadMarkingRecognition[r]=d.sdii.here.pb.RoadMarkingRecognition.fromObject(e.roadMarkingRecognition[r])}}if(e.trafficSignalHeadDetection){if(!Array.isArray(e.trafficSignalHeadDetection))throw TypeError(".sdii.here.pb.PathEvents.trafficSignalHeadDetection: array expected");for(t.trafficSignalHeadDetection=[],r=0;r<e.trafficSignalHeadDetection.length;++r){if("object"!=typeof e.trafficSignalHeadDetection[r])throw TypeError(".sdii.here.pb.PathEvents.trafficSignalHeadDetection: object expected");t.trafficSignalHeadDetection[r]=d.sdii.here.pb.TrafficSignalHeadRecognition.fromObject(e.trafficSignalHeadDetection[r])}}if(e.proprietaryDataContainer){if(!Array.isArray(e.proprietaryDataContainer))throw TypeError(".sdii.here.pb.PathEvents.proprietaryDataContainer: array expected");for(t.proprietaryDataContainer=[],r=0;r<e.proprietaryDataContainer.length;++r){if("object"!=typeof e.proprietaryDataContainer[r])throw TypeError(".sdii.here.pb.PathEvents.proprietaryDataContainer: object expected");t.proprietaryDataContainer[r]=d.sdii.here.pb.ProprietaryDataContainer.fromObject(e.proprietaryDataContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.vehicleStatus=[],r.vehicleDynamics=[],r.signRecognition=[],r.laneBoundaryRecognition=[],r.exceptionalVehicleState=[],r.proprietaryInfo=[],r.environmentStatus=[],r.objectDetection=[],r.adServiceAndSensorState=[],r.specificObservedEvent=[],r.roadCondition=[],r.roadBoundaryRecognition=[],r.vehicleManeuver=[],r.localizationInformation=[],r.roadAttributerecognition=[],r.passengerEnvironment=[],r.roadMarkingRecognition=[],r.trafficSignalHeadDetection=[],r.proprietaryDataContainer=[]),e.vehicleStatus&&e.vehicleStatus.length){r.vehicleStatus=[];for(var i=0;i<e.vehicleStatus.length;++i)r.vehicleStatus[i]=d.sdii.here.pb.VehicleStatus.toObject(e.vehicleStatus[i],t)}if(e.vehicleDynamics&&e.vehicleDynamics.length)for(r.vehicleDynamics=[],i=0;i<e.vehicleDynamics.length;++i)r.vehicleDynamics[i]=d.sdii.here.pb.VehicleDynamics.toObject(e.vehicleDynamics[i],t);if(e.signRecognition&&e.signRecognition.length)for(r.signRecognition=[],i=0;i<e.signRecognition.length;++i)r.signRecognition[i]=d.sdii.here.pb.SignRecognition.toObject(e.signRecognition[i],t);if(e.laneBoundaryRecognition&&e.laneBoundaryRecognition.length)for(r.laneBoundaryRecognition=[],i=0;i<e.laneBoundaryRecognition.length;++i)r.laneBoundaryRecognition[i]=d.sdii.here.pb.LaneBoundaryRecognition.toObject(e.laneBoundaryRecognition[i],t);if(e.exceptionalVehicleState&&e.exceptionalVehicleState.length)for(r.exceptionalVehicleState=[],i=0;i<e.exceptionalVehicleState.length;++i)r.exceptionalVehicleState[i]=d.sdii.here.pb.ExceptionalVehicleState.toObject(e.exceptionalVehicleState[i],t);if(e.proprietaryInfo&&e.proprietaryInfo.length)for(r.proprietaryInfo=[],i=0;i<e.proprietaryInfo.length;++i)r.proprietaryInfo[i]=d.sdii.here.pb.ProprietaryInfo.toObject(e.proprietaryInfo[i],t);if(e.environmentStatus&&e.environmentStatus.length)for(r.environmentStatus=[],i=0;i<e.environmentStatus.length;++i)r.environmentStatus[i]=d.sdii.here.pb.EnvironmentStatus.toObject(e.environmentStatus[i],t);if(e.objectDetection&&e.objectDetection.length)for(r.objectDetection=[],i=0;i<e.objectDetection.length;++i)r.objectDetection[i]=d.sdii.here.pb.ObjectDetection.toObject(e.objectDetection[i],t);if(e.adServiceAndSensorState&&e.adServiceAndSensorState.length)for(r.adServiceAndSensorState=[],i=0;i<e.adServiceAndSensorState.length;++i)r.adServiceAndSensorState[i]=d.sdii.here.pb.ADServiceAndSensorState.toObject(e.adServiceAndSensorState[i],t);if(e.specificObservedEvent&&e.specificObservedEvent.length)for(r.specificObservedEvent=[],i=0;i<e.specificObservedEvent.length;++i)r.specificObservedEvent[i]=d.sdii.here.pb.SpecificObservedEvent.toObject(e.specificObservedEvent[i],t);if(e.roadCondition&&e.roadCondition.length)for(r.roadCondition=[],i=0;i<e.roadCondition.length;++i)r.roadCondition[i]=d.sdii.here.pb.RoadCondition.toObject(e.roadCondition[i],t);if(e.roadBoundaryRecognition&&e.roadBoundaryRecognition.length)for(r.roadBoundaryRecognition=[],i=0;i<e.roadBoundaryRecognition.length;++i)r.roadBoundaryRecognition[i]=d.sdii.here.pb.RoadBoundaryRecognition.toObject(e.roadBoundaryRecognition[i],t);if(e.vehicleManeuver&&e.vehicleManeuver.length)for(r.vehicleManeuver=[],i=0;i<e.vehicleManeuver.length;++i)r.vehicleManeuver[i]=d.sdii.here.pb.VehicleManeuverEvent.toObject(e.vehicleManeuver[i],t);if(e.localizationInformation&&e.localizationInformation.length)for(r.localizationInformation=[],i=0;i<e.localizationInformation.length;++i)r.localizationInformation[i]=d.sdii.here.pb.LocalizationInformation.toObject(e.localizationInformation[i],t);if(e.roadAttributerecognition&&e.roadAttributerecognition.length)for(r.roadAttributerecognition=[],i=0;i<e.roadAttributerecognition.length;++i)r.roadAttributerecognition[i]=d.sdii.here.pb.RoadAttributeRecognition.toObject(e.roadAttributerecognition[i],t);if(e.passengerEnvironment&&e.passengerEnvironment.length)for(r.passengerEnvironment=[],i=0;i<e.passengerEnvironment.length;++i)r.passengerEnvironment[i]=d.sdii.here.pb.PassengerEnvironment.toObject(e.passengerEnvironment[i],t);if(e.roadMarkingRecognition&&e.roadMarkingRecognition.length)for(r.roadMarkingRecognition=[],i=0;i<e.roadMarkingRecognition.length;++i)r.roadMarkingRecognition[i]=d.sdii.here.pb.RoadMarkingRecognition.toObject(e.roadMarkingRecognition[i],t);if(e.trafficSignalHeadDetection&&e.trafficSignalHeadDetection.length)for(r.trafficSignalHeadDetection=[],i=0;i<e.trafficSignalHeadDetection.length;++i)r.trafficSignalHeadDetection[i]=d.sdii.here.pb.TrafficSignalHeadRecognition.toObject(e.trafficSignalHeadDetection[i],t);if(e.proprietaryDataContainer&&e.proprietaryDataContainer.length)for(r.proprietaryDataContainer=[],i=0;i<e.proprietaryDataContainer.length;++i)r.proprietaryDataContainer[i]=d.sdii.here.pb.ProprietaryDataContainer.toObject(e.proprietaryDataContainer[i],t);return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o.MediaContainer=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.mediaType=0,e.prototype.mediaFormat="",e.prototype.mediaContent=u.newBuffer([]),e.prototype.mediaID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.sensorOffset=null,e.prototype.sensorDirection=null,e.prototype.duration_s=0,e.prototype.verticalViewingAngle_deg=0,e.prototype.horizontalViewingAngle_deg=0,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.MediaContainer;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.timeStampUTC_ms=e.int64();break;case 2:i.mediaType=e.int32();break;case 3:i.mediaFormat=e.string();break;case 4:i.mediaContent=e.bytes();break;case 5:i.mediaID=e.int64();break;case 6:i.sensorOffset=d.sdii.here.pb.PositionOffset.decode(e,e.uint32());break;case 7:i.sensorDirection=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 8:i.duration_s=e.int32();break;case 9:i.verticalViewingAngle_deg=e.double();break;case 10:i.horizontalViewingAngle_deg=e.double();break;default:e.skipType(7&n)}}if(!i.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:i});if(!i.hasOwnProperty("mediaType"))throw u.ProtocolError("missing required 'mediaType'",{instance:i});if(!i.hasOwnProperty("mediaFormat"))throw u.ProtocolError("missing required 'mediaFormat'",{instance:i});if(!i.hasOwnProperty("mediaContent"))throw u.ProtocolError("missing required 'mediaContent'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.MediaContainer)return e;var t=new d.sdii.here.pb.MediaContainer;switch(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),e.mediaType){case"MEDIA_TYPE_UNDEFINED":case 0:t.mediaType=0;break;case"OTHER":case 1:t.mediaType=1;break;case"IMAGE":case 2:t.mediaType=2;break;case"VIDEO":case 3:t.mediaType=3;break;case"AUDIO":case 4:t.mediaType=4}if(null!=e.mediaFormat&&(t.mediaFormat=String(e.mediaFormat)),null!=e.mediaContent&&("string"==typeof e.mediaContent?u.base64.decode(e.mediaContent,t.mediaContent=u.newBuffer(u.base64.length(e.mediaContent)),0):e.mediaContent.length&&(t.mediaContent=e.mediaContent)),null!=e.mediaID&&(u.Long?(t.mediaID=u.Long.fromValue(e.mediaID)).unsigned=!1:"string"==typeof e.mediaID?t.mediaID=parseInt(e.mediaID,10):"number"==typeof e.mediaID?t.mediaID=e.mediaID:"object"==typeof e.mediaID&&(t.mediaID=new u.LongBits(e.mediaID.low>>>0,e.mediaID.high>>>0).toNumber())),null!=e.sensorOffset){if("object"!=typeof e.sensorOffset)throw TypeError(".sdii.here.pb.MediaContainer.sensorOffset: object expected");t.sensorOffset=d.sdii.here.pb.PositionOffset.fromObject(e.sensorOffset)}if(null!=e.sensorDirection){if("object"!=typeof e.sensorDirection)throw TypeError(".sdii.here.pb.MediaContainer.sensorDirection: object expected");t.sensorDirection=d.sdii.here.pb.Vector3D.fromObject(e.sensorDirection)}return null!=e.duration_s&&(t.duration_s=0|e.duration_s),null!=e.verticalViewingAngle_deg&&(t.verticalViewingAngle_deg=Number(e.verticalViewingAngle_deg)),null!=e.horizontalViewingAngle_deg&&(t.horizontalViewingAngle_deg=Number(e.horizontalViewingAngle_deg)),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(u.Long){var i=new u.Long(0,0,!1);r.timeStampUTC_ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.timeStampUTC_ms=t.longs===String?"0":0;r.mediaType=t.enums===String?"MEDIA_TYPE_UNDEFINED":0,r.mediaFormat="",r.mediaContent=t.bytes===String?"":[],u.Long?(i=new u.Long(0,0,!1),r.mediaID=t.longs===String?i.toString():t.longs===Number?i.toNumber():i):r.mediaID=t.longs===String?"0":0,r.sensorOffset=null,r.sensorDirection=null,r.duration_s=0,r.verticalViewingAngle_deg=0,r.horizontalViewingAngle_deg=0}return null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?r.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:r.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.mediaType&&e.hasOwnProperty("mediaType")&&(r.mediaType=t.enums===String?d.sdii.here.pb.MediaContainer.MediaTypeEnum[e.mediaType]:e.mediaType),null!=e.mediaFormat&&e.hasOwnProperty("mediaFormat")&&(r.mediaFormat=e.mediaFormat),null!=e.mediaContent&&e.hasOwnProperty("mediaContent")&&(r.mediaContent=t.bytes===String?u.base64.encode(e.mediaContent,0,e.mediaContent.length):t.bytes===Array?Array.prototype.slice.call(e.mediaContent):e.mediaContent),null!=e.mediaID&&e.hasOwnProperty("mediaID")&&("number"==typeof e.mediaID?r.mediaID=t.longs===String?String(e.mediaID):e.mediaID:r.mediaID=t.longs===String?u.Long.prototype.toString.call(e.mediaID):t.longs===Number?new u.LongBits(e.mediaID.low>>>0,e.mediaID.high>>>0).toNumber():e.mediaID),null!=e.sensorOffset&&e.hasOwnProperty("sensorOffset")&&(r.sensorOffset=d.sdii.here.pb.PositionOffset.toObject(e.sensorOffset,t)),null!=e.sensorDirection&&e.hasOwnProperty("sensorDirection")&&(r.sensorDirection=d.sdii.here.pb.Vector3D.toObject(e.sensorDirection,t)),null!=e.duration_s&&e.hasOwnProperty("duration_s")&&(r.duration_s=e.duration_s),null!=e.verticalViewingAngle_deg&&e.hasOwnProperty("verticalViewingAngle_deg")&&(r.verticalViewingAngle_deg=t.json&&!isFinite(e.verticalViewingAngle_deg)?String(e.verticalViewingAngle_deg):e.verticalViewingAngle_deg),null!=e.horizontalViewingAngle_deg&&e.hasOwnProperty("horizontalViewingAngle_deg")&&(r.horizontalViewingAngle_deg=t.json&&!isFinite(e.horizontalViewingAngle_deg)?String(e.horizontalViewingAngle_deg):e.horizontalViewingAngle_deg),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e.MediaTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="MEDIA_TYPE_UNDEFINED"]=0,t[e[1]="OTHER"]=1,t[e[2]="IMAGE"]=2,t[e[3]="VIDEO"]=3,t[e[4]="AUDIO"]=4,t}(),e}(),o.PathMedia=function(){function e(e){if(this.mediaContainer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.mediaContainer=u.emptyArray,e.decode=function(e,t){e instanceof l||(e=l.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.sdii.here.pb.PathMedia;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:i.mediaContainer&&i.mediaContainer.length||(i.mediaContainer=[]),i.mediaContainer.push(d.sdii.here.pb.MediaContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return i},e.decodeDelimited=function(e){return e instanceof l||(e=new l(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.PathMedia)return e;var t=new d.sdii.here.pb.PathMedia;if(e.mediaContainer){if(!Array.isArray(e.mediaContainer))throw TypeError(".sdii.here.pb.PathMedia.mediaContainer: array expected");t.mediaContainer=[];for(var r=0;r<e.mediaContainer.length;++r){if("object"!=typeof e.mediaContainer[r])throw TypeError(".sdii.here.pb.PathMedia.mediaContainer: object expected");t.mediaContainer[r]=d.sdii.here.pb.MediaContainer.fromObject(e.mediaContainer[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.mediaContainer=[]),e.mediaContainer&&e.mediaContainer.length){r.mediaContainer=[];for(var i=0;i<e.mediaContainer.length;++i)r.mediaContainer[i]=d.sdii.here.pb.MediaContainer.toObject(e.mediaContainer[i],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},e}(),o),a),s),e.exports=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.b64toBlob=function(e,t="",r=512){const i=atob(e),n=[];for(let e=0;e<i.length;e+=r){const t=i.slice(e,e+r),o=[];for(let e=0;e<t.length;e+=1)o[e]=t.charCodeAt(e);const a=new Uint8Array(o);n.push(a)}return new Blob(n,{type:t})},t.convertToHumanReadable=function(e){return e.replace(/([A-Z])/g," $1").toLowerCase().replace(/_/g," ").replace(/(\b[a-z](?!\s))/g,e=>e.toUpperCase())}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2);class n{constructor(){this.permanencyMap=new Map,this.m_positions=[],this.m_atlasOffsets=[],this.m_dynamics=[],this.m_data=[]}static getAtlasCoordinates(e){return[e%n.ATLAS_SIZE_Y/n.ATLAS_SIZE_Y,Math.floor(e/n.ATLAS_SIZE_X)/n.ATLAS_SIZE_X]}processEvent(e,t,r,i){this.m_positions.push(r.x,r.y,r.z),0!==e.roadSignPermanency&&void 0!==e.roadSignPermanency||(e.roadSignPermanency=1),i.add(e.roadSignPermanency);let o=this.permanencyMap.get(e.roadSignPermanency);o||(o={signIndexes:[]},this.permanencyMap.set(e.roadSignPermanency,o)),o.signIndexes.push(t);const a=n.getAtlasCoordinates(this.getAtlasIndex(e.roadSignPermanency,e.roadSignType));this.m_atlasOffsets.push(...a);const s=1!==e.roadSignType||1!==e.roadSignPermanency&&2!==e.roadSignPermanency?0:1;this.m_dynamics.push(s),this.m_data.push({timeStampUTC_ms:e.timeStampUTC_ms,roadSignType:e.roadSignType,roadSignValue:e.roadSignValue,roadSignPermanency:e.roadSignPermanency})}getGeometry(e,t){if(0===this.m_positions.length)return;const r=this.m_positions.length/3,o=new Float32Array(r);o.fill(1);const a=new Float32Array(r);a.fill(0);const s=new Float32Array(2*r);for(let e=0;e<s.length;)s[e++]=n.ATLAS_SCALE[0],s[e++]=n.ATLAS_SCALE[1];return{messageId:t,vertexAttributes:[{name:"position",buffer:new Float32Array(this.m_positions).buffer,type:"float",itemCount:3},{name:"alpha",buffer:new Float32Array(a).buffer,type:"float",itemCount:1},{name:"atlasScale",buffer:new Float32Array(s).buffer,type:"float",itemCount:2},{name:"atlasOffset",buffer:new Float32Array(this.m_atlasOffsets).buffer,type:"float",itemCount:2},{name:"scale",buffer:new Float32Array(o).buffer,type:"float",itemCount:1},{name:"dynamic",buffer:new Float32Array(this.m_dynamics).buffer,type:"float",itemCount:1}],type:i.GeometryType.Point,groups:[{start:0,count:0,technique:e,createdOffsets:[]}],signData:this.m_data,signPermanencyMap:this.permanencyMap,objectType:"signs",uuid:`signs-${t}`}}getAtlasIndex(e,t){let r;switch(e){case 1:r=t;break;case 2:r=254;break;default:r=255}return r}}t.SignRecognitionDecoder=n,n.ATLAS_SIZE_X=16,n.ATLAS_SIZE_Y=16,n.ATLAS_SCALE=[1/n.ATLAS_SIZE_X,1/n.ATLAS_SIZE_Y]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(511),n=r(512);t.sdiiTheme={name:"sdii",styles:[{when:"type == 'line'",technique:"solid-line",renderOrder:2200,attr:{id:"line",lineWidth:{interpolation:"Linear",zoomLevels:[10,11,12,13,14,15,16],values:[300,120,60,24,12,7,3]},color:"rgb(0, 255, 255)"}},{when:"type == 'line-inactive'",technique:"solid-line",renderOrder:2200,attr:{id:"line-inactive",lineWidth:{interpolation:"Linear",zoomLevels:[10,11,12,13,14,15,16],values:[300,120,60,24,12,7,3]},color:"rgb(255, 255, 255)"}},{when:"type == 'arrow'",technique:"fill",renderOrder:2201,attr:{transparent:!0,color:"rgb(255, 255, 255)"}},{when:"type == 'circle'",technique:"fill",renderOrder:2202,attr:{transparent:!0,color:"rgb(0, 160, 160)"}},{when:"type == 'sign'",technique:"shader",renderOrder:2203,attr:{id:"sign",params:n.signShaderCfg,primitive:"point"}},{when:"type == 'pathEvent'",technique:"shader",renderOrder:2205,attr:{id:"pathEvent",params:i.eventsShaderCfg,primitive:"point"}}]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.eventsShaderCfg={transparent:!0,depthTest:!0,vertexShader:["attribute float alpha;","attribute float scale;","attribute vec2 atlasScale;","attribute vec2 atlasOffset;","uniform float uSize;","uniform float uDPI;","varying float vAlpha;","varying float vScale;","varying vec2 vAtlasOffset;","varying vec2 vAtlasScale;","void main() {","vAlpha = alpha;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_PointSize = uSize * scale * uDPI;","gl_Position = projectionMatrix * mvPosition;","vAtlasOffset = atlasOffset;","vAtlasScale = atlasScale;","vScale = scale;","if (vScale > 1.0) {","gl_Position.z = 0.95;","} else {","gl_Position.z = 1.0;","}","}"].join("\n"),fragmentShader:["varying float vAlpha;","varying vec2 vAtlasOffset;","varying vec2 vAtlasScale;","varying float vScale;","uniform sampler2D uTexture;","void main() {","vec2 texCoord = gl_PointCoord;","texCoord *= vAtlasScale;","texCoord += vAtlasOffset;","gl_FragColor = texture2D(uTexture, texCoord);","gl_FragColor.a *= vAlpha;","gl_FragColor.a *= vScale;","if (vScale > 0.5 && gl_FragColor.a < 0.1) { discard; }","}"].join("\n"),uniforms:{uTexture:{type:"t",value:null},uSize:{type:"f",value:32},uDPI:{type:"f",value:1}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.signShaderCfg={transparent:!0,depthTest:!0,vertexShader:["attribute float alpha;","attribute float scale;","attribute vec2 atlasScale;","attribute vec2 atlasOffset;","attribute float dynamic;","uniform float uSize;","uniform float uDPI;","varying float vAlpha;","varying float vScale;","varying vec2 vAtlasOffset;","varying vec2 vAtlasScale;","varying float vDynamic;","void main() {","vAlpha = alpha;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_PointSize = uSize * scale * uDPI;","gl_Position = projectionMatrix * mvPosition;","vAtlasOffset = atlasOffset;","vAtlasScale = atlasScale;","vScale = scale;","vDynamic = dynamic;","if (vScale > 1.0) {","gl_Position.z = 0.95;","} else {","gl_Position.z = 1.0;","}","}"].join("\n"),fragmentShader:["varying float vAlpha;","varying vec2 vAtlasOffset;","varying vec2 vAtlasScale;","varying float vScale;","varying float vDynamic;","uniform sampler2D uTexture;","uniform sampler2D uDynamicTexture;","void main() {","vec2 texCoord = gl_PointCoord;","texCoord *= vAtlasScale;","texCoord += vAtlasOffset;","if (vDynamic == 0.0) {","gl_FragColor = texture2D(uTexture, texCoord);","} else {","gl_FragColor = texture2D(uDynamicTexture, texCoord);","}","gl_FragColor.a *= vAlpha;","gl_FragColor.a *= vScale;","if (vScale > 0.5 && gl_FragColor.a < 0.1) { discard; }","}"].join("\n"),uniforms:{uTexture:{type:"t",value:null},uSize:{type:"f",value:32},uDPI:{type:"f",value:1},uDynamicTexture:{type:"t",value:null}}}}]);